import{a as rt,u as it}from"./useFileUpload.e340816f.js";import{bN as Ke,M as Be,K as Ue,a as Pe,f as we,p as pe,_ as nt,r as st,o as at,u as Re,P as We,Q as Ge,h as Ae,e as ge,k as ot,S as lt,U as ut,J as De}from"./index.f883e59e.js";import{f as ze}from"./request.df7e735f.js";import{r as ft}from"./base.203c5653.js";import"./tooltip.f118fcb0.js";import{E as dt}from"./popper.c016fa44.js";/* empty css               */import"./common.cad90977.js";import"./index.4050475c.js";import"./index.e341ea23.js";import"./event.776e7e11.js";import"./index.a1317908.js";import"./scroll.cd049cdb.js";import"./event.3ec63147.js";import"./focus-trap.b3dee7bc.js";import"./validator.922d2bcd.js";import"./index.9499933b.js";import"./directive.88613689.js";var ct="/assets/video-download.3a226681.png",ht="/assets/video-thunder.5e7f4cec.png",vt="/assets/video-motrix.95ef7e61.png",pt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAOeUlEQVR4Xu3dy5EjuRWF4TMGyA550ibIgPZirJjFODIeaDVOaDMvSREKRdRKGy0UVF1mZTV5yGS+ACSA/G/EV1F1p7unu4pA4nEB6nK5fIeG/UN/vvyuL5df9fXyi75///zHq9/00+UP/fye+9vVr3q7cZnw7deMvy/+jPiz4s+MPz/+PyH+v//Wnx7+PmiKPIEKRUMbG/nYuIdG7Q34GPF3GTuJ4e/4hc6hDfIEDjY29njaRqN6/cSu29gxDCMTOoUKyRMoLIbS8dSs7ameS/wbx5FC/Nv9+4Gi5AlkNj7hhzl1/w1+ztghMEI4hDyBDOJJF8PgWFDzBoB745SB0UER8gQSGRs9T/nthl0MOoOM5AnswJM+n7EzYJqQlDyBDWL+OqzYP75wkd6w5fjl4eeA1eQJLDQU4MRqdrvbdK0bipWYIuwgT2AGT/s6xc+EjmA1eQITYt+auX394mfE9GAxeQI3YsGJlfw2DT+zrywaviZP4MNw8IX5fevoCF6SJ04tXiTDqTqe+L0ZOwL/mZ+cPHFaNPxzGEqPWSP4IE+cTrwYWNw7H3YNruSJ0/i2j//44sB5xGvgxOsD8sQpsMCHe/FaOOX6gDzRNYb7eCVeGyebFsgTXRrO4DPcxzIxQvTXUKfkie4M12uxuo91TrJbIE90g6c+Uuh8NCBPdGE4l89TH2l0vDYgTzRvuLf+8YcI7NfdToE80awY8nNMF7nFa6yjugF5okkM+VFSvNY6mRLIE81hyI9jdFE8JE80g1V+1CBeg/7abIg80YRo/FT0oRYNrwvIE9Vjvo8aNbouIE9UbXiHXA7xoFZvrXUC8kS1WOxDG95aKiGWJ6pE40d7mtghkCeqM5zd928uUL8GzhHIE1Vhmw+tq7wTkCeqQeNHLyruBOSJKtD40ZtKC4bkicPR+NGrCkcC8sShaPzoXWWdgDxxGFb7cRYVdQLyxCHY58f5VFEnIE8UN5T3+jcH6F8FFYPyRFHU9uPcDi8blieKiUMTNH7g0ANE8kQRcXaaI73AINrCQfcJyBNFcJkHcC8uFfF2UoA8kR17/cBzB2wPyhNZsd0HvFZ4UVCeyIZFP2CJoouC8kQWLPoByxVcFJQnsuAde4B1Ci0KyhPJMe8HtspeLixPJDXM+/0fBWCZ7OsB8kQyzPuB/aJmxttWQvJEMuz3A2lkrA+QJ5LghB+QVqapgDyRBEN/IK1oU97OEpAnduNmHyCPDFMBeWIXVv2BvBJPBeSJXTjlB+SVeFdAntiMgh+glGQFQvLEJrHnz0EfoJS3VGcF5IlN2PMHykr0TkPyxGos/AHHSLAgKE+sxsIfcIwEC4LyxCpU/AHH2nmDkDyxChV/wLF2VgjKE4ux7QfUYvO2oDyxGE9/oA47rhCTJxbh6b/Pv969/WXw9yf/HVhv0yhAnpjFRR/7/Pevl4f4zw90BNhn4yhAnpjF03+7eOJPxf/+Ofx3/z3AcqtHAfLELJ7+2z17+nvEr2E0gC027AjIEy+x77/Pmohpgf9+YN6qUYA88RJVf/usjZgWxIKh/znAlJXVgfLEJJ7++20NpgVYY0V1oDwxiXf32W9vsEiIJVa8q5A88RQn/tJIEUwLsMTCk4LyxFNc9JlGyqB2AK8svEBUnniK237SSB3UDmDa28Xb8RPyxAMW/9LJFbFIyLQAbsFioDzxgMW/dHIHtQO4tWAxUJ64M1z2+fgHY5sSwbQAt2bOB8gTd1j8S6tkUDuAMLMYKE/cofIvrSOC0cC5zVQGyhOf2PtP76igduDcXtQEyBOfGP6nd3RQO3BOL6YB8sQnhv/p1RJMC87lxTRAnrhi+J9HTUHtwLlMTAPkiSuG/3nUGNQOnMPENECeuKL4J49ag9qB/k0UBckTFP9kVHtQO9C3J0VB8gS1/xm1EkwL+vTkbIA8wVt9Z9RSUDvQnydvKS5PcOtvRi0G04J+PLk1WHcJtv/yajVYJOyHbQfq9osLb/qRV+tB7UAP7q4N1+0XzP8z6yUoKW6XrQPo9gvKfzPrKZgWtMnKgvX5Bfv/+fUYLBK256YeQOMn7P8X0HNQO9COm3oAjZ9Q/19A70HtQBtuzgVo/IT6/wLOEkwL6nZzLkDjJxQAFXC2YJGwTjcFQbp+wgJgGWcMpgV1+lgIVHygArCQMwe1A3X5WAhUfLhQAVjG2YPagZpcKwIVH6gALIQYgkXC431UBCo+sANQCHEf1A4c52MnQPGBEuBCiMdgkfAYHzsBig8X3v67DGI6mBaUd+0A2AIsh5gPFgnLeW/7YguwIGJZMC0o43d9EYeACiLWBbUDeV07AGoAyiHWB7UD+fyi78UpwIKI7cEiYXrXDoAioHKI/UHtQDrvbZ8OoCQiTbBImMZv+klUARZEpA2mBfv8oZ9FFWBBRJ5gkXCbawfARSDlEPmCacF6722fDqAkIn9QO7DGW9QBcA6gFKJMUDuw1LUD8CRyIcoGb2U2iw6gJOKYoHZgEh1AScRxEaMB/3mADqAo4thgXeABHUBJxLERi4P+Mzk5OoCSiOPDfyYnRwdQEnFssA7wgA6gJOLYYEvwAYVAJRHHBQuAz1AJWBRRPjgx+MobZwFKIsoF5cDzroeBOA5cDlEmOBC0zLUD4EKQcoi8Qe3/Otf7AOgAyiHyBMP9ba5XgnEnYDlE+mC4v931UlCuBS+HSBfcALTftQPgjUHKIdIEw/00Pt4XgLcGK4XYF+zpp/aVNwctidgWDPfzuL43IG8PXg6xPhju5/P+8H//ePnuQjlwGcTyYLif33vbj4/fUQ5cCDEfDPfLiDb/2QFQDFQG8Tq4vLOcaPOfHQDFQGUQz4PhfnnR5j87AGoByiDugxLeI3293IwAqAUogfgWDPePFW3+swNgK7AMguF+LaLNf3YA7ASUceZguF+Tt8tHu9f4CTsBBZw1OLFXl48dgKDxE04FFnC24IKOOkVbf+gAWAjM7yzBcL9uHwuAQeMnLAQWcIZguF+/jwXAoPGTKxYC8+o5GO634aMEeKTbL6gIzKzHYLjflo8KwJFuv7hQEZhXb8Fwv0XXCsCRbr/gcpDMeglO7LUr2vhkBxBYB8inh2C43y6b/wd5gnWAjFoOSnjbZ/P/IE9QD5BRi8Fwvx83+/8jeYJ6gIxaC4b7fbnZ/x/JE1e8YWgerQTD/f5Em/Z2PtkBcC4gj9qD4X6/bur/b8kTV2wH5lFzcEFH32z7byRPfGI7ML0ag+F+/55s/43kiU9MA9KrKSjhPY+J4X+QJz4xDUivlmC4fy4Tw/8gT9xhGpDW0cFw/3xeDP+DPHGHaUBaRwXD/fN6MfwP8sQdpgFpHRGc2Du3F8P/IE884LLQdEoGF3Tg5vLPKfLEA84GpFMiGO5j9KT238kTD4azAbx9eAq5g+E+vvm8+/8VeeIpjginkSsY7sM9Ofr7jDzxFIuBaaQOhvuYMrP4N5InJrEYuF/KYLiPKQsW/0byxCQWA/dLEZzYw5wFi38jeeIl7gnYZ28w3Mecmco/J0+8xLXh+2wNSnix3N2133PkiZdiS5DzAdutDYb7WCPa5pNrv16RJ2ZxPmC7NcFwH2vN1P0/I0/MojBouxjKzwXDfWzztvbpH+SJRRgFbBNP9alguI89Njz9gzyxCKOA7WL/3oPhPvbZ9PQP8sRi7AhsF0P8aPQ88ZHGqpX/W/LEYuwIAMfbsPJ/S55YhVEAcLTNT/8gT6xGdSBwjIl3+1lDnliNMwLAMVbU/E+RJzbhpCBQ1ooTf6/IE5sM9wWwLQiU8bb0vP8ceWIzioOAMjYW/TwjT2zGtiCQ38rjvnPkiV1YEATySrDwd0ue2I0LRIE8Fl70uYY8sRtTASC9nRV/U+SJJJgKAGklHvqP5IlkmAoAaWQY+o/kiWSYCgD7ZRr6j+SJpJgKAPskKviZIk8kR4EQsE3Cgp8p8kQWnBgE1klU6z9HnsiC9QBguczz/lvyRDasBwBLJDvos4Q8kRU3CAFzdt3ws5Y8kR31AcBzGff7p8gT2cXchkVB4F6C6722kCeKYFEQ+Kbgop+TJ4qIfyy3CAGh6KKfkyeKYmcA5/aW65DPUvJEcewM4KwObvxBnjgE5cI4n6LbfVPkicOwPYizKFDjv5Q8cSg6AfTugL3+V+SJw9EJoFeVNf4gT1SBdxpCbyps/EGeqAYjAfSi0sYf5Imq0AmgdRU3/iBPVIdOAK2qaLV/ijxRJeoE0J4q9vnnyBPVomIQbTi8vHcNeaJqw9kBDhChVoce7NlCnqhefIM5SozaxGuyscYf5IkmcKkIahJ1Kwed599LnmhGfMPZIcDRKt/mmyNPNIfFQRyjqcW+KfJEk1gXQEmNzvefkSeaFVMCzhAgt4bn+8/IE82jaAh5xPZzE8U9a8gTXWBKgJRix6mTIb+TJ7rBLgFSaKCefw95ojuxUstoAGvFa6aDVf458kSXGA1gjXjqd7TQ94o80TXWBvBKx3P9KfLEKQw7BRwqwqjLFf4l5InTYFqAEK+Bkwz3n5EnTmP8oceQj4NF5xMFPScb7j8jT5xWDAFZH+jfSVb3l5InTi1GBcPhItYHejN07qec578iT+AydAQsFPaBhv+SPAETHQFTg/bQ8BeRJzCBNYI2xIIuc/zF5AnMiBcXx47rw6r+JvIEFhqqClknOFKMyE5UtpuDPIENGBWU9Hb9XjPMT0KewA7jqIDCovSG7+lXnvZpyRNIZOwMWDjcLhp9fA+Z22cjTyADRgZLDcP7eNLT6IuQJ5DZcAjpy/UQCqODsTT3x+v3hOF9cfIECosnXTzxztIhDPv0NPhKyBM42DhCiClDDIdb7hTi7z78G76nwddJnkCFouHcjhSiUQ3rCTXUILxd/y5jQx/n7zT2JsgTaMzYOQxvnR7lyvG0jSH2t45iKJiJkUR0GKPHhjwaf/3YsIfpSexoDA08/l808i78HzPcPJXn8KhQAAAAAElFTkSuQmCC",gt="/assets/video-iina.1db26170.png",mt="/assets/video-vlc.54e63a7e.png",yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAK2UlEQVR4Xu2dC3BUZxXHD4g4VlukLRTEIKhYochjeBRaCoggpQaqBSrQWFuCwLbFDpRhQIs4Y8YRO1Lr4JSWJkCJVihgy0PerxapUhqaQrCFIkUghM1rs7sJVCYcz3d3v+Tuud+9e/dFdpPvP/OfwAzs3j0//v9zv2x2ANDS0tLS0tLS0tLS0tLS0tLS0tJqEHrhi1gJM+jrOqyAf2A5vEFeSr8exP+sVopFg59C9pJR6UrYRu7F/55WCkQJWGABoPY1Ss9K+tqZP4ZWkkQwRtGAryuG7+QAgfmFqDj+eFoJiob7nmLgbl1KNTYdEVrzx9WKQ1gFvRVDjt2VcIx8P398rRhFdfWoZbiJ2AvbCcxd/Hm0XIqAeCxDTdz19Lj5qBd/7EoREOkApWWJXvwxKMVADFdXQmkRLX7Qiz+6UgHkagXgyWrAzTWAvw0APh1s8Im5Qb34HZUMINfJ5yoBd/sAl/sB5zYCUHpOELaT+/Jr0YL4gVwmAIcpBQUEYKFi6C5cPy8I+TNr9eKPkFsgAQLwPgFYTzX0K+tw43ctBH4WgLwlevGHZAfkGu2BjwjAVgLwXOQeSJrnRLqU4OSORGjDr7FFSQIRe+A8pWAfQXiRaugZxQCTaQajwU8FoeSJlrz4j1SBZw2lYJFiaKk0BxGGYZiA4Owg7JpdC/359TZ7zQuAhw8rleYQzCBMMKTr6ff5U2rhy/y6m61uJBAnEAoYODPsWQGom9FSFv+NAhIPDAKBPyXnkh8nT/dD6fQAzG7Wiz/VQDgIFQwzCDMMAULCkP4xOccPJVOb6+JPJRAOgsPgqZAwZCrMMH4ShvEIeSr5R+TJftg3obkt/lQA4RDcwFBVlDkVAoSwAYI8iW7Nf0B3hxNqoH68Dwqyq6Arf20ZqWQC4QDcgrCDoUrFw/5GGNnkB8hjyCN8UDe8BvImZ/riTxYQDoGDsNsV5oqyS4WAIVPxkN9IhQFiLHmUgEG+hzzEBwjVUAYXBzwB+5dk5uJPFAiHoAJhB0O1uM2pUFWUTIWAIUAMEhAudUU4PQeheBfCOz6Ew36EQ/4SeNufzV9v2iteIByCHQwVCGEOQqbCXFEShLBIhYAhQEA5+VwOQsk6hCNlCP8MEogAgRAmGG+HfZD8ln8/HKzOnMWfTCBOu8IpFbyieCp6VxKAiw8ifLQC4djHCO8SgH+F3QDD3whDgBDeXxPy3pp62Fv9KuyuS//FHw8QDiIWGHxfqCpqXLWoodEI/1mKcPwownvBEAThIyYYAoSEYU7FwTCIfQYMhN1UY7vIO6vrYIcvD/5eeQufQ9ooViDxgHBa3MJTKAntL/emGlqEcHIvpYCGVxQMgVDBcKqoAyYYe3xmGAjbydsMl8OW6sf5LNJCsQCxA+EEwy4VA6taIVzw0DLeRMvYSxDqCIJwbSOIoyYQFhh+sbitFSVTIWBIEDsEDF8Ixpaw36xCeKPqZUBsxWfSpHIDxCkV0hyEeV8ICA+Ku6GL06iGChBOnCEINPz360IgGmC4SIWqosyp2OuLhCFSIZMhQGw2QCBsqgz5b1WL+EyaVNGAcBgcCE+GhDGNauhm71iET36P8CHtgeJgCIJ0BIjaRhgyFSoY5oqyLm5TRclUmEA0pCIMYiN5A/n1iquwtjZ93te3A8IhcBAcxgzy3RX9qIZ+iXCK9sBxGswHtZEQLKkQIEwVxUEYMEypiKgotridKmpzdSgVEoYBgrxOuBzhLxUL+FyaTBwIh6ACISsqu0rcDT1FNbSRaqgsBECagzDD4KlQwVClQsKQqZAVpV7c1lREwKhA+KuAIVy5jc+lySSBcAgqGI/QmaBVGR3IzuVTDZ0mCDTYD65EglDBsOwKxeK2gxHv4hapUFXUegajkPzn8nf5XJpMAgiHIEGIu6O+5fcjnF9GNUR74EQwBEH4eIww3KTC6WzBFzdPRcTiDleUJRXhinpNwqC7u7XkV737+FyaTHNMQASEMVV0HihdjHBmD0KJrxGA2W5ACMebCleL2xe5uLc6VJQqFRLGGgPI83wuTaaJPvAYe+CTDQj/LrUO3+xYU6GCwUHEe7YwUuGwuEVFOaVCwlgtvl4eyufSdDp51WMZvMoGiBhg8IqKNRXRKsq8uI2zBUuFZXFHVFQIhHDBpfRZ6IbcAHEDIu6K8lthSBDy2x92i5tXVMPZIkpFGSDIq8pOQUGgAx9J08oJiNuKkiAaYIRBqCrK6cTNzxY8FU6L21xRAgSvKJEKM4z8SzvgT95OfBxNLzsgqoriIOJOhaKilItbpsIEgqfCrqJUqRBeVVYKr5RN42NIH6mAcBDxwrA7catguF3cvKKUi7vcurgLvNdglfcP8MfT6futd0MSiKgntxVlt7hVFSXPFqoTd6oXt4SRX3YI8i9nyAeEJJBYQDilQllRNqmwragYFrdTKlZ7vbQrHku7b7E7SgBJFAYHwSvKdnErUqFa3KqKclrcKz6sh8cWvzhs2LD2/OWmv4oFEAcQsVaUanFLGDIVzu/mWVMRraJWX0CY9xL2HTsa87vdcQQBBvKXmTkqDjQCsQOhSkXK381jqTC+/WFKRd4W7PDQw/jz/t3xU6BSAqC/BLPIGf7RawGEg7CkQjjOVERb3KqKsqSC/NIxhNz5mDNiIJ6F1gKA9HVyAfl2/tIyU8W1ViDRUhENhtPibkiFCYQqFYXnEBa+gNnjx+CBrDvMAMwmSnAPf0mZLQ7EDgYHwRe307t5blKxkXbB0k1497SpuGbAN/nguenB4GlyZv64qKMkEA4iGRUVbXGvPIRZT87F34wZhFegLR+6yqKeCsnp8x540iWAcBiuKoqnIlxRTot73SmEZ5ehZ9I4PNPtK3zY0VxCHskvv/lJAnGbiljOFlvLEJa9hlOnP4pvDfk2H7Bb0xPCAnJbfunNU0UExHUqoi1uSsLqA/jdZ+bj+ux7ETu348ON1a+Ts/glN28JIBxGxOKWMGwqatNx7J23DJfnjMcrfboj3vYZxC+0QmxtGW4sPk3+Hr/UlqEiOofYpULcRfHFvfMCtl1eiM8+mYtnRw5A7EYp6HIzpeEmxHZtENtahhuLqTthMflz/DJbjo4SEBUMWVEH6ZZ07U6ctXghvjNxNGKfLog9b0P8xi2IXQlEFwLRke6Q2iWcis3k7vzyWp4EEH62eLMIf/jc87hlxkTE+76F2K8zgaDDWc+OiHfeHoIhU5F4RZ0lj+eX1XIlgOw5i/e9XIj582fhlQcGIw7thjj4q4iDskIwenUKpeLO9o0VJVMRf0V9Sv41+fP8klq0/pszzoPf6YE4/OuI9xKIIWEQ/ama+lEqeplSISsq8VTsJPfg16JFwlFf8+Dw7qFUSBgRFRVOhYDRWaRCLO64YZwnT+bXoGUSjiAgsqKMVIQrykjFreFUJFxR/yP/jpzZnyG/EcIhWZ5QRYVTwSsq8cV9gKz/iwu3olR4lBWV+NmilJxDzqD3s9NA2Kejx5IKubjjO1tcI79A/hJ/Li0Xwrs6TYpc3OFUxFdRh8n9+HNoxSDs2aFHEs4W5eRc1PWUHGGnmw7HubjrySvIt/LH1EpA2AaGUirEyZkP3MlHyYP5Y2klSTTcmRj6F88Hz11N9mDG/7hNBoiG/H3yxwoIwuJw9wo5zT5P0cyFMOCzNPQJGLp13UBeSZ5HTsPPUmhpaWlpaWlpaWlpaWlpaWlpaWlpaWklqv8Da8GBU4g36CAAAAAASUVORK5CYII=",Et="/assets/video-mxplayer.5dfa69aa.png",xt="/assets/video-mxplayer-pro.10406916.png",He={exports:{}};/*!
 * artplayer.js v4.5.2
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(ye,Ie){(function(O,C,x,T,h){var m=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Be!="undefined"?Be:{},M=typeof m.parcelRequire4dc0=="function"&&m.parcelRequire4dc0,S=M.cache||{},p=typeof Ke=="function"&&Ke.bind(ye);function u(l,c){if(!S[l]){if(!O[l]){var v=typeof m.parcelRequire4dc0=="function"&&m.parcelRequire4dc0;if(!c&&v)return v(l,!0);if(M)return M(l,!0);if(p&&typeof l=="string")return p(l);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}t.resolve=function(r){var e=O[l][1][r];return e!=null?e:r},t.cache={};var i=S[l]=new u.Module(l);O[l][0].call(i.exports,t,i,i.exports,this)}return S[l].exports;function t(r){var e=t.resolve(r);return e===!1?{}:u(e)}}u.isParcelRequire=!0,u.Module=function(l){this.id=l,this.bundle=u,this.exports={}},u.modules=O,u.cache=S,u.parent=M,u.register=function(l,c){O[l]=[function(v,d){d.exports=c},{}]},Object.defineProperty(u,"root",{get:function(){return m.parcelRequire4dc0}}),m.parcelRequire4dc0=u;for(var n=0;n<C.length;n++)u(C[n]);var f=u(x);ye.exports=f})({"6SN6P":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("bundle-text:./style/index.less"),m=T.interopDefault(h),M=O("option-validator"),S=T.interopDefault(M),p=O("./utils/emitter"),u=T.interopDefault(p),n=O("./utils"),f=O("./scheme"),l=T.interopDefault(f),c=O("./config"),v=T.interopDefault(c),d=O("./whitelist"),i=T.interopDefault(d),t=O("./template"),r=T.interopDefault(t),e=O("./i18n"),s=T.interopDefault(e),o=O("./player"),a=T.interopDefault(o),g=O("./control"),A=T.interopDefault(g),D=O("./contextmenu"),y=T.interopDefault(D),E=O("./info"),_=T.interopDefault(E),L=O("./subtitle"),I=T.interopDefault(L),b=O("./events"),R=T.interopDefault(b),P=O("./hotkey"),w=T.interopDefault(P),F=O("./layer"),k=T.interopDefault(F),B=O("./loading"),U=T.interopDefault(B),j=O("./notice"),K=T.interopDefault(j),N=O("./mask"),Z=T.interopDefault(N),$=O("./icons"),Y=T.interopDefault($),ee=O("./setting"),Q=T.interopDefault(ee),G=O("./storage"),q=T.interopDefault(G),te=O("./plugins"),ie=T.interopDefault(te),ne=O("./mobile"),le=T.interopDefault(ne);let se=0;const oe=[];class J extends u.default{constructor(fe,de){super(),this.id=++se;const ve=n.mergeDeep(J.option,fe);this.option=(0,S.default)(ve,l.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new i.default(this),this.template=new r.default(this),this.events=new R.default(this),this.whitelist.state?(this.storage=new q.default(this),this.icons=new Y.default(this),this.i18n=new s.default(this),this.notice=new K.default(this),this.player=new a.default(this),this.layers=new k.default(this),this.controls=new A.default(this),this.contextmenu=new y.default(this),this.subtitle=new I.default(this),this.info=new _.default(this),this.loading=new U.default(this),this.hotkey=new w.default(this),this.mask=new Z.default(this),this.setting=new Q.default(this),this.plugins=new ie.default(this)):this.mobile=new le.default(this),typeof de=="function"&&this.on("ready",()=>de.call(this)),oe.push(this)}static get instances(){return oe}static get version(){return"4.5.2"}static get env(){return"production"}static get build(){return"1655888299105"}static get config(){return v.default}static get utils(){return n}static get scheme(){return l.default}static get Emitter(){return u.default}static get validator(){return S.default}static get kindOf(){return S.default.kindOf}static get html(){return r.default.html}static get option(){return{container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:n.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(fe=!0){this.events.destroy(),this.template.destroy(fe),oe.splice(oe.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(x.default=J,J.NOTICE_TIME=2e3,J.SETTING_WIDTH=250,J.SETTING_ITEM_WIDTH=200,J.SETTING_ITEM_HEIGHT=35,J.INDICATOR_SIZE=14,J.INDICATOR_SIZE_ICON=16,J.INDICATOR_SIZE_MOBILE=18,J.INDICATOR_SIZE_MOBILE_ICON=20,J.VOLUME_PANEL_WIDTH=60,J.VOLUME_HANDLE_WIDTH=12,J.RESIZE_TIME=500,J.SCROLL_TIME=200,J.SCROLL_GAP=50,J.AUTO_PLAYBACK_MAX=10,J.AUTO_PLAYBACK_TIMEOUT=3e3,J.RECONNECT_TIME_MAX=5,J.RECONNECT_SLEEP_TIME=1e3,J.CONTROL_HIDE_TIME=3e3,J.DB_CLICE_TIME=300,J.MOBILE_AUTO_PLAYBACKRATE=3,J.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,J.MOBILE_AUTO_ORIENTATION_TIME=200,J.INFO_LOOP_TIME=1e3,J.FAST_FORWARD_VALUE=3,J.FAST_FORWARD_TIME=1e3,typeof document!="undefined"&&!document.getElementById("artplayer-style")){const ae=document.createElement("style");ae.id="artplayer-style",ae.textContent=m.default,document.head.appendChild(ae)}typeof window!="undefined"&&(window.Artplayer=J),console.log(`%c ArtPlayer %c ${J.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"9EPUe","option-validator":"2A2W5","./utils/emitter":"7pHuB","./utils":"geSvU","./scheme":"3vPoh","./config":"eksZR","./whitelist":"fCKwj","./template":"bqHdK","./i18n":"4O9ZY","./player":"fzROd","./control":"kJ9J9","./contextmenu":"7rh9q","./info":"c896w","./subtitle":"2hqso","./events":"j2hlX","./hotkey":"aTHWZ","./layer":"f2kxw","./loading":"bOs9w","./notice":"ic4th","./mask":"iLfmB","./icons":"5lAmI","./setting":"d5XKP","./storage":"5M8nN","./plugins":"jWfEd","./mobile":"fkUkB","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9EPUe":[function(O,C,x){C.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:none}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-auto-size .art-video-player{transition:all .2s}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player .art-layer-autoPlayback{background-color:#000c;border-radius:3px;align-items:center;padding:10px;line-height:1;display:none;position:absolute;bottom:60px;left:20px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close{cursor:pointer;align-items:center;margin-right:10px;display:flex}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close svg{width:15px;height:15px;fill:#00c9ff}.art-video-player .art-layer-autoPlayback .art-autoPlayback-last{margin-right:10px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-jump{color:#00c9ff;cursor:pointer}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],"2A2W5":[function(O,C,x){C.exports=function(){function T(n){return(T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(n)}var h=Object.prototype.toString,m=function(n){if(n===void 0)return"undefined";if(n===null)return"null";var f=T(n);if(f==="boolean")return"boolean";if(f==="string")return"string";if(f==="number")return"number";if(f==="symbol")return"symbol";if(f==="function")return function(l){return M(l)==="GeneratorFunction"}(n)?"generatorfunction":"function";if(function(l){return Array.isArray?Array.isArray(l):l instanceof Array}(n))return"array";if(function(l){return!(!l.constructor||typeof l.constructor.isBuffer!="function")&&l.constructor.isBuffer(l)}(n))return"buffer";if(function(l){try{if(typeof l.length=="number"&&typeof l.callee=="function")return!0}catch(c){if(c.message.indexOf("callee")!==-1)return!0}return!1}(n))return"arguments";if(function(l){return l instanceof Date||typeof l.toDateString=="function"&&typeof l.getDate=="function"&&typeof l.setDate=="function"}(n))return"date";if(function(l){return l instanceof Error||typeof l.message=="string"&&l.constructor&&typeof l.constructor.stackTraceLimit=="number"}(n))return"error";if(function(l){return l instanceof RegExp||typeof l.flags=="string"&&typeof l.ignoreCase=="boolean"&&typeof l.multiline=="boolean"&&typeof l.global=="boolean"}(n))return"regexp";switch(M(n)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(l){return typeof l.throw=="function"&&typeof l.return=="function"&&typeof l.next=="function"}(n))return"generator";switch(f=h.call(n)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return f.slice(8,-1).toLowerCase().replace(/\s/g,"")};function M(n){return n.constructor?n.constructor.name:null}function S(n,f){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return p(n,f,l),u(n,f,l),function(c,v,d){var i=m(v),t=m(c);if(i==="object"){if(t!=="object")throw new Error("[Type Error]: '".concat(d.join("."),"' require 'object' type, but got '").concat(t,"'"));Object.keys(v).forEach(function(r){var e=c[r],s=v[r],o=d.slice();o.push(r),p(e,s,o),u(e,s,o),S(e,s,o)})}if(i==="array"){if(t!=="array")throw new Error("[Type Error]: '".concat(d.join("."),"' require 'array' type, but got '").concat(t,"'"));c.forEach(function(r,e){var s=c[e],o=v[e]||v[0],a=d.slice();a.push(e),p(s,o,a),u(s,o,a),S(s,o,a)})}}(n,f,l),n}function p(n,f,l){if(m(f)==="string"){var c=m(n);if(f[0]==="?"&&(f=f.slice(1)+"|undefined"),!(-1<f.indexOf("|")?f.split("|").map(function(v){return v.toLowerCase().trim()}).filter(Boolean).some(function(v){return c===v}):f.toLowerCase().trim()===c))throw new Error("[Type Error]: '".concat(l.join("."),"' require '").concat(f,"' type, but got '").concat(c,"'"))}}function u(n,f,l){if(m(f)==="function"){var c=f(n,m(n),l);if(c!==!0){var v=m(c);throw v==="string"?new Error(c):v==="error"?c:new Error("[Validator Error]: The scheme for '".concat(l.join("."),"' validator require return true, but got '").concat(c,"'"))}}}return S.kindOf=m,S}()},{}],"7pHuB":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=class{on(T,h,m){const M=this.e||(this.e={});return(M[T]||(M[T]=[])).push({fn:h,ctx:m}),this}once(T,h,m){const M=this;function S(...p){M.off(T,S),h.apply(m,p)}return S._=h,this.on(T,S,m)}emit(T,...h){const m=((this.e||(this.e={}))[T]||[]).slice();for(let M=0;M<m.length;M+=1)m[M].fn.apply(m[M].ctx,h);return this}off(T,h){const m=this.e||(this.e={}),M=m[T],S=[];if(M&&h)for(let p=0,u=M.length;p<u;p+=1)M[p].fn!==h&&M[p].fn._!==h&&S.push(M[p]);return S.length?m[T]=S:delete m[T],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(O,C,x){x.interopDefault=function(T){return T&&T.__esModule?T:{default:T}},x.defineInteropFlag=function(T){Object.defineProperty(T,"__esModule",{value:!0})},x.exportAll=function(T,h){return Object.keys(T).forEach(function(m){m==="default"||m==="__esModule"||h.hasOwnProperty(m)||Object.defineProperty(h,m,{enumerable:!0,get:function(){return T[m]}})}),h},x.export=function(T,h,m){Object.defineProperty(T,h,{enumerable:!0,get:m})}},{}],geSvU:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./dom");T.exportAll(h,x);var m=O("./error");T.exportAll(m,x);var M=O("./subtitle");T.exportAll(M,x);var S=O("./file");T.exportAll(S,x);var p=O("./property");T.exportAll(p,x);var u=O("./time");T.exportAll(u,x);var n=O("./format");T.exportAll(n,x);var f=O("./compatibility");T.exportAll(f,x)},{"./dom":"ff6Hs","./error":"lDQPM","./subtitle":"1dyFb","./file":"96gQe","./property":"lMM6V","./time":"41yFW","./format":"MRJhs","./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ff6Hs:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x),T.export(x,"query",()=>m),T.export(x,"queryAll",()=>M),T.export(x,"addClass",()=>S),T.export(x,"removeClass",()=>p),T.export(x,"hasClass",()=>u),T.export(x,"append",()=>n),T.export(x,"remove",()=>f),T.export(x,"setStyle",()=>l),T.export(x,"setStyles",()=>c),T.export(x,"getStyle",()=>v),T.export(x,"sublings",()=>d),T.export(x,"inverseClass",()=>i),T.export(x,"tooltip",()=>t),T.export(x,"isInViewport",()=>r),T.export(x,"includeFromEvent",()=>e),T.export(x,"replaceElement",()=>s);var h=O("./compatibility");function m(o,a=document){return a.querySelector(o)}function M(o,a=document){return Array.from(a.querySelectorAll(o))}function S(o,a){return o.classList.add(a)}function p(o,a){return o.classList.remove(a)}function u(o,a){return o.classList.contains(a)}function n(o,a){return a instanceof Element?o.appendChild(a):o.insertAdjacentHTML("beforeend",String(a)),o.lastElementChild||o.lastChild}function f(o){return o.parentNode.removeChild(o)}function l(o,a,g){return o.style[a]=g,o}function c(o,a){return Object.keys(a).forEach(g=>{l(o,g,a[g])}),o}function v(o,a,g=!0){const A=window.getComputedStyle(o,null).getPropertyValue(a);return g?parseFloat(A):A}function d(o){return Array.from(o.parentElement.children).filter(a=>a!==o)}function i(o,a){d(o).forEach(g=>p(g,a)),S(o,a)}function t(o,a,g="top"){h.isMobile||(o.setAttribute("aria-label",a),S(o,"hint--rounded"),S(o,`hint--${g}`))}function r(o,a=0){const g=o.getBoundingClientRect(),A=window.innerHeight||document.documentElement.clientHeight,D=window.innerWidth||document.documentElement.clientWidth,y=g.top-a<=A&&g.top+g.height+a>=0,E=g.left-a<=D+a&&g.left+g.width+a>=0;return y&&E}function e(o,a){return o.composedPath&&o.composedPath().indexOf(a)>-1}function s(o,a){return a.parentNode.replaceChild(o,a),o}},{"./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ki3pQ:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x),T.export(x,"userAgent",()=>h),T.export(x,"isMobile",()=>m),T.export(x,"isSafari",()=>M),T.export(x,"isWechat",()=>S),T.export(x,"isIE",()=>p),T.export(x,"isAndroid",()=>u),T.export(x,"isIOS",()=>n);const h=typeof window!="undefined"?window.navigator.userAgent:"",m=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(h),M=/^((?!chrome|android).)*safari/i.test(h),S=/MicroMessenger/i.test(h),p=/MSIE|Trident/i.test(h),u=/android/i.test(h),n=/iPad|iPhone|iPod/i.test(h)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lDQPM:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x),T.export(x,"ArtPlayerError",()=>h),T.export(x,"errorHandle",()=>m);class h extends Error{constructor(S,p){super(S),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,p||this.constructor),this.name="ArtPlayerError"}}function m(M,S){if(!M)throw new h(S);return M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1dyFb":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(S){return`WEBVTT \r
\r
`.concat((p=S,p.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(u,n,f)=>{let l=f.slice(0,3);return f.length===1&&(l=f+"00"),f.length===2&&(l=f+"0"),`${n},${l}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var p}function m(S){return URL.createObjectURL(new Blob([S],{type:"text/vtt"}))}function M(S){const p=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function u(n=""){return n.split(/[:.]/).map((f,l,c)=>{if(l===c.length-1){if(f.length===1)return`.${f}00`;if(f.length===2)return`.${f}0`}else if(f.length===1)return(l===0?"0":":0")+f;return l===0?f:l===c.length-1?`.${f}`:`:${f}`}).join("")}return`WEBVTT

${S.split(/\r?\n/).map(n=>{const f=n.match(p);return f?{start:u(f[1].trim()),end:u(f[2].trim()),text:f[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(l=>l.trim()).join(`
`)}:null}).filter(n=>n).map((n,f)=>n?`${f+1}
${n.start} --> ${n.end}
${n.text}`:"").filter(n=>n.trim()).join(`

`)}`}T.defineInteropFlag(x),T.export(x,"srtToVtt",()=>h),T.export(x,"vttToBlob",()=>m),T.export(x,"assToVtt",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"96gQe":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(M){return M.includes("?")?h(M.split("?")[0]):M.includes("#")?h(M.split("#")[0]):M.trim().toLowerCase().split(".").pop()}function m(M,S){const p=document.createElement("a");p.style.display="none",p.href=M,p.download=S,document.body.appendChild(p),p.click(),document.body.removeChild(p)}T.defineInteropFlag(x),T.export(x,"getExt",()=>h),T.export(x,"download",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lMM6V:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x),T.export(x,"def",()=>h),T.export(x,"has",()=>M),T.export(x,"get",()=>S),T.export(x,"mergeDeep",()=>p);const h=Object.defineProperty,{hasOwnProperty:m}=Object.prototype;function M(u,n){return m.call(u,n)}function S(u,n){return Object.getOwnPropertyDescriptor(u,n)}function p(...u){const n=f=>f&&typeof f=="object"&&!Array.isArray(f);return u.reduce((f,l)=>(Object.keys(l).forEach(c=>{const v=f[c],d=l[c];Array.isArray(v)&&Array.isArray(d)?f[c]=v.concat(...d):!n(v)||!n(d)||d instanceof Element?f[c]=d:f[c]=p(v,d)}),f),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"41yFW":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(S=0){return new Promise(p=>setTimeout(p,S))}function m(S,p,u){let n;function f(...l){clearTimeout(n),n=setTimeout(function(){n=null,S.apply(u,l)},p)}return f.clearTimeout=function(){clearTimeout(n)},f}function M(S,p){let u,n,f=!1;return function l(...c){if(f)return u=c,void(n=this);f=!0,S.apply(this,c),setTimeout(()=>{f=!1,u&&(l.apply(n,u),u=null,n=null)},p)}}T.defineInteropFlag(x),T.export(x,"sleep",()=>h),T.export(x,"debounce",()=>m),T.export(x,"throttle",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],MRJhs:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(S,p,u){return Math.max(Math.min(S,Math.max(p,u)),Math.min(p,u))}function m(S){const p=Math.floor(S/3600),u=Math.floor((S-3600*p)/60),n=Math.floor(S-3600*p-60*u);return(p>0?[p,u,n]:[u,n]).map(f=>f<10?`0${f}`:String(f)).join(":")}function M(S){return S.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}T.defineInteropFlag(x),T.export(x,"clamp",()=>h),T.export(x,"secondToTime",()=>m),T.export(x,"escape",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3vPoh":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x),T.export(x,"ComponentOption",()=>l);var h=O("../utils");const m="array",M="boolean",S="string",p="number",u="object",n="function";function f(c,v,d){return(0,h.errorHandle)(v===S||v===p||c instanceof Element,`${d.join(".")} require '${S}' or 'Element' type`)}const l={html:f,disable:`?${M}`,name:`?${S}`,index:`?${p}`,style:`?${u}`,click:`?${n}`,mounted:`?${n}`,tooltip:`?${S}|${p}`,width:`?${p}`,selector:`?${m}`,onSelect:`?${n}`,switch:`?${M}`,onSwitch:`?${n}`,range:`?${m}`,onRange:`?${n}`};x.default={container:f,url:S,poster:S,title:S,type:S,theme:S,lang:S,volume:p,isLive:M,muted:M,autoplay:M,autoSize:M,autoMini:M,loop:M,flip:M,playbackRate:M,aspectRatio:M,screenshot:M,setting:M,hotkey:M,pip:M,mutex:M,backdrop:M,fullscreen:M,fullscreenWeb:M,subtitleOffset:M,miniProgressBar:M,useSSR:M,playsInline:M,lock:M,fastForward:M,autoPlayback:M,autoOrientation:M,plugins:[n],whitelist:[`${S}|${n}|regexp`],layers:[l],contextmenu:[l],settings:[l],controls:[{...l,position:(c,v,d)=>{const i=["top","left","right"];return(0,h.errorHandle)(i.includes(c),`${d.join(".")} only accept ${i.toString()} as parameters`)}}],quality:[{default:`?${M}`,html:S,url:S}],highlight:[{time:p,text:S}],thumbnails:{url:S,number:p,column:p},subtitle:{url:S,type:S,style:u,encoding:S},moreVideoAttr:u,icons:u,customType:u}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eksZR:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fCKwj:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("./utils");x.default=class{constructor(h){this.art=h}get state(){const{option:h,constructor:{kindOf:m}}=this.art;return!T.isMobile||h.whitelist.some(M=>{switch(m(M)){case"string":return M==="*"||T.userAgent.indexOf(M)>-1;case"function":return M(T.userAgent);case"regexp":return M.test(T.userAgent);default:return!1}})}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bqHdK:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("./utils");class h{constructor(M){this.art=M;const{option:S,constructor:p,whitelist:u}=M;S.container instanceof Element?this.$container=S.container:(this.$container=(0,T.query)(S.container),(0,T.errorHandle)(this.$container,`No container element found by ${S.container}`));const n=this.$container.tagName.toLowerCase();(0,T.errorHandle)(n==="div",`Unsupported container element type, only support 'div' but got '${n}'`),(0,T.errorHandle)(p.instances.every(f=>f.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=M.id,this.$original=this.$container.cloneNode(!0),u.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.5.2</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(M){return(0,T.query)(M,this.$container)}desktop(){const{option:M}=this.art;M.useSSR||(this.$container.innerHTML=h.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),M.backdrop&&((0,T.addClass)(this.$setting,"art-backdrop-filter"),(0,T.addClass)(this.$contextmenu,"art-backdrop-filter"),(0,T.addClass)(this.$info,"art-backdrop-filter")),T.isMobile&&(0,T.addClass)(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(M){M?(0,T.replaceElement)(this.$original,this.$container):(0,T.addClass)(this.$player,"art-destroy")}}x.default=h},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4O9ZY":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../utils"),m=O("./zh-cn.json"),M=T.interopDefault(m),S=O("./zh-tw.json"),p=T.interopDefault(S),u=O("./pl.json"),n=T.interopDefault(u),f=O("./cs.json"),l=T.interopDefault(f);x.default=class{constructor(c){this.art=c,this.languages={"zh-cn":M.default,"zh-tw":p.default,pl:n.default,cs:l.default},this.init()}init(){const c=this.art.option.lang.toLowerCase();this.language=this.languages[c]||{}}get(c){return this.language[c]||c}update(c){this.languages=(0,h.mergeDeep)(this.languages,c),this.init()}}},{"../utils":"geSvU","./zh-cn.json":"e7BQ4","./zh-tw.json":"5kFyN","./pl.json":"3cd1e","./cs.json":"an7cR","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e7BQ4:[function(O,C,x){C.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F6C\u64AD\u653E"}')},{}],"5kFyN":[function(O,C,x){C.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F49\u64AD\u653E"}')},{}],"3cd1e":[function(O,C,x){C.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Last Seen":"Ostatnio widziany","Jump Play":"Skocz do gry"}')},{}],an7cR:[function(O,C,x){C.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Last Seen":"Naposledy vid\u011Bn","Jump Play":"Hra na skok"}')},{}],fzROd:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./urlMix"),m=T.interopDefault(h),M=O("./attrMix"),S=T.interopDefault(M),p=O("./playMix"),u=T.interopDefault(p),n=O("./pauseMix"),f=T.interopDefault(n),l=O("./toggleMix"),c=T.interopDefault(l),v=O("./seekMix"),d=T.interopDefault(v),i=O("./volumeMix"),t=T.interopDefault(i),r=O("./currentTimeMix"),e=T.interopDefault(r),s=O("./durationMix"),o=T.interopDefault(s),a=O("./switchMix"),g=T.interopDefault(a),A=O("./playbackRateMix"),D=T.interopDefault(A),y=O("./aspectRatioMix"),E=T.interopDefault(y),_=O("./screenshotMix"),L=T.interopDefault(_),I=O("./fullscreenMix"),b=T.interopDefault(I),R=O("./fullscreenWebMix"),P=T.interopDefault(R),w=O("./pipMix"),F=T.interopDefault(w),k=O("./loadedMix"),B=T.interopDefault(k),U=O("./playedMix"),j=T.interopDefault(U),K=O("./playingMix"),N=T.interopDefault(K),Z=O("./autoSizeMix"),$=T.interopDefault(Z),Y=O("./rectMix"),ee=T.interopDefault(Y),Q=O("./flipMix"),G=T.interopDefault(Q),q=O("./miniMix"),te=T.interopDefault(q),ie=O("./loopMix"),ne=T.interopDefault(ie),le=O("./posterMix"),se=T.interopDefault(le),oe=O("./autoHeightMix"),J=T.interopDefault(oe),ae=O("./themeMix"),fe=T.interopDefault(ae),de=O("./titleMix"),ve=T.interopDefault(de),ue=O("./normalSizeMix"),Te=T.interopDefault(ue),he=O("./subtitleOffsetMix"),Ee=T.interopDefault(he),W=O("./optionInit"),z=T.interopDefault(W),V=O("./eventInit"),X=T.interopDefault(V);x.default=class{constructor(H){(0,m.default)(H),(0,S.default)(H),(0,u.default)(H),(0,f.default)(H),(0,c.default)(H),(0,d.default)(H),(0,t.default)(H),(0,e.default)(H),(0,o.default)(H),(0,g.default)(H),(0,D.default)(H),(0,E.default)(H),(0,L.default)(H),(0,b.default)(H),(0,P.default)(H),(0,F.default)(H),(0,B.default)(H),(0,j.default)(H),(0,N.default)(H),(0,$.default)(H),(0,ee.default)(H),(0,G.default)(H),(0,te.default)(H),(0,ne.default)(H),(0,se.default)(H),(0,J.default)(H),(0,fe.default)(H),(0,ve.default)(H),(0,Te.default)(H),(0,Ee.default)(H),(0,X.default)(H),(0,z.default)(H)}}},{"./urlMix":"cChak","./attrMix":"e6Qkm","./playMix":"1FNSV","./pauseMix":"aPHUd","./toggleMix":"joISC","./seekMix":"4wG3e","./volumeMix":"42Xo1","./currentTimeMix":"8Z3pM","./durationMix":"hpnJy","./switchMix":"aCsa8","./playbackRateMix":"61TVa","./aspectRatioMix":"8BV9k","./screenshotMix":"bop8O","./fullscreenMix":"i63VK","./fullscreenWebMix":"bEKHA","./pipMix":"ibIuh","./loadedMix":"kwpxq","./playedMix":"e4Iws","./playingMix":"fueZP","./autoSizeMix":"l6TMg","./rectMix":"6URTt","./flipMix":"joth7","./miniMix":"durkk","./loopMix":"5EZwI","./posterMix":"22WMt","./autoHeightMix":"8pdNr","./themeMix":"eADqm","./titleMix":"8T9U6","./normalSizeMix":"iEQHG","./subtitleOffsetMix":"8CMLG","./optionInit":"aqLU7","./eventInit":"59ETf","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],cChak:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{option:m,template:{$video:M}}=h;(0,T.def)(h,"url",{get:()=>M.currentSrc,async set(S){const p=m.type||(0,T.getExt)(S),u=m.customType[p];p&&u?(await(0,T.sleep)(),h.loading.show=!0,u.call(h,M,S,h)):(h.url&&h.url!==S&&h.once("video:canplay",()=>{h.isReady&&h.emit("restart")}),M.src=S,h.option.url=S,h.emit("url",S))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e6Qkm:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{template:{$video:m}}=h;(0,T.def)(h,"attr",{value(M,S){if(S===void 0)return m[M];m[M]=S}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1FNSV":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,notice:M,option:S,constructor:{instances:p},template:{$video:u}}=h;(0,T.def)(h,"play",{value(){const n=u.play();if(n&&n.then&&n.then().catch(f=>{throw M.show=f,f}),S.mutex)for(let f=0;f<p.length;f++){const l=p[f];l!==h&&l.pause()}return M.show=m.get("Play"),h.emit("play"),n}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPHUd:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{template:{$video:m},i18n:M,notice:S}=h;(0,T.def)(h,"pause",{value(){const p=m.pause();return S.show=M.get("Pause"),h.emit("pause"),p}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joISC:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){(0,T.def)(h,"toggle",{value:()=>h.playing?h.pause():h.play()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4wG3e":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{notice:m}=h;(0,T.def)(h,"seek",{set(M){h.currentTime=M,h.emit("seek",h.currentTime),h.duration&&(m.show=`${(0,T.secondToTime)(h.currentTime)} / ${(0,T.secondToTime)(h.duration)}`)}}),(0,T.def)(h,"forward",{set(M){h.seek=h.currentTime+M}}),(0,T.def)(h,"backward",{set(M){h.seek=h.currentTime-M}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"42Xo1":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{template:{$video:m},i18n:M,notice:S,storage:p}=h;(0,T.def)(h,"volume",{get:()=>m.volume||0,set:u=>{m.volume=(0,T.clamp)(u,0,1),S.show=`${M.get("Volume")}: ${parseInt(100*m.volume,10)}`,m.volume!==0&&p.set("volume",m.volume),h.emit("volume",m.volume)}}),(0,T.def)(h,"muted",{get:()=>m.muted,set:u=>{m.muted=u,h.emit("volume",m.volume)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8Z3pM":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{$video:m}=h.template;(0,T.def)(h,"currentTime",{get:()=>m.currentTime||0,set:M=>{M=parseFloat(M),Number.isNaN(M)||(m.currentTime=(0,T.clamp)(M,0,h.duration))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],hpnJy:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){(0,T.def)(h,"duration",{get:()=>{const{duration:m}=h.template.$video;return m===1/0?0:m||0}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aCsa8:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,option:M,notice:S}=h;function p(u,n,f){return new Promise(l=>{if(u===h.url)return l(u);const{playing:c}=h;h.pause(),URL.revokeObjectURL(h.url),h.url=u,h.once("video:canplay",()=>{h.playbackRate=!1,h.aspectRatio=!1,h.flip="normal",h.autoSize=M.autoSize,h.currentTime=f,h.notice.show="",c&&h.play(),n&&(S.show=`${m.get("Switch Video")}: ${n}`),h.emit("switch",u),l(u)})})}(0,T.def)(h,"switchQuality",{value:(u,n)=>p(u,n,h.currentTime)}),(0,T.def)(h,"switchUrl",{value:(u,n)=>p(u,n,0)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"61TVa":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{template:{$video:m},i18n:M,notice:S}=h;(0,T.def)(h,"playbackRate",{get:()=>m.playbackRate,set(p){if(p){if(p===m.playbackRate)return;const u=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];(0,T.errorHandle)(u.includes(p),`'playbackRate' only accept ${u.toString()} as parameters`),m.playbackRate=p,S.show=`${M.get("Rate")}: ${p===1?M.get("Normal"):`${p}x`}`,h.emit("playbackRate",p)}else h.playbackRate=1,h.emit("playbackRate")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8BV9k":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{template:{$video:m,$player:M},i18n:S,notice:p}=h;(0,T.def)(h,"aspectRatio",{get:()=>M.dataset.aspectRatio||"default",set(u){u||(u="default");const n=["default","4:3","16:9"];if((0,T.errorHandle)(n.includes(u),`'aspectRatio' only accept ${n.toString()} as parameters`),u==="default")(0,T.setStyle)(m,"width",null),(0,T.setStyle)(m,"height",null),(0,T.setStyle)(m,"padding",null),delete M.dataset.aspectRatio;else{const f=u.split(":").map(Number),{videoWidth:l,videoHeight:c}=m,{clientWidth:v,clientHeight:d}=M,i=l/c,t=f[0]/f[1];if(i>t){const r=t*c/l;(0,T.setStyle)(m,"width",100*r+"%"),(0,T.setStyle)(m,"height","100%"),(0,T.setStyle)(m,"padding",`0 ${(v-v*r)/2}px`)}else{const r=l/t/c;(0,T.setStyle)(m,"width","100%"),(0,T.setStyle)(m,"height",100*r+"%"),(0,T.setStyle)(m,"padding",(d-d*r)/2+"px 0")}M.dataset.aspectRatio=u}p.show=`${S.get("Aspect Ratio")}: ${u==="default"?S.get("Default"):u}`,h.emit("aspectRatio",u)}}),(0,T.def)(h,"aspectRatioReset",{set(u){if(u){const{aspectRatio:n}=h;h.aspectRatio=n}}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bop8O:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{option:m,notice:M,template:{$video:S}}=h,p=document.createElement("canvas");(0,T.def)(h,"getDataURL",{value:()=>new Promise((u,n)=>{try{p.width=S.videoWidth,p.height=S.videoHeight,p.getContext("2d").drawImage(S,0,0),u(p.toDataURL("image/png"))}catch(f){M.show=f,n(f)}})}),(0,T.def)(h,"getBlobUrl",{value:()=>new Promise((u,n)=>{try{p.width=S.videoWidth,p.height=S.videoHeight,p.getContext("2d").drawImage(S,0,0),p.toBlob(f=>{u(URL.createObjectURL(f))})}catch(f){M.show=f,n(f)}})}),(0,T.def)(h,"screenshot",{value:async()=>{const u=await h.getDataURL();return(0,T.download)(u,`${m.title||"artplayer"}_${(0,T.secondToTime)(S.currentTime)}.png`),h.emit("screenshot",u),u}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i63VK:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../libs/screenfull"),m=T.interopDefault(h),M=O("../utils");x.default=function(S){const{i18n:p,notice:u,template:{$video:n,$player:f}}=S,l=(0,m.default)();S.once("video:loadedmetadata",()=>{var c;l.isEnabled?(c=S,l.on("change",()=>c.emit("fullscreen",l.isFullscreen)),(0,M.def)(c,"fullscreen",{get:()=>l.isFullscreen,async set(v){v?(c.normalSize="fullscreen",c.aspectRatioReset=!0,c.autoSize=!1,await l.request(f),(0,M.addClass)(f,"art-fullscreen"),c.emit("resize"),c.emit("fullscreen",!0),u.show=""):(c.aspectRatioReset=!0,c.autoSize=c.option.autoSize,await l.exit(),(0,M.removeClass)(f,"art-fullscreen"),c.emit("resize"),c.emit("fullscreen"),u.show="")}})):document.fullscreenEnabled||n.webkitSupportsFullscreen?(v=>{(0,M.def)(v,"fullscreen",{get:()=>n.webkitDisplayingFullscreen,set(d){d?(v.normalSize="fullscreen",n.webkitEnterFullscreen(),v.emit("fullscreen",!0),u.show=""):(n.webkitExitFullscreen(),v.emit("fullscreen"),u.show="")}})})(S):(0,M.def)(S,"fullscreen",{get:()=>!1,set(){u.show=p.get("Fullscreen Not Supported")}}),(0,M.def)(S,"fullscreen",(0,M.get)(S,"fullscreen"))})}},{"../libs/screenfull":"aPwar","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPwar:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(){const T=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],h=(()=>{const S=T[0],p={};for(const u of T)if(u[1]in document){for(const[n,f]of u.entries())p[S[n]]=f;return p}return!1})(),m={change:h.fullscreenchange,error:h.fullscreenerror};let M={request:(S=document.documentElement,p)=>new Promise((u,n)=>{const f=()=>{M.off("change",f),u()};M.on("change",f);const l=S[h.requestFullscreen](p);l instanceof Promise&&l.then(f).catch(n)}),exit:()=>new Promise((S,p)=>{if(!M.isFullscreen)return void S();const u=()=>{M.off("change",u),S()};M.on("change",u);const n=document[h.exitFullscreen]();n instanceof Promise&&n.then(u).catch(p)}),toggle:(S,p)=>M.isFullscreen?M.exit():M.request(S,p),onchange(S){M.on("change",S)},onerror(S){M.on("error",S)},on(S,p){const u=m[S];u&&document.addEventListener(u,p,!1)},off(S,p){const u=m[S];u&&document.removeEventListener(u,p,!1)},raw:h};return Object.defineProperties(M,{isFullscreen:{get:()=>Boolean(document[h.fullscreenElement])},element:{enumerable:!0,get:()=>document[h.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[h.fullscreenEnabled])}}),h||(M={isEnabled:!1}),M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bEKHA:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{notice:m,template:{$player:M}}=h;(0,T.def)(h,"fullscreenWeb",{get:()=>(0,T.hasClass)(M,"art-fullscreen-web"),set(S){S?(h.normalSize="fullscreenWeb",(0,T.addClass)(M,"art-fullscreen-web"),h.aspectRatioReset=!0,h.autoSize=!1,h.emit("resize"),h.emit("fullscreenWeb",!0),m.show=""):((0,T.removeClass)(M,"art-fullscreen-web"),h.aspectRatioReset=!0,h.autoSize=h.option.autoSize,h.emit("resize"),h.emit("fullscreenWeb"),m.show="")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ibIuh:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,notice:M,template:{$video:S}}=h;document.pictureInPictureEnabled?function(p){const{template:{$video:u},events:{proxy:n},notice:f}=p;u.disablePictureInPicture=!1,(0,T.def)(p,"pip",{get:()=>document.pictureInPictureElement,set(l){l?(p.normalSize="pip",u.requestPictureInPicture().catch(c=>{throw f.show=c,c})):document.exitPictureInPicture().catch(c=>{throw f.show=c,c})}}),n(u,"enterpictureinpicture",()=>{p.emit("pip",!0)}),n(u,"leavepictureinpicture",()=>{p.emit("pip")})}(h):S.webkitSupportsPresentationMode?function(p){const{$video:u}=p.template;u.webkitSetPresentationMode("inline"),(0,T.def)(p,"pip",{get:()=>u.webkitPresentationMode==="picture-in-picture",set(n){n?(p.normalSize="pip",u.webkitSetPresentationMode("picture-in-picture"),p.emit("pip",!0)):(u.webkitSetPresentationMode("inline"),p.emit("pip"))}})}(h):(0,T.def)(h,"pip",{get:()=>!1,set(){M.show=m.get("PIP Not Supported")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kwpxq:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{$video:m}=h.template;(0,T.def)(h,"loaded",{get:()=>h.loadedTime/m.duration}),(0,T.def)(h,"loadedTime",{get:()=>m.buffered.length?m.buffered.end(m.buffered.length-1):0})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e4Iws:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){(0,T.def)(h,"played",{get:()=>h.currentTime/h.duration})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fueZP:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{$video:m}=h.template;(0,T.def)(h,"playing",{get:()=>m.currentTime>0&&!m.paused&&!m.ended&&m.readyState>2})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],l6TMg:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{$container:m,$player:M,$video:S}=h.template;(0,T.def)(h,"autoSize",{get:()=>(0,T.hasClass)(m,"art-auto-size"),set(p){if(p){const{videoWidth:u,videoHeight:n}=S,{width:f,height:l}=m.getBoundingClientRect(),c=u/n,v=f/l;if((0,T.addClass)(m,"art-auto-size"),v>c){const d=l*c/f*100;(0,T.setStyle)(M,"width",`${d}%`),(0,T.setStyle)(M,"height","100%")}else{const d=f/c/l*100;(0,T.setStyle)(M,"width","100%"),(0,T.setStyle)(M,"height",`${d}%`)}h.emit("autoSize",{width:h.width,height:h.height})}else(0,T.removeClass)(m,"art-auto-size"),(0,T.setStyle)(M,"width",null),(0,T.setStyle)(M,"height",null),h.emit("autoSize")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"6URTt":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){(0,T.def)(h,"rect",{get:()=>h.template.$player.getBoundingClientRect()});const m=["bottom","height","left","right","top","width"];for(let M=0;M<m.length;M++){const S=m[M];(0,T.def)(h,S,{get:()=>h.rect[S]})}(0,T.def)(h,"x",{get:()=>h.left+window.pageXOffset}),(0,T.def)(h,"y",{get:()=>h.top+window.pageYOffset})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joth7:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{template:{$player:m},i18n:M,notice:S}=h;(0,T.def)(h,"flip",{get:()=>m.dataset.flip||"normal",set(p){p||(p="normal");const u=["normal","horizontal","vertical"];(0,T.errorHandle)(u.includes(p),`'flip' only accept ${u.toString()} as parameters`),p==="normal"?delete m.dataset.flip:m.dataset.flip=p;const n=p.replace(p[0],p[0].toUpperCase());S.show=`${M.get("Video Flip")}: ${M.get(n)}`,h.emit("flip",p)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],durkk:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,option:M,storage:S,events:{proxy:p},template:{$player:u,$miniClose:n,$miniTitle:f,$miniHeader:l}}=h;let c=!1,v=0,d=0,i=0,t=0;p(l,"mousedown",r=>{c=!0,v=r.pageX,d=r.pageY,i=h.left,t=h.top}),p(document,"mousemove",r=>{if(c){(0,T.addClass)(u,"art-is-dragging");const e=t+r.pageY-d,s=i+r.pageX-v;(0,T.setStyle)(u,"top",`${e}px`),(0,T.setStyle)(u,"left",`${s}px`),S.set("top",e),S.set("left",s)}}),p(document,"mouseup",()=>{c=!1,(0,T.removeClass)(u,"art-is-dragging")}),p(n,"click",()=>{h.mini=!1,c=!1,(0,T.removeClass)(u,"art-is-dragging")}),(0,T.append)(f,M.title||m.get("Mini Player")),(0,T.def)(h,"mini",{get:()=>(0,T.hasClass)(u,"art-mini"),set(r){if(r){h.normalSize="mini",h.autoSize=!1,(0,T.addClass)(u,"art-mini");const e=S.get("top"),s=S.get("left");if(e&&s)(0,T.setStyle)(u,"top",`${e}px`),(0,T.setStyle)(u,"left",`${s}px`),(0,T.isInViewport)(l)||(S.del("top"),S.del("left"),h.mini=!0);else{const o=window.innerHeight-h.height-50,a=window.innerWidth-h.width-50;S.set("top",o),S.set("left",a),(0,T.setStyle)(u,"top",`${o}px`),(0,T.setStyle)(u,"left",`${a}px`)}h.aspectRatio=!1,h.playbackRate=!1,h.notice.show="",h.emit("mini",!0)}else(0,T.removeClass)(u,"art-mini"),(0,T.setStyle)(u,"top",null),(0,T.setStyle)(u,"left",null),h.aspectRatio=!1,h.playbackRate=!1,h.autoSize=M.autoSize,h.notice.show="",h.emit("mini")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5EZwI":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){let m=[];(0,T.def)(h,"loop",{get:()=>m,set:M=>{if(Array.isArray(M)&&typeof M[0]=="number"&&typeof M[1]=="number"){const S=(0,T.clamp)(M[0],0,Math.min(M[1],h.duration)),p=(0,T.clamp)(M[1],S,h.duration);p-S>=1?(m=[S,p],h.emit("loop",m)):(m=[],h.emit("loop"))}else m=[],h.emit("loop")}}),h.on("video:timeupdate",()=>{m.length&&(h.currentTime<m[0]||h.currentTime>m[1])&&(h.seek=m[0])})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"22WMt":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{option:m,template:{$poster:M}}=h;(0,T.def)(h,"poster",{get:()=>m.poster,set(S){m.poster=S,(0,T.setStyle)(M,"backgroundImage",`url(${S})`)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8pdNr":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{option:m,template:{$container:M,$video:S}}=h,p=M.style.height;(0,T.def)(h,"autoHeight",{get:()=>(0,T.hasClass)(M,"art-auto-height"),set(u){if(u){const{clientWidth:n}=M,{videoHeight:f,videoWidth:l}=S,c=f*(n/l);(0,T.setStyle)(M,"height",c+"px"),(0,T.addClass)(M,"art-auto-height"),h.autoSize=m.autoSize,h.emit("autoHeight",c)}else(0,T.setStyle)(M,"height",p),(0,T.removeClass)(M,"art-auto-height"),h.autoSize=m.autoSize,h.emit("autoHeight")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eADqm:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{option:m,template:{$player:M}}=h;(0,T.def)(h,"theme",{get:()=>getComputedStyle(M).getPropertyValue("--theme"),set(S){m.theme=S,M.style.setProperty("--theme",S)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8T9U6":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){(0,T.def)(h,"title",{get:()=>h.option.title,set(m){h.option.title=m}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iEQHG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const m=["mini","pip","fullscreen","fullscreenWeb"];(0,T.def)(h,"normalSize",{get:()=>m.every(M=>!h[M]),set(M){m.filter(S=>S!==M).forEach(S=>{h[S]&&(h[S]=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8CMLG":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{clamp:m}=h.constructor.utils,{notice:M,template:S,i18n:p}=h;let u=0,n=[];h.on("subtitle:switch",()=>{n=[]}),(0,T.def)(h,"subtitleOffset",{get:()=>u,set(f){if(S.$track&&S.$track.track){const l=Array.from(S.$track.track.cues);u=m(f,-5,5);for(let c=0;c<l.length;c++){const v=l[c];n[c]||(n[c]={startTime:v.startTime,endTime:v.endTime}),v.startTime=m(n[c].startTime+u,0,h.duration),v.endTime=m(n[c].endTime+u,0,h.duration)}h.subtitle.update(),M.show=`${p.get("Subtitle Offset")}: ${f}s`,h.emit("subtitleOffset",f)}else h.emit("subtitleOffset",0)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aqLU7:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{option:m,storage:M,template:{$video:S,$poster:p}}=h;Object.keys(m.moreVideoAttr).forEach(n=>{h.attr(n,m.moreVideoAttr[n])}),m.muted&&(h.muted=m.muted),m.volume&&(S.volume=(0,T.clamp)(m.volume,0,1));const u=M.get("volume");typeof u=="number"&&(S.volume=(0,T.clamp)(u,0,1)),m.poster&&(0,T.setStyle)(p,"backgroundImage",`url(${m.poster})`),m.autoplay&&(S.autoplay=m.autoplay),m.playsInline&&(S.playsInline=!0,S["webkit-playsinline"]=!0),m.theme&&(h.theme=m.theme),h.url=m.url}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"59ETf":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../config"),m=T.interopDefault(h),M=O("../utils");x.default=function(S){const{i18n:p,notice:u,option:n,constructor:f,events:{proxy:l},template:{$player:c,$video:v,$poster:d}}=S;let i=0;for(let t=0;t<m.default.events.length;t++)l(v,m.default.events[t],r=>{S.emit(`video:${r.type}`,r)});S.on("video:canplay",()=>{i=0,S.loading.show=!1}),S.once("video:canplay",()=>{S.loading.show=!1,S.controls.show=!0,S.mask.show=!0,S.isReady=!0,S.emit("ready")}),S.on("video:ended",()=>{n.loop?(S.seek=0,S.play(),S.controls.show=!1,S.mask.show=!1):(S.controls.show=!0,S.mask.show=!0)}),S.on("video:error",async()=>{i<f.RECONNECT_TIME_MAX?(await(0,M.sleep)(f.RECONNECT_SLEEP_TIME),i+=1,S.url=n.url,u.show=`${p.get("Reconnect")}: ${i}`,S.emit("error",i)):(S.mask.show=!0,S.loading.show=!1,S.controls.show=!0,(0,M.addClass)(c,"art-error"),await(0,M.sleep)(f.RECONNECT_SLEEP_TIME),u.show=p.get("Video Load Failed"),S.destroy(!1))}),S.on("video:loadedmetadata",()=>{S.autoSize=n.autoSize,M.isMobile&&(S.loading.show=!1,S.controls.show=!0,S.mask.show=!0)}),S.on("video:loadstart",()=>{S.loading.show=!0,S.mask.show=!1,S.controls.show=!0}),S.on("video:pause",()=>{S.controls.show=!0,S.mask.show=!0}),S.on("video:play",()=>{S.mask.show=!1,(0,M.setStyle)(d,"display","none")}),S.on("video:playing",()=>{S.mask.show=!1}),S.on("video:seeked",()=>{S.loading.show=!1}),S.on("video:seeking",()=>{S.loading.show=!0,S.mask.show=!1}),S.on("video:timeupdate",()=>{S.mask.show=!1}),S.on("video:waiting",()=>{S.loading.show=!0,S.mask.show=!1})}},{"../config":"eksZR","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kJ9J9:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../utils"),m=O("../utils/component"),M=T.interopDefault(m),S=O("./fullscreen"),p=T.interopDefault(S),u=O("./fullscreenWeb"),n=T.interopDefault(u),f=O("./pip"),l=T.interopDefault(f),c=O("./playAndPause"),v=T.interopDefault(c),d=O("./progress"),i=T.interopDefault(d),t=O("./time"),r=T.interopDefault(t),e=O("./volume"),s=T.interopDefault(e),o=O("./setting"),a=T.interopDefault(o),g=O("./thumbnails"),A=T.interopDefault(g),D=O("./screenshot"),y=T.interopDefault(D),E=O("./quality"),_=T.interopDefault(E),L=O("./loop"),I=T.interopDefault(L);class b extends M.default{constructor(P){super(P),this.name="control";const{constructor:w,events:{proxy:F},template:{$player:k}}=P;let B=Date.now();F(k,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,(0,h.removeClass)(k,"art-hide-cursor"),(0,h.addClass)(k,"art-hover"),B=Date.now()}),P.on("video:timeupdate",()=>{!P.isInput&&P.playing&&this.show&&Date.now()-B>=w.CONTROL_HIDE_TIME&&(this.show=!1,(0,h.addClass)(k,"art-hide-cursor"),(0,h.removeClass)(k,"art-hover"))}),this.init()}init(){const{option:P}=this.art;this.add((0,i.default)({name:"progress",disable:P.isLive,position:"top",index:10})),this.add((0,A.default)({name:"thumbnails",disable:!P.thumbnails.url||P.isLive||h.isMobile,position:"top",index:20})),this.add((0,I.default)({name:"loop",disable:!1,position:"top",index:30})),this.add((0,v.default)({name:"playAndPause",disable:!1,position:"left",index:10})),this.add((0,s.default)({name:"volume",disable:!1,position:"left",index:20})),this.add((0,r.default)({name:"time",disable:P.isLive,position:"left",index:30})),this.add((0,_.default)({name:"quality",disable:P.quality.length===0,position:"right",index:10})),this.add((0,y.default)({name:"screenshot",disable:!P.screenshot||h.isMobile,position:"right",index:20})),this.add((0,a.default)({name:"setting",disable:!P.setting,position:"right",index:30})),this.add((0,l.default)({name:"pip",disable:!P.pip,position:"right",index:40})),this.add((0,n.default)({name:"fullscreenWeb",disable:!P.fullscreenWeb,position:"right",index:50})),this.add((0,p.default)({name:"fullscreen",disable:!P.fullscreen,position:"right",index:60}));for(let w=0;w<P.controls.length;w++)this.add(P.controls[w])}add(P){const w=typeof P=="function"?P(this.art):P,{$progress:F,$controlsLeft:k,$controlsRight:B}=this.art.template;switch(w.position){case"top":this.$parent=F;break;case"left":this.$parent=k;break;case"right":this.$parent=B;break;default:(0,h.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(w)}}x.default=b},{"../utils":"geSvU","../utils/component":"kPHYl","./fullscreen":"awkUw","./fullscreenWeb":"3qoPe","./pip":"lFHYL","./playAndPause":"b8vU1","./progress":"dRwzT","./time":"ltYI1","./volume":"8O7mM","./setting":"lX5UX","./thumbnails":"lUoGG","./screenshot":"jvdQ0","./quality":"k9pKK","./loop":"aE690","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kPHYl:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./dom"),m=O("option-validator"),M=T.interopDefault(m),S=O("../scheme"),p=O("./property"),u=O("./error");x.default=class{constructor(n){this.id=0,this.art=n,this.add=this.add.bind(this)}get show(){return(0,h.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(n){const{$player:f}=this.art.template,l=`art-${this.name}-show`;n?(0,h.addClass)(f,l):(0,h.removeClass)(f,l),this.art.emit(this.name,n)}set toggle(n){n&&(this.show=!this.show)}add(n){const f=typeof n=="function"?n(this.art):n;if(f.html=f.html||"",(0,M.default)(f,S.ComponentOption),!this.$parent||!this.name||f.disable)return;const l=f.name||`${this.name}${this.id}`;(0,u.errorHandle)(!(0,p.has)(this,l),`Cannot add an existing name [${l}] to the [${this.name}]`),this.id+=1;const c=document.createElement("div");(0,h.addClass)(c,`art-${this.name}`),(0,h.addClass)(c,`art-${this.name}-${l}`);const v=Array.from(this.$parent.children);c.dataset.index=f.index||this.id;const d=v.find(i=>Number(i.dataset.index)>=Number(c.dataset.index));return d?d.insertAdjacentElement("beforebegin",c):(0,h.append)(this.$parent,c),f.html&&(0,h.append)(c,f.html),f.style&&(0,h.setStyles)(c,f.style),f.tooltip&&(0,h.tooltip)(c,f.tooltip),f.click&&this.art.events.proxy(c,"click",i=>{i.preventDefault(),f.click.call(this.art,this,i)}),f.selector&&["left","right"].includes(f.position)&&this.selector(f,c),f.mounted&&f.mounted.call(this.art,c),c.childNodes.length===1&&c.childNodes[0].nodeType===3&&(0,h.addClass)(c,"art-control-onlyText"),(0,p.def)(this,l,{value:c}),c}selector(n,f){const{hover:l,proxy:c}=this.art.events;(0,h.addClass)(f,"art-control-selector");const v=document.createElement("div");(0,h.addClass)(v,"art-selector-value"),(0,h.append)(v,n.html),f.innerText="",(0,h.append)(f,v);const d=n.selector.map((r,e)=>`<div class="art-selector-item ${r.default?"art-current":""}" data-index="${e}">${r.html}</div>`).join(""),i=document.createElement("div");(0,h.addClass)(i,"art-selector-list"),(0,h.append)(i,d),(0,h.append)(f,i);const t=()=>{const r=(0,h.getStyle)(f,"width")/2-(0,h.getStyle)(i,"width")/2;i.style.left=`${r}px`};l(f,t),c(i,"click",async r=>{const e=(r.composedPath()||[]).find(a=>(0,h.hasClass)(a,"art-selector-item"));if(!e)return;(0,h.inverseClass)(e,"art-current");const s=Number(e.dataset.index),o=n.selector[s]||{};if(v.innerText=e.innerText,n.onSelect){const a=await n.onSelect.call(this.art,o,e,r);typeof a!="string"&&typeof a!="number"||(v.innerHTML=a)}t(),this.art.emit("selector",o,e)})}}},{"./dom":"ff6Hs","option-validator":"2A2W5","../scheme":"3vPoh","./property":"lMM6V","./error":"lDQPM","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],awkUw:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Fullscreen"),mounted:M=>{const{events:{proxy:S},icons:p,i18n:u}=m,n=(0,T.append)(M,p.fullscreenOn),f=(0,T.append)(M,p.fullscreenOff);(0,T.setStyle)(f,"display","none"),S(M,"click",()=>{m.fullscreen=!m.fullscreen}),m.on("fullscreen",l=>{l?((0,T.tooltip)(M,u.get("Exit Fullscreen")),(0,T.setStyle)(n,"display","none"),(0,T.setStyle)(f,"display","inline-flex")):((0,T.tooltip)(M,u.get("Fullscreen")),(0,T.setStyle)(n,"display","inline-flex"),(0,T.setStyle)(f,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3qoPe":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Web Fullscreen"),mounted:M=>{const{events:{proxy:S},icons:p,i18n:u}=m,n=(0,T.append)(M,p.fullscreenWebOn),f=(0,T.append)(M,p.fullscreenWebOff);(0,T.setStyle)(f,"display","none"),S(M,"click",()=>{m.fullscreenWeb=!m.fullscreenWeb}),m.on("fullscreenWeb",l=>{l?((0,T.tooltip)(M,u.get("Exit Web Fullscreen")),(0,T.setStyle)(n,"display","none"),(0,T.setStyle)(f,"display","inline-flex")):((0,T.tooltip)(M,u.get("Web Fullscreen")),(0,T.setStyle)(n,"display","inline-flex"),(0,T.setStyle)(f,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lFHYL:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("PIP Mode"),mounted:M=>{const{events:{proxy:S},icons:p,i18n:u}=m;(0,T.append)(M,p.pip),S(M,"click",()=>{m.pip=!m.pip}),m.on("pip",n=>{(0,T.tooltip)(M,u.get(n?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],b8vU1:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,mounted:M=>{const{events:{proxy:S},icons:p,i18n:u}=m,n=(0,T.append)(M,p.play),f=(0,T.append)(M,p.pause);function l(){(0,T.setStyle)(n,"display","flex"),(0,T.setStyle)(f,"display","none")}function c(){(0,T.setStyle)(n,"display","none"),(0,T.setStyle)(f,"display","flex")}(0,T.tooltip)(n,u.get("Play")),(0,T.tooltip)(f,u.get("Pause")),S(n,"click",()=>{m.play()}),S(f,"click",()=>{m.pause()}),m.playing?c():l(),m.on("video:playing",()=>{c()}),m.on("video:pause",()=>{l()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],dRwzT:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x),T.export(x,"getPosFromEvent",()=>m);var h=O("../utils");function m(M,S){const{$progress:p}=M.template,{left:u}=p.getBoundingClientRect(),n=S.pageX,f=(0,h.clamp)(n-u,0,p.clientWidth),l=f/p.clientWidth*M.duration;return{second:l,time:(0,h.secondToTime)(l),width:f,percentage:(0,h.clamp)(f/p.clientWidth,0,1)}}x.default=function(M){return S=>{const{icons:p,option:u,events:{proxy:n}}=S;return{...M,html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:f=>{let l=!1;const c=(0,h.query)(".art-progress-loaded",f),v=(0,h.query)(".art-progress-played",f),d=(0,h.query)(".art-progress-highlight",f),i=(0,h.query)(".art-progress-indicator",f),t=(0,h.query)(".art-progress-tip",f);(0,h.setStyle)(v,"backgroundColor","var(--theme)");let r=S.constructor.INDICATOR_SIZE;function e(s,o){s==="loaded"&&(0,h.setStyle)(c,"width",100*o+"%"),s==="played"&&((0,h.setStyle)(v,"width",100*o+"%"),(0,h.setStyle)(i,"left",`calc(${100*o}% - ${r/2}px)`))}p.indicator?(r=S.constructor.INDICATOR_SIZE_ICON,(0,h.append)(i,p.indicator)):(0,h.setStyles)(i,{backgroundColor:"var(--theme)"}),h.isMobile&&(r=S.constructor.INDICATOR_SIZE_MOBILE,p.indicator&&(r=S.constructor.INDICATOR_SIZE_MOBILE_ICON)),(0,h.setStyles)(i,{left:`-${r/2}px`,width:`${r}px`,height:`${r}px`}),S.on("video:loadedmetadata",()=>{for(let s=0;s<u.highlight.length;s++){const o=u.highlight[s],a=(0,h.clamp)(o.time,0,S.duration)/S.duration*100;(0,h.append)(d,`<span data-text="${o.text}" data-time="${o.time}" style="left: ${a}%"></span>`)}}),e("loaded",S.loaded),S.on("setBar",(s,o)=>{e(s,o)}),S.on("video:progress",()=>{e("loaded",S.loaded)}),S.on("video:timeupdate",()=>{e("played",S.played)}),S.on("video:ended",()=>{e("played",1)}),h.isMobile||(n(f,"click",s=>{if(s.target!==i){const{second:o,percentage:a}=m(S,s);e("played",a),S.seek=o}}),n(f,"mousemove",s=>{(0,h.setStyle)(t,"display","block"),(0,h.includeFromEvent)(s,d)?function(o){const{width:a}=m(S,o),{text:g}=o.target.dataset;t.innerHTML=g;const A=t.clientWidth;a<=A/2?(0,h.setStyle)(t,"left",0):a>f.clientWidth-A/2?(0,h.setStyle)(t,"left",f.clientWidth-A+"px"):(0,h.setStyle)(t,"left",a-A/2+"px")}(s):function(o){const{width:a,time:g}=m(S,o);t.innerHTML=g;const A=t.clientWidth;a<=A/2?(0,h.setStyle)(t,"left",0):a>f.clientWidth-A/2?(0,h.setStyle)(t,"left",f.clientWidth-A+"px"):(0,h.setStyle)(t,"left",a-A/2+"px")}(s)}),n(f,"mouseout",()=>{(0,h.setStyle)(t,"display","none")}),n(i,"mousedown",()=>{l=!0}),n(document,"mousemove",s=>{if(l){const{second:o,percentage:a}=m(S,s);e("played",a),S.seek=o}}),n(document,"mouseup",()=>{l&&(l=!1)}))}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ltYI1:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,style:{cursor:"auto"},mounted:M=>{function S(){const u=`${(0,T.secondToTime)(m.currentTime)} / ${(0,T.secondToTime)(m.duration)}`;u!==M.innerText&&(M.innerText=u)}S();const p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let u=0;u<p.length;u++)m.on(p[u],S)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8O7mM":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,mounted:M=>{const{events:{proxy:S},icons:p,i18n:u}=m;let n=!1;const f=m.constructor.VOLUME_PANEL_WIDTH,l=m.constructor.VOLUME_HANDLE_WIDTH,c=(0,T.append)(M,p.volume),v=(0,T.append)(M,p.volumeClose),d=(0,T.append)(M,'<div class="art-volume-panel"></div>'),i=(0,T.append)(d,'<div class="art-volume-slider-handle"></div>');function t(e){const{left:s}=d.getBoundingClientRect();return(0,T.clamp)(e.pageX-s-l/2,0,f-l/2)/(f-l)}function r(e=.7){if(m.muted||e===0)(0,T.setStyle)(c,"display","none"),(0,T.setStyle)(v,"display","flex"),(0,T.setStyle)(i,"left","0");else{const s=(f-l)*e;(0,T.setStyle)(c,"display","flex"),(0,T.setStyle)(v,"display","none"),(0,T.setStyle)(i,"left",`${s}px`)}}(0,T.tooltip)(c,u.get("Mute")),(0,T.setStyle)(v,"display","none"),T.isMobile&&(0,T.setStyle)(d,"display","none"),r(m.volume),m.on("video:volumechange",()=>{r(m.volume)}),S(c,"click",()=>{m.muted=!0}),S(v,"click",()=>{m.muted=!1}),S(d,"click",e=>{m.muted=!1,m.volume=t(e)}),S(i,"mousedown",()=>{n=!0}),S(M,"mousemove",e=>{n&&(m.muted=!1,m.volume=t(e))}),S(document,"mouseup",()=>{n&&(n=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lX5UX:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Show Setting"),mounted:M=>{const{events:{proxy:S},icons:p,i18n:u}=m;(0,T.append)(M,p.setting),S(M,"click",()=>{m.setting.toggle=!0}),m.on("setting",n=>{(0,T.tooltip)(M,u.get(n?"Hide Setting":"Show Setting"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lUoGG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils"),h=O("./progress");x.default=function(m){return M=>({...m,mounted:S=>{const{option:p,template:{$progress:u,$video:n},events:{proxy:f,loadImg:l}}=M;let c=null,v=!1,d=!1;f(u,"mousemove",async i=>{v||(v=!0,c=await l(p.thumbnails.url),d=!0),d&&((0,T.setStyle)(S,"display","block"),function(t){const{width:r}=(0,h.getPosFromEvent)(M,t),{url:e,number:s,column:o}=p.thumbnails,a=c.naturalWidth/o,g=a/(n.videoWidth/n.videoHeight),A=u.clientWidth/s,D=Math.floor(r/A),y=Math.ceil(D/o)-1,E=D%o||o-1;(0,T.setStyle)(S,"backgroundImage",`url(${e})`),(0,T.setStyle)(S,"height",`${g}px`),(0,T.setStyle)(S,"width",`${a}px`),(0,T.setStyle)(S,"backgroundPosition",`-${E*a}px -${y*g}px`),r<=a/2?(0,T.setStyle)(S,"left",0):r>u.clientWidth-a/2?(0,T.setStyle)(S,"left",u.clientWidth-a+"px"):(0,T.setStyle)(S,"left",r-a/2+"px")}(i))}),f(u,"mouseout",()=>{(0,T.setStyle)(S,"display","none")})}})}},{"../utils":"geSvU","./progress":"dRwzT","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jvdQ0:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Screenshot"),mounted:M=>{const{events:{proxy:S},icons:p}=m;(0,T.append)(M,p.screenshot),S(M,"click",()=>{m.screenshot()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k9pKK:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(T){return h=>{const m=h.option.quality,M=m.find(S=>S.default)||m[0];return{...T,html:M?M.html:"",selector:m,onSelect(S){h.switchQuality(S.url,S.html)}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aE690:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>({...h,mounted:M=>{const S=(0,T.append)(M,'<span class="art-loop-point"></span>'),p=(0,T.append)(M,'<span class="art-loop-point"></span>');m.on("loop",u=>{u?((0,T.setStyle)(M,"display","block"),(0,T.setStyle)(S,"left",`calc(${u[0]/m.duration*100}% - ${S.clientWidth}px)`),(0,T.setStyle)(p,"left",u[1]/m.duration*100+"%")):(0,T.setStyle)(M,"display","none")})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7rh9q":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../utils"),m=O("../utils/component"),M=T.interopDefault(m),S=O("./playbackRate"),p=T.interopDefault(S),u=O("./aspectRatio"),n=T.interopDefault(u),f=O("./flip"),l=T.interopDefault(f),c=O("./info"),v=T.interopDefault(c),d=O("./version"),i=T.interopDefault(d),t=O("./close"),r=T.interopDefault(t);class e extends M.default{constructor(o){super(o),this.name="contextmenu",this.$parent=o.template.$contextmenu,h.isMobile||this.init()}init(){const{option:o,template:{$player:a,$contextmenu:g},events:{proxy:A}}=this.art;this.add((0,p.default)({disable:!o.playbackRate,name:"playbackRate",index:10})),this.add((0,n.default)({disable:!o.aspectRatio,name:"aspectRatio",index:20})),this.add((0,l.default)({disable:!o.flip,name:"flip",index:30})),this.add((0,v.default)({disable:!1,name:"info",index:40})),this.add((0,i.default)({disable:!1,name:"version",index:50})),this.add((0,r.default)({disable:!1,name:"close",index:60}));for(let D=0;D<o.contextmenu.length;D++)this.add(o.contextmenu[D]);A(a,"contextmenu",D=>{D.preventDefault(),this.show=!0;const y=D.clientX,E=D.clientY,{height:_,width:L,left:I,top:b}=a.getBoundingClientRect(),{height:R,width:P}=g.getBoundingClientRect();let w=y-I,F=E-b;y+P>I+L&&(w=L-P),E+R>b+_&&(F=_-R),(0,h.setStyles)(g,{top:`${F}px`,left:`${w}px`})}),A(a,"click",D=>{(0,h.includeFromEvent)(D,g)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}x.default=e},{"../utils":"geSvU","../utils/component":"kPHYl","./playbackRate":"9P3rd","./aspectRatio":"3OqVf","./flip":"iMg4Y","./info":"9FFXO","./version":"duhqU","./close":"k3lJQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9P3rd":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>{const{i18n:M}=m;return{...h,html:`${M.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${M.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(S,p)=>{const{value:u}=p.target.dataset;u&&(m.playbackRate=Number(u),S.show=!1)},mounted:S=>{m.on("playbackRate",p=>{const u=(0,T.queryAll)("span",S).find(n=>Number(n.dataset.value)===p);u&&(0,T.inverseClass)(u,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3OqVf":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>{const{i18n:M}=m;return{...h,html:`${M.get("Aspect Ratio")}:<span data-value="default" class="art-current">${M.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(S,p)=>{const{value:u}=p.target.dataset;u&&(m.aspectRatio=u,S.show=!1)},mounted:S=>{m.on("aspectRatio",p=>{const u=(0,T.queryAll)("span",S).find(n=>n.dataset.value===p);u&&(0,T.inverseClass)(u,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iMg4Y:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){return m=>{const{i18n:M}=m;return{...h,html:`${M.get("Video Flip")}:<span data-value="normal" class="art-current">${M.get("Normal")}</span><span data-value="horizontal">${M.get("Horizontal")}</span><span data-value="vertical">${M.get("Vertical")}</span>`,click:(S,p)=>{const{value:u}=p.target.dataset;u&&(m.flip=u,S.show=!1)},mounted:S=>{m.on("flip",p=>{const u=(0,T.queryAll)("span",S).find(n=>n.dataset.value===p);u&&(0,T.inverseClass)(u,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9FFXO":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(T){return h=>({...T,html:h.i18n.get("Video Info"),click:m=>{h.info.show=!0,m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],duhqU:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(T){return{...T,html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.5.2</a>'}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k3lJQ:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(T){return h=>({...T,html:h.i18n.get("Close"),click:m=>{m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],c896w:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=T.interopDefault(m);class S extends M.default{constructor(u){super(u),this.name="info",h.isMobile||this.init()}init(){const{constructor:u,events:{proxy:n},template:{$infoPanel:f,$infoClose:l,$video:c}}=this.art;n(l,"click",()=>{this.show=!1});let v=null;const d=(0,h.queryAll)("[data-video]",f)||[];this.art.on("destroy",()=>{clearTimeout(v)}),function i(){for(let t=0;t<d.length;t++){const r=d[t],e=c[r.dataset.video],s=typeof e=="number"?e.toFixed(2):e;r.innerText!==s&&(r.innerText=s)}v=setTimeout(i,u.INFO_LOOP_TIME)}()}}x.default=S},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"2hqso":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=T.interopDefault(m),S=O("option-validator"),p=T.interopDefault(S),u=O("./scheme"),n=T.interopDefault(u);class f extends M.default{constructor(c){super(c),this.name="subtitle",this.init(c.option.subtitle)}get url(){return this.art.template.$track.src}set url(c){this.switch(c)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(c,v){const{$subtitle:d}=this.art.template;return typeof c=="object"?(0,h.setStyles)(d,c):(0,h.setStyle)(d,c,v)}update(){const{$subtitle:c}=this.art.template;c.innerHTML="",this.activeCue&&(c.innerHTML=this.activeCue.text.split(/\r?\n/).map(v=>`<p>${(0,h.escape)(v)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}async switch(c,v={}){const{i18n:d,notice:i,option:t}=this.art,r={...t.subtitle,...v,url:c},e=await this.init(r);return v.name&&(i.show=`${d.get("Switch Subtitle")}: ${v.name}`),e}init(c){if((0,p.default)(c,n.default.subtitle),!c.url)return;const{notice:v,events:{proxy:d},template:{$subtitle:i,$video:t,$track:r}}=this.art;if(!r){const e=document.createElement("track");e.default=!0,e.kind="metadata",t.appendChild(e),this.art.template.$track=e,d(this.textTrack,"cuechange",this.update.bind(this))}return this.style(c.style),(0,h.errorHandle)(window.fetch,"fetch not support"),fetch(c.url).then(e=>e.arrayBuffer()).then(e=>{(0,h.errorHandle)(window.TextDecoder,"TextDecoder not support");const s=new TextDecoder(c.encoding).decode(e);switch(this.art.emit("subtitleLoad",c.url),c.type||(0,h.getExt)(c.url)){case"srt":return(0,h.vttToBlob)((0,h.srtToVtt)(s));case"ass":return(0,h.vttToBlob)((0,h.assToVtt)(s));case"vtt":return(0,h.vttToBlob)(s);default:return c.url}}).then(e=>(i.innerHTML="",this.url===e||(URL.revokeObjectURL(this.url),this.art.template.$track.src=e,this.art.emit("subtitleSwitch",e)),e)).catch(e=>{throw v.show=e,e})}}x.default=f},{"./utils":"geSvU","./utils/component":"kPHYl","option-validator":"2A2W5","./scheme":"3vPoh","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j2hlX:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../utils/error"),m=O("./clickInit"),M=T.interopDefault(m),S=O("./hoverInit"),p=T.interopDefault(S),u=O("./mousemoveInit"),n=T.interopDefault(u),f=O("./resizeInit"),l=T.interopDefault(f),c=O("./gestureInit"),v=T.interopDefault(c),d=O("./viewInit"),i=T.interopDefault(d);x.default=class{constructor(t){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),t.whitelist.state&&((0,M.default)(t,this),(0,p.default)(t,this),(0,n.default)(t,this),(0,l.default)(t,this),(0,v.default)(t,this),(0,i.default)(t,this))}proxy(t,r,e,s={}){if(Array.isArray(r))return r.map(a=>this.proxy(t,a,e,s));t.addEventListener(r,e,s);const o=()=>t.removeEventListener(r,e,s);return this.destroyEvents.push(o),o}hover(t,r,e){r&&this.proxy(t,"mouseenter",r),e&&this.proxy(t,"mouseleave",e)}loadImg(t){return new Promise((r,e)=>{let s;if(t instanceof HTMLImageElement)s=t;else{if(typeof t!="string")return e(new h.ArtPlayerError("Unable to get Image"));s=new Image,s.src=t}if(s.complete)return r(s);this.proxy(s,"load",()=>r(s)),this.proxy(s,"error",()=>e(new h.ArtPlayerError(`Failed to load Image: ${s.src}`)))})}destroy(){for(let t=0;t<this.destroyEvents.length;t++)this.destroyEvents[t]()}}},{"../utils/error":"lDQPM","./clickInit":"iP4Z9","./hoverInit":"aoIIW","./mousemoveInit":"4WC5c","./resizeInit":"7fpan","./gestureInit":"ixtiG","./viewInit":"5WvmH","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iP4Z9:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h,m){const{constructor:M,template:{$player:S,$video:p}}=h;m.proxy(document,["click","contextmenu"],n=>{(0,T.includeFromEvent)(n,S)?(h.isInput=n.target.tagName==="INPUT",h.isFocus=!0,h.emit("focus")):(h.isInput=!1,h.isFocus=!1,h.emit("blur"))});let u=0;m.proxy(p,"click",()=>{const n=Date.now();n-u<=M.DB_CLICE_TIME?(h.emit("dblclick"),T.isMobile?h.isLock||h.toggle():h.fullscreen=!h.fullscreen):(h.emit("click"),T.isMobile||h.toggle()),u=n})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aoIIW:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h,m){const{$player:M}=h.template;m.hover(M,()=>{(0,T.addClass)(M,"art-hover"),h.emit("hover",!0)},()=>{(0,T.removeClass)(M,"art-hover"),h.emit("hover")})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4WC5c":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(T,h){const{$player:m}=T.template;h.proxy(m,"mousemove",M=>{T.emit("mousemove",M)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7fpan":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h,m){const{option:M}=h,S=(0,T.throttle)(()=>{h.normalSize&&(h.autoSize=M.autoSize),h.aspectRatioReset=!0,h.notice.show="",h.emit("resize")},h.constructor.RESIZE_TIME);m.proxy(window,["orientationchange","resize"],()=>{S()}),screen&&screen.orientation&&screen.orientation.onchange&&m.proxy(screen.orientation,"change",()=>{S()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ixtiG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h,m){if(T.isMobile&&!h.option.isLive){const{$video:M,$bottom:S,$controls:p}=h.template;let u=!1,n=0,f=0,l=0;const c=i=>{if(i.touches.length===1&&!h.isLock){u=!0;const{clientX:t,clientY:r}=i.touches[0];n=t,f=r,l=h.currentTime}},v=i=>{if(i.touches.length===1&&u&&h.duration){const t=h.plugins.autoOrientation&&h.plugins.autoOrientation.state,{clientX:r,clientY:e}=i.touches[0],s=(0,T.clamp)((r-n)/h.width,-1,1),o=(0,T.clamp)((e-f)/h.height,-1,1),a=t?o:s,g=(0,T.clamp)(l+h.duration*a/2,0,h.duration);h.seek=g,h.emit("setBar","played",(0,T.clamp)(g/h.duration,0,1)),h.notice.show=`${(0,T.secondToTime)(g)} / ${(0,T.secondToTime)(h.duration)}`}},d=()=>{u&&(n=0,f=0,l=0,u=!1)};m.proxy(S,"touchstart",i=>{(0,T.includeFromEvent)(i,p)||c(i)}),m.proxy(S,"touchmove",v),m.proxy(M,"touchstart",c),m.proxy(M,"touchmove",v),m.proxy(document,"touchend",d)}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5WvmH":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h,m){const{option:M,constructor:S,template:{$container:p}}=h,u=(0,T.throttle)(()=>{h.emit("view",(0,T.isInViewport)(p,S.SCROLL_GAP))},S.SCROLL_TIME);m.proxy(window,"scroll",()=>{u()}),h.on("view",n=>{M.autoMini&&(h.mini=!n)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aTHWZ:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("./utils");x.default=class{constructor(h){this.art=h,this.keys={},h.option.hotkey&&!T.isMobile&&this.init()}init(){const{proxy:h}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),h(window,"keydown",m=>{if(this.art.isFocus){const M=document.activeElement.tagName.toUpperCase(),S=document.activeElement.getAttribute("contenteditable");if(M!=="INPUT"&&M!=="TEXTAREA"&&S!==""&&S!=="true"){const p=this.keys[m.keyCode];if(p){m.preventDefault();for(let u=0;u<p.length;u++)p[u].call(this.art,m);this.art.emit("hotkey",m)}}}})}add(h,m){return this.keys[h]?this.keys[h].push(m):this.keys[h]=[m],this}remove(h,m){if(this.keys[h]){const M=this.keys[h].indexOf(m);M!==-1&&this.keys[h].splice(M,1)}return this}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],f2kxw:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./utils/component"),m=T.interopDefault(h);class M extends m.default{constructor(p){super(p);const{option:u,template:{$layer:n}}=p;this.name="layer",this.$parent=n;for(let f=0;f<u.layers.length;f++)this.add(u.layers[f])}}x.default=M},{"./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bOs9w:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=T.interopDefault(m);class S extends M.default{constructor(u){super(u),this.name="loading",(0,h.append)(u.template.$loading,u.icons.loading)}}x.default=S},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ic4th:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("./utils");x.default=class{constructor(h){this.art=h,this.timer=null}set show(h){const{constructor:m,template:{$player:M,$noticeInner:S}}=this.art;h?(S.innerText=h instanceof Error?h.message.trim():h,(0,T.addClass)(M,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{S.innerText="",(0,T.removeClass)(M,"art-notice-show")},m.NOTICE_TIME)):(0,T.removeClass)(M,"art-notice-show")}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iLfmB:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=T.interopDefault(m);class S extends M.default{constructor(u){super(u),this.name="mask";const{template:n,icons:f,events:l}=u,c=(0,h.append)(n.$state,f.state),v=(0,h.append)(n.$state,f.error);(0,h.setStyle)(v,"display","none"),u.on("destroy",()=>{(0,h.setStyle)(c,"display","none"),(0,h.setStyle)(v,"display",null)}),l.proxy(n.$state,"click",()=>u.play())}}x.default=S},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5lAmI":[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../utils"),m=O("bundle-text:./loading.svg"),M=T.interopDefault(m),S=O("bundle-text:./state.svg"),p=T.interopDefault(S),u=O("bundle-text:./check.svg"),n=T.interopDefault(u),f=O("bundle-text:./play.svg"),l=T.interopDefault(f),c=O("bundle-text:./pause.svg"),v=T.interopDefault(c),d=O("bundle-text:./volume.svg"),i=T.interopDefault(d),t=O("bundle-text:./volume-close.svg"),r=T.interopDefault(t),e=O("bundle-text:./screenshot.svg"),s=T.interopDefault(e),o=O("bundle-text:./setting.svg"),a=T.interopDefault(o),g=O("bundle-text:./arrow-left.svg"),A=T.interopDefault(g),D=O("bundle-text:./arrow-right.svg"),y=T.interopDefault(D),E=O("bundle-text:./playback-rate.svg"),_=T.interopDefault(E),L=O("bundle-text:./aspect-ratio.svg"),I=T.interopDefault(L),b=O("bundle-text:./config.svg"),R=T.interopDefault(b),P=O("bundle-text:./pip.svg"),w=T.interopDefault(P),F=O("bundle-text:./lock.svg"),k=T.interopDefault(F),B=O("bundle-text:./unlock.svg"),U=T.interopDefault(B),j=O("bundle-text:./fullscreen-off.svg"),K=T.interopDefault(j),N=O("bundle-text:./fullscreen-on.svg"),Z=T.interopDefault(N),$=O("bundle-text:./fullscreen-web-off.svg"),Y=T.interopDefault($),ee=O("bundle-text:./fullscreen-web-on.svg"),Q=T.interopDefault(ee),G=O("bundle-text:./switch-on.svg"),q=T.interopDefault(G),te=O("bundle-text:./switch-off.svg"),ie=T.interopDefault(te),ne=O("bundle-text:./flip.svg"),le=T.interopDefault(ne),se=O("bundle-text:./error.svg"),oe=T.interopDefault(se),J=O("bundle-text:./close.svg"),ae=T.interopDefault(J);x.default=class{constructor(fe){const de={loading:M.default,state:p.default,play:l.default,pause:v.default,check:n.default,volume:i.default,volumeClose:r.default,screenshot:s.default,setting:a.default,pip:w.default,arrowLeft:A.default,arrowRight:y.default,playbackRate:_.default,aspectRatio:I.default,config:R.default,lock:k.default,flip:le.default,unlock:U.default,fullscreenOff:K.default,fullscreenOn:Z.default,fullscreenWebOff:Y.default,fullscreenWebOn:Q.default,switchOn:q.default,switchOff:ie.default,error:oe.default,close:ae.default,...fe.option.icons};Object.keys(de).forEach(ve=>{(0,h.def)(this,ve,{get:()=>{const ue=document.createElement("i");return(0,h.addClass)(ue,"art-icon"),(0,h.addClass)(ue,`art-icon-${ve}`),(0,h.append)(ue,de[ve]),ue}})})}}},{"../utils":"geSvU","bundle-text:./loading.svg":"hX0lQ","bundle-text:./state.svg":"01U3R","bundle-text:./check.svg":"9jaCP","bundle-text:./play.svg":"invok","bundle-text:./pause.svg":"68285","bundle-text:./volume.svg":"3zSKr","bundle-text:./volume-close.svg":"ft8Zf","bundle-text:./screenshot.svg":"dfLel","bundle-text:./setting.svg":"j8dnn","bundle-text:./arrow-left.svg":"fMoi9","bundle-text:./arrow-right.svg":"auIjA","bundle-text:./playback-rate.svg":"g3V1U","bundle-text:./aspect-ratio.svg":"3LQJt","bundle-text:./config.svg":"bcTkc","bundle-text:./pip.svg":"jDSoL","bundle-text:./lock.svg":"jqFLt","bundle-text:./unlock.svg":"5qYod","bundle-text:./fullscreen-off.svg":"25MvP","bundle-text:./fullscreen-on.svg":"6CCX4","bundle-text:./fullscreen-web-off.svg":"m9TwS","bundle-text:./fullscreen-web-on.svg":"iWJrW","bundle-text:./switch-on.svg":"8cFxH","bundle-text:./switch-off.svg":"6tBmw","bundle-text:./flip.svg":"6N8Hu","bundle-text:./error.svg":"bNBRZ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","bundle-text:./close.svg":"8pxPz"}],hX0lQ:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],"01U3R":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],"9jaCP":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],invok:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],68285:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],"3zSKr":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],ft8Zf:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],dfLel:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],j8dnn:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],fMoi9:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],auIjA:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],g3V1U:[function(O,C,x){C.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"3LQJt":[function(O,C,x){C.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],bcTkc:[function(O,C,x){C.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],jDSoL:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],jqFLt:[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],"5qYod":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],"25MvP":[function(O,C,x){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],"6CCX4":[function(O,C,x){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],m9TwS:[function(O,C,x){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],iWJrW:[function(O,C,x){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"8cFxH":[function(O,C,x){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],"6tBmw":[function(O,C,x){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],"6N8Hu":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],bNBRZ:[function(O,C,x){C.exports='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.082 93.082 0 0 1 34.448 33.341zM512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88zm0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2z"/></svg>'},{}],"8pxPz":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733-17.066-17.067-42.666-17.067-59.733 0L512 452.267l-268.8-268.8c-17.067-17.067-42.667-17.067-59.733 0-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733L571.733 512z"/></svg>'},{}],d5XKP:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./flip"),m=T.interopDefault(h),M=O("./aspectRatio"),S=T.interopDefault(M),p=O("./playbackRate"),u=T.interopDefault(p),n=O("./subtitleOffset"),f=T.interopDefault(n),l=O("../utils/component"),c=T.interopDefault(l),v=O("../utils");function d(r,e,s){for(let o=0;o<r.length;o++){const a=r[o];a.$parentItem=e,a.$parentList=s,a.selector&&d(a.selector,a,r)}return r}function i(r){return["string","number"].includes(typeof r)}class t extends c.default{constructor(e){super(e);const{option:s,events:{proxy:o},template:{$setting:a,$player:g}}=e;if(this.name="setting",this.$parent=a,this.option=[],this.events=[],this.cache=new Map,s.setting){s.playbackRate&&this.option.push((0,u.default)(e)),s.aspectRatio&&this.option.push((0,S.default)(e)),s.flip&&this.option.push((0,m.default)(e)),s.subtitleOffset&&this.option.push((0,f.default)(e));for(let A=0;A<s.settings.length;A++)this.option.push(s.settings[A]);this.option=d(this.option),this.init(this.option),e.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),o(g,"click",A=>{!this.show||(0,v.includeFromEvent)(A,e.controls.setting)||(0,v.includeFromEvent)(A,this.$parent)||(this.show=!1,this.init(this.option))})}}add(e){typeof e=="function"?this.option.push(e(this.art)):this.option.push(e),this.cache=new Map,this.events.forEach(s=>s()),this.events=[],this.$parent.innerHTML="",this.option=d(this.option),this.init(this.option)}creatHeader(e){const{icons:s,events:{proxy:o}}=this.art,a=document.createElement("div");(0,v.addClass)(a,"art-setting-item"),(0,v.addClass)(a,"art-setting-item-back");const g=(0,v.append)(a,'<div class="art-setting-item-left"></div>'),A=document.createElement("div");(0,v.addClass)(A,"art-setting-item-left-icon"),(0,v.append)(A,s.arrowLeft),(0,v.append)(g,A),(0,v.append)(g,e.$parentItem.html);const D=o(a,"click",()=>{this.init(e.$parentList)});return this.events.push(D),a}creatItem(e,s){const{icons:o,events:{proxy:a}}=this.art,g=document.createElement("div");(0,v.addClass)(g,"art-setting-item"),i(s.name)&&(g.dataset.name=s.name),i(s.value)&&(g.dataset.value=s.value);const A=(0,v.append)(g,'<div class="art-setting-item-left"></div>'),D=(0,v.append)(g,'<div class="art-setting-item-right"></div>'),y=document.createElement("div");switch((0,v.addClass)(y,"art-setting-item-left-icon"),e){case"switch":case"range":(0,v.append)(y,i(s.icon)||s.icon instanceof Element?s.icon:o.config);break;case"selector":s.selector&&s.selector.length?(0,v.append)(y,i(s.icon)||s.icon instanceof Element?s.icon:o.config):(0,v.append)(y,o.check)}(0,v.append)(A,y),s.$icon=y,(0,v.def)(s,"icon",{configurable:!0,get:()=>y.innerHTML,set(L){i(L)&&(y.innerHTML=L)}});const E=document.createElement("div");(0,v.addClass)(E,"art-setting-item-left-text"),(0,v.append)(E,s.html||""),(0,v.append)(A,E),s.$html=E,(0,v.def)(s,"html",{configurable:!0,get:()=>E.innerHTML,set(L){i(L)&&(E.innerHTML=L)}});const _=document.createElement("div");switch((0,v.addClass)(_,"art-setting-item-right-tooltip"),(0,v.append)(_,s.tooltip||""),(0,v.append)(D,_),s.$tooltip=_,(0,v.def)(s,"tooltip",{configurable:!0,get:()=>_.innerHTML,set(L){i(L)&&(_.innerHTML=L)}}),e){case"switch":{const L=document.createElement("div");(0,v.addClass)(L,"art-setting-item-right-icon");const I=(0,v.append)(L,o.switchOn),b=(0,v.append)(L,o.switchOff);(0,v.setStyle)(s.switch?b:I,"display","none"),(0,v.append)(D,L),s.$switch=s.switch,(0,v.def)(s,"switch",{configurable:!0,get:()=>s.$switch,set(R){s.$switch=R,R?((0,v.setStyle)(b,"display","none"),(0,v.setStyle)(I,"display",null)):((0,v.setStyle)(b,"display",null),(0,v.setStyle)(I,"display","none"))}});break}case"range":{const L=document.createElement("div");(0,v.addClass)(L,"art-setting-item-right-icon");const I=(0,v.append)(L,'<input type="range">');I.value=s.range[0]||0,I.min=s.range[1]||0,I.max=s.range[2]||10,I.step=s.range[3]||1,(0,v.addClass)(I,"art-setting-range"),(0,v.append)(D,L),s.$range=I,(0,v.def)(s,"range",{configurable:!0,get:()=>I.valueAsNumber,set(b){I.value=Number(b)}})}break;case"selector":if(s.selector&&s.selector.length){const L=document.createElement("div");(0,v.addClass)(L,"art-setting-item-right-icon"),(0,v.append)(L,o.arrowRight),(0,v.append)(D,L)}}switch(e){case"switch":if(s.onSwitch){const L=a(g,"click",async I=>{s.switch=await s.onSwitch.call(this.art,s,g,I)});this.events.push(L)}break;case"range":if(s.onRange&&s.$range){const L=a(s.$range,"change",async I=>{s.tooltip=await s.onRange.call(this.art,s,g,I)});this.events.push(L)}break;case"selector":{const L=a(g,"click",async I=>{if(s.selector&&s.selector.length)this.init(s.selector,s.width);else if((0,v.inverseClass)(g,"art-current"),s.$parentList&&this.init(s.$parentList),s.$parentItem&&s.$parentItem.onSelect){const b=await s.$parentItem.onSelect.call(this.art,s,g,I);s.$parentItem.$tooltip&&i(b)&&(s.$parentItem.$tooltip.innerHTML=b)}});this.events.push(L),s.default&&(0,v.addClass)(g,"art-current")}}return g}init(e,s){const{constructor:o}=this.art;if(this.cache.has(e)){const a=this.cache.get(e);(0,v.inverseClass)(a,"art-current"),(0,v.setStyle)(this.$parent,"width",`${a.dataset.width}px`),(0,v.setStyle)(this.$parent,"height",`${a.dataset.height}px`)}else{const a=document.createElement("div");(0,v.addClass)(a,"art-setting-panel"),a.dataset.width=s||o.SETTING_WIDTH,a.dataset.height=e.length*o.SETTING_ITEM_HEIGHT,e[0]&&e[0].$parentItem&&((0,v.append)(a,this.creatHeader(e[0])),a.dataset.height=Number(a.dataset.height)+o.SETTING_ITEM_HEIGHT);for(let g=0;g<e.length;g++){const A=e[g];(0,v.has)(A,"switch")?(0,v.append)(a,this.creatItem("switch",A)):(0,v.has)(A,"range")?(0,v.append)(a,this.creatItem("range",A)):(0,v.append)(a,this.creatItem("selector",A))}(0,v.append)(this.$parent,a),this.cache.set(e,a),(0,v.inverseClass)(a,"art-current"),(0,v.setStyle)(this.$parent,"width",`${a.dataset.width}px`),(0,v.setStyle)(this.$parent,"height",`${a.dataset.height}px`),e[0]&&e[0].$parentItem&&e[0].$parentItem.mounted&&e[0].$parentItem.mounted.call(this.art,a,e[0].$parentItem)}}}x.default=t},{"./flip":"ah3Qs","./aspectRatio":"1gs5B","./playbackRate":"j50mh","./subtitleOffset":"i17b6","../utils/component":"kPHYl","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ah3Qs:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:S}=h,p={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function u(n,f,l){f&&(f.innerText=m.get(p[l]));const c=(0,T.queryAll)(".art-setting-item",n).find(v=>v.dataset.value===l);c&&(0,T.inverseClass)(c,"art-current")}return{width:S.SETTING_ITEM_WIDTH,html:m.get("Video Flip"),tooltip:m.get(p[h.flip]),icon:M.flip,selector:Object.keys(p).map(n=>({value:n,default:n===h.flip,html:m.get(p[n])})),onSelect(n){h.flip=n.value},mounted:(n,f)=>{u(n,f.$tooltip,h.flip),h.on("flip",()=>{u(n,f.$tooltip,h.flip)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1gs5B":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:S}=h;function p(n){return n==="default"?m.get("Default"):n}function u(n,f,l){f&&(f.innerText=p(l));const c=(0,T.queryAll)(".art-setting-item",n).find(v=>v.dataset.value===l);c&&(0,T.inverseClass)(c,"art-current")}return{width:S.SETTING_ITEM_WIDTH,html:m.get("Aspect Ratio"),icon:M.aspectRatio,tooltip:p(h.aspectRatio),selector:["default","4:3","16:9"].map(n=>({value:n,default:n===h.aspectRatio,html:p(n)})),onSelect(n){h.aspectRatio=n.value},mounted:(n,f)=>{u(n,f.$tooltip,h.aspectRatio),h.on("aspectRatio",()=>{u(n,f.$tooltip,h.aspectRatio)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j50mh:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:S}=h;function p(n){return n===1?m.get("Normal"):n}function u(n,f,l){f&&(f.innerText=p(l));const c=(0,T.queryAll)(".art-setting-item",n).find(v=>Number(v.dataset.value)===l);c&&(0,T.inverseClass)(c,"art-current")}return{width:S.SETTING_ITEM_WIDTH,html:m.get("Play Speed"),tooltip:p(h.playbackRate),icon:M.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(n=>({value:n,default:n===h.playbackRate,html:p(n)})),onSelect(n){h.playbackRate=n.value},mounted:(n,f)=>{u(n,f.$tooltip,h.playbackRate),h.on("playbackRate",()=>{u(n,f.$tooltip,h.playbackRate)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i17b6:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:S}=h;function p(n){return n===0?m.get("Normal"):n}function u(n,f,l){f&&(f.innerText=p(l));const c=(0,T.queryAll)(".art-setting-item",n).find(v=>Number(v.dataset.value)===l);c&&(0,T.inverseClass)(c,"art-current")}return{width:S.SETTING_ITEM_WIDTH,html:m.get("Subtitle Offset"),tooltip:p(h.subtitleOffset),icon:M.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(n=>({value:n,default:n===h.subtitleOffset,html:p(n)})),onSelect(n){h.subtitleOffset=n.value},mounted:(n,f)=>{u(n,f.$tooltip,h.subtitleOffset),h.on("subtitleOffset",()=>{u(n,f.$tooltip,h.subtitleOffset)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5M8nN":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(T){try{const h=JSON.parse(window.localStorage.getItem(this.name))||{};return T?h[T]:h}catch{return T?this.settings[T]:this.settings}}set(T,h){try{const m=Object.assign({},this.get(),{[T]:h});window.localStorage.setItem(this.name,JSON.stringify(m))}catch{this.settings[T]=h}}del(T){try{const h=this.get();delete h[T],window.localStorage.setItem(this.name,JSON.stringify(h))}catch{delete this.settings[T]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jWfEd:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("../utils"),m=O("./miniProgressBar"),M=T.interopDefault(m),S=O("./autoOrientation"),p=T.interopDefault(S),u=O("./autoPlayback"),n=T.interopDefault(u),f=O("./fastForward"),l=T.interopDefault(f),c=O("./lock"),v=T.interopDefault(c);x.default=class{constructor(d){this.art=d,this.id=0;const{option:i}=d;i.miniProgressBar&&!i.isLive&&this.add(M.default),i.lock&&h.isMobile&&this.add(v.default),i.autoPlayback&&this.add(n.default),i.autoOrientation&&h.isMobile&&this.add(p.default),i.fastForward&&h.isMobile&&!i.isLive&&this.add(l.default);for(let t=0;t<i.plugins.length;t++)this.add(i.plugins[t])}add(d){this.id+=1;const i=d.call(this,this.art),t=i&&i.name||d.name||`plugin${this.id}`;return(0,h.errorHandle)(!(0,h.has)(this,t),`Cannot add a plugin that already has the same name: ${t}`),(0,h.def)(this,t,{value:i}),this}}},{"../utils":"geSvU","./miniProgressBar":"7KBj0","./autoOrientation":"aPIVP","./autoPlayback":"j87OI","./fastForward":"1VTki","./lock":"7BtoE","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7KBj0":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(T){return T.on("ready",()=>{T.layers.add({name:"miniProgressBar",mounted(h){T.on("destroy",()=>{h.style.display="none"}),T.on("video:timeupdate",()=>{h.style.width=100*T.played+"%"}),T.on("setBar",(m,M)=>{m==="played"&&(h.style.width=100*M+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPIVP:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{option:m,constructor:M,template:{$player:S,$video:p}}=h;return h.on("fullscreenWeb",u=>{if(u){const{videoWidth:n,videoHeight:f}=p,{clientWidth:l,clientHeight:c}=document.documentElement;(n>f&&l<c||n<f&&l>c)&&setTimeout(()=>{(0,T.setStyle)(S,"width",`${c}px`),(0,T.setStyle)(S,"height",`${l}px`),(0,T.setStyle)(S,"transform-origin","0 0"),(0,T.setStyle)(S,"transform",`rotate(90deg) translate(0, -${l}px)`),(0,T.addClass)(S,"art-auto-orientation"),h.emit("resize")},M.MOBILE_AUTO_ORIENTATION_TIME)}else(0,T.hasClass)(S,"art-auto-orientation")&&((0,T.setStyle)(S,"width",null),(0,T.setStyle)(S,"height",null),(0,T.setStyle)(S,"transform",null),(0,T.setStyle)(S,"transform-origin",null),(0,T.removeClass)(S,"art-auto-orientation"),h.aspectRatioReset=!0,h.autoSize=m.autoSize,h.notice.show="",h.emit("resize"))}),h.on("fullscreen",async u=>{const n=screen.orientation.type;if(u){const{videoWidth:f,videoHeight:l}=p,{clientWidth:c,clientHeight:v}=document.documentElement;if(f>l&&c<v||f<l&&c>v){const d=n.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(d),(0,T.addClass)(S,"art-auto-orientation-fullscreen")}}else(0,T.hasClass)(S,"art-auto-orientation-fullscreen")&&(await screen.orientation.lock(n),(0,T.removeClass)(S,"art-auto-orientation-fullscreen"))}),{name:"autoOrientation",get state(){return(0,T.hasClass)(S,"art-auto-orientation")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j87OI:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{i18n:m,icons:M,storage:S,constructor:p,events:{proxy:u},template:{$poster:n}}=h,f=h.layers.add({name:"autoPlayback",html:'<div class="art-autoPlayback-close"></div><div class="art-autoPlayback-last"></div><div class="art-autoPlayback-jump"></div>'}),l=(0,T.query)(".art-autoPlayback-last",f),c=(0,T.query)(".art-autoPlayback-jump",f),v=(0,T.query)(".art-autoPlayback-close",f);return h.on("video:timeupdate",()=>{const d=S.get("times")||{},i=Object.keys(d);i.length>p.AUTO_PLAYBACK_MAX&&delete d[i[0]],d[h.option.url]=h.currentTime,S.set("times",d)}),h.on("ready",()=>{const d=(S.get("times")||{})[h.option.url];d&&((0,T.append)(v,M.close),(0,T.setStyle)(f,"display","flex"),l.innerText=`${m.get("Last Seen")} ${(0,T.secondToTime)(d)}`,c.innerText=m.get("Jump Play"),u(v,"click",()=>{(0,T.setStyle)(f,"display","none")}),u(c,"click",()=>{h.seek=d,h.play(),(0,T.setStyle)(n,"display","none"),(0,T.setStyle)(f,"display","none")}),h.once("video:timeupdate",()=>{setTimeout(()=>{(0,T.setStyle)(f,"display","none")},p.AUTO_PLAYBACK_TIMEOUT)}))}),{name:"autoPlayback",get times(){return S.get("times")||{}},clear:()=>S.del("times")}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1VTki":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{constructor:m,events:{proxy:M},template:{$player:S,$video:p}}=h;let u=null,n=!1;const f=()=>{clearTimeout(u),n&&(n=!1,h.playbackRate=1,(0,T.removeClass)(S,"art-fast-forward"))};return M(p,"touchstart",l=>{l.touches.length===1&&h.playing&&!h.isLock&&(u=setTimeout(()=>{n=!0,h.playbackRate=m.FAST_FORWARD_VALUE,(0,T.addClass)(S,"art-fast-forward")},m.FAST_FORWARD_TIME))}),M(document,"touchmove",f),M(document,"touchend",f),{name:"fastForward",get state(){return(0,T.hasClass)(S,"art-fast-forward")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7BtoE":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var T=O("../utils");x.default=function(h){const{layers:m,icons:M,template:{$player:S}}=h;return m.add({name:"lock",mounted(p){const u=(0,T.append)(p,M.lock),n=(0,T.append)(p,M.unlock);(0,T.setStyle)(u,"display","none"),h.on("lock",f=>{f?((0,T.setStyle)(u,"display","inline-flex"),(0,T.setStyle)(n,"display","none")):((0,T.setStyle)(u,"display","none"),(0,T.setStyle)(n,"display","inline-flex"))})},click(){(0,T.hasClass)(S,"art-lock")?((0,T.removeClass)(S,"art-lock"),this.isLock=!1,h.emit("lock",!1)):((0,T.addClass)(S,"art-lock"),this.isLock=!0,h.emit("lock",!0))}}),{name:"lock",get state(){return(0,T.hasClass)(S,"art-lock")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fkUkB:[function(O,C,x){var T=O("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(x);var h=O("./config"),m=T.interopDefault(h),M=O("./utils");x.default=class{constructor(S){const{option:p,events:{proxy:u},template:{$video:n}}=S;for(let c=0;c<m.default.events.length;c++)u(n,m.default.events[c],v=>{S.emit(`video:${v.type}`,v)});Object.keys(p.moreVideoAttr).forEach(c=>{n[c]=p.moreVideoAttr[c]}),p.muted&&(n.muted=p.muted),p.volume&&(n.volume=(0,M.clamp)(p.volume,0,1)),p.poster&&(n.poster=p.poster),p.autoplay&&(n.autoplay=p.autoplay),p.playsInline&&(n.playsInline=!0,n["webkit-playsinline"]=!0);const f=p.type||(0,M.getExt)(p.url),l=p.customType[f];f&&l?(l(n,p.url,S),S.emit("customType",f)):(n.src=p.url,S.emit("url",n.src))}}},{"./config":"eksZR","./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}]},["6SN6P"],"6SN6P")})(He);var _t=Ue(He.exports);const Tt={style:{transform:"scale(-1,1)"},height:"25",width:"25",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},St=pe("path",{d:"M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"},null,-1),Lt=[St];function At(ye,Ie){return Pe(),we("svg",Tt,Lt)}var Dt={name:"custom-prev",render:At};const Mt={height:"25",width:"25",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},It=pe("path",{d:"M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"},null,-1),bt=[It];function Rt(ye,Ie){return Pe(),we("svg",Mt,bt)}var Ot={name:"custom-next",render:Rt},Ye={exports:{}};(function(ye,Ie){(function(C,x){ye.exports=x()})(self,function(){return function(){var O={"./node_modules/es6-promise/dist/es6-promise.js":function(h,m,M){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(S,p){h.exports=p()})(this,function(){function S(W){var z=typeof W;return W!==null&&(z==="object"||z==="function")}function p(W){return typeof W=="function"}var u=void 0;Array.isArray?u=Array.isArray:u=function(W){return Object.prototype.toString.call(W)==="[object Array]"};var n=u,f=0,l=void 0,c=void 0,v=function(z,V){E[f]=z,E[f+1]=V,f+=2,f===2&&(c?c(_):I())};function d(W){c=W}function i(W){v=W}var t=typeof window!="undefined"?window:void 0,r=t||{},e=r.MutationObserver||r.WebKitMutationObserver,s=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",o=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function a(){return function(){return process.nextTick(_)}}function g(){return typeof l!="undefined"?function(){l(_)}:y()}function A(){var W=0,z=new e(_),V=document.createTextNode("");return z.observe(V,{characterData:!0}),function(){V.data=W=++W%2}}function D(){var W=new MessageChannel;return W.port1.onmessage=_,function(){return W.port2.postMessage(0)}}function y(){var W=setTimeout;return function(){return W(_,1)}}var E=new Array(1e3);function _(){for(var W=0;W<f;W+=2){var z=E[W],V=E[W+1];z(V),E[W]=void 0,E[W+1]=void 0}f=0}function L(){try{var W=Function("return this")().require("vertx");return l=W.runOnLoop||W.runOnContext,g()}catch{return y()}}var I=void 0;s?I=a():e?I=A():o?I=D():t===void 0?I=L():I=y();function b(W,z){var V=this,X=new this.constructor(w);X[P]===void 0&&oe(X);var H=V._state;if(H){var re=arguments[H-1];v(function(){return ie(H,X,re,V._result)})}else q(V,X,W,z);return X}function R(W){var z=this;if(W&&typeof W=="object"&&W.constructor===z)return W;var V=new z(w);return Y(V,W),V}var P=Math.random().toString(36).substring(2);function w(){}var F=void 0,k=1,B=2;function U(){return new TypeError("You cannot resolve a promise with itself")}function j(){return new TypeError("A promises callback cannot return that same promise.")}function K(W,z,V,X){try{W.call(z,V,X)}catch(H){return H}}function N(W,z,V){v(function(X){var H=!1,re=K(V,z,function(ce){H||(H=!0,z!==ce?Y(X,ce):Q(X,ce))},function(ce){H||(H=!0,G(X,ce))},"Settle: "+(X._label||" unknown promise"));!H&&re&&(H=!0,G(X,re))},W)}function Z(W,z){z._state===k?Q(W,z._result):z._state===B?G(W,z._result):q(z,void 0,function(V){return Y(W,V)},function(V){return G(W,V)})}function $(W,z,V){z.constructor===W.constructor&&V===b&&z.constructor.resolve===R?Z(W,z):V===void 0?Q(W,z):p(V)?N(W,z,V):Q(W,z)}function Y(W,z){if(W===z)G(W,U());else if(S(z)){var V=void 0;try{V=z.then}catch(X){G(W,X);return}$(W,z,V)}else Q(W,z)}function ee(W){W._onerror&&W._onerror(W._result),te(W)}function Q(W,z){W._state===F&&(W._result=z,W._state=k,W._subscribers.length!==0&&v(te,W))}function G(W,z){W._state===F&&(W._state=B,W._result=z,v(ee,W))}function q(W,z,V,X){var H=W._subscribers,re=H.length;W._onerror=null,H[re]=z,H[re+k]=V,H[re+B]=X,re===0&&W._state&&v(te,W)}function te(W){var z=W._subscribers,V=W._state;if(z.length!==0){for(var X=void 0,H=void 0,re=W._result,ce=0;ce<z.length;ce+=3)X=z[ce],H=z[ce+V],X?ie(V,X,H,re):H(re);W._subscribers.length=0}}function ie(W,z,V,X){var H=p(V),re=void 0,ce=void 0,me=!0;if(H){try{re=V(X)}catch(xe){me=!1,ce=xe}if(z===re){G(z,j());return}}else re=X;z._state!==F||(H&&me?Y(z,re):me===!1?G(z,ce):W===k?Q(z,re):W===B&&G(z,re))}function ne(W,z){try{z(function(X){Y(W,X)},function(X){G(W,X)})}catch(V){G(W,V)}}var le=0;function se(){return le++}function oe(W){W[P]=le++,W._state=void 0,W._result=void 0,W._subscribers=[]}function J(){return new Error("Array Methods must be provided an Array")}var ae=function(){function W(z,V){this._instanceConstructor=z,this.promise=new z(w),this.promise[P]||oe(this.promise),n(V)?(this.length=V.length,this._remaining=V.length,this._result=new Array(this.length),this.length===0?Q(this.promise,this._result):(this.length=this.length||0,this._enumerate(V),this._remaining===0&&Q(this.promise,this._result))):G(this.promise,J())}return W.prototype._enumerate=function(V){for(var X=0;this._state===F&&X<V.length;X++)this._eachEntry(V[X],X)},W.prototype._eachEntry=function(V,X){var H=this._instanceConstructor,re=H.resolve;if(re===R){var ce=void 0,me=void 0,xe=!1;try{ce=V.then}catch(_e){xe=!0,me=_e}if(ce===b&&V._state!==F)this._settledAt(V._state,X,V._result);else if(typeof ce!="function")this._remaining--,this._result[X]=V;else if(H===he){var Se=new H(w);xe?G(Se,me):$(Se,V,ce),this._willSettleAt(Se,X)}else this._willSettleAt(new H(function(_e){return _e(V)}),X)}else this._willSettleAt(re(V),X)},W.prototype._settledAt=function(V,X,H){var re=this.promise;re._state===F&&(this._remaining--,V===B?G(re,H):this._result[X]=H),this._remaining===0&&Q(re,this._result)},W.prototype._willSettleAt=function(V,X){var H=this;q(V,void 0,function(re){return H._settledAt(k,X,re)},function(re){return H._settledAt(B,X,re)})},W}();function fe(W){return new ae(this,W).promise}function de(W){var z=this;return n(W)?new z(function(V,X){for(var H=W.length,re=0;re<H;re++)z.resolve(W[re]).then(V,X)}):new z(function(V,X){return X(new TypeError("You must pass an array to race."))})}function ve(W){var z=this,V=new z(w);return G(V,W),V}function ue(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Te(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var he=function(){function W(z){this[P]=se(),this._result=this._state=void 0,this._subscribers=[],w!==z&&(typeof z!="function"&&ue(),this instanceof W?ne(this,z):Te())}return W.prototype.catch=function(V){return this.then(null,V)},W.prototype.finally=function(V){var X=this,H=X.constructor;return p(V)?X.then(function(re){return H.resolve(V()).then(function(){return re})},function(re){return H.resolve(V()).then(function(){throw re})}):X.then(V,V)},W}();he.prototype.then=b,he.all=fe,he.race=de,he.resolve=R,he.reject=ve,he._setScheduler=d,he._setAsap=i,he._asap=v;function Ee(){var W=void 0;if(typeof M.g!="undefined")W=M.g;else if(typeof self!="undefined")W=self;else try{W=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var z=W.Promise;if(z){var V=null;try{V=Object.prototype.toString.call(z.resolve())}catch{}if(V==="[object Promise]"&&!z.cast)return}W.Promise=he}return he.polyfill=Ee,he.Promise=he,he})},"./node_modules/events/events.js":function(h){var m=typeof Reflect=="object"?Reflect:null,M=m&&typeof m.apply=="function"?m.apply:function(y,E,_){return Function.prototype.apply.call(y,E,_)},S;m&&typeof m.ownKeys=="function"?S=m.ownKeys:Object.getOwnPropertySymbols?S=function(y){return Object.getOwnPropertyNames(y).concat(Object.getOwnPropertySymbols(y))}:S=function(y){return Object.getOwnPropertyNames(y)};function p(D){console&&console.warn&&console.warn(D)}var u=Number.isNaN||function(y){return y!==y};function n(){n.init.call(this)}h.exports=n,h.exports.once=a,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var f=10;function l(D){if(typeof D!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof D)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(D){if(typeof D!="number"||D<0||u(D))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+D+".");f=D}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||u(y))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+y+".");return this._maxListeners=y,this};function c(D){return D._maxListeners===void 0?n.defaultMaxListeners:D._maxListeners}n.prototype.getMaxListeners=function(){return c(this)},n.prototype.emit=function(y){for(var E=[],_=1;_<arguments.length;_++)E.push(arguments[_]);var L=y==="error",I=this._events;if(I!==void 0)L=L&&I.error===void 0;else if(!L)return!1;if(L){var b;if(E.length>0&&(b=E[0]),b instanceof Error)throw b;var R=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw R.context=b,R}var P=I[y];if(P===void 0)return!1;if(typeof P=="function")M(P,this,E);else for(var w=P.length,F=e(P,w),_=0;_<w;++_)M(F[_],this,E);return!0};function v(D,y,E,_){var L,I,b;if(l(E),I=D._events,I===void 0?(I=D._events=Object.create(null),D._eventsCount=0):(I.newListener!==void 0&&(D.emit("newListener",y,E.listener?E.listener:E),I=D._events),b=I[y]),b===void 0)b=I[y]=E,++D._eventsCount;else if(typeof b=="function"?b=I[y]=_?[E,b]:[b,E]:_?b.unshift(E):b.push(E),L=c(D),L>0&&b.length>L&&!b.warned){b.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(y)+" listeners added. Use emitter.setMaxListeners() to increase limit");R.name="MaxListenersExceededWarning",R.emitter=D,R.type=y,R.count=b.length,p(R)}return D}n.prototype.addListener=function(y,E){return v(this,y,E,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(y,E){return v(this,y,E,!0)};function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function i(D,y,E){var _={fired:!1,wrapFn:void 0,target:D,type:y,listener:E},L=d.bind(_);return L.listener=E,_.wrapFn=L,L}n.prototype.once=function(y,E){return l(E),this.on(y,i(this,y,E)),this},n.prototype.prependOnceListener=function(y,E){return l(E),this.prependListener(y,i(this,y,E)),this},n.prototype.removeListener=function(y,E){var _,L,I,b,R;if(l(E),L=this._events,L===void 0)return this;if(_=L[y],_===void 0)return this;if(_===E||_.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete L[y],L.removeListener&&this.emit("removeListener",y,_.listener||E));else if(typeof _!="function"){for(I=-1,b=_.length-1;b>=0;b--)if(_[b]===E||_[b].listener===E){R=_[b].listener,I=b;break}if(I<0)return this;I===0?_.shift():s(_,I),_.length===1&&(L[y]=_[0]),L.removeListener!==void 0&&this.emit("removeListener",y,R||E)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(y){var E,_,L;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[y]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[y]),this;if(arguments.length===0){var I=Object.keys(_),b;for(L=0;L<I.length;++L)b=I[L],b!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=_[y],typeof E=="function")this.removeListener(y,E);else if(E!==void 0)for(L=E.length-1;L>=0;L--)this.removeListener(y,E[L]);return this};function t(D,y,E){var _=D._events;if(_===void 0)return[];var L=_[y];return L===void 0?[]:typeof L=="function"?E?[L.listener||L]:[L]:E?o(L):e(L,L.length)}n.prototype.listeners=function(y){return t(this,y,!0)},n.prototype.rawListeners=function(y){return t(this,y,!1)},n.listenerCount=function(D,y){return typeof D.listenerCount=="function"?D.listenerCount(y):r.call(D,y)},n.prototype.listenerCount=r;function r(D){var y=this._events;if(y!==void 0){var E=y[D];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?S(this._events):[]};function e(D,y){for(var E=new Array(y),_=0;_<y;++_)E[_]=D[_];return E}function s(D,y){for(;y+1<D.length;y++)D[y]=D[y+1];D.pop()}function o(D){for(var y=new Array(D.length),E=0;E<y.length;++E)y[E]=D[E].listener||D[E];return y}function a(D,y){return new Promise(function(E,_){function L(b){D.removeListener(y,I),_(b)}function I(){typeof D.removeListener=="function"&&D.removeListener("error",L),E([].slice.call(arguments))}A(D,y,I,{once:!0}),y!=="error"&&g(D,L,{once:!0})})}function g(D,y,E){typeof D.on=="function"&&A(D,"error",y,E)}function A(D,y,E,_){if(typeof D.on=="function")_.once?D.once(y,E):D.on(y,E);else if(typeof D.addEventListener=="function")D.addEventListener(y,function L(I){_.once&&D.removeEventListener(y,L),E(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof D)}},"./node_modules/webworkify-webpack/index.js":function(h,m,M){function S(d){var i={};function t(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return d[e].call(s.exports,s,s.exports,t),s.l=!0,s.exports}t.m=d,t.c=i,t.i=function(e){return e},t.d=function(e,s,o){t.o(e,s)||Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:o})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="/",t.oe=function(e){throw console.error(e),e};var r=t(t.s=ENTRY_MODULE);return r.default||r}var p="[\\.|\\-|\\+|\\w|/|@]+",u="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function n(d){return(d+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function f(d){return!isNaN(1*d)}function l(d,i,t){var r={};r[t]=[];var e=i.toString(),s=e.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return r;for(var o=s[1],a=new RegExp("(\\\\n|\\W)"+n(o)+u,"g"),g;g=a.exec(e);)g[3]!=="dll-reference"&&r[t].push(g[3]);for(a=new RegExp("\\("+n(o)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+u,"g");g=a.exec(e);)d[g[2]]||(r[t].push(g[1]),d[g[2]]=M(g[1]).m),r[g[2]]=r[g[2]]||[],r[g[2]].push(g[4]);for(var A=Object.keys(r),D=0;D<A.length;D++)for(var y=0;y<r[A[D]].length;y++)f(r[A[D]][y])&&(r[A[D]][y]=1*r[A[D]][y]);return r}function c(d){var i=Object.keys(d);return i.reduce(function(t,r){return t||d[r].length>0},!1)}function v(d,i){for(var t={main:[i]},r={main:[]},e={main:{}};c(t);)for(var s=Object.keys(t),o=0;o<s.length;o++){var a=s[o],g=t[a],A=g.pop();if(e[a]=e[a]||{},!(e[a][A]||!d[a][A])){e[a][A]=!0,r[a]=r[a]||[],r[a].push(A);for(var D=l(d,d[a][A],a),y=Object.keys(D),E=0;E<y.length;E++)t[y[E]]=t[y[E]]||[],t[y[E]]=t[y[E]].concat(D[y[E]])}}return r}h.exports=function(d,i){i=i||{};var t={main:M.m},r=i.all?{main:Object.keys(t.main)}:v(t,d),e="";Object.keys(r).filter(function(A){return A!=="main"}).forEach(function(A){for(var D=0;r[A][D];)D++;r[A].push(D),t[A][D]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",e=e+"var "+A+" = ("+S.toString().replace("ENTRY_MODULE",JSON.stringify(D))+")({"+r[A].map(function(y){return""+JSON.stringify(y)+": "+t[A][y].toString()}).join(",")+`});
`}),e=e+"new (("+S.toString().replace("ENTRY_MODULE",JSON.stringify(d))+")({"+r.main.map(function(A){return""+JSON.stringify(A)+": "+t.main[A].toString()}).join(",")+"}))(self);";var s=new window.Blob([e],{type:"text/javascript"});if(i.bare)return s;var o=window.URL||window.webkitURL||window.mozURL||window.msURL,a=o.createObjectURL(s),g=new window.Worker(a);return g.objectURL=a,g}},"./src/config.js":function(h,m,M){M.r(m),M.d(m,{defaultConfig:function(){return S},createDefaultConfig:function(){return p}});var S={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function p(){return Object.assign({},S)}},"./src/core/features.js":function(h,m,M){M.r(m);var S=M("./src/io/io-controller.js"),p=M("./src/config.js"),u=function(){function n(){}return n.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},n.supportNetworkStreamIO=function(){var f=new S.default({},(0,p.createDefaultConfig)()),l=f.loaderType;return f.destroy(),l=="fetch-stream-loader"||l=="xhr-moz-chunked-loader"},n.getNetworkLoaderTypeName=function(){var f=new S.default({},(0,p.createDefaultConfig)()),l=f.loaderType;return f.destroy(),l},n.supportNativeMediaPlayback=function(f){n.videoElement==null&&(n.videoElement=window.document.createElement("video"));var l=n.videoElement.canPlayType(f);return l==="probably"||l=="maybe"},n.getFeatureList=function(){var f={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return f.mseFlvPlayback=n.supportMSEH264Playback(),f.networkStreamIO=n.supportNetworkStreamIO(),f.networkLoaderName=n.getNetworkLoaderTypeName(),f.mseLiveFlvPlayback=f.mseFlvPlayback&&f.networkStreamIO,f.nativeMP4H264Playback=n.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),f.nativeWebmVP8Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),f.nativeWebmVP9Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp9"'),f},n}();m.default=u},"./src/core/media-info.js":function(h,m,M){M.r(m);var S=function(){function p(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return p.prototype.isComplete=function(){var u=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,n=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&u&&n},p.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},p.prototype.getNearestKeyframe=function(u){if(this.keyframesIndex==null)return null;var n=this.keyframesIndex,f=this._search(n.times,u);return{index:f,milliseconds:n.times[f],fileposition:n.filepositions[f]}},p.prototype._search=function(u,n){var f=0,l=u.length-1,c=0,v=0,d=l;for(n<u[0]&&(f=0,v=d+1);v<=d;)if(c=v+Math.floor((d-v)/2),c===l||n>=u[c]&&n<u[c+1]){f=c;break}else u[c]<n?v=c+1:d=c-1;return f},p}();m.default=S},"./src/core/media-segment-info.js":function(h,m,M){M.r(m),M.d(m,{SampleInfo:function(){return S},MediaSegmentInfo:function(){return p},IDRSampleList:function(){return u},MediaSegmentInfoList:function(){return n}});var S=function(){function f(l,c,v,d,i){this.dts=l,this.pts=c,this.duration=v,this.originalDts=d,this.isSyncPoint=i,this.fileposition=null}return f}(),p=function(){function f(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return f.prototype.appendSyncPoint=function(l){l.isSyncPoint=!0,this.syncPoints.push(l)},f}(),u=function(){function f(){this._list=[]}return f.prototype.clear=function(){this._list=[]},f.prototype.appendArray=function(l){var c=this._list;l.length!==0&&(c.length>0&&l[0].originalDts<c[c.length-1].originalDts&&this.clear(),Array.prototype.push.apply(c,l))},f.prototype.getLastSyncPointBeforeDts=function(l){if(this._list.length==0)return null;var c=this._list,v=0,d=c.length-1,i=0,t=0,r=d;for(l<c[0].dts&&(v=0,t=r+1);t<=r;)if(i=t+Math.floor((r-t)/2),i===d||l>=c[i].dts&&l<c[i+1].dts){v=i;break}else c[i].dts<l?t=i+1:r=i-1;return this._list[v]},f}(),n=function(){function f(l){this._type=l,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(f.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),f.prototype.isEmpty=function(){return this._list.length===0},f.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},f.prototype._searchNearestSegmentBefore=function(l){var c=this._list;if(c.length===0)return-2;var v=c.length-1,d=0,i=0,t=v,r=0;if(l<c[0].originalBeginDts)return r=-1,r;for(;i<=t;)if(d=i+Math.floor((t-i)/2),d===v||l>c[d].lastSample.originalDts&&l<c[d+1].originalBeginDts){r=d;break}else c[d].originalBeginDts<l?i=d+1:t=d-1;return r},f.prototype._searchNearestSegmentAfter=function(l){return this._searchNearestSegmentBefore(l)+1},f.prototype.append=function(l){var c=this._list,v=l,d=this._lastAppendLocation,i=0;d!==-1&&d<c.length&&v.originalBeginDts>=c[d].lastSample.originalDts&&(d===c.length-1||d<c.length-1&&v.originalBeginDts<c[d+1].originalBeginDts)?i=d+1:c.length>0&&(i=this._searchNearestSegmentBefore(v.originalBeginDts)+1),this._lastAppendLocation=i,this._list.splice(i,0,v)},f.prototype.getLastSegmentBefore=function(l){var c=this._searchNearestSegmentBefore(l);return c>=0?this._list[c]:null},f.prototype.getLastSampleBefore=function(l){var c=this.getLastSegmentBefore(l);return c!=null?c.lastSample:null},f.prototype.getLastSyncPointBefore=function(l){for(var c=this._searchNearestSegmentBefore(l),v=this._list[c].syncPoints;v.length===0&&c>0;)c--,v=this._list[c].syncPoints;return v.length>0?v[v.length-1]:null},f}()},"./src/core/mse-controller.js":function(h,m,M){M.r(m);var S=M("./node_modules/events/events.js"),p=M.n(S),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),f=M("./src/core/mse-events.js"),l=M("./src/core/media-segment-info.js"),c=M("./src/utils/exception.js"),v=function(){function d(i){this.TAG="MSEController",this._config=i,this._emitter=new(p()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new l.IDRSampleList}return d.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},d.prototype.on=function(i,t){this._emitter.addListener(i,t)},d.prototype.off=function(i,t){this._emitter.removeListener(i,t)},d.prototype.attachMediaElement=function(i){if(this._mediaSource)throw new c.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=i,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),i.src=this._mediaSourceObjectURL},d.prototype.detachMediaElement=function(){if(this._mediaSource){var i=this._mediaSource;for(var t in this._sourceBuffers){var r=this._pendingSegments[t];r.splice(0,r.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var e=this._sourceBuffers[t];if(e){if(i.readyState!=="closed"){try{i.removeSourceBuffer(e)}catch(s){u.default.e(this.TAG,s.message)}e.removeEventListener("error",this.e.onSourceBufferError),e.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if(i.readyState==="open")try{i.endOfStream()}catch(s){u.default.e(this.TAG,s.message)}i.removeEventListener("sourceopen",this.e.onSourceOpen),i.removeEventListener("sourceended",this.e.onSourceEnded),i.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},d.prototype.appendInitSegment=function(i,t){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(i),this._pendingSegments[i.type].push(i);return}var r=i,e=""+r.container;r.codec&&r.codec.length>0&&(e+=";codecs="+r.codec);var s=!1;if(u.default.v(this.TAG,"Received Initialization Segment, mimeType: "+e),this._lastInitSegments[r.type]=r,e!==this._mimeTypes[r.type]){if(this._mimeTypes[r.type])u.default.v(this.TAG,"Notice: "+r.type+" mimeType changed, origin: "+this._mimeTypes[r.type]+", target: "+e);else{s=!0;try{var o=this._sourceBuffers[r.type]=this._mediaSource.addSourceBuffer(e);o.addEventListener("error",this.e.onSourceBufferError),o.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(a){u.default.e(this.TAG,a.message),this._emitter.emit(f.default.ERROR,{code:a.code,msg:a.message});return}}this._mimeTypes[r.type]=e}t||this._pendingSegments[r.type].push(r),s||this._sourceBuffers[r.type]&&!this._sourceBuffers[r.type].updating&&this._doAppendSegments(),n.default.safari&&r.container==="audio/mpeg"&&r.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=r.mediaDuration/1e3,this._updateMediaSourceDuration())},d.prototype.appendMediaSegment=function(i){var t=i;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var r=this._sourceBuffers[t.type];r&&!r.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},d.prototype.seek=function(i){for(var t in this._sourceBuffers)if(!!this._sourceBuffers[t]){var r=this._sourceBuffers[t];if(this._mediaSource.readyState==="open")try{r.abort()}catch(A){u.default.e(this.TAG,A.message)}this._idrList.clear();var e=this._pendingSegments[t];if(e.splice(0,e.length),this._mediaSource.readyState!=="closed"){for(var s=0;s<r.buffered.length;s++){var o=r.buffered.start(s),a=r.buffered.end(s);this._pendingRemoveRanges[t].push({start:o,end:a})}if(r.updating||this._doRemoveRanges(),n.default.safari){var g=this._lastInitSegments[t];g&&(this._pendingSegments[t].push(g),r.updating||this._doAppendSegments())}}}},d.prototype.endOfStream=function(){var i=this._mediaSource,t=this._sourceBuffers;if(!i||i.readyState!=="open"){i&&i.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,i.endOfStream())},d.prototype.getNearestKeyframe=function(i){return this._idrList.getLastSyncPointBeforeDts(i)},d.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var i=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var r=this._sourceBuffers[t];if(r){var e=r.buffered;if(e.length>=1&&i-e.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},d.prototype._doCleanupSourceBuffer=function(){var i=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var r=this._sourceBuffers[t];if(r){for(var e=r.buffered,s=!1,o=0;o<e.length;o++){var a=e.start(o),g=e.end(o);if(a<=i&&i<g+3){if(i-a>=this._config.autoCleanupMaxBackwardDuration){s=!0;var A=i-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:a,end:A})}}else g<i&&(s=!0,this._pendingRemoveRanges[t].push({start:a,end:g}))}s&&!r.updating&&this._doRemoveRanges()}}},d.prototype._updateMediaSourceDuration=function(){var i=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(i.video&&i.video.updating||i.audio&&i.audio.updating)){var t=this._mediaSource.duration,r=this._pendingMediaDuration;r>0&&(isNaN(t)||r>t)&&(u.default.v(this.TAG,"Update MediaSource duration from "+t+" to "+r),this._mediaSource.duration=r),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},d.prototype._doRemoveRanges=function(){for(var i in this._pendingRemoveRanges)if(!(!this._sourceBuffers[i]||this._sourceBuffers[i].updating))for(var t=this._sourceBuffers[i],r=this._pendingRemoveRanges[i];r.length&&!t.updating;){var e=r.shift();t.remove(e.start,e.end)}},d.prototype._doAppendSegments=function(){var i=this._pendingSegments;for(var t in i)if(!(!this._sourceBuffers[t]||this._sourceBuffers[t].updating)&&i[t].length>0){var r=i[t].shift();if(r.timestampOffset){var e=this._sourceBuffers[t].timestampOffset,s=r.timestampOffset/1e3,o=Math.abs(e-s);o>.1&&(u.default.v(this.TAG,"Update MPEG audio timestampOffset from "+e+" to "+s),this._sourceBuffers[t].timestampOffset=s),delete r.timestampOffset}if(!r.data||r.data.byteLength===0)continue;try{this._sourceBuffers[t].appendBuffer(r.data),this._isBufferFull=!1,t==="video"&&r.hasOwnProperty("info")&&this._idrList.appendArray(r.info.syncPoints)}catch(a){this._pendingSegments[t].unshift(r),a.code===22?(this._isBufferFull||this._emitter.emit(f.default.BUFFER_FULL),this._isBufferFull=!0):(u.default.e(this.TAG,a.message),this._emitter.emit(f.default.ERROR,{code:a.code,msg:a.message}))}}},d.prototype._onSourceOpen=function(){if(u.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var i=this._pendingSourceBufferInit;i.length;){var t=i.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(f.default.SOURCE_OPEN)},d.prototype._onSourceEnded=function(){u.default.v(this.TAG,"MediaSource onSourceEnded")},d.prototype._onSourceClose=function(){u.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},d.prototype._hasPendingSegments=function(){var i=this._pendingSegments;return i.video.length>0||i.audio.length>0},d.prototype._hasPendingRemoveRanges=function(){var i=this._pendingRemoveRanges;return i.video.length>0||i.audio.length>0},d.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(f.default.UPDATE_END)},d.prototype._onSourceBufferError=function(i){u.default.e(this.TAG,"SourceBuffer Error: "+i)},d}();m.default=v},"./src/core/mse-events.js":function(h,m,M){M.r(m);var S={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};m.default=S},"./src/core/transmuxer.js":function(h,m,M){M.r(m);var S=M("./node_modules/events/events.js"),p=M.n(S),u=M("./node_modules/webworkify-webpack/index.js"),n=M.n(u),f=M("./src/utils/logger.js"),l=M("./src/utils/logging-control.js"),c=M("./src/core/transmuxing-controller.js"),v=M("./src/core/transmuxing-events.js"),d=M("./src/core/media-info.js"),i=function(){function t(r,e){if(this.TAG="Transmuxer",this._emitter=new(p()),e.enableWorker&&typeof Worker!="undefined")try{this._worker=n()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[r,e]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},l.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:l.default.getConfig()})}catch{f.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new c.default(r,e)}else this._controller=new c.default(r,e);if(this._controller){var s=this._controller;s.on(v.default.IO_ERROR,this._onIOError.bind(this)),s.on(v.default.DEMUX_ERROR,this._onDemuxError.bind(this)),s.on(v.default.INIT_SEGMENT,this._onInitSegment.bind(this)),s.on(v.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),s.on(v.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),s.on(v.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),s.on(v.default.MEDIA_INFO,this._onMediaInfo.bind(this)),s.on(v.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),s.on(v.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),s.on(v.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),s.on(v.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return t.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),l.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},t.prototype.on=function(r,e){this._emitter.addListener(r,e)},t.prototype.off=function(r,e){this._emitter.removeListener(r,e)},t.prototype.hasWorker=function(){return this._worker!=null},t.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},t.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},t.prototype.seek=function(r){this._worker?this._worker.postMessage({cmd:"seek",param:r}):this._controller.seek(r)},t.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},t.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},t.prototype._onInitSegment=function(r,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.INIT_SEGMENT,r,e)})},t.prototype._onMediaSegment=function(r,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.MEDIA_SEGMENT,r,e)})},t.prototype._onLoadingComplete=function(){var r=this;Promise.resolve().then(function(){r._emitter.emit(v.default.LOADING_COMPLETE)})},t.prototype._onRecoveredEarlyEof=function(){var r=this;Promise.resolve().then(function(){r._emitter.emit(v.default.RECOVERED_EARLY_EOF)})},t.prototype._onMediaInfo=function(r){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.MEDIA_INFO,r)})},t.prototype._onMetaDataArrived=function(r){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.METADATA_ARRIVED,r)})},t.prototype._onScriptDataArrived=function(r){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.SCRIPTDATA_ARRIVED,r)})},t.prototype._onStatisticsInfo=function(r){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.STATISTICS_INFO,r)})},t.prototype._onIOError=function(r,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.IO_ERROR,r,e)})},t.prototype._onDemuxError=function(r,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.DEMUX_ERROR,r,e)})},t.prototype._onRecommendSeekpoint=function(r){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.RECOMMEND_SEEKPOINT,r)})},t.prototype._onLoggingConfigChanged=function(r){this._worker&&this._worker.postMessage({cmd:"logging_config",param:r})},t.prototype._onWorkerMessage=function(r){var e=r.data,s=e.data;if(e.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(e.msg){case v.default.INIT_SEGMENT:case v.default.MEDIA_SEGMENT:this._emitter.emit(e.msg,s.type,s.data);break;case v.default.LOADING_COMPLETE:case v.default.RECOVERED_EARLY_EOF:this._emitter.emit(e.msg);break;case v.default.MEDIA_INFO:Object.setPrototypeOf(s,d.default.prototype),this._emitter.emit(e.msg,s);break;case v.default.METADATA_ARRIVED:case v.default.SCRIPTDATA_ARRIVED:case v.default.STATISTICS_INFO:this._emitter.emit(e.msg,s);break;case v.default.IO_ERROR:case v.default.DEMUX_ERROR:this._emitter.emit(e.msg,s.type,s.info);break;case v.default.RECOMMEND_SEEKPOINT:this._emitter.emit(e.msg,s);break;case"logcat_callback":f.default.emitter.emit("log",s.type,s.logcat);break}},t}();m.default=i},"./src/core/transmuxing-controller.js":function(h,m,M){M.r(m);var S=M("./node_modules/events/events.js"),p=M.n(S),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),f=M("./src/core/media-info.js"),l=M("./src/demux/flv-demuxer.js"),c=M("./src/remux/mp4-remuxer.js"),v=M("./src/demux/demux-errors.js"),d=M("./src/io/io-controller.js"),i=M("./src/core/transmuxing-events.js"),t=function(){function r(e,s){this.TAG="TransmuxingController",this._emitter=new(p()),this._config=s,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),typeof e.cors!="boolean"&&(e.cors=!0),typeof e.withCredentials!="boolean"&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var o=0;this._mediaDataSource.segments.forEach(function(a){a.timestampBase=o,o+=a.duration,a.cors=e.cors,a.withCredentials=e.withCredentials,s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy)}),!isNaN(o)&&this._mediaDataSource.duration!==o&&(this._mediaDataSource.duration=o),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return r.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},r.prototype.on=function(e,s){this._emitter.addListener(e,s)},r.prototype.off=function(e,s){this._emitter.removeListener(e,s)},r.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},r.prototype._loadSegment=function(e,s){this._currentSegmentIndex=e;var o=this._mediaDataSource.segments[e],a=this._ioctl=new d.default(o,this._config,e);a.onError=this._onIOException.bind(this),a.onSeeked=this._onIOSeeked.bind(this),a.onComplete=this._onIOComplete.bind(this),a.onRedirect=this._onIORedirect.bind(this),a.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),s?this._demuxer.bindDataSource(this._ioctl):a.onDataArrival=this._onInitChunkArrival.bind(this),a.open(s)},r.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},r.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},r.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},r.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},r.prototype.seek=function(e){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var s=this._searchSegmentIndexContains(e);if(s===this._currentSegmentIndex){var o=this._mediaInfo.segments[s];if(o==null)this._pendingSeekTime=e;else{var a=o.getNearestKeyframe(e);this._remuxer.seek(a.milliseconds),this._ioctl.seek(a.fileposition),this._pendingResolveSeekPoint=a.milliseconds}}else{var g=this._mediaInfo.segments[s];if(g==null)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(s);else{var a=g.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[s].timestampBase,this._loadSegment(s,a.fileposition),this._pendingResolveSeekPoint=a.milliseconds,this._reportSegmentMediaInfo(s)}}this._enableStatisticsReporter()}},r.prototype._searchSegmentIndexContains=function(e){for(var s=this._mediaDataSource.segments,o=s.length-1,a=0;a<s.length;a++)if(e<s[a].timestampBase){o=a-1;break}return o},r.prototype._onInitChunkArrival=function(e,s){var o=this,a=null,g=0;if(s>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,g=this._demuxer.parseChunks(e,s);else if((a=l.default.probe(e)).match){this._demuxer=new l.default(a,this._config),this._remuxer||(this._remuxer=new c.default(this._config));var A=this._mediaDataSource;A.duration!=null&&!isNaN(A.duration)&&(this._demuxer.overridedDuration=A.duration),typeof A.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=A.hasAudio),typeof A.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=A.hasVideo),this._demuxer.timestampBase=A.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),g=this._demuxer.parseChunks(e,s)}else a=null,u.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){o._internalAbort()}),this._emitter.emit(i.default.DEMUX_ERROR,v.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),g=0;return g},r.prototype._onMediaInfo=function(e){var s=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,f.default.prototype));var o=Object.assign({},e);Object.setPrototypeOf(o,f.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=o,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var a=s._pendingSeekTime;s._pendingSeekTime=null,s.seek(a)})},r.prototype._onMetaDataArrived=function(e){this._emitter.emit(i.default.METADATA_ARRIVED,e)},r.prototype._onScriptDataArrived=function(e){this._emitter.emit(i.default.SCRIPTDATA_ARRIVED,e)},r.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},r.prototype._onIOComplete=function(e){var s=e,o=s+1;o<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(o)):(this._remuxer.flushStashedSamples(),this._emitter.emit(i.default.LOADING_COMPLETE),this._disableStatisticsReporter())},r.prototype._onIORedirect=function(e){var s=this._ioctl.extraData;this._mediaDataSource.segments[s].redirectedURL=e},r.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(i.default.RECOVERED_EARLY_EOF)},r.prototype._onIOException=function(e,s){u.default.e(this.TAG,"IOException: type = "+e+", code = "+s.code+", msg = "+s.msg),this._emitter.emit(i.default.IO_ERROR,e,s),this._disableStatisticsReporter()},r.prototype._onDemuxException=function(e,s){u.default.e(this.TAG,"DemuxException: type = "+e+", info = "+s),this._emitter.emit(i.default.DEMUX_ERROR,e,s)},r.prototype._onRemuxerInitSegmentArrival=function(e,s){this._emitter.emit(i.default.INIT_SEGMENT,e,s)},r.prototype._onRemuxerMediaSegmentArrival=function(e,s){if(this._pendingSeekTime==null&&(this._emitter.emit(i.default.MEDIA_SEGMENT,e,s),this._pendingResolveSeekPoint!=null&&e==="video")){var o=s.info.syncPoints,a=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,n.default.safari&&o.length>0&&o[0].originalDts===a&&(a=o[0].pts),this._emitter.emit(i.default.RECOMMEND_SEEKPOINT,a)}},r.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},r.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},r.prototype._reportSegmentMediaInfo=function(e){var s=this._mediaInfo.segments[e],o=Object.assign({},s);o.duration=this._mediaInfo.duration,o.segmentCount=this._mediaInfo.segmentCount,delete o.segments,delete o.keyframesIndex,this._emitter.emit(i.default.MEDIA_INFO,o)},r.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(i.default.STATISTICS_INFO,e)},r}();m.default=t},"./src/core/transmuxing-events.js":function(h,m,M){M.r(m);var S={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};m.default=S},"./src/core/transmuxing-worker.js":function(h,m,M){M.r(m);var S=M("./src/utils/logging-control.js"),p=M("./src/utils/polyfill.js"),u=M("./src/core/transmuxing-controller.js"),n=M("./src/core/transmuxing-events.js"),f=function(l){var c=null,v=y.bind(this);p.default.install(),l.addEventListener("message",function(E){switch(E.data.cmd){case"init":c=new u.default(E.data.param[0],E.data.param[1]),c.on(n.default.IO_ERROR,g.bind(this)),c.on(n.default.DEMUX_ERROR,A.bind(this)),c.on(n.default.INIT_SEGMENT,d.bind(this)),c.on(n.default.MEDIA_SEGMENT,i.bind(this)),c.on(n.default.LOADING_COMPLETE,t.bind(this)),c.on(n.default.RECOVERED_EARLY_EOF,r.bind(this)),c.on(n.default.MEDIA_INFO,e.bind(this)),c.on(n.default.METADATA_ARRIVED,s.bind(this)),c.on(n.default.SCRIPTDATA_ARRIVED,o.bind(this)),c.on(n.default.STATISTICS_INFO,a.bind(this)),c.on(n.default.RECOMMEND_SEEKPOINT,D.bind(this));break;case"destroy":c&&(c.destroy(),c=null),l.postMessage({msg:"destroyed"});break;case"start":c.start();break;case"stop":c.stop();break;case"seek":c.seek(E.data.param);break;case"pause":c.pause();break;case"resume":c.resume();break;case"logging_config":{var _=E.data.param;S.default.applyConfig(_),_.enableCallback===!0?S.default.addLogListener(v):S.default.removeLogListener(v);break}}});function d(E,_){var L={msg:n.default.INIT_SEGMENT,data:{type:E,data:_}};l.postMessage(L,[_.data])}function i(E,_){var L={msg:n.default.MEDIA_SEGMENT,data:{type:E,data:_}};l.postMessage(L,[_.data])}function t(){var E={msg:n.default.LOADING_COMPLETE};l.postMessage(E)}function r(){var E={msg:n.default.RECOVERED_EARLY_EOF};l.postMessage(E)}function e(E){var _={msg:n.default.MEDIA_INFO,data:E};l.postMessage(_)}function s(E){var _={msg:n.default.METADATA_ARRIVED,data:E};l.postMessage(_)}function o(E){var _={msg:n.default.SCRIPTDATA_ARRIVED,data:E};l.postMessage(_)}function a(E){var _={msg:n.default.STATISTICS_INFO,data:E};l.postMessage(_)}function g(E,_){l.postMessage({msg:n.default.IO_ERROR,data:{type:E,info:_}})}function A(E,_){l.postMessage({msg:n.default.DEMUX_ERROR,data:{type:E,info:_}})}function D(E){l.postMessage({msg:n.default.RECOMMEND_SEEKPOINT,data:E})}function y(E,_){l.postMessage({msg:"logcat_callback",data:{type:E,logcat:_}})}};m.default=f},"./src/demux/amf-parser.js":function(h,m,M){M.r(m);var S=M("./src/utils/logger.js"),p=M("./src/utils/utf8-conv.js"),u=M("./src/utils/exception.js"),n=function(){var l=new ArrayBuffer(2);return new DataView(l).setInt16(0,256,!0),new Int16Array(l)[0]===256}(),f=function(){function l(){}return l.parseScriptData=function(c,v,d){var i={};try{var t=l.parseValue(c,v,d),r=l.parseValue(c,v+t.size,d-t.size);i[t.data]=r.data}catch(e){S.default.e("AMF",e.toString())}return i},l.parseObject=function(c,v,d){if(d<3)throw new u.IllegalStateException("Data not enough when parse ScriptDataObject");var i=l.parseString(c,v,d),t=l.parseValue(c,v+i.size,d-i.size),r=t.objectEnd;return{data:{name:i.data,value:t.data},size:i.size+t.size,objectEnd:r}},l.parseVariable=function(c,v,d){return l.parseObject(c,v,d)},l.parseString=function(c,v,d){if(d<2)throw new u.IllegalStateException("Data not enough when parse String");var i=new DataView(c,v,d),t=i.getUint16(0,!n),r;return t>0?r=(0,p.default)(new Uint8Array(c,v+2,t)):r="",{data:r,size:2+t}},l.parseLongString=function(c,v,d){if(d<4)throw new u.IllegalStateException("Data not enough when parse LongString");var i=new DataView(c,v,d),t=i.getUint32(0,!n),r;return t>0?r=(0,p.default)(new Uint8Array(c,v+4,t)):r="",{data:r,size:4+t}},l.parseDate=function(c,v,d){if(d<10)throw new u.IllegalStateException("Data size invalid when parse Date");var i=new DataView(c,v,d),t=i.getFloat64(0,!n),r=i.getInt16(8,!n);return t+=r*60*1e3,{data:new Date(t),size:8+2}},l.parseValue=function(c,v,d){if(d<1)throw new u.IllegalStateException("Data not enough when parse Value");var i=new DataView(c,v,d),t=1,r=i.getUint8(0),e,s=!1;try{switch(r){case 0:e=i.getFloat64(1,!n),t+=8;break;case 1:{var o=i.getUint8(1);e=!!o,t+=1;break}case 2:{var a=l.parseString(c,v+1,d-1);e=a.data,t+=a.size;break}case 3:{e={};var g=0;for((i.getUint32(d-4,!n)&16777215)===9&&(g=3);t<d-4;){var A=l.parseObject(c,v+t,d-t-g);if(A.objectEnd)break;e[A.data.name]=A.data.value,t+=A.size}if(t<=d-3){var D=i.getUint32(t-1,!n)&16777215;D===9&&(t+=3)}break}case 8:{e={},t+=4;var g=0;for((i.getUint32(d-4,!n)&16777215)===9&&(g=3);t<d-8;){var y=l.parseVariable(c,v+t,d-t-g);if(y.objectEnd)break;e[y.data.name]=y.data.value,t+=y.size}if(t<=d-3){var D=i.getUint32(t-1,!n)&16777215;D===9&&(t+=3)}break}case 9:e=void 0,t=1,s=!0;break;case 10:{e=[];var E=i.getUint32(1,!n);t+=4;for(var _=0;_<E;_++){var L=l.parseValue(c,v+t,d-t);e.push(L.data),t+=L.size}break}case 11:{var I=l.parseDate(c,v+1,d-1);e=I.data,t+=I.size;break}case 12:{var b=l.parseString(c,v+1,d-1);e=b.data,t+=b.size;break}default:t=d,S.default.w("AMF","Unsupported AMF value type "+r)}}catch(R){S.default.e("AMF",R.toString())}return{data:e,size:t,objectEnd:s}},l}();m.default=f},"./src/demux/demux-errors.js":function(h,m,M){M.r(m);var S={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};m.default=S},"./src/demux/exp-golomb.js":function(h,m,M){M.r(m);var S=M("./src/utils/exception.js"),p=function(){function u(n){this.TAG="ExpGolomb",this._buffer=n,this._buffer_index=0,this._total_bytes=n.byteLength,this._total_bits=n.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return u.prototype.destroy=function(){this._buffer=null},u.prototype._fillCurrentWord=function(){var n=this._total_bytes-this._buffer_index;if(n<=0)throw new S.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var f=Math.min(4,n),l=new Uint8Array(4);l.set(this._buffer.subarray(this._buffer_index,this._buffer_index+f)),this._current_word=new DataView(l.buffer).getUint32(0,!1),this._buffer_index+=f,this._current_word_bits_left=f*8},u.prototype.readBits=function(n){if(n>32)throw new S.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(n<=this._current_word_bits_left){var f=this._current_word>>>32-n;return this._current_word<<=n,this._current_word_bits_left-=n,f}var l=this._current_word_bits_left?this._current_word:0;l=l>>>32-this._current_word_bits_left;var c=n-this._current_word_bits_left;this._fillCurrentWord();var v=Math.min(c,this._current_word_bits_left),d=this._current_word>>>32-v;return this._current_word<<=v,this._current_word_bits_left-=v,l=l<<v|d,l},u.prototype.readBool=function(){return this.readBits(1)===1},u.prototype.readByte=function(){return this.readBits(8)},u.prototype._skipLeadingZero=function(){var n;for(n=0;n<this._current_word_bits_left;n++)if((this._current_word&2147483648>>>n)!==0)return this._current_word<<=n,this._current_word_bits_left-=n,n;return this._fillCurrentWord(),n+this._skipLeadingZero()},u.prototype.readUEG=function(){var n=this._skipLeadingZero();return this.readBits(n+1)-1},u.prototype.readSEG=function(){var n=this.readUEG();return n&1?n+1>>>1:-1*(n>>>1)},u}();m.default=p},"./src/demux/flv-demuxer.js":function(h,m,M){M.r(m);var S=M("./src/utils/logger.js"),p=M("./src/demux/amf-parser.js"),u=M("./src/demux/sps-parser.js"),n=M("./src/demux/demux-errors.js"),f=M("./src/core/media-info.js"),l=M("./src/utils/exception.js");function c(d,i){return d[i]<<24|d[i+1]<<16|d[i+2]<<8|d[i+3]}var v=function(){function d(i,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=i.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=i.hasAudioTrack,this._hasVideo=i.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new f.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256}()}return d.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},d.probe=function(i){var t=new Uint8Array(i),r={match:!1};if(t[0]!==70||t[1]!==76||t[2]!==86||t[3]!==1)return r;var e=(t[4]&4)>>>2!==0,s=(t[4]&1)!==0,o=c(t,5);return o<9?r:{match:!0,consumed:o,dataOffset:o,hasAudioTrack:e,hasVideoTrack:s}},d.prototype.bindDataSource=function(i){return i.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(d.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(i){this._onTrackMetadata=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(i){this._onMediaInfo=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(i){this._onMetaDataArrived=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(i){this._onScriptDataArrived=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onError",{get:function(){return this._onError},set:function(i){this._onError=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(i){this._onDataAvailable=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(i){this._timestampBase=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"overridedDuration",{get:function(){return this._duration},set:function(i){this._durationOverrided=!0,this._duration=i,this._mediaInfo.duration=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"overridedHasAudio",{set:function(i){this._hasAudioFlagOverrided=!0,this._hasAudio=i,this._mediaInfo.hasAudio=i},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"overridedHasVideo",{set:function(i){this._hasVideoFlagOverrided=!0,this._hasVideo=i,this._mediaInfo.hasVideo=i},enumerable:!1,configurable:!0}),d.prototype.resetMediaInfo=function(){this._mediaInfo=new f.default},d.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},d.prototype.parseChunks=function(i,t){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new l.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var r=0,e=this._littleEndian;if(t===0)if(i.byteLength>13){var s=d.probe(i);r=s.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,t+r!==this._dataOffset&&S.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var o=new DataView(i,r),a=o.getUint32(0,!e);a!==0&&S.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),r+=4}for(;r<i.byteLength;){this._dispatch=!0;var o=new DataView(i,r);if(r+11+4>i.byteLength)break;var g=o.getUint8(0),A=o.getUint32(0,!e)&16777215;if(r+11+A+4>i.byteLength)break;if(g!==8&&g!==9&&g!==18){S.default.w(this.TAG,"Unsupported tag type "+g+", skipped"),r+=11+A+4;continue}var D=o.getUint8(4),y=o.getUint8(5),E=o.getUint8(6),_=o.getUint8(7),L=E|y<<8|D<<16|_<<24,I=o.getUint32(7,!e)&16777215;I!==0&&S.default.w(this.TAG,"Meet tag which has StreamID != 0!");var b=r+11;switch(g){case 8:this._parseAudioData(i,b,A,L);break;case 9:this._parseVideoData(i,b,A,L,t+r);break;case 18:this._parseScriptData(i,b,A);break}var R=o.getUint32(11+A,!e);R!==11+A&&S.default.w(this.TAG,"Invalid PrevTagSize "+R),r+=11+A+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),r},d.prototype._parseScriptData=function(i,t,r){var e=p.default.parseScriptData(i,t,r);if(e.hasOwnProperty("onMetaData")){if(e.onMetaData==null||typeof e.onMetaData!="object"){S.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&S.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=e;var s=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},s)),typeof s.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=s.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof s.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=s.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof s.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=s.audiodatarate),typeof s.videodatarate=="number"&&(this._mediaInfo.videoDataRate=s.videodatarate),typeof s.width=="number"&&(this._mediaInfo.width=s.width),typeof s.height=="number"&&(this._mediaInfo.height=s.height),typeof s.duration=="number"){if(!this._durationOverrided){var o=Math.floor(s.duration*this._timescale);this._duration=o,this._mediaInfo.duration=o}}else this._mediaInfo.duration=0;if(typeof s.framerate=="number"){var a=Math.floor(s.framerate*1e3);if(a>0){var g=a/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=g,this._referenceFrameRate.fps_num=a,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=g}}if(typeof s.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var A=s.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(A),s.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=s,S.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(e).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},e))},d.prototype._parseKeyframesIndex=function(i){for(var t=[],r=[],e=1;e<i.times.length;e++){var s=this._timestampBase+Math.floor(i.times[e]*1e3);t.push(s),r.push(i.filepositions[e])}return{times:t,filepositions:r}},d.prototype._parseAudioData=function(i,t,r,e){if(r<=1){S.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var s=new DataView(i,t,r),o=s.getUint8(0),a=o>>>4;if(a!==2&&a!==10){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+a);return}var g=0,A=(o&12)>>>2;if(A>=0&&A<=4)g=this._flvSoundRateTable[A];else{this._onError(n.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+A);return}var D=o&1,y=this._audioMetadata,E=this._audioTrack;if(y||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),y=this._audioMetadata={},y.type="audio",y.id=E.id,y.timescale=this._timescale,y.duration=this._duration,y.audioSampleRate=g,y.channelCount=D===0?1:2),a===10){var _=this._parseAACAudioData(i,t+1,r-1);if(_==null)return;if(_.packetType===0){y.config&&S.default.w(this.TAG,"Found another AudioSpecificConfig!");var L=_.data;y.audioSampleRate=L.samplingRate,y.channelCount=L.channelCount,y.codec=L.codec,y.originalCodec=L.originalCodec,y.config=L.config,y.refSampleDuration=1024/y.audioSampleRate*y.timescale,S.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",y);var I=this._mediaInfo;I.audioCodec=y.originalCodec,I.audioSampleRate=y.audioSampleRate,I.audioChannelCount=y.channelCount,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}else if(_.packetType===1){var b=this._timestampBase+e,R={unit:_.data,length:_.data.byteLength,dts:b,pts:b};E.samples.push(R),E.length+=_.data.length}else S.default.e(this.TAG,"Flv: Unsupported AAC data type "+_.packetType)}else if(a===2){if(!y.codec){var L=this._parseMP3AudioData(i,t+1,r-1,!0);if(L==null)return;y.audioSampleRate=L.samplingRate,y.channelCount=L.channelCount,y.codec=L.codec,y.originalCodec=L.originalCodec,y.refSampleDuration=1152/y.audioSampleRate*y.timescale,S.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",y);var I=this._mediaInfo;I.audioCodec=y.codec,I.audioSampleRate=y.audioSampleRate,I.audioChannelCount=y.channelCount,I.audioDataRate=L.bitRate,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}var P=this._parseMP3AudioData(i,t+1,r-1,!1);if(P==null)return;var b=this._timestampBase+e,w={unit:P,length:P.byteLength,dts:b,pts:b};E.samples.push(w),E.length+=P.length}}},d.prototype._parseAACAudioData=function(i,t,r){if(r<=1){S.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var e={},s=new Uint8Array(i,t,r);return e.packetType=s[0],s[0]===0?e.data=this._parseAACAudioSpecificConfig(i,t+1,r-1):e.data=s.subarray(1),e},d.prototype._parseAACAudioSpecificConfig=function(i,t,r){var e=new Uint8Array(i,t,r),s=null,o=0,a=0,g=0,A=null;if(o=a=e[0]>>>3,g=(e[0]&7)<<1|e[1]>>>7,g<0||g>=this._mpegSamplingRates.length){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var D=this._mpegSamplingRates[g],y=(e[1]&120)>>>3;if(y<0||y>=8){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}o===5&&(A=(e[1]&7)<<1|e[2]>>>7,(e[2]&124)>>>2);var E=self.navigator.userAgent.toLowerCase();return E.indexOf("firefox")!==-1?g>=6?(o=5,s=new Array(4),A=g-3):(o=2,s=new Array(2),A=g):E.indexOf("android")!==-1?(o=2,s=new Array(2),A=g):(o=5,A=g,s=new Array(4),g>=6?A=g-3:y===1&&(o=2,s=new Array(2),A=g)),s[0]=o<<3,s[0]|=(g&15)>>>1,s[1]=(g&15)<<7,s[1]|=(y&15)<<3,o===5&&(s[1]|=(A&15)>>>1,s[2]=(A&1)<<7,s[2]|=2<<2,s[3]=0),{config:s,samplingRate:D,channelCount:y,codec:"mp4a.40."+o,originalCodec:"mp4a.40."+a}},d.prototype._parseMP3AudioData=function(i,t,r,e){if(r<4){S.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var s=new Uint8Array(i,t,r),o=null;if(e){if(s[0]!==255)return;var a=s[1]>>>3&3,g=(s[1]&6)>>1,A=(s[2]&240)>>>4,D=(s[2]&12)>>>2,y=s[3]>>>6&3,E=y!==3?2:1,_=0,L=0,I="mp3";switch(a){case 0:_=this._mpegAudioV25SampleRateTable[D];break;case 2:_=this._mpegAudioV20SampleRateTable[D];break;case 3:_=this._mpegAudioV10SampleRateTable[D];break}switch(g){case 1:A<this._mpegAudioL3BitRateTable.length&&(L=this._mpegAudioL3BitRateTable[A]);break;case 2:A<this._mpegAudioL2BitRateTable.length&&(L=this._mpegAudioL2BitRateTable[A]);break;case 3:A<this._mpegAudioL1BitRateTable.length&&(L=this._mpegAudioL1BitRateTable[A]);break}o={bitRate:L,samplingRate:_,channelCount:E,codec:I,originalCodec:I}}else o=s;return o},d.prototype._parseVideoData=function(i,t,r,e,s){if(r<=1){S.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var o=new Uint8Array(i,t,r)[0],a=(o&240)>>>4,g=o&15;if(g!==7){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+g);return}this._parseAVCVideoPacket(i,t+1,r-1,e,s,a)}},d.prototype._parseAVCVideoPacket=function(i,t,r,e,s,o){if(r<4){S.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var a=this._littleEndian,g=new DataView(i,t,r),A=g.getUint8(0),D=g.getUint32(0,!a)&16777215,y=D<<8>>8;if(A===0)this._parseAVCDecoderConfigurationRecord(i,t+4,r-4);else if(A===1)this._parseAVCVideoData(i,t+4,r-4,e,s,o,y);else if(A!==2){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid video packet type "+A);return}},d.prototype._parseAVCDecoderConfigurationRecord=function(i,t,r){if(r<7){S.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var e=this._videoMetadata,s=this._videoTrack,o=this._littleEndian,a=new DataView(i,t,r);e?typeof e.avcc!="undefined"&&S.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),e=this._videoMetadata={},e.type="video",e.id=s.id,e.timescale=this._timescale,e.duration=this._duration);var g=a.getUint8(0),A=a.getUint8(1);if(a.getUint8(2),a.getUint8(3),g!==1||A===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(a.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(n.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var D=a.getUint8(5)&31;if(D===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else D>1&&S.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+D);for(var y=6,E=0;E<D;E++){var _=a.getUint16(y,!o);if(y+=2,_!==0){var L=new Uint8Array(i,t+y,_);y+=_;var I=u.default.parseSPS(L);if(E===0){e.codecWidth=I.codec_size.width,e.codecHeight=I.codec_size.height,e.presentWidth=I.present_size.width,e.presentHeight=I.present_size.height,e.profile=I.profile_string,e.level=I.level_string,e.bitDepth=I.bit_depth,e.chromaFormat=I.chroma_format,e.sarRatio=I.sar_ratio,e.frameRate=I.frame_rate,(I.frame_rate.fixed===!1||I.frame_rate.fps_num===0||I.frame_rate.fps_den===0)&&(e.frameRate=this._referenceFrameRate);var b=e.frameRate.fps_den,R=e.frameRate.fps_num;e.refSampleDuration=e.timescale*(b/R);for(var P=L.subarray(1,4),w="avc1.",F=0;F<3;F++){var k=P[F].toString(16);k.length<2&&(k="0"+k),w+=k}e.codec=w;var B=this._mediaInfo;B.width=e.codecWidth,B.height=e.codecHeight,B.fps=e.frameRate.fps,B.profile=e.profile,B.level=e.level,B.refFrames=I.ref_frames,B.chromaFormat=I.chroma_format_string,B.sarNum=e.sarRatio.width,B.sarDen=e.sarRatio.height,B.videoCodec=w,B.hasAudio?B.audioCodec!=null&&(B.mimeType='video/x-flv; codecs="'+B.videoCodec+","+B.audioCodec+'"'):B.mimeType='video/x-flv; codecs="'+B.videoCodec+'"',B.isComplete()&&this._onMediaInfo(B)}}}var U=a.getUint8(y);if(U===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else U>1&&S.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+U);y++;for(var E=0;E<U;E++){var _=a.getUint16(y,!o);y+=2,_!==0&&(y+=_)}e.avcc=new Uint8Array(r),e.avcc.set(new Uint8Array(i,t,r),0),S.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",e)},d.prototype._parseAVCVideoData=function(i,t,r,e,s,o,a){for(var g=this._littleEndian,A=new DataView(i,t,r),D=[],y=0,E=0,_=this._naluLengthSize,L=this._timestampBase+e,I=o===1;E<r;){if(E+4>=r){S.default.w(this.TAG,"Malformed Nalu near timestamp "+L+", offset = "+E+", dataSize = "+r);break}var b=A.getUint32(E,!g);if(_===3&&(b>>>=8),b>r-_){S.default.w(this.TAG,"Malformed Nalus near timestamp "+L+", NaluSize > DataSize!");return}var R=A.getUint8(E+_)&31;R===5&&(I=!0);var P=new Uint8Array(i,t+E,_+b),w={type:R,data:P};D.push(w),y+=P.byteLength,E+=_+b}if(D.length){var F=this._videoTrack,k={units:D,length:y,isKeyframe:I,dts:L,cts:a,pts:L+a};I&&(k.fileposition=s),F.samples.push(k),F.length+=y}},d}();m.default=v},"./src/demux/sps-parser.js":function(h,m,M){M.r(m);var S=M("./src/demux/exp-golomb.js"),p=function(){function u(){}return u._ebsp2rbsp=function(n){for(var f=n,l=f.byteLength,c=new Uint8Array(l),v=0,d=0;d<l;d++)d>=2&&f[d]===3&&f[d-1]===0&&f[d-2]===0||(c[v]=f[d],v++);return new Uint8Array(c.buffer,0,v)},u.parseSPS=function(n){var f=u._ebsp2rbsp(n),l=new S.default(f);l.readByte();var c=l.readByte();l.readByte();var v=l.readByte();l.readUEG();var d=u.getProfileString(c),i=u.getLevelString(v),t=1,r=420,e=[0,420,422,444],s=8;if((c===100||c===110||c===122||c===244||c===44||c===83||c===86||c===118||c===128||c===138||c===144)&&(t=l.readUEG(),t===3&&l.readBits(1),t<=3&&(r=e[t]),s=l.readUEG()+8,l.readUEG(),l.readBits(1),l.readBool()))for(var o=t!==3?8:12,a=0;a<o;a++)l.readBool()&&(a<6?u._skipScalingList(l,16):u._skipScalingList(l,64));l.readUEG();var g=l.readUEG();if(g===0)l.readUEG();else if(g===1){l.readBits(1),l.readSEG(),l.readSEG();for(var A=l.readUEG(),a=0;a<A;a++)l.readSEG()}var D=l.readUEG();l.readBits(1);var y=l.readUEG(),E=l.readUEG(),_=l.readBits(1);_===0&&l.readBits(1),l.readBits(1);var L=0,I=0,b=0,R=0,P=l.readBool();P&&(L=l.readUEG(),I=l.readUEG(),b=l.readUEG(),R=l.readUEG());var w=1,F=1,k=0,B=!0,U=0,j=0,K=l.readBool();if(K){if(l.readBool()){var N=l.readByte(),Z=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],$=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];N>0&&N<16?(w=Z[N-1],F=$[N-1]):N===255&&(w=l.readByte()<<8|l.readByte(),F=l.readByte()<<8|l.readByte())}if(l.readBool()&&l.readBool(),l.readBool()&&(l.readBits(4),l.readBool()&&l.readBits(24)),l.readBool()&&(l.readUEG(),l.readUEG()),l.readBool()){var Y=l.readBits(32),ee=l.readBits(32);B=l.readBool(),U=ee,j=Y*2,k=U/j}}var Q=1;(w!==1||F!==1)&&(Q=w/F);var G=0,q=0;if(t===0)G=1,q=2-_;else{var te=t===3?1:2,ie=t===1?2:1;G=te,q=ie*(2-_)}var ne=(y+1)*16,le=(2-_)*((E+1)*16);ne-=(L+I)*G,le-=(b+R)*q;var se=Math.ceil(ne*Q);return l.destroy(),l=null,{profile_string:d,level_string:i,bit_depth:s,ref_frames:D,chroma_format:r,chroma_format_string:u.getChromaFormatString(r),frame_rate:{fixed:B,fps:k,fps_den:j,fps_num:U},sar_ratio:{width:w,height:F},codec_size:{width:ne,height:le},present_size:{width:se,height:le}}},u._skipScalingList=function(n,f){for(var l=8,c=8,v=0,d=0;d<f;d++)c!==0&&(v=n.readSEG(),c=(l+v+256)%256),l=c===0?l:c},u.getProfileString=function(n){switch(n){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},u.getLevelString=function(n){return(n/10).toFixed(1)},u.getChromaFormatString=function(n){switch(n){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},u}();m.default=p},"./src/flv.js":function(h,m,M){M.r(m);var S=M("./src/utils/polyfill.js"),p=M("./src/core/features.js"),u=M("./src/io/loader.js"),n=M("./src/player/flv-player.js"),f=M("./src/player/native-player.js"),l=M("./src/player/player-events.js"),c=M("./src/player/player-errors.js"),v=M("./src/utils/logging-control.js"),d=M("./src/utils/exception.js");S.default.install();function i(s,o){var a=s;if(a==null||typeof a!="object")throw new d.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!a.hasOwnProperty("type"))throw new d.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(a.type){case"flv":return new n.default(a,o);default:return new f.default(a,o)}}function t(){return p.default.supportMSEH264Playback()}function r(){return p.default.getFeatureList()}var e={};e.createPlayer=i,e.isSupported=t,e.getFeatureList=r,e.BaseLoader=u.BaseLoader,e.LoaderStatus=u.LoaderStatus,e.LoaderErrors=u.LoaderErrors,e.Events=l.default,e.ErrorTypes=c.ErrorTypes,e.ErrorDetails=c.ErrorDetails,e.FlvPlayer=n.default,e.NativePlayer=f.default,e.LoggingControl=v.default,Object.defineProperty(e,"version",{enumerable:!0,get:function(){return"1.6.2"}}),m.default=e},"./src/index.js":function(h,m,M){h.exports=M("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(h,m,M){M.r(m);var S=M("./src/utils/browser.js"),p=M("./src/io/loader.js"),u=M("./src/utils/exception.js"),n=function(){var l=function(c,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(d[t]=i[t])},l(c,v)};return function(c,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(c,v);function d(){this.constructor=c}c.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}(),f=function(l){n(c,l);function c(v,d){var i=l.call(this,"fetch-stream-loader")||this;return i.TAG="FetchStreamLoader",i._seekHandler=v,i._config=d,i._needStash=!0,i._requestAbort=!1,i._contentLength=null,i._receivedLength=0,i}return c.isSupported=function(){try{var v=S.default.msedge&&S.default.version.minor>=15048,d=S.default.msedge?v:!0;return self.fetch&&self.ReadableStream&&d}catch{return!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),l.prototype.destroy.call(this)},c.prototype.open=function(v,d){var i=this;this._dataSource=v,this._range=d;var t=v.url;this._config.reuseRedirectedURL&&v.redirectedURL!=null&&(t=v.redirectedURL);var r=this._seekHandler.getConfig(t,d),e=new self.Headers;if(typeof r.headers=="object"){var s=r.headers;for(var o in s)s.hasOwnProperty(o)&&e.append(o,s[o])}var a={method:"GET",headers:e,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var o in this._config.headers)e.append(o,this._config.headers[o]);v.cors===!1&&(a.mode="same-origin"),v.withCredentials&&(a.credentials="include"),v.referrerPolicy&&(a.referrerPolicy=v.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,a.signal=this._abortController.signal),this._status=p.LoaderStatus.kConnecting,self.fetch(r.url,a).then(function(g){if(i._requestAbort){i._status=p.LoaderStatus.kIdle,g.body.cancel();return}if(g.ok&&g.status>=200&&g.status<=299){if(g.url!==r.url&&i._onURLRedirect){var A=i._seekHandler.removeURLParameters(g.url);i._onURLRedirect(A)}var D=g.headers.get("Content-Length");return D!=null&&(i._contentLength=parseInt(D),i._contentLength!==0&&i._onContentLengthKnown&&i._onContentLengthKnown(i._contentLength)),i._pump.call(i,g.body.getReader())}else if(i._status=p.LoaderStatus.kError,i._onError)i._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:g.status,msg:g.statusText});else throw new u.RuntimeException("FetchStreamLoader: Http code invalid, "+g.status+" "+g.statusText)}).catch(function(g){if(!(i._abortController&&i._abortController.signal.aborted))if(i._status=p.LoaderStatus.kError,i._onError)i._onError(p.LoaderErrors.EXCEPTION,{code:-1,msg:g.message});else throw g})},c.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==p.LoaderStatus.kBuffering||!S.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},c.prototype._pump=function(v){var d=this;return v.read().then(function(i){if(i.done)if(d._contentLength!==null&&d._receivedLength<d._contentLength){d._status=p.LoaderStatus.kError;var t=p.LoaderErrors.EARLY_EOF,r={code:-1,msg:"Fetch stream meet Early-EOF"};if(d._onError)d._onError(t,r);else throw new u.RuntimeException(r.msg)}else d._status=p.LoaderStatus.kComplete,d._onComplete&&d._onComplete(d._range.from,d._range.from+d._receivedLength-1);else{if(d._abortController&&d._abortController.signal.aborted){d._status=p.LoaderStatus.kComplete;return}else if(d._requestAbort===!0)return d._status=p.LoaderStatus.kComplete,v.cancel();d._status=p.LoaderStatus.kBuffering;var e=i.value.buffer,s=d._range.from+d._receivedLength;d._receivedLength+=e.byteLength,d._onDataArrival&&d._onDataArrival(e,s,d._receivedLength),d._pump(v)}}).catch(function(i){if(d._abortController&&d._abortController.signal.aborted){d._status=p.LoaderStatus.kComplete;return}if(!(i.code===11&&S.default.msedge)){d._status=p.LoaderStatus.kError;var t=0,r=null;if((i.code===19||i.message==="network error")&&(d._contentLength===null||d._contentLength!==null&&d._receivedLength<d._contentLength)?(t=p.LoaderErrors.EARLY_EOF,r={code:i.code,msg:"Fetch stream meet Early-EOF"}):(t=p.LoaderErrors.EXCEPTION,r={code:i.code,msg:i.message}),d._onError)d._onError(t,r);else throw new u.RuntimeException(r.msg)}})},c}(p.BaseLoader);m.default=f},"./src/io/io-controller.js":function(h,m,M){M.r(m);var S=M("./src/utils/logger.js"),p=M("./src/io/speed-sampler.js"),u=M("./src/io/loader.js"),n=M("./src/io/fetch-stream-loader.js"),f=M("./src/io/xhr-moz-chunked-loader.js"),l=M("./src/io/xhr-range-loader.js"),c=M("./src/io/websocket-loader.js"),v=M("./src/io/range-seek-handler.js"),d=M("./src/io/param-seek-handler.js"),i=M("./src/utils/exception.js"),t=function(){function r(e,s,o){this.TAG="IOController",this._config=s,this._extraData=o,this._stashInitialSize=1024*384,s.stashInitialSize!=null&&s.stashInitialSize>0&&(this._stashInitialSize=s.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,s.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new p.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return r.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},r.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},r.prototype.isPaused=function(){return this._paused},Object.defineProperty(r.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"currentSpeed",{get:function(){return this._loaderClass===l.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),r.prototype._selectSeekHandler=function(){var e=this._config;if(e.seekType==="range")this._seekHandler=new v.default(this._config.rangeLoadZeroStart);else if(e.seekType==="param"){var s=e.seekParamStart||"bstart",o=e.seekParamEnd||"bend";this._seekHandler=new d.default(s,o)}else if(e.seekType==="custom"){if(typeof e.customSeekHandler!="function")throw new i.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}else throw new i.InvalidArgumentException("Invalid seekType in config: "+e.seekType)},r.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=c.default;else if(n.default.isSupported())this._loaderClass=n.default;else if(f.default.isSupported())this._loaderClass=f.default;else if(l.default.isSupported())this._loaderClass=l.default;else throw new i.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},r.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},r.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},r.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},r.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},r.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},r.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},r.prototype._internalSeek=function(e,s){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(s),this._loader.destroy(),this._loader=null;var o={from:e,to:-1};this._currentRange={from:o.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,o),this._onSeeked&&this._onSeeked()},r.prototype.updateUrl=function(e){if(!e||typeof e!="string"||e.length===0)throw new i.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=e},r.prototype._expandBuffer=function(e){for(var s=this._stashSize;s+1024*1024*1<e;)s*=2;if(s+=1024*1024*1,s!==this._bufferSize){var o=new ArrayBuffer(s);if(this._stashUsed>0){var a=new Uint8Array(this._stashBuffer,0,this._stashUsed),g=new Uint8Array(o,0,s);g.set(a,0)}this._stashBuffer=o,this._bufferSize=s}},r.prototype._normalizeSpeed=function(e){var s=this._speedNormalizeList,o=s.length-1,a=0,g=0,A=o;if(e<s[0])return s[0];for(;g<=A;){if(a=g+Math.floor((A-g)/2),a===o||e>=s[a]&&e<s[a+1])return s[a];s[a]<e?g=a+1:A=a-1}},r.prototype._adjustStashSize=function(e){var s=0;this._config.isLive||e<512?s=e:e>=512&&e<=1024?s=Math.floor(e*1.5):s=e*2,s>8192&&(s=8192);var o=s*1024+1024*1024*1;this._bufferSize<o&&this._expandBuffer(o),this._stashSize=s*1024},r.prototype._dispatchChunks=function(e,s){return this._currentRange.to=s+e.byteLength-1,this._onDataArrival(e,s)},r.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},r.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},r.prototype._onLoaderChunkArrival=function(e,s,o){if(!this._onDataArrival)throw new i.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var a=this._speedSampler.lastSecondKBps;if(a!==0){var g=this._normalizeSpeed(a);this._speedNormalized!==g&&(this._speedNormalized=g,this._adjustStashSize(g))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=s),this._stashUsed+e.byteLength<=this._stashSize){var y=new Uint8Array(this._stashBuffer,0,this._stashSize);y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var _=this._stashBuffer.slice(0,this._stashUsed),A=this._dispatchChunks(_,this._stashByteStart);if(A<_.byteLength){if(A>0){var E=new Uint8Array(_,A);y.set(E,0),this._stashUsed=E.byteLength,this._stashByteStart+=A}}else this._stashUsed=0,this._stashByteStart+=A;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var A=this._dispatchChunks(e,s);if(A<e.byteLength){var D=e.byteLength-A;D>this._bufferSize&&(this._expandBuffer(D),y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),y.set(new Uint8Array(e,A),0),this._stashUsed+=D,this._stashByteStart=s+A}}}else if(this._stashUsed===0){var A=this._dispatchChunks(e,s);if(A<e.byteLength){var D=e.byteLength-A;D>this._bufferSize&&this._expandBuffer(D);var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);y.set(new Uint8Array(e,A),0),this._stashUsed+=D,this._stashByteStart=s+A}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;var A=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(A<this._stashUsed&&A>0){var E=new Uint8Array(this._stashBuffer,A);y.set(E,0)}this._stashUsed-=A,this._stashByteStart+=A}}},r.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var s=this._stashBuffer.slice(0,this._stashUsed),o=this._dispatchChunks(s,this._stashByteStart),a=s.byteLength-o;if(o<s.byteLength)if(e)S.default.w(this.TAG,a+" bytes unconsumed data remain when flush buffer, dropped");else{if(o>0){var g=new Uint8Array(this._stashBuffer,0,this._bufferSize),A=new Uint8Array(s,o);g.set(A,0),this._stashUsed=A.byteLength,this._stashByteStart+=o}return 0}return this._stashUsed=0,this._stashByteStart=0,a}return 0},r.prototype._onLoaderComplete=function(e,s){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},r.prototype._onLoaderError=function(e,s){switch(S.default.e(this.TAG,"Loader error, code = "+s.code+", msg = "+s.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF),e){case u.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var o=this._currentRange.to+1;o<this._totalLength&&(S.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(o,!1));return}e=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case u.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case u.LoaderErrors.CONNECTING_TIMEOUT:case u.LoaderErrors.HTTP_STATUS_CODE_INVALID:case u.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(e,s);else throw new i.RuntimeException("IOException: "+s.msg)},r}();m.default=t},"./src/io/loader.js":function(h,m,M){M.r(m),M.d(m,{LoaderStatus:function(){return p},LoaderErrors:function(){return u},BaseLoader:function(){return n}});var S=M("./src/utils/exception.js"),p={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},u={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},n=function(){function f(l){this._type=l||"undefined",this._status=p.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return f.prototype.destroy=function(){this._status=p.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},f.prototype.isWorking=function(){return this._status===p.kConnecting||this._status===p.kBuffering},Object.defineProperty(f.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(l){this._onContentLengthKnown=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(l){this._onURLRedirect=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(l){this._onDataArrival=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onError",{get:function(){return this._onError},set:function(l){this._onError=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onComplete",{get:function(){return this._onComplete},set:function(l){this._onComplete=l},enumerable:!1,configurable:!0}),f.prototype.open=function(l,c){throw new S.NotImplementedException("Unimplemented abstract function!")},f.prototype.abort=function(){throw new S.NotImplementedException("Unimplemented abstract function!")},f}()},"./src/io/param-seek-handler.js":function(h,m,M){M.r(m);var S=function(){function p(u,n){this._startName=u,this._endName=n}return p.prototype.getConfig=function(u,n){var f=u;if(n.from!==0||n.to!==-1){var l=!0;f.indexOf("?")===-1&&(f+="?",l=!1),l&&(f+="&"),f+=this._startName+"="+n.from.toString(),n.to!==-1&&(f+="&"+this._endName+"="+n.to.toString())}return{url:f,headers:{}}},p.prototype.removeURLParameters=function(u){var n=u.split("?")[0],f=void 0,l=u.indexOf("?");l!==-1&&(f=u.substring(l+1));var c="";if(f!=null&&f.length>0)for(var v=f.split("&"),d=0;d<v.length;d++){var i=v[d].split("="),t=d>0;i[0]!==this._startName&&i[0]!==this._endName&&(t&&(c+="&"),c+=v[d])}return c.length===0?n:n+"?"+c},p}();m.default=S},"./src/io/range-seek-handler.js":function(h,m,M){M.r(m);var S=function(){function p(u){this._zeroStart=u||!1}return p.prototype.getConfig=function(u,n){var f={};if(n.from!==0||n.to!==-1){var l=void 0;n.to!==-1?l="bytes="+n.from.toString()+"-"+n.to.toString():l="bytes="+n.from.toString()+"-",f.Range=l}else this._zeroStart&&(f.Range="bytes=0-");return{url:u,headers:f}},p.prototype.removeURLParameters=function(u){return u},p}();m.default=S},"./src/io/speed-sampler.js":function(h,m,M){M.r(m);var S=function(){function p(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return p.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},p.prototype.addBytes=function(u){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=u,this._totalBytes+=u):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=u,this._totalBytes+=u):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=u,this._totalBytes+=u,this._lastCheckpoint=this._now())},Object.defineProperty(p.prototype,"currentKBps",{get:function(){this.addBytes(0);var u=(this._now()-this._lastCheckpoint)/1e3;return u==0&&(u=1),this._intervalBytes/u/1024},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"averageKBps",{get:function(){var u=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/u/1024},enumerable:!1,configurable:!0}),p}();m.default=S},"./src/io/websocket-loader.js":function(h,m,M){M.r(m);var S=M("./src/io/loader.js"),p=M("./src/utils/exception.js"),u=function(){var f=function(l,c){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,d){v.__proto__=d}||function(v,d){for(var i in d)Object.prototype.hasOwnProperty.call(d,i)&&(v[i]=d[i])},f(l,c)};return function(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");f(l,c);function v(){this.constructor=l}l.prototype=c===null?Object.create(c):(v.prototype=c.prototype,new v)}}(),n=function(f){u(l,f);function l(){var c=f.call(this,"websocket-loader")||this;return c.TAG="WebSocketLoader",c._needStash=!0,c._ws=null,c._requestAbort=!1,c._receivedLength=0,c}return l.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch{return!1}},l.prototype.destroy=function(){this._ws&&this.abort(),f.prototype.destroy.call(this)},l.prototype.open=function(c){try{var v=this._ws=new self.WebSocket(c.url);v.binaryType="arraybuffer",v.onopen=this._onWebSocketOpen.bind(this),v.onclose=this._onWebSocketClose.bind(this),v.onmessage=this._onWebSocketMessage.bind(this),v.onerror=this._onWebSocketError.bind(this),this._status=S.LoaderStatus.kConnecting}catch(i){this._status=S.LoaderStatus.kError;var d={code:i.code,msg:i.message};if(this._onError)this._onError(S.LoaderErrors.EXCEPTION,d);else throw new p.RuntimeException(d.msg)}},l.prototype.abort=function(){var c=this._ws;c&&(c.readyState===0||c.readyState===1)&&(this._requestAbort=!0,c.close()),this._ws=null,this._status=S.LoaderStatus.kComplete},l.prototype._onWebSocketOpen=function(c){this._status=S.LoaderStatus.kBuffering},l.prototype._onWebSocketClose=function(c){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=S.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},l.prototype._onWebSocketMessage=function(c){var v=this;if(c.data instanceof ArrayBuffer)this._dispatchArrayBuffer(c.data);else if(c.data instanceof Blob){var d=new FileReader;d.onload=function(){v._dispatchArrayBuffer(d.result)},d.readAsArrayBuffer(c.data)}else{this._status=S.LoaderStatus.kError;var i={code:-1,msg:"Unsupported WebSocket message type: "+c.data.constructor.name};if(this._onError)this._onError(S.LoaderErrors.EXCEPTION,i);else throw new p.RuntimeException(i.msg)}},l.prototype._dispatchArrayBuffer=function(c){var v=c,d=this._receivedLength;this._receivedLength+=v.byteLength,this._onDataArrival&&this._onDataArrival(v,d,this._receivedLength)},l.prototype._onWebSocketError=function(c){this._status=S.LoaderStatus.kError;var v={code:c.code,msg:c.message};if(this._onError)this._onError(S.LoaderErrors.EXCEPTION,v);else throw new p.RuntimeException(v.msg)},l}(S.BaseLoader);m.default=n},"./src/io/xhr-moz-chunked-loader.js":function(h,m,M){M.r(m);var S=M("./src/utils/logger.js"),p=M("./src/io/loader.js"),u=M("./src/utils/exception.js"),n=function(){var l=function(c,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(d[t]=i[t])},l(c,v)};return function(c,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(c,v);function d(){this.constructor=c}c.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}(),f=function(l){n(c,l);function c(v,d){var i=l.call(this,"xhr-moz-chunked-loader")||this;return i.TAG="MozChunkedLoader",i._seekHandler=v,i._config=d,i._needStash=!0,i._xhr=null,i._requestAbort=!1,i._contentLength=null,i._receivedLength=0,i}return c.isSupported=function(){try{var v=new XMLHttpRequest;return v.open("GET","https://example.com",!0),v.responseType="moz-chunked-arraybuffer",v.responseType==="moz-chunked-arraybuffer"}catch(d){return S.default.w("MozChunkedLoader",d.message),!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),l.prototype.destroy.call(this)},c.prototype.open=function(v,d){this._dataSource=v,this._range=d;var i=v.url;this._config.reuseRedirectedURL&&v.redirectedURL!=null&&(i=v.redirectedURL);var t=this._seekHandler.getConfig(i,d);this._requestURL=t.url;var r=this._xhr=new XMLHttpRequest;if(r.open("GET",t.url,!0),r.responseType="moz-chunked-arraybuffer",r.onreadystatechange=this._onReadyStateChange.bind(this),r.onprogress=this._onProgress.bind(this),r.onloadend=this._onLoadEnd.bind(this),r.onerror=this._onXhrError.bind(this),v.withCredentials&&(r.withCredentials=!0),typeof t.headers=="object"){var e=t.headers;for(var s in e)e.hasOwnProperty(s)&&r.setRequestHeader(s,e[s])}if(typeof this._config.headers=="object"){var e=this._config.headers;for(var s in e)e.hasOwnProperty(s)&&r.setRequestHeader(s,e[s])}this._status=p.LoaderStatus.kConnecting,r.send()},c.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=p.LoaderStatus.kComplete},c.prototype._onReadyStateChange=function(v){var d=v.target;if(d.readyState===2){if(d.responseURL!=null&&d.responseURL!==this._requestURL&&this._onURLRedirect){var i=this._seekHandler.removeURLParameters(d.responseURL);this._onURLRedirect(i)}if(d.status!==0&&(d.status<200||d.status>299))if(this._status=p.LoaderStatus.kError,this._onError)this._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:d.status,msg:d.statusText});else throw new u.RuntimeException("MozChunkedLoader: Http code invalid, "+d.status+" "+d.statusText);else this._status=p.LoaderStatus.kBuffering}},c.prototype._onProgress=function(v){if(this._status!==p.LoaderStatus.kError){this._contentLength===null&&v.total!==null&&v.total!==0&&(this._contentLength=v.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var d=v.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=d.byteLength,this._onDataArrival&&this._onDataArrival(d,i,this._receivedLength)}},c.prototype._onLoadEnd=function(v){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===p.LoaderStatus.kError)return;this._status=p.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},c.prototype._onXhrError=function(v){this._status=p.LoaderStatus.kError;var d=0,i=null;if(this._contentLength&&v.loaded<this._contentLength?(d=p.LoaderErrors.EARLY_EOF,i={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(d=p.LoaderErrors.EXCEPTION,i={code:-1,msg:v.constructor.name+" "+v.type}),this._onError)this._onError(d,i);else throw new u.RuntimeException(i.msg)},c}(p.BaseLoader);m.default=f},"./src/io/xhr-range-loader.js":function(h,m,M){M.r(m);var S=M("./src/utils/logger.js"),p=M("./src/io/speed-sampler.js"),u=M("./src/io/loader.js"),n=M("./src/utils/exception.js"),f=function(){var c=function(v,d){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])},c(v,d)};return function(v,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");c(v,d);function i(){this.constructor=v}v.prototype=d===null?Object.create(d):(i.prototype=d.prototype,new i)}}(),l=function(c){f(v,c);function v(d,i){var t=c.call(this,"xhr-range-loader")||this;return t.TAG="RangeLoader",t._seekHandler=d,t._config=i,t._needStash=!1,t._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],t._currentChunkSizeKB=384,t._currentSpeedNormalized=0,t._zeroSpeedChunkCount=0,t._xhr=null,t._speedSampler=new p.default,t._requestAbort=!1,t._waitForTotalLength=!1,t._totalLengthReceived=!1,t._currentRequestURL=null,t._currentRedirectedURL=null,t._currentRequestRange=null,t._totalLength=null,t._contentLength=null,t._receivedLength=0,t._lastTimeLoaded=0,t}return v.isSupported=function(){try{var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="arraybuffer",d.responseType==="arraybuffer"}catch(i){return S.default.w("RangeLoader",i.message),!1}},v.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),c.prototype.destroy.call(this)},Object.defineProperty(v.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),v.prototype.open=function(d,i){this._dataSource=d,this._range=i,this._status=u.LoaderStatus.kConnecting;var t=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(t=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!t?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},v.prototype._openSubRange=function(){var d=this._currentChunkSizeKB*1024,i=this._range.from+this._receivedLength,t=i+d;this._contentLength!=null&&t-this._range.from>=this._contentLength&&(t=this._range.from+this._contentLength-1),this._currentRequestRange={from:i,to:t},this._internalOpen(this._dataSource,this._currentRequestRange)},v.prototype._internalOpen=function(d,i){this._lastTimeLoaded=0;var t=d.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?t=this._currentRedirectedURL:d.redirectedURL!=null&&(t=d.redirectedURL));var r=this._seekHandler.getConfig(t,i);this._currentRequestURL=r.url;var e=this._xhr=new XMLHttpRequest;if(e.open("GET",r.url,!0),e.responseType="arraybuffer",e.onreadystatechange=this._onReadyStateChange.bind(this),e.onprogress=this._onProgress.bind(this),e.onload=this._onLoad.bind(this),e.onerror=this._onXhrError.bind(this),d.withCredentials&&(e.withCredentials=!0),typeof r.headers=="object"){var s=r.headers;for(var o in s)s.hasOwnProperty(o)&&e.setRequestHeader(o,s[o])}if(typeof this._config.headers=="object"){var s=this._config.headers;for(var o in s)s.hasOwnProperty(o)&&e.setRequestHeader(o,s[o])}e.send()},v.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=u.LoaderStatus.kComplete},v.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},v.prototype._onReadyStateChange=function(d){var i=d.target;if(i.readyState===2){if(i.responseURL!=null){var t=this._seekHandler.removeURLParameters(i.responseURL);i.responseURL!==this._currentRequestURL&&t!==this._currentRedirectedURL&&(this._currentRedirectedURL=t,this._onURLRedirect&&this._onURLRedirect(t))}if(i.status>=200&&i.status<=299){if(this._waitForTotalLength)return;this._status=u.LoaderStatus.kBuffering}else if(this._status=u.LoaderStatus.kError,this._onError)this._onError(u.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:i.status,msg:i.statusText});else throw new n.RuntimeException("RangeLoader: Http code invalid, "+i.status+" "+i.statusText)}},v.prototype._onProgress=function(d){if(this._status!==u.LoaderStatus.kError){if(this._contentLength===null){var i=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,i=!0;var t=d.total;this._internalAbort(),t!=null&t!==0&&(this._totalLength=t)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,i){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var r=d.loaded-this._lastTimeLoaded;this._lastTimeLoaded=d.loaded,this._speedSampler.addBytes(r)}},v.prototype._normalizeSpeed=function(d){var i=this._chunkSizeKBList,t=i.length-1,r=0,e=0,s=t;if(d<i[0])return i[0];for(;e<=s;){if(r=e+Math.floor((s-e)/2),r===t||d>=i[r]&&d<i[r+1])return i[r];i[r]<d?e=r+1:s=r-1}},v.prototype._onLoad=function(d){if(this._status!==u.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var i=this._speedSampler.lastSecondKBps;if(i===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(i=this._speedSampler.currentKBps)),i!==0){var t=this._normalizeSpeed(i);this._currentSpeedNormalized!==t&&(this._currentSpeedNormalized=t,this._currentChunkSizeKB=t)}var r=d.target.response,e=this._range.from+this._receivedLength;this._receivedLength+=r.byteLength;var s=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():s=!0,this._onDataArrival&&this._onDataArrival(r,e,this._receivedLength),s&&(this._status=u.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},v.prototype._onXhrError=function(d){this._status=u.LoaderStatus.kError;var i=0,t=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(i=u.LoaderErrors.EARLY_EOF,t={code:-1,msg:"RangeLoader meet Early-Eof"}):(i=u.LoaderErrors.EXCEPTION,t={code:-1,msg:d.constructor.name+" "+d.type}),this._onError)this._onError(i,t);else throw new n.RuntimeException(t.msg)},v}(u.BaseLoader);m.default=l},"./src/player/flv-player.js":function(h,m,M){M.r(m);var S=M("./node_modules/events/events.js"),p=M.n(S),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),f=M("./src/player/player-events.js"),l=M("./src/core/transmuxer.js"),c=M("./src/core/transmuxing-events.js"),v=M("./src/core/mse-controller.js"),d=M("./src/core/mse-events.js"),i=M("./src/player/player-errors.js"),t=M("./src/config.js"),r=M("./src/utils/exception.js"),e=function(){function s(o,a){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(p()),this._config=(0,t.createDefaultConfig)(),typeof a=="object"&&Object.assign(this._config,a),o.type.toLowerCase()!=="flv")throw new r.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");o.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=o,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var g=n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661);this._alwaysSeekKeyframe=!!(g||n.default.msedge||n.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return s.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},s.prototype.on=function(o,a){var g=this;o===f.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){g._emitter.emit(f.default.MEDIA_INFO,g.mediaInfo)}):o===f.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){g._emitter.emit(f.default.STATISTICS_INFO,g.statisticsInfo)}),this._emitter.addListener(o,a)},s.prototype.off=function(o,a){this._emitter.removeListener(o,a)},s.prototype.attachMediaElement=function(o){var a=this;if(this._mediaElement=o,o.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),o.addEventListener("seeking",this.e.onvSeeking),o.addEventListener("canplay",this.e.onvCanPlay),o.addEventListener("stalled",this.e.onvStalled),o.addEventListener("progress",this.e.onvProgress),this._msectl=new v.default(this._config),this._msectl.on(d.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(d.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(d.default.SOURCE_OPEN,function(){a._mseSourceOpened=!0,a._hasPendingLoad&&(a._hasPendingLoad=!1,a.load())}),this._msectl.on(d.default.ERROR,function(g){a._emitter.emit(f.default.ERROR,i.ErrorTypes.MEDIA_ERROR,i.ErrorDetails.MEDIA_MSE_ERROR,g)}),this._msectl.attachMediaElement(o),this._pendingSeekTime!=null)try{o.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},s.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},s.prototype.load=function(){var o=this;if(!this._mediaElement)throw new r.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new r.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new l.default(this._mediaDataSource,this._config),this._transmuxer.on(c.default.INIT_SEGMENT,function(a,g){o._msectl.appendInitSegment(g)}),this._transmuxer.on(c.default.MEDIA_SEGMENT,function(a,g){if(o._msectl.appendMediaSegment(g),o._config.lazyLoad&&!o._config.isLive){var A=o._mediaElement.currentTime;g.info.endDts>=(A+o._config.lazyLoadMaxDuration)*1e3&&o._progressChecker==null&&(u.default.v(o.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),o._suspendTransmuxer())}}),this._transmuxer.on(c.default.LOADING_COMPLETE,function(){o._msectl.endOfStream(),o._emitter.emit(f.default.LOADING_COMPLETE)}),this._transmuxer.on(c.default.RECOVERED_EARLY_EOF,function(){o._emitter.emit(f.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(c.default.IO_ERROR,function(a,g){o._emitter.emit(f.default.ERROR,i.ErrorTypes.NETWORK_ERROR,a,g)}),this._transmuxer.on(c.default.DEMUX_ERROR,function(a,g){o._emitter.emit(f.default.ERROR,i.ErrorTypes.MEDIA_ERROR,a,{code:-1,msg:g})}),this._transmuxer.on(c.default.MEDIA_INFO,function(a){o._mediaInfo=a,o._emitter.emit(f.default.MEDIA_INFO,Object.assign({},a))}),this._transmuxer.on(c.default.METADATA_ARRIVED,function(a){o._emitter.emit(f.default.METADATA_ARRIVED,a)}),this._transmuxer.on(c.default.SCRIPTDATA_ARRIVED,function(a){o._emitter.emit(f.default.SCRIPTDATA_ARRIVED,a)}),this._transmuxer.on(c.default.STATISTICS_INFO,function(a){o._statisticsInfo=o._fillStatisticsInfo(a),o._emitter.emit(f.default.STATISTICS_INFO,Object.assign({},o._statisticsInfo))}),this._transmuxer.on(c.default.RECOMMEND_SEEKPOINT,function(a){o._mediaElement&&!o._config.accurateSeek&&(o._requestSetTime=!0,o._mediaElement.currentTime=a/1e3)}),this._transmuxer.open()}},s.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},s.prototype.play=function(){return this._mediaElement.play()},s.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(s.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(o){this._mediaElement.volume=o},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(o){this._mediaElement.muted=o},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(o){this._mediaElement?this._internalSeek(o):this._pendingSeekTime=o},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),s.prototype._fillStatisticsInfo=function(o){if(o.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return o;var a=!0,g=0,A=0;if(this._mediaElement.getVideoPlaybackQuality){var D=this._mediaElement.getVideoPlaybackQuality();g=D.totalVideoFrames,A=D.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(g=this._mediaElement.webkitDecodedFrameCount,A=this._mediaElement.webkitDroppedFrameCount):a=!1;return a&&(o.decodedFrames=g,o.droppedFrames=A),o},s.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var o=this._mediaElement.buffered,a=this._mediaElement.currentTime,g=0,A=0;A<o.length;A++){var D=o.start(A),y=o.end(A);if(D<=a&&a<y){g=y;break}}g>=a+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(u.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},s.prototype._onmseBufferFull=function(){u.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},s.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},s.prototype._checkProgressAndResume=function(){for(var o=this._mediaElement.currentTime,a=this._mediaElement.buffered,g=!1,A=0;A<a.length;A++){var D=a.start(A),y=a.end(A);if(o>=D&&o<y){o>=y-this._config.lazyLoadRecoverDuration&&(g=!0);break}}g&&(window.clearInterval(this._progressChecker),this._progressChecker=null,g&&(u.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},s.prototype._isTimepointBuffered=function(o){for(var a=this._mediaElement.buffered,g=0;g<a.length;g++){var A=a.start(g),D=a.end(g);if(o>=A&&o<D)return!0}return!1},s.prototype._internalSeek=function(o){var a=this._isTimepointBuffered(o),g=!1,A=0;if(o<1&&this._mediaElement.buffered.length>0){var D=this._mediaElement.buffered.start(0);(D<1&&o<D||n.default.safari)&&(g=!0,A=n.default.safari?.1:D)}if(g)this._requestSetTime=!0,this._mediaElement.currentTime=A;else if(a){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=o;else{var y=this._msectl.getNearestKeyframe(Math.floor(o*1e3));this._requestSetTime=!0,y!=null?this._mediaElement.currentTime=y.dts/1e3:this._mediaElement.currentTime=o}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(o*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o)},s.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var o=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(o)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(o*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},s.prototype._checkAndResumeStuckPlayback=function(o){var a=this._mediaElement;if(o||!this._receivedCanPlay||a.readyState<2){var g=a.buffered;g.length>0&&a.currentTime<g.start(0)&&(u.default.w(this.TAG,"Playback seems stuck at "+a.currentTime+", seek to "+g.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=g.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},s.prototype._onvLoadedMetadata=function(o){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},s.prototype._onvSeeking=function(o){var a=this._mediaElement.currentTime,g=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(a<1&&g.length>0){var A=g.start(0);if(A<1&&a<A||n.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=n.default.safari?.1:A;return}}if(this._isTimepointBuffered(a)){if(this._alwaysSeekKeyframe){var D=this._msectl.getNearestKeyframe(Math.floor(a*1e3));D!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=D.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:a,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},s.prototype._onvCanPlay=function(o){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},s.prototype._onvStalled=function(o){this._checkAndResumeStuckPlayback(!0)},s.prototype._onvProgress=function(o){this._checkAndResumeStuckPlayback()},s}();m.default=e},"./src/player/native-player.js":function(h,m,M){M.r(m);var S=M("./node_modules/events/events.js"),p=M.n(S),u=M("./src/player/player-events.js"),n=M("./src/config.js"),f=M("./src/utils/exception.js"),l=function(){function c(v,d){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(p()),this._config=(0,n.createDefaultConfig)(),typeof d=="object"&&Object.assign(this._config,d),v.type.toLowerCase()==="flv")throw new f.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(v.hasOwnProperty("segments"))throw new f.InvalidArgumentException("NativePlayer("+v.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=v,this._mediaElement=null}return c.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},c.prototype.on=function(v,d){var i=this;v===u.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){i._emitter.emit(u.default.MEDIA_INFO,i.mediaInfo)}):v===u.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){i._emitter.emit(u.default.STATISTICS_INFO,i.statisticsInfo)}),this._emitter.addListener(v,d)},c.prototype.off=function(v,d){this._emitter.removeListener(v,d)},c.prototype.attachMediaElement=function(v){if(this._mediaElement=v,v.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{v.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},c.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},c.prototype.load=function(){if(!this._mediaElement)throw new f.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},c.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},c.prototype.play=function(){return this._mediaElement.play()},c.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(c.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(v){this._mediaElement.volume=v},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(v){this._mediaElement.muted=v},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(v){this._mediaElement?this._mediaElement.currentTime=v:this._pendingSeekTime=v},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"mediaInfo",{get:function(){var v=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",d={mimeType:v+this._mediaDataSource.type};return this._mediaElement&&(d.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(d.width=this._mediaElement.videoWidth,d.height=this._mediaElement.videoHeight)),d},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"statisticsInfo",{get:function(){var v={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return v;var d=!0,i=0,t=0;if(this._mediaElement.getVideoPlaybackQuality){var r=this._mediaElement.getVideoPlaybackQuality();i=r.totalVideoFrames,t=r.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(i=this._mediaElement.webkitDecodedFrameCount,t=this._mediaElement.webkitDroppedFrameCount):d=!1;return d&&(v.decodedFrames=i,v.droppedFrames=t),v},enumerable:!1,configurable:!0}),c.prototype._onvLoadedMetadata=function(v){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(u.default.MEDIA_INFO,this.mediaInfo)},c.prototype._reportStatisticsInfo=function(){this._emitter.emit(u.default.STATISTICS_INFO,this.statisticsInfo)},c}();m.default=l},"./src/player/player-errors.js":function(h,m,M){M.r(m),M.d(m,{ErrorTypes:function(){return u},ErrorDetails:function(){return n}});var S=M("./src/io/loader.js"),p=M("./src/demux/demux-errors.js"),u={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},n={NETWORK_EXCEPTION:S.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:S.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:S.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:S.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:p.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:p.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:p.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(h,m,M){M.r(m);var S={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};m.default=S},"./src/remux/aac-silent.js":function(h,m,M){M.r(m);var S=function(){function p(){}return p.getSilentFrame=function(u,n){if(u==="mp4a.40.2"){if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},p}();m.default=S},"./src/remux/mp4-generator.js":function(h,m,M){M.r(m);var S=function(){function p(){}return p.init=function(){p.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var u in p.types)p.types.hasOwnProperty(u)&&(p.types[u]=[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3)]);var n=p.constants={};n.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),n.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),n.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSC=n.STCO=n.STTS,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},p.box=function(u){for(var n=8,f=null,l=Array.prototype.slice.call(arguments,1),c=l.length,v=0;v<c;v++)n+=l[v].byteLength;f=new Uint8Array(n),f[0]=n>>>24&255,f[1]=n>>>16&255,f[2]=n>>>8&255,f[3]=n&255,f.set(u,4);for(var d=8,v=0;v<c;v++)f.set(l[v],d),d+=l[v].byteLength;return f},p.generateInitSegment=function(u){var n=p.box(p.types.ftyp,p.constants.FTYP),f=p.moov(u),l=new Uint8Array(n.byteLength+f.byteLength);return l.set(n,0),l.set(f,n.byteLength),l},p.moov=function(u){var n=p.mvhd(u.timescale,u.duration),f=p.trak(u),l=p.mvex(u);return p.box(p.types.moov,n,f,l)},p.mvhd=function(u,n){return p.box(p.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},p.trak=function(u){return p.box(p.types.trak,p.tkhd(u),p.mdia(u))},p.tkhd=function(u){var n=u.id,f=u.duration,l=u.presentWidth,c=u.presentHeight;return p.box(p.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,l>>>8&255,l&255,0,0,c>>>8&255,c&255,0,0]))},p.mdia=function(u){return p.box(p.types.mdia,p.mdhd(u),p.hdlr(u),p.minf(u))},p.mdhd=function(u){var n=u.timescale,f=u.duration;return p.box(p.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,85,196,0,0]))},p.hdlr=function(u){var n=null;return u.type==="audio"?n=p.constants.HDLR_AUDIO:n=p.constants.HDLR_VIDEO,p.box(p.types.hdlr,n)},p.minf=function(u){var n=null;return u.type==="audio"?n=p.box(p.types.smhd,p.constants.SMHD):n=p.box(p.types.vmhd,p.constants.VMHD),p.box(p.types.minf,n,p.dinf(),p.stbl(u))},p.dinf=function(){var u=p.box(p.types.dinf,p.box(p.types.dref,p.constants.DREF));return u},p.stbl=function(u){var n=p.box(p.types.stbl,p.stsd(u),p.box(p.types.stts,p.constants.STTS),p.box(p.types.stsc,p.constants.STSC),p.box(p.types.stsz,p.constants.STSZ),p.box(p.types.stco,p.constants.STCO));return n},p.stsd=function(u){return u.type==="audio"?u.codec==="mp3"?p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp3(u)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp4a(u)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.avc1(u))},p.mp3=function(u){var n=u.channelCount,f=u.audioSampleRate,l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,f>>>8&255,f&255,0,0]);return p.box(p.types[".mp3"],l)},p.mp4a=function(u){var n=u.channelCount,f=u.audioSampleRate,l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,f>>>8&255,f&255,0,0]);return p.box(p.types.mp4a,l,p.esds(u))},p.esds=function(u){var n=u.config||[],f=n.length,l=new Uint8Array([0,0,0,0,3,23+f,0,1,0,4,15+f,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([f]).concat(n).concat([6,1,2]));return p.box(p.types.esds,l)},p.avc1=function(u){var n=u.avcc,f=u.codecWidth,l=u.codecHeight,c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>>8&255,f&255,l>>>8&255,l&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return p.box(p.types.avc1,c,p.box(p.types.avcC,n))},p.mvex=function(u){return p.box(p.types.mvex,p.trex(u))},p.trex=function(u){var n=u.id,f=new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return p.box(p.types.trex,f)},p.moof=function(u,n){return p.box(p.types.moof,p.mfhd(u.sequenceNumber),p.traf(u,n))},p.mfhd=function(u){var n=new Uint8Array([0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255]);return p.box(p.types.mfhd,n)},p.traf=function(u,n){var f=u.id,l=p.box(p.types.tfhd,new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255])),c=p.box(p.types.tfdt,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255])),v=p.sdtp(u),d=p.trun(u,v.byteLength+16+16+8+16+8+8);return p.box(p.types.traf,l,c,d,v)},p.sdtp=function(u){for(var n=u.samples||[],f=n.length,l=new Uint8Array(4+f),c=0;c<f;c++){var v=n[c].flags;l[c+4]=v.isLeading<<6|v.dependsOn<<4|v.isDependedOn<<2|v.hasRedundancy}return p.box(p.types.sdtp,l)},p.trun=function(u,n){var f=u.samples||[],l=f.length,c=12+16*l,v=new Uint8Array(c);n+=8+c,v.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,l&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0);for(var d=0;d<l;d++){var i=f[d].duration,t=f[d].size,r=f[d].flags,e=f[d].cts;v.set([i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,r.isLeading<<2|r.dependsOn,r.isDependedOn<<6|r.hasRedundancy<<4|r.isNonSync,0,0,e>>>24&255,e>>>16&255,e>>>8&255,e&255],12+16*d)}return p.box(p.types.trun,v)},p.mdat=function(u){return p.box(p.types.mdat,u)},p}();S.init(),m.default=S},"./src/remux/mp4-remuxer.js":function(h,m,M){M.r(m);var S=M("./src/utils/logger.js"),p=M("./src/remux/mp4-generator.js"),u=M("./src/remux/aac-silent.js"),n=M("./src/utils/browser.js"),f=M("./src/core/media-segment-info.js"),l=M("./src/utils/exception.js"),c=function(){function v(d){this.TAG="MP4Remuxer",this._config=d,this._isLive=d.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new f.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new f.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661)),this._fillSilentAfterSeek=n.default.msedge||n.default.msie,this._mp3UseMpegAudio=!n.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return v.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},v.prototype.bindDataSource=function(d){return d.onDataAvailable=this.remux.bind(this),d.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(v.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(d){this._onInitSegment=d},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(d){this._onMediaSegment=d},enumerable:!1,configurable:!0}),v.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},v.prototype.seek=function(d){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},v.prototype.remux=function(d,i){if(!this._onMediaSegment)throw new l.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(d,i),this._remuxVideo(i),this._remuxAudio(d)},v.prototype._onTrackMetadataReceived=function(d,i){var t=null,r="mp4",e=i.codec;if(d==="audio")this._audioMeta=i,i.codec==="mp3"&&this._mp3UseMpegAudio?(r="mpeg",e="",t=new Uint8Array):t=p.default.generateInitSegment(i);else if(d==="video")this._videoMeta=i,t=p.default.generateInitSegment(i);else return;if(!this._onInitSegment)throw new l.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(d,{type:d,data:t.buffer,codec:e,container:d+"/"+r,mediaDuration:i.duration})},v.prototype._calculateDtsBase=function(d,i){this._dtsBaseInited||(d.samples&&d.samples.length&&(this._audioDtsBase=d.samples[0].dts),i.samples&&i.samples.length&&(this._videoDtsBase=i.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},v.prototype.flushStashedSamples=function(){var d=this._videoStashedLastSample,i=this._audioStashedLastSample,t={type:"video",id:1,sequenceNumber:0,samples:[],length:0};d!=null&&(t.samples.push(d),t.length=d.length);var r={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};i!=null&&(r.samples.push(i),r.length=i.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(t,!0),this._remuxAudio(r,!0)},v.prototype._remuxAudio=function(d,i){if(this._audioMeta!=null){var t=d,r=t.samples,e=void 0,s=-1,o=-1,a=this._audioMeta.refSampleDuration,g=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,A=this._dtsBaseInited&&this._audioNextDts===void 0,D=!1;if(!(!r||r.length===0)&&!(r.length===1&&!i)){var y=0,E=null,_=0;g?(y=0,_=t.length):(y=8,_=8+t.length);var L=null;if(r.length>1&&(L=r.pop(),_-=L.length),this._audioStashedLastSample!=null){var I=this._audioStashedLastSample;this._audioStashedLastSample=null,r.unshift(I),_+=I.length}L!=null&&(this._audioStashedLastSample=L);var b=r[0].dts-this._dtsBase;if(this._audioNextDts)e=b-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())e=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(D=!0);else{var R=this._audioSegmentInfoList.getLastSampleBefore(b);if(R!=null){var P=b-(R.originalDts+R.duration);P<=3&&(P=0);var w=R.dts+R.duration+P;e=b-w}else e=0}if(D){var F=b-e,k=this._videoSegmentInfoList.getLastSegmentBefore(b);if(k!=null&&k.beginDts<F){var B=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(B){var U=k.beginDts,j=F-k.beginDts;S.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+U+", duration: "+j),r.unshift({unit:B,dts:U,pts:U}),_+=B.byteLength}}else D=!1}for(var K=[],N=0;N<r.length;N++){var I=r[N],Z=I.unit,$=I.dts-this._dtsBase,U=$,Y=!1,ee=null,Q=0;if(!($<-.001)){if(this._audioMeta.codec!=="mp3"){var G=$,q=3;if(this._audioNextDts&&(G=this._audioNextDts),e=$-G,e<=-q*a){S.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+$+" ms ,curRefDts: "+G+" ms)  due to dtsCorrection: "+e+" ms overlap.");continue}else if(e>=q*a&&this._fillAudioTimestampGap&&!n.default.safari){Y=!0;var te=Math.floor(e/a);S.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+$+" ms, curRefDts: "+G+" ms, ")+("dtsCorrection: "+Math.round(e)+" ms, generate: "+te+" frames")),U=Math.floor(G),Q=Math.floor(G+a)-U;var B=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);B==null&&(S.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),B=Z),ee=[];for(var ie=0;ie<te;ie++){G=G+a;var ne=Math.floor(G),le=Math.floor(G+a)-ne,se={dts:ne,pts:ne,cts:0,unit:B,size:B.byteLength,duration:le,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};ee.push(se),_+=se.size}this._audioNextDts=G+a}else U=Math.floor(G),Q=Math.floor(G+a)-U,this._audioNextDts=G+a}else{if(U=$-e,N!==r.length-1){var oe=r[N+1].dts-this._dtsBase-e;Q=oe-U}else if(L!=null){var oe=L.dts-this._dtsBase-e;Q=oe-U}else K.length>=1?Q=K[K.length-1].duration:Q=Math.floor(a);this._audioNextDts=U+Q}s===-1&&(s=U),K.push({dts:U,pts:U,cts:0,unit:I.unit,size:I.unit.byteLength,duration:Q,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Y&&K.push.apply(K,ee)}}if(K.length===0){t.samples=[],t.length=0;return}g?E=new Uint8Array(_):(E=new Uint8Array(_),E[0]=_>>>24&255,E[1]=_>>>16&255,E[2]=_>>>8&255,E[3]=_&255,E.set(p.default.types.mdat,4));for(var N=0;N<K.length;N++){var Z=K[N].unit;E.set(Z,y),y+=Z.byteLength}var J=K[K.length-1];o=J.dts+J.duration;var ae=new f.MediaSegmentInfo;ae.beginDts=s,ae.endDts=o,ae.beginPts=s,ae.endPts=o,ae.originalBeginDts=K[0].originalDts,ae.originalEndDts=J.originalDts+J.duration,ae.firstSample=new f.SampleInfo(K[0].dts,K[0].pts,K[0].duration,K[0].originalDts,!1),ae.lastSample=new f.SampleInfo(J.dts,J.pts,J.duration,J.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(ae),t.samples=K,t.sequenceNumber++;var fe=null;g?fe=new Uint8Array:fe=p.default.moof(t,s),t.samples=[],t.length=0;var de={type:"audio",data:this._mergeBoxes(fe,E).buffer,sampleCount:K.length,info:ae};g&&A&&(de.timestampOffset=s),this._onMediaSegment("audio",de)}}},v.prototype._remuxVideo=function(d,i){if(this._videoMeta!=null){var t=d,r=t.samples,e=void 0,s=-1,o=-1,a=-1,g=-1;if(!(!r||r.length===0)&&!(r.length===1&&!i)){var A=8,D=null,y=8+d.length,E=null;if(r.length>1&&(E=r.pop(),y-=E.length),this._videoStashedLastSample!=null){var _=this._videoStashedLastSample;this._videoStashedLastSample=null,r.unshift(_),y+=_.length}E!=null&&(this._videoStashedLastSample=E);var L=r[0].dts-this._dtsBase;if(this._videoNextDts)e=L-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())e=0;else{var I=this._videoSegmentInfoList.getLastSampleBefore(L);if(I!=null){var b=L-(I.originalDts+I.duration);b<=3&&(b=0);var R=I.dts+I.duration+b;e=L-R}else e=0}for(var P=new f.MediaSegmentInfo,w=[],F=0;F<r.length;F++){var _=r[F],k=_.dts-this._dtsBase,B=_.isKeyframe,U=k-e,j=_.cts,K=U+j;s===-1&&(s=U,a=K);var N=0;if(F!==r.length-1){var Z=r[F+1].dts-this._dtsBase-e;N=Z-U}else if(E!=null){var Z=E.dts-this._dtsBase-e;N=Z-U}else w.length>=1?N=w[w.length-1].duration:N=Math.floor(this._videoMeta.refSampleDuration);if(B){var $=new f.SampleInfo(U,K,N,_.dts,!0);$.fileposition=_.fileposition,P.appendSyncPoint($)}w.push({dts:U,pts:K,cts:j,units:_.units,size:_.length,isKeyframe:B,duration:N,originalDts:k,flags:{isLeading:0,dependsOn:B?2:1,isDependedOn:B?1:0,hasRedundancy:0,isNonSync:B?0:1}})}D=new Uint8Array(y),D[0]=y>>>24&255,D[1]=y>>>16&255,D[2]=y>>>8&255,D[3]=y&255,D.set(p.default.types.mdat,4);for(var F=0;F<w.length;F++)for(var Y=w[F].units;Y.length;){var ee=Y.shift(),Q=ee.data;D.set(Q,A),A+=Q.byteLength}var G=w[w.length-1];if(o=G.dts+G.duration,g=G.pts+G.duration,this._videoNextDts=o,P.beginDts=s,P.endDts=o,P.beginPts=a,P.endPts=g,P.originalBeginDts=w[0].originalDts,P.originalEndDts=G.originalDts+G.duration,P.firstSample=new f.SampleInfo(w[0].dts,w[0].pts,w[0].duration,w[0].originalDts,w[0].isKeyframe),P.lastSample=new f.SampleInfo(G.dts,G.pts,G.duration,G.originalDts,G.isKeyframe),this._isLive||this._videoSegmentInfoList.append(P),t.samples=w,t.sequenceNumber++,this._forceFirstIDR){var q=w[0].flags;q.dependsOn=2,q.isNonSync=0}var te=p.default.moof(t,s);t.samples=[],t.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(te,D).buffer,sampleCount:w.length,info:P})}}},v.prototype._mergeBoxes=function(d,i){var t=new Uint8Array(d.byteLength+i.byteLength);return t.set(d,0),t.set(i,d.byteLength),t},v}();m.default=c},"./src/utils/browser.js":function(h,m,M){M.r(m);var S={};function p(){var u=self.navigator.userAgent.toLowerCase(),n=/(edge)\/([\w.]+)/.exec(u)||/(opr)[\/]([\w.]+)/.exec(u)||/(chrome)[ \/]([\w.]+)/.exec(u)||/(iemobile)[\/]([\w.]+)/.exec(u)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+)/.exec(u)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||u.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(u)||u.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(u)||[],f=/(ipad)/.exec(u)||/(ipod)/.exec(u)||/(windows phone)/.exec(u)||/(iphone)/.exec(u)||/(kindle)/.exec(u)||/(android)/.exec(u)||/(windows)/.exec(u)||/(mac)/.exec(u)||/(linux)/.exec(u)||/(cros)/.exec(u)||[],l={browser:n[5]||n[3]||n[1]||"",version:n[2]||n[4]||"0",majorVersion:n[4]||n[2]||"0",platform:f[0]||""},c={};if(l.browser){c[l.browser]=!0;var v=l.majorVersion.split(".");c.version={major:parseInt(l.majorVersion,10),string:l.version},v.length>1&&(c.version.minor=parseInt(v[1],10)),v.length>2&&(c.version.build=parseInt(v[2],10))}if(l.platform&&(c[l.platform]=!0),(c.chrome||c.opr||c.safari)&&(c.webkit=!0),c.rv||c.iemobile){c.rv&&delete c.rv;var d="msie";l.browser=d,c[d]=!0}if(c.edge){delete c.edge;var i="msedge";l.browser=i,c[i]=!0}if(c.opr){var t="opera";l.browser=t,c[t]=!0}if(c.safari&&c.android){var r="android";l.browser=r,c[r]=!0}c.name=l.browser,c.platform=l.platform;for(var e in S)S.hasOwnProperty(e)&&delete S[e];Object.assign(S,c)}p(),m.default=S},"./src/utils/exception.js":function(h,m,M){M.r(m),M.d(m,{RuntimeException:function(){return p},IllegalStateException:function(){return u},InvalidArgumentException:function(){return n},NotImplementedException:function(){return f}});var S=function(){var l=function(c,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(d[t]=i[t])},l(c,v)};return function(c,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(c,v);function d(){this.constructor=c}c.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}(),p=function(){function l(c){this._message=c}return Object.defineProperty(l.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),l.prototype.toString=function(){return this.name+": "+this.message},l}(),u=function(l){S(c,l);function c(v){return l.call(this,v)||this}return Object.defineProperty(c.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),c}(p),n=function(l){S(c,l);function c(v){return l.call(this,v)||this}return Object.defineProperty(c.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),c}(p),f=function(l){S(c,l);function c(v){return l.call(this,v)||this}return Object.defineProperty(c.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),c}(p)},"./src/utils/logger.js":function(h,m,M){M.r(m);var S=M("./node_modules/events/events.js"),p=M.n(S),u=function(){function n(){}return n.e=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var c="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","error",c),n.ENABLE_ERROR&&(console.error?console.error(c):console.warn?console.warn(c):console.log(c))},n.i=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var c="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","info",c),n.ENABLE_INFO&&(console.info?console.info(c):console.log(c))},n.w=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var c="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","warn",c),n.ENABLE_WARN&&(console.warn?console.warn(c):console.log(c))},n.d=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var c="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","debug",c),n.ENABLE_DEBUG&&(console.debug?console.debug(c):console.log(c))},n.v=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var c="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","verbose",c),n.ENABLE_VERBOSE&&console.log(c)},n}();u.GLOBAL_TAG="flv.js",u.FORCE_GLOBAL_TAG=!1,u.ENABLE_ERROR=!0,u.ENABLE_INFO=!0,u.ENABLE_WARN=!0,u.ENABLE_DEBUG=!0,u.ENABLE_VERBOSE=!0,u.ENABLE_CALLBACK=!1,u.emitter=new(p()),m.default=u},"./src/utils/logging-control.js":function(h,m,M){M.r(m);var S=M("./node_modules/events/events.js"),p=M.n(S),u=M("./src/utils/logger.js"),n=function(){function f(){}return Object.defineProperty(f,"forceGlobalTag",{get:function(){return u.default.FORCE_GLOBAL_TAG},set:function(l){u.default.FORCE_GLOBAL_TAG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"globalTag",{get:function(){return u.default.GLOBAL_TAG},set:function(l){u.default.GLOBAL_TAG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableAll",{get:function(){return u.default.ENABLE_VERBOSE&&u.default.ENABLE_DEBUG&&u.default.ENABLE_INFO&&u.default.ENABLE_WARN&&u.default.ENABLE_ERROR},set:function(l){u.default.ENABLE_VERBOSE=l,u.default.ENABLE_DEBUG=l,u.default.ENABLE_INFO=l,u.default.ENABLE_WARN=l,u.default.ENABLE_ERROR=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableDebug",{get:function(){return u.default.ENABLE_DEBUG},set:function(l){u.default.ENABLE_DEBUG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableVerbose",{get:function(){return u.default.ENABLE_VERBOSE},set:function(l){u.default.ENABLE_VERBOSE=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableInfo",{get:function(){return u.default.ENABLE_INFO},set:function(l){u.default.ENABLE_INFO=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableWarn",{get:function(){return u.default.ENABLE_WARN},set:function(l){u.default.ENABLE_WARN=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableError",{get:function(){return u.default.ENABLE_ERROR},set:function(l){u.default.ENABLE_ERROR=l,f._notifyChange()},enumerable:!1,configurable:!0}),f.getConfig=function(){return{globalTag:u.default.GLOBAL_TAG,forceGlobalTag:u.default.FORCE_GLOBAL_TAG,enableVerbose:u.default.ENABLE_VERBOSE,enableDebug:u.default.ENABLE_DEBUG,enableInfo:u.default.ENABLE_INFO,enableWarn:u.default.ENABLE_WARN,enableError:u.default.ENABLE_ERROR,enableCallback:u.default.ENABLE_CALLBACK}},f.applyConfig=function(l){u.default.GLOBAL_TAG=l.globalTag,u.default.FORCE_GLOBAL_TAG=l.forceGlobalTag,u.default.ENABLE_VERBOSE=l.enableVerbose,u.default.ENABLE_DEBUG=l.enableDebug,u.default.ENABLE_INFO=l.enableInfo,u.default.ENABLE_WARN=l.enableWarn,u.default.ENABLE_ERROR=l.enableError,u.default.ENABLE_CALLBACK=l.enableCallback},f._notifyChange=function(){var l=f.emitter;if(l.listenerCount("change")>0){var c=f.getConfig();l.emit("change",c)}},f.registerListener=function(l){f.emitter.addListener("change",l)},f.removeListener=function(l){f.emitter.removeListener("change",l)},f.addLogListener=function(l){u.default.emitter.addListener("log",l),u.default.emitter.listenerCount("log")>0&&(u.default.ENABLE_CALLBACK=!0,f._notifyChange())},f.removeLogListener=function(l){u.default.emitter.removeListener("log",l),u.default.emitter.listenerCount("log")===0&&(u.default.ENABLE_CALLBACK=!1,f._notifyChange())},f}();n.emitter=new(p()),m.default=n},"./src/utils/polyfill.js":function(h,m,M){M.r(m);var S=function(){function p(){}return p.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(u,n){return u.__proto__=n,u},Object.assign=Object.assign||function(u){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(u),f=1;f<arguments.length;f++){var l=arguments[f];if(l!=null)for(var c in l)l.hasOwnProperty(c)&&(n[c]=l[c])}return n},typeof self.Promise!="function"&&M("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},p}();S.install(),m.default=S},"./src/utils/utf8-conv.js":function(h,m,M){M.r(m);function S(u,n,f){var l=u;if(n+f<l.length){for(;f--;)if((l[++n]&192)!==128)return!1;return!0}else return!1}function p(u){for(var n=[],f=u,l=0,c=u.length;l<c;){if(f[l]<128){n.push(String.fromCharCode(f[l])),++l;continue}else if(!(f[l]<192)){if(f[l]<224){if(S(f,l,1)){var v=(f[l]&31)<<6|f[l+1]&63;if(v>=128){n.push(String.fromCharCode(v&65535)),l+=2;continue}}}else if(f[l]<240){if(S(f,l,2)){var v=(f[l]&15)<<12|(f[l+1]&63)<<6|f[l+2]&63;if(v>=2048&&(v&63488)!==55296){n.push(String.fromCharCode(v&65535)),l+=3;continue}}}else if(f[l]<248&&S(f,l,3)){var v=(f[l]&7)<<18|(f[l+1]&63)<<12|(f[l+2]&63)<<6|f[l+3]&63;if(v>65536&&v<1114112){v-=65536,n.push(String.fromCharCode(v>>>10|55296)),n.push(String.fromCharCode(v&1023|56320)),l+=4;continue}}}n.push(String.fromCharCode(65533)),++l}return n.join("")}m.default=p}},C={};function x(h){var m=C[h];if(m!==void 0)return m.exports;var M=C[h]={exports:{}};return O[h].call(M.exports,M,M.exports,x),M.exports}x.m=O,function(){x.n=function(h){var m=h&&h.__esModule?function(){return h.default}:function(){return h};return x.d(m,{a:m}),m}}(),function(){x.d=function(h,m){for(var M in m)x.o(m,M)&&!x.o(h,M)&&Object.defineProperty(h,M,{enumerable:!0,get:m[M]})}}(),function(){x.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){x.o=function(h,m){return Object.prototype.hasOwnProperty.call(h,m)}}(),function(){x.r=function(h){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}}();var T=x("./src/index.js");return T}()})})(Ye);var Ve=Ue(Ye.exports),Ze={exports:{}};(function(ye,Ie){typeof window!="undefined"&&function(C,x){ye.exports=x()}(Be,function(){return function(O){var C={};function x(T){if(C[T])return C[T].exports;var h=C[T]={i:T,l:!1,exports:{}};return O[T].call(h.exports,h,h.exports,x),h.l=!0,h.exports}return x.m=O,x.c=C,x.d=function(T,h,m){x.o(T,h)||Object.defineProperty(T,h,{enumerable:!0,get:m})},x.r=function(T){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(T,"__esModule",{value:!0})},x.t=function(T,h){if(h&1&&(T=x(T)),h&8||h&4&&typeof T=="object"&&T&&T.__esModule)return T;var m=Object.create(null);if(x.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:T}),h&2&&typeof T!="string")for(var M in T)x.d(m,M,function(S){return T[S]}.bind(null,M));return m},x.n=function(T){var h=T&&T.__esModule?function(){return T.default}:function(){return T};return x.d(h,"a",h),h},x.o=function(T,h){return Object.prototype.hasOwnProperty.call(T,h)},x.p="/dist/",x(x.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(O,C,x){var T=Object.prototype.hasOwnProperty,h="~";function m(){}Object.create&&(m.prototype=Object.create(null),new m().__proto__||(h=!1));function M(n,f,l){this.fn=n,this.context=f,this.once=l||!1}function S(n,f,l,c,v){if(typeof l!="function")throw new TypeError("The listener must be a function");var d=new M(l,c||n,v),i=h?h+f:f;return n._events[i]?n._events[i].fn?n._events[i]=[n._events[i],d]:n._events[i].push(d):(n._events[i]=d,n._eventsCount++),n}function p(n,f){--n._eventsCount===0?n._events=new m:delete n._events[f]}function u(){this._events=new m,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],l,c;if(this._eventsCount===0)return f;for(c in l=this._events)T.call(l,c)&&f.push(h?c.slice(1):c);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(l)):f},u.prototype.listeners=function(f){var l=h?h+f:f,c=this._events[l];if(!c)return[];if(c.fn)return[c.fn];for(var v=0,d=c.length,i=new Array(d);v<d;v++)i[v]=c[v].fn;return i},u.prototype.listenerCount=function(f){var l=h?h+f:f,c=this._events[l];return c?c.fn?1:c.length:0},u.prototype.emit=function(f,l,c,v,d,i){var t=h?h+f:f;if(!this._events[t])return!1;var r=this._events[t],e=arguments.length,s,o;if(r.fn){switch(r.once&&this.removeListener(f,r.fn,void 0,!0),e){case 1:return r.fn.call(r.context),!0;case 2:return r.fn.call(r.context,l),!0;case 3:return r.fn.call(r.context,l,c),!0;case 4:return r.fn.call(r.context,l,c,v),!0;case 5:return r.fn.call(r.context,l,c,v,d),!0;case 6:return r.fn.call(r.context,l,c,v,d,i),!0}for(o=1,s=new Array(e-1);o<e;o++)s[o-1]=arguments[o];r.fn.apply(r.context,s)}else{var a=r.length,g;for(o=0;o<a;o++)switch(r[o].once&&this.removeListener(f,r[o].fn,void 0,!0),e){case 1:r[o].fn.call(r[o].context);break;case 2:r[o].fn.call(r[o].context,l);break;case 3:r[o].fn.call(r[o].context,l,c);break;case 4:r[o].fn.call(r[o].context,l,c,v);break;default:if(!s)for(g=1,s=new Array(e-1);g<e;g++)s[g-1]=arguments[g];r[o].fn.apply(r[o].context,s)}}return!0},u.prototype.on=function(f,l,c){return S(this,f,l,c,!1)},u.prototype.once=function(f,l,c){return S(this,f,l,c,!0)},u.prototype.removeListener=function(f,l,c,v){var d=h?h+f:f;if(!this._events[d])return this;if(!l)return p(this,d),this;var i=this._events[d];if(i.fn)i.fn===l&&(!v||i.once)&&(!c||i.context===c)&&p(this,d);else{for(var t=0,r=[],e=i.length;t<e;t++)(i[t].fn!==l||v&&!i[t].once||c&&i[t].context!==c)&&r.push(i[t]);r.length?this._events[d]=r.length===1?r[0]:r:p(this,d)}return this},u.prototype.removeAllListeners=function(f){var l;return f?(l=h?h+f:f,this._events[l]&&p(this,l)):(this._events=new m,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=h,u.EventEmitter=u,O.exports=u},"./node_modules/url-toolkit/src/url-toolkit.js":function(O,C,x){(function(T){var h=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,m=/^([^\/?#]*)([^]*)$/,M=/(?:\/|^)\.(?=\/)/g,S=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(u,n,f){if(f=f||{},u=u.trim(),n=n.trim(),!n){if(!f.alwaysNormalize)return u;var l=p.parseURL(u);if(!l)throw new Error("Error trying to parse base URL.");return l.path=p.normalizePath(l.path),p.buildURLFromParts(l)}var c=p.parseURL(n);if(!c)throw new Error("Error trying to parse relative URL.");if(c.scheme)return f.alwaysNormalize?(c.path=p.normalizePath(c.path),p.buildURLFromParts(c)):n;var v=p.parseURL(u);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var d=m.exec(v.path);v.netLoc=d[1],v.path=d[2]}v.netLoc&&!v.path&&(v.path="/");var i={scheme:v.scheme,netLoc:c.netLoc,path:null,params:c.params,query:c.query,fragment:c.fragment};if(!c.netLoc&&(i.netLoc=v.netLoc,c.path[0]!=="/"))if(!c.path)i.path=v.path,c.params||(i.params=v.params,c.query||(i.query=v.query));else{var t=v.path,r=t.substring(0,t.lastIndexOf("/")+1)+c.path;i.path=p.normalizePath(r)}return i.path===null&&(i.path=f.alwaysNormalize?p.normalizePath(c.path):c.path),p.buildURLFromParts(i)},parseURL:function(u){var n=h.exec(u);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(M,"");u.length!==(u=u.replace(S,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};O.exports=p})()},"./node_modules/webworkify-webpack/index.js":function(O,C,x){function T(f){var l={};function c(d){if(l[d])return l[d].exports;var i=l[d]={i:d,l:!1,exports:{}};return f[d].call(i.exports,i,i.exports,c),i.l=!0,i.exports}c.m=f,c.c=l,c.i=function(d){return d},c.d=function(d,i,t){c.o(d,i)||Object.defineProperty(d,i,{configurable:!1,enumerable:!0,get:t})},c.r=function(d){Object.defineProperty(d,"__esModule",{value:!0})},c.n=function(d){var i=d&&d.__esModule?function(){return d.default}:function(){return d};return c.d(i,"a",i),i},c.o=function(d,i){return Object.prototype.hasOwnProperty.call(d,i)},c.p="/",c.oe=function(d){throw console.error(d),d};var v=c(c.s=ENTRY_MODULE);return v.default||v}var h="[\\.|\\-|\\+|\\w|/|@]+",m="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+h+").*?\\)";function M(f){return(f+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function S(f){return!isNaN(1*f)}function p(f,l,c){var v={};v[c]=[];var d=l.toString(),i=d.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!i)return v;for(var t=i[1],r=new RegExp("(\\\\n|\\W)"+M(t)+m,"g"),e;e=r.exec(d);)e[3]!=="dll-reference"&&v[c].push(e[3]);for(r=new RegExp("\\("+M(t)+'\\("(dll-reference\\s('+h+'))"\\)\\)'+m,"g");e=r.exec(d);)f[e[2]]||(v[c].push(e[1]),f[e[2]]=x(e[1]).m),v[e[2]]=v[e[2]]||[],v[e[2]].push(e[4]);for(var s=Object.keys(v),o=0;o<s.length;o++)for(var a=0;a<v[s[o]].length;a++)S(v[s[o]][a])&&(v[s[o]][a]=1*v[s[o]][a]);return v}function u(f){var l=Object.keys(f);return l.reduce(function(c,v){return c||f[v].length>0},!1)}function n(f,l){for(var c={main:[l]},v={main:[]},d={main:{}};u(c);)for(var i=Object.keys(c),t=0;t<i.length;t++){var r=i[t],e=c[r],s=e.pop();if(d[r]=d[r]||{},!(d[r][s]||!f[r][s])){d[r][s]=!0,v[r]=v[r]||[],v[r].push(s);for(var o=p(f,f[r][s],r),a=Object.keys(o),g=0;g<a.length;g++)c[a[g]]=c[a[g]]||[],c[a[g]]=c[a[g]].concat(o[a[g]])}}return v}O.exports=function(f,l){l=l||{};var c={main:x.m},v=l.all?{main:Object.keys(c.main)}:n(c,f),d="";Object.keys(v).filter(function(s){return s!=="main"}).forEach(function(s){for(var o=0;v[s][o];)o++;v[s].push(o),c[s][o]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",d=d+"var "+s+" = ("+T.toString().replace("ENTRY_MODULE",JSON.stringify(o))+")({"+v[s].map(function(a){return""+JSON.stringify(a)+": "+c[s][a].toString()}).join(",")+`});
`}),d=d+"new (("+T.toString().replace("ENTRY_MODULE",JSON.stringify(f))+")({"+v.main.map(function(s){return""+JSON.stringify(s)+": "+c.main[s].toString()}).join(",")+"}))(self);";var i=new window.Blob([d],{type:"text/javascript"});if(l.bare)return i;var t=window.URL||window.webkitURL||window.mozURL||window.msURL,r=t.createObjectURL(i),e=new window.Worker(r);return e.objectURL=r,e}},"./src/config.ts":function(O,C,x){x.r(C),x.d(C,"hlsDefaultConfig",function(){return g}),x.d(C,"mergeConfig",function(){return D}),x.d(C,"enableStreamingMode",function(){return y});var T=x("./src/controller/abr-controller.ts"),h=x("./src/controller/audio-stream-controller.ts"),m=x("./src/controller/audio-track-controller.ts"),M=x("./src/controller/subtitle-stream-controller.ts"),S=x("./src/controller/subtitle-track-controller.ts"),p=x("./src/controller/buffer-controller.ts"),u=x("./src/controller/timeline-controller.ts"),n=x("./src/controller/cap-level-controller.ts"),f=x("./src/controller/fps-controller.ts"),l=x("./src/controller/eme-controller.ts"),c=x("./src/controller/cmcd-controller.ts"),v=x("./src/utils/xhr-loader.ts"),d=x("./src/utils/fetch-loader.ts"),i=x("./src/utils/cues.ts"),t=x("./src/utils/mediakeys-helper.ts"),r=x("./src/utils/logger.ts");function e(){return e=Object.assign||function(E){for(var _=1;_<arguments.length;_++){var L=arguments[_];for(var I in L)Object.prototype.hasOwnProperty.call(L,I)&&(E[I]=L[I])}return E},e.apply(this,arguments)}function s(E,_){var L=Object.keys(E);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(E);_&&(I=I.filter(function(b){return Object.getOwnPropertyDescriptor(E,b).enumerable})),L.push.apply(L,I)}return L}function o(E){for(var _=1;_<arguments.length;_++){var L=arguments[_]!=null?arguments[_]:{};_%2?s(Object(L),!0).forEach(function(I){a(E,I,L[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(L)):s(Object(L)).forEach(function(I){Object.defineProperty(E,I,Object.getOwnPropertyDescriptor(L,I))})}return E}function a(E,_,L){return _ in E?Object.defineProperty(E,_,{value:L,enumerable:!0,configurable:!0,writable:!0}):E[_]=L,E}var g=o(o({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:v.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:T.default,bufferController:p.default,capLevelController:n.default,fpsController:f.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:t.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},A()),{},{subtitleStreamController:M.SubtitleStreamController,subtitleTrackController:S.default,timelineController:u.TimelineController,audioStreamController:h.default,audioTrackController:m.default,emeController:l.default,cmcdController:c.default});function A(){return{cueHandler:i.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function D(E,_){if((_.liveSyncDurationCount||_.liveMaxLatencyDurationCount)&&(_.liveSyncDuration||_.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(_.liveMaxLatencyDurationCount!==void 0&&(_.liveSyncDurationCount===void 0||_.liveMaxLatencyDurationCount<=_.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(_.liveMaxLatencyDuration!==void 0&&(_.liveSyncDuration===void 0||_.liveMaxLatencyDuration<=_.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return e({},E,_)}function y(E){var _=E.loader;if(_!==d.default&&_!==v.default)r.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),E.progressive=!1;else{var L=Object(d.fetchSupported)();L&&(E.loader=d.default,E.progressive=!0,E.enableSoftwareAES=!0,r.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(O,C,x){x.r(C);var T=x("./src/polyfills/number.ts"),h=x("./src/utils/ewma-bandwidth-estimator.ts"),m=x("./src/events.ts"),M=x("./src/utils/buffer-helper.ts"),S=x("./src/errors.ts"),p=x("./src/types/loader.ts"),u=x("./src/utils/logger.ts");function n(c,v){for(var d=0;d<v.length;d++){var i=v[d];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(c,i.key,i)}}function f(c,v,d){return v&&n(c.prototype,v),d&&n(c,d),c}var l=function(){function c(d){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=d;var i=d.config;this.bwEstimator=new h.default(i.abrEwmaSlowVoD,i.abrEwmaFastVoD,i.abrEwmaDefaultEstimate),this.registerListeners()}var v=c.prototype;return v.registerListeners=function(){var i=this.hls;i.on(m.Events.FRAG_LOADING,this.onFragLoading,this),i.on(m.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),i.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(m.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){var i=this.hls;i.off(m.Events.FRAG_LOADING,this.onFragLoading,this),i.off(m.Events.FRAG_LOADED,this.onFragLoaded,this),i.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),i.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(m.Events.ERROR,this.onError,this)},v.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},v.onFragLoading=function(i,t){var r=t.frag;if(r.type===p.PlaylistLevelType.MAIN&&!this.timer){var e;this.fragCurrent=r,this.partCurrent=(e=t.part)!=null?e:null,this.timer=self.setInterval(this.onCheck,100)}},v.onLevelLoaded=function(i,t){var r=this.hls.config;t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)},v._abandonRulesCheck=function(){var i=this.fragCurrent,t=this.partCurrent,r=this.hls,e=r.autoLevelEnabled,s=r.config,o=r.media;if(!(!i||!o)){var a=t?t.stats:i.stats,g=t?t.duration:i.duration;if(a.aborted){u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!e||o.paused||!o.playbackRate||!o.readyState)){var A=performance.now()-a.loading.start,D=Math.abs(o.playbackRate);if(!(A<=500*g/D)){var y=r.levels,E=r.minAutoLevel,_=y[i.level],L=a.total||Math.max(a.loaded,Math.round(g*_.maxBitrate/8)),I=Math.max(1,a.bwEstimate?a.bwEstimate/8:a.loaded*1e3/A),b=(L-a.loaded)/I,R=o.currentTime,P=(M.BufferHelper.bufferInfo(o,R,s.maxBufferHole).end-R)/D;if(!(P>=2*g/D||b<=P)){var w=Number.POSITIVE_INFINITY,F;for(F=i.level-1;F>E;F--){var k=y[F].maxBitrate;if(w=g*k/(8*.8*I),w<P)break}if(!(w>=b)){var B=this.bwEstimator.getEstimate();u.logger.warn("Fragment "+i.sn+(t?" part "+t.index:"")+" of level "+i.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+F+`
      Current BW estimate: `+(Object(T.isFiniteNumber)(B)?(B/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+b.toFixed(3)+` s
      Estimated load time for the next fragment: `+w.toFixed(3)+` s
      Time to underbuffer: `+P.toFixed(3)+" s"),r.nextLoadLevel=F,this.bwEstimator.sample(A,a.loaded),this.clearTimer(),i.loader&&(this.fragCurrent=this.partCurrent=null,i.loader.abort()),r.trigger(m.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:t,stats:a})}}}}}},v.onFragLoaded=function(i,t){var r=t.frag,e=t.part;if(r.type===p.PlaylistLevelType.MAIN&&Object(T.isFiniteNumber)(r.sn)){var s=e?e.stats:r.stats,o=e?e.duration:r.duration;if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[r.level],g=(a.loaded?a.loaded.bytes:0)+s.loaded,A=(a.loaded?a.loaded.duration:0)+o;a.loaded={bytes:g,duration:A},a.realBitrate=Math.round(8*g/A)}if(r.bitrateTest){var D={stats:s,frag:r,part:e,id:r.type};this.onFragBuffered(m.Events.FRAG_BUFFERED,D),r.bitrateTest=!1}}},v.onFragBuffered=function(i,t){var r=t.frag,e=t.part,s=e?e.stats:r.stats;if(!s.aborted&&!(r.type!==p.PlaylistLevelType.MAIN||r.sn==="initSegment")){var o=s.parsing.end-s.loading.start;this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}},v.onError=function(i,t){switch(t.details){case S.ErrorDetails.FRAG_LOAD_ERROR:case S.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},v.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},v.getNextABRAutoLevel=function(){var i=this.fragCurrent,t=this.partCurrent,r=this.hls,e=r.maxAutoLevel,s=r.config,o=r.minAutoLevel,a=r.media,g=t?t.duration:i?i.duration:0,A=a?a.currentTime:0,D=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,y=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,E=(M.BufferHelper.bufferInfo(a,A,s.maxBufferHole).end-A)/D,_=this.findBestLevel(y,o,e,E,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(_>=0)return _;u.logger.trace((E?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var L=g?Math.min(g,s.maxStarvationDelay):s.maxStarvationDelay,I=s.abrBandWidthFactor,b=s.abrBandWidthUpFactor;if(!E){var R=this.bitrateTestDelay;if(R){var P=g?Math.min(g,s.maxLoadingDelay):s.maxLoadingDelay;L=P-R,u.logger.trace("bitrate test took "+Math.round(1e3*R)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*L)+" ms"),I=b=1}}return _=this.findBestLevel(y,o,e,E+L,I,b),Math.max(_,0)},v.findBestLevel=function(i,t,r,e,s,o){for(var a,g=this.fragCurrent,A=this.partCurrent,D=this.lastLoadedFragLevel,y=this.hls.levels,E=y[D],_=!!(E!=null&&(a=E.details)!==null&&a!==void 0&&a.live),L=E==null?void 0:E.codecSet,I=A?A.duration:g?g.duration:0,b=r;b>=t;b--){var R=y[b];if(!(!R||L&&R.codecSet!==L)){var P=R.details,w=(A?P==null?void 0:P.partTarget:P==null?void 0:P.averagetargetduration)||I,F=void 0;b<=D?F=s*i:F=o*i;var k=y[b].maxBitrate,B=k*w/F;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+b+"/"+Math.round(F)+"/"+k+"/"+w+"/"+e+"/"+B),F>k&&(!B||_&&!this.bitrateTestDelay||B<e))return b}}return-1},f(c,[{key:"nextAutoLevel",get:function(){var i=this._nextAutoLevel,t=this.bwEstimator;if(i!==-1&&(!t||!t.canEstimate()))return i;var r=this.getNextABRAutoLevel();return i!==-1&&(r=Math.min(i,r)),r},set:function(i){this._nextAutoLevel=i}}]),c}();C.default=l},"./src/controller/audio-stream-controller.ts":function(O,C,x){x.r(C);var T=x("./src/polyfills/number.ts"),h=x("./src/controller/base-stream-controller.ts"),m=x("./src/events.ts"),M=x("./src/utils/buffer-helper.ts"),S=x("./src/controller/fragment-tracker.ts"),p=x("./src/types/level.ts"),u=x("./src/types/loader.ts"),n=x("./src/loader/fragment.ts"),f=x("./src/demux/chunk-cache.ts"),l=x("./src/demux/transmuxer-interface.ts"),c=x("./src/types/transmuxer.ts"),v=x("./src/controller/fragment-finders.ts"),d=x("./src/utils/discontinuities.ts"),i=x("./src/errors.ts"),t=x("./src/utils/logger.ts");function r(){return r=Object.assign||function(g){for(var A=1;A<arguments.length;A++){var D=arguments[A];for(var y in D)Object.prototype.hasOwnProperty.call(D,y)&&(g[y]=D[y])}return g},r.apply(this,arguments)}function e(g,A){g.prototype=Object.create(A.prototype),g.prototype.constructor=g,s(g,A)}function s(g,A){return s=Object.setPrototypeOf||function(y,E){return y.__proto__=E,y},s(g,A)}var o=100,a=function(g){e(A,g);function A(y,E){var _;return _=g.call(this,y,E,"[audio-stream-controller]")||this,_.videoBuffer=null,_.videoTrackCC=-1,_.waitingVideoCC=-1,_.audioSwitch=!1,_.trackId=-1,_.waitingData=null,_.mainDetails=null,_.bufferFlushed=!1,_._registerListeners(),_}var D=A.prototype;return D.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},D._registerListeners=function(){var E=this.hls;E.on(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.on(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.on(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.on(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.on(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.on(m.Events.ERROR,this.onError,this),E.on(m.Events.BUFFER_RESET,this.onBufferReset,this),E.on(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.on(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.on(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var E=this.hls;E.off(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.off(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.off(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.off(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.off(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.off(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.off(m.Events.ERROR,this.onError,this),E.off(m.Events.BUFFER_RESET,this.onBufferReset,this),E.off(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.off(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.off(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onInitPtsFound=function(E,_){var L=_.frag,I=_.id,b=_.initPTS;if(I==="main"){var R=L.cc;this.initPTS[L.cc]=b,this.log("InitPTS for cc: "+R+" found from main: "+b),this.videoTrackCC=R,this.state===h.State.WAITING_INIT_PTS&&this.tick()}},D.startLoad=function(E){if(!this.levels){this.startPosition=E,this.state=h.State.STOPPED;return}var _=this.lastCurrentTime;this.stopLoad(),this.setInterval(o),this.fragLoadError=0,_>0&&E===-1?(this.log("Override startPosition with lastCurrentTime @"+_.toFixed(3)),this.state=h.State.IDLE):(this.loadedmetadata=!1,this.state=h.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=E,this.tick()},D.doTick=function(){switch(this.state){case h.State.IDLE:this.doTickIdle();break;case h.State.WAITING_TRACK:{var E,_=this.levels,L=this.trackId,I=_==null||(E=_[L])===null||E===void 0?void 0:E.details;if(I){if(this.waitForCdnTuneIn(I))break;this.state=h.State.WAITING_INIT_PTS}break}case h.State.FRAG_LOADING_WAITING_RETRY:{var b,R=performance.now(),P=this.retryDate;(!P||R>=P||(b=this.media)!==null&&b!==void 0&&b.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=h.State.IDLE);break}case h.State.WAITING_INIT_PTS:{var w=this.waitingData;if(w){var F=w.frag,k=w.part,B=w.cache,U=w.complete;if(this.initPTS[F.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=h.State.FRAG_LOADING;var j=B.flush(),K={frag:F,part:k,payload:j,networkDetails:null};this._handleFragmentLoadProgress(K),U&&g.prototype._handleFragmentLoadComplete.call(this,K)}else if(this.videoTrackCC!==this.waitingVideoCC)t.logger.log("Waiting fragment cc ("+F.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var N=this.getLoadPosition(),Z=M.BufferHelper.bufferInfo(this.mediaBuffer,N,this.config.maxBufferHole),$=Object(v.fragmentWithinToleranceTest)(Z.end,this.config.maxFragLookUpTolerance,F);$<0&&(t.logger.log("Waiting fragment cc ("+F.cc+") @ "+F.start+" cancelled because another fragment at "+Z.end+" is needed"),this.clearWaitingFragment())}}else this.state=h.State.IDLE}}this.onTickEnd()},D.clearWaitingFragment=function(){var E=this.waitingData;E&&(this.fragmentTracker.removeFragment(E.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=h.State.IDLE)},D.onTickEnd=function(){var E=this.media;if(!(!E||!E.readyState)){var _=this.mediaBuffer?this.mediaBuffer:E,L=_.buffered;!this.loadedmetadata&&L.length&&(this.loadedmetadata=!0),this.lastCurrentTime=E.currentTime}},D.doTickIdle=function(){var E,_,L=this.hls,I=this.levels,b=this.media,R=this.trackId,P=L.config;if(!(!I||!I[R])&&!(!b&&(this.startFragRequested||!P.startFragPrefetch))){var w=I[R],F=w.details;if(!F||F.live&&this.levelLastLoaded!==R||this.waitForCdnTuneIn(F)){this.state=h.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,n.ElementaryStreamTypes.AUDIO,u.PlaylistLevelType.AUDIO));var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,u.PlaylistLevelType.AUDIO);if(k!==null){var B=k.len,U=this.getMaxBufferLength(),j=this.audioSwitch;if(!(B>=U&&!j)){if(!j&&this._streamEnded(k,F)){L.trigger(m.Events.BUFFER_EOS,{type:"audio"}),this.state=h.State.ENDED;return}var K=F.fragments,N=K[0].start,Z=k.end;if(j){var $=this.getLoadPosition();Z=$,F.PTSKnown&&$<N&&(k.end>N||k.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),b.currentTime=N+.05)}var Y=this.getNextFragment(Z,F);if(!Y){this.bufferFlushed=!0;return}((E=Y.decryptdata)===null||E===void 0?void 0:E.keyFormat)==="identity"&&!((_=Y.decryptdata)!==null&&_!==void 0&&_.key)?this.loadKey(Y,F):this.loadFragment(Y,F,Z)}}}},D.getMaxBufferLength=function(){var E=g.prototype.getMaxBufferLength.call(this),_=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,u.PlaylistLevelType.MAIN);return _===null?E:Math.max(E,_.len)},D.onMediaDetaching=function(){this.videoBuffer=null,g.prototype.onMediaDetaching.call(this)},D.onAudioTracksUpdated=function(E,_){var L=_.audioTracks;this.resetTransmuxer(),this.levels=L.map(function(I){return new p.Level(I)})},D.onAudioTrackSwitching=function(E,_){var L=!!_.url;this.trackId=_.id;var I=this.fragCurrent;I!=null&&I.loader&&I.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),L?this.setInterval(o):this.resetTransmuxer(),L?(this.audioSwitch=!0,this.state=h.State.IDLE):this.state=h.State.STOPPED,this.tick()},D.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},D.onLevelLoaded=function(E,_){this.mainDetails=_.details},D.onAudioTrackLoaded=function(E,_){var L,I=this.levels,b=_.details,R=_.id;if(!I){this.warn("Audio tracks were reset while loading level "+R);return}this.log("Track "+R+" loaded ["+b.startSN+","+b.endSN+"],duration:"+b.totalduration);var P=I[R],w=0;if(b.live||(L=P.details)!==null&&L!==void 0&&L.live){var F=this.mainDetails;if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed||!F)return;!P.details&&b.hasProgramDateTime&&F.hasProgramDateTime?(Object(d.alignMediaPlaylistByPDT)(b,F),w=b.fragments[0].start):w=this.alignPlaylists(b,P.details)}P.details=b,this.levelLastLoaded=R,!this.startFragRequested&&(this.mainDetails||!b.live)&&this.setStartPosition(P.details,w),this.state===h.State.WAITING_TRACK&&!this.waitForCdnTuneIn(b)&&(this.state=h.State.IDLE),this.tick()},D._handleFragmentLoadProgress=function(E){var _,L=E.frag,I=E.part,b=E.payload,R=this.config,P=this.trackId,w=this.levels;if(!w){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+L.sn+" of level "+L.level+" will not be buffered");return}var F=w[P];console.assert(F,"Audio track is defined on fragment load progress");var k=F.details;console.assert(k,"Audio track details are defined on fragment load progress");var B=R.defaultAudioCodec||F.audioCodec||"mp4a.40.2",U=this.transmuxer;U||(U=this.transmuxer=new l.default(this.hls,u.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var j=this.initPTS[L.cc],K=(_=L.initSegment)===null||_===void 0?void 0:_.data;if(j!==void 0){var N=!1,Z=I?I.index:-1,$=Z!==-1,Y=new c.ChunkMetadata(L.level,L.sn,L.stats.chunkCount,b.byteLength,Z,$);U.push(b,K,B,"",L,I,k.totalduration,N,Y,j)}else{t.logger.log("Unknown video PTS for cc "+L.cc+", waiting for video PTS before demuxing audio frag "+L.sn+" of ["+k.startSN+" ,"+k.endSN+"],track "+P);var ee=this.waitingData=this.waitingData||{frag:L,part:I,cache:new f.default,complete:!1},Q=ee.cache;Q.push(new Uint8Array(b)),this.waitingVideoCC=this.videoTrackCC,this.state=h.State.WAITING_INIT_PTS}},D._handleFragmentLoadComplete=function(E){if(this.waitingData){this.waitingData.complete=!0;return}g.prototype._handleFragmentLoadComplete.call(this,E)},D.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},D.onBufferCreated=function(E,_){var L=_.tracks.audio;L&&(this.mediaBuffer=L.buffer),_.tracks.video&&(this.videoBuffer=_.tracks.video.buffer)},D.onFragBuffered=function(E,_){var L=_.frag,I=_.part;if(L.type===u.PlaylistLevelType.AUDIO){if(this.fragContextChanged(L)){this.warn("Fragment "+L.sn+(I?" p: "+I.index:"")+" of level "+L.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}L.sn!=="initSegment"&&(this.fragPrevious=L,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(L,I)}},D.onError=function(E,_){switch(_.details){case i.ErrorDetails.FRAG_LOAD_ERROR:case i.ErrorDetails.FRAG_LOAD_TIMEOUT:case i.ErrorDetails.KEY_LOAD_ERROR:case i.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.AUDIO,_);break;case i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==h.State.ERROR&&this.state!==h.State.STOPPED&&(this.state=_.fatal?h.State.ERROR:h.State.IDLE,this.warn(_.details+" while loading frag, switching to "+this.state+" state"));break;case i.ErrorDetails.BUFFER_FULL_ERROR:if(_.parent==="audio"&&(this.state===h.State.PARSING||this.state===h.State.PARSED)){var L=!0,I=this.getFwdBufferInfo(this.mediaBuffer,u.PlaylistLevelType.AUDIO);I&&I.len>.5&&(L=!this.reduceMaxBufferLength(I.len)),L&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},D.onBufferFlushed=function(E,_){var L=_.type;L===n.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},D._handleTransmuxComplete=function(E){var _,L="audio",I=this.hls,b=E.remuxResult,R=E.chunkMeta,P=this.getCurrentContext(R);if(!P){this.warn("The loading context changed while buffering fragment "+R.sn+" of level "+R.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(R.level);return}var w=P.frag,F=P.part,k=b.audio,B=b.text,U=b.id3,j=b.initSegment;if(!this.fragContextChanged(w)){if(this.state=h.State.PARSING,this.audioSwitch&&k&&this.completeAudioSwitch(),j!=null&&j.tracks&&(this._bufferInitSegment(j.tracks,w,R),I.trigger(m.Events.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:L,tracks:j.tracks})),k){var K=k.startPTS,N=k.endPTS,Z=k.startDTS,$=k.endDTS;F&&(F.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:K,endPTS:N,startDTS:Z,endDTS:$}),w.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,K,N,Z,$),this.bufferFragmentData(k,w,F,R)}if(U!=null&&(_=U.samples)!==null&&_!==void 0&&_.length){var Y=r({frag:w,id:L},U);I.trigger(m.Events.FRAG_PARSING_METADATA,Y)}if(B){var ee=r({frag:w,id:L},B);I.trigger(m.Events.FRAG_PARSING_USERDATA,ee)}}},D._bufferInitSegment=function(E,_,L){if(this.state===h.State.PARSING){E.video&&delete E.video;var I=E.audio;if(!!I){I.levelCodec=I.codec,I.id="audio",this.log("Init audio buffer, container:"+I.container+", codecs[parsed]=["+I.codec+"]"),this.hls.trigger(m.Events.BUFFER_CODECS,E);var b=I.initSegment;if(b!=null&&b.byteLength){var R={type:"audio",frag:_,part:null,chunkMeta:L,parent:_.type,data:b};this.hls.trigger(m.Events.BUFFER_APPENDING,R)}this.tick()}}},D.loadFragment=function(E,_,L){var I=this.fragmentTracker.getState(E);this.fragCurrent=E,(this.audioSwitch||I===S.FragmentState.NOT_LOADED||I===S.FragmentState.PARTIAL)&&(E.sn==="initSegment"?this._loadInitSegment(E):_.live&&!Object(T.isFiniteNumber)(this.initPTS[E.cc])?(this.log("Waiting for video PTS in continuity counter "+E.cc+" of live stream before loading audio fragment "+E.sn+" of level "+this.trackId),this.state=h.State.WAITING_INIT_PTS):(this.startFragRequested=!0,g.prototype.loadFragment.call(this,E,_,L)))},D.completeAudioSwitch=function(){var E=this.hls,_=this.media,L=this.trackId;_&&(this.log("Switching audio track : flushing all audio"),g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,E.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:L})},A}(h.default);C.default=a},"./src/controller/audio-track-controller.ts":function(O,C,x){x.r(C);var T=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/controller/base-playlist-controller.ts"),M=x("./src/types/loader.ts");function S(l,c){for(var v=0;v<c.length;v++){var d=c[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(l,d.key,d)}}function p(l,c,v){return c&&S(l.prototype,c),v&&S(l,v),l}function u(l,c){l.prototype=Object.create(c.prototype),l.prototype.constructor=l,n(l,c)}function n(l,c){return n=Object.setPrototypeOf||function(d,i){return d.__proto__=i,d},n(l,c)}var f=function(l){u(c,l);function c(d){var i;return i=l.call(this,d,"[audio-track-controller]")||this,i.tracks=[],i.groupId=null,i.tracksInGroup=[],i.trackId=-1,i.trackName="",i.selectDefaultTrack=!0,i.registerListeners(),i}var v=c.prototype;return v.registerListeners=function(){var i=this.hls;i.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(T.Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.on(T.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.on(T.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){var i=this.hls;i.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(T.Events.LEVEL_LOADING,this.onLevelLoading,this),i.off(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.off(T.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.off(T.Events.ERROR,this.onError,this)},v.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,l.prototype.destroy.call(this)},v.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},v.onManifestParsed=function(i,t){this.tracks=t.audioTracks||[]},v.onAudioTrackLoaded=function(i,t){var r=t.id,e=t.details,s=this.tracksInGroup[r];if(!s){this.warn("Invalid audio track id "+r);return}var o=s.details;s.details=t.details,this.log("audioTrack "+r+" loaded ["+e.startSN+"-"+e.endSN+"]"),r===this.trackId&&(this.retryCount=0,this.playlistLoaded(r,t,o))},v.onLevelLoading=function(i,t){this.switchLevel(t.level)},v.onLevelSwitching=function(i,t){this.switchLevel(t.level)},v.switchLevel=function(i){var t=this.hls.levels[i];if(!!(t!=null&&t.audioGroupIds)){var r=t.audioGroupIds[t.urlId];if(this.groupId!==r){this.groupId=r;var e=this.tracks.filter(function(o){return!r||o.groupId===r});this.selectDefaultTrack&&!e.some(function(o){return o.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;var s={audioTracks:e};this.log("Updating audio tracks, "+e.length+' track(s) found in "'+r+'" group-id'),this.hls.trigger(T.Events.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}}},v.onError=function(i,t){l.prototype.onError.call(this,i,t),!(t.fatal||!t.context)&&t.context.type===M.PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.retryLoadingOrFail(t)},v.setAudioTrack=function(i){var t=this.tracksInGroup;if(i<0||i>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var r=t[this.trackId];this.log("Now switching to audio-track index "+i);var e=t[i],s=e.id,o=e.groupId,a=o===void 0?"":o,g=e.name,A=e.type,D=e.url;if(this.trackId=i,this.trackName=g,this.selectDefaultTrack=!1,this.hls.trigger(T.Events.AUDIO_TRACK_SWITCHING,{id:s,groupId:a,name:g,type:A,url:D}),!(e.details&&!e.details.live)){var y=this.switchParams(e.url,r==null?void 0:r.details);this.loadPlaylist(y)}},v.selectInitialTrack=function(){var i=this.tracksInGroup;console.assert(i.length,"Initial audio track should be selected when tracks are known");var t=this.trackName,r=this.findTrackId(t)||this.findTrackId();r!==-1?this.setAudioTrack(r):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},v.findTrackId=function(i){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var e=t[r];if((!this.selectDefaultTrack||e.default)&&(!i||i===e.name))return e.id}return-1},v.loadPlaylist=function(i){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var r=t.id,e=t.groupId,s=t.url;if(i)try{s=i.addDirectives(s)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("loading audio-track playlist for id: "+r),this.clearTimer(),this.hls.trigger(T.Events.AUDIO_TRACK_LOADING,{url:s,id:r,groupId:e,deliveryDirectives:i||null})}},p(c,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(i){this.selectDefaultTrack=!1,this.setAudioTrack(i)}}]),c}(m.default);C.default=f},"./src/controller/base-playlist-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return p});var T=x("./src/polyfills/number.ts"),h=x("./src/types/level.ts"),m=x("./src/controller/level-helper.ts"),M=x("./src/utils/logger.ts"),S=x("./src/errors.ts"),p=function(){function u(f,l){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=M.logger.log.bind(M.logger,l+":"),this.warn=M.logger.warn.bind(M.logger,l+":"),this.hls=f}var n=u.prototype;return n.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},n.onError=function(l,c){c.fatal&&c.type===S.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},n.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},n.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},n.stopLoad=function(){this.canLoad=!1,this.clearTimer()},n.switchParams=function(l,c){var v=c==null?void 0:c.renditionReports;if(v)for(var d=0;d<v.length;d++){var i=v[d],t=""+i.URI;if(t===l.substr(-t.length)){var r=parseInt(i["LAST-MSN"]),e=parseInt(i["LAST-PART"]);if(c&&this.hls.config.lowLatencyMode){var s=Math.min(c.age-c.partTarget,c.targetduration);e!==void 0&&s>c.partTarget&&(e+=1)}if(Object(T.isFiniteNumber)(r))return new h.HlsUrlParameters(r,Object(T.isFiniteNumber)(e)?e:void 0,h.HlsSkip.No)}}},n.loadPlaylist=function(l){},n.shouldLoadTrack=function(l){return this.canLoad&&l&&!!l.url&&(!l.details||l.details.live)},n.playlistLoaded=function(l,c,v){var d=this,i=c.details,t=c.stats,r=t.loading.end?Math.max(0,self.performance.now()-t.loading.end):0;if(i.advancedDateTime=Date.now()-r,i.live||v!=null&&v.live){if(i.reloaded(v),v&&this.log("live playlist "+l+" "+(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED")),v&&i.fragments.length>0&&Object(m.mergeDetails)(v,i),!this.canLoad||!i.live)return;var e,s=void 0,o=void 0;if(i.canBlockReload&&i.endSN&&i.advanced){var a=this.hls.config.lowLatencyMode,g=i.lastPartSn,A=i.endSN,D=i.lastPartIndex,y=D!==-1,E=g===A,_=a?0:D;y?(s=E?A+1:g,o=E?_:D+1):s=A+1;var L=i.age,I=L+i.ageHeader,b=Math.min(I-i.partTarget,i.targetduration*1.5);if(b>0){if(v&&b>v.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+v.tuneInGoal+" to: "+b+" with playlist age: "+i.age),b=0;else{var R=Math.floor(b/i.targetduration);if(s+=R,o!==void 0){var P=Math.round(b%i.targetduration/i.partTarget);o+=P}this.log("CDN Tune-in age: "+i.ageHeader+"s last advanced "+L.toFixed(2)+"s goal: "+b+" skip sn "+R+" to part "+o)}i.tuneInGoal=b}if(e=this.getDeliveryDirectives(i,c.deliveryDirectives,s,o),a||!E){this.loadPlaylist(e);return}}else e=this.getDeliveryDirectives(i,c.deliveryDirectives,s,o);var w=Object(m.computeReloadInterval)(i,t);s!==void 0&&i.canBlockReload&&(w-=i.partTarget||1),this.log("reload live playlist "+l+" in "+Math.round(w)+" ms"),this.timer=self.setTimeout(function(){return d.loadPlaylist(e)},w)}else this.clearTimer()},n.getDeliveryDirectives=function(l,c,v,d){var i=Object(h.getSkipValue)(l,v);return c!=null&&c.skip&&l.deltaUpdateFailed&&(v=c.msn,d=c.part,i=h.HlsSkip.No),new h.HlsUrlParameters(v,d,i)},n.retryLoadingOrFail=function(l){var c=this,v=this.hls.config,d=this.retryCount<v.levelLoadingMaxRetry;if(d){var i;if(this.retryCount++,l.details.indexOf("LoadTimeOut")>-1&&(i=l.context)!==null&&i!==void 0&&i.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+l.details+'"'),this.loadPlaylist();else{var t=Math.min(Math.pow(2,this.retryCount)*v.levelLoadingRetryDelay,v.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return c.loadPlaylist()},t),this.warn("retry playlist loading #"+this.retryCount+" in "+t+' ms after "'+l.details+'"')}}else this.warn('cannot recover from error "'+l.details+'"'),this.clearTimer(),l.fatal=!0;return d},u}()},"./src/controller/base-stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"State",function(){return A}),x.d(C,"default",function(){return D});var T=x("./src/polyfills/number.ts"),h=x("./src/task-loop.ts"),m=x("./src/controller/fragment-tracker.ts"),M=x("./src/utils/buffer-helper.ts"),S=x("./src/utils/logger.ts"),p=x("./src/events.ts"),u=x("./src/errors.ts"),n=x("./src/types/transmuxer.ts"),f=x("./src/utils/mp4-tools.ts"),l=x("./src/utils/discontinuities.ts"),c=x("./src/controller/fragment-finders.ts"),v=x("./src/controller/level-helper.ts"),d=x("./src/loader/fragment-loader.ts"),i=x("./src/crypt/decrypter.ts"),t=x("./src/utils/time-ranges.ts"),r=x("./src/types/loader.ts");function e(y,E){for(var _=0;_<E.length;_++){var L=E[_];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(y,L.key,L)}}function s(y,E,_){return E&&e(y.prototype,E),_&&e(y,_),y}function o(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function a(y,E){y.prototype=Object.create(E.prototype),y.prototype.constructor=y,g(y,E)}function g(y,E){return g=Object.setPrototypeOf||function(L,I){return L.__proto__=I,L},g(y,E)}var A={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},D=function(y){a(E,y);function E(L,I,b){var R;return R=y.call(this)||this,R.hls=void 0,R.fragPrevious=null,R.fragCurrent=null,R.fragmentTracker=void 0,R.transmuxer=null,R._state=A.STOPPED,R.media=void 0,R.mediaBuffer=void 0,R.config=void 0,R.bitrateTest=!1,R.lastCurrentTime=0,R.nextLoadPosition=0,R.startPosition=0,R.loadedmetadata=!1,R.fragLoadError=0,R.retryDate=0,R.levels=null,R.fragmentLoader=void 0,R.levelLastLoaded=null,R.startFragRequested=!1,R.decrypter=void 0,R.initPTS=[],R.onvseeking=null,R.onvended=null,R.logPrefix="",R.log=void 0,R.warn=void 0,R.logPrefix=b,R.log=S.logger.log.bind(S.logger,b+":"),R.warn=S.logger.warn.bind(S.logger,b+":"),R.hls=L,R.fragmentLoader=new d.default(L.config),R.fragmentTracker=I,R.config=L.config,R.decrypter=new i.default(L,L.config),L.on(p.Events.KEY_LOADED,R.onKeyLoaded,o(R)),R}var _=E.prototype;return _.doTick=function(){this.onTickEnd()},_.onTickEnd=function(){},_.startLoad=function(I){},_.stopLoad=function(){this.fragmentLoader.abort();var I=this.fragCurrent;I&&this.fragmentTracker.removeFragment(I),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=A.STOPPED},_._streamEnded=function(I,b){var R=this.fragCurrent,P=this.fragmentTracker;if(!b.live&&R&&R.sn>=b.endSN&&!I.nextStart){var w=b.partList;if(w!=null&&w.length){var F=w[w.length-1],k=M.BufferHelper.isBuffered(this.media,F.start+F.duration/2);return k}var B=P.getState(R);return B===m.FragmentState.PARTIAL||B===m.FragmentState.OK}return!1},_.onMediaAttached=function(I,b){var R=this.media=this.mediaBuffer=b.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),R.addEventListener("seeking",this.onvseeking),R.addEventListener("ended",this.onvended);var P=this.config;this.levels&&P.autoStartLoad&&this.state===A.STOPPED&&this.startLoad(P.startPosition)},_.onMediaDetaching=function(){var I=this.media;I!=null&&I.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),I&&(I.removeEventListener("seeking",this.onvseeking),I.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},_.onMediaSeeking=function(){var I=this.config,b=this.fragCurrent,R=this.media,P=this.mediaBuffer,w=this.state,F=R?R.currentTime:0,k=M.BufferHelper.bufferInfo(P||R,F,I.maxBufferHole);if(this.log("media seeking to "+(Object(T.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+w),w===A.ENDED)this.resetLoadingState();else if(b&&!k.len){var B=I.maxFragLookUpTolerance,U=b.start-B,j=b.start+b.duration+B,K=F>j;(F<U||K)&&(K&&b.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),b.loader.abort()),this.resetLoadingState())}R&&(this.lastCurrentTime=F),!this.loadedmetadata&&!k.len&&(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},_.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},_.onKeyLoaded=function(I,b){if(!(this.state!==A.KEY_LOADING||b.frag!==this.fragCurrent||!this.levels)){this.state=A.IDLE;var R=this.levels[b.frag.level].details;R&&this.loadFragment(b.frag,R,b.frag.start)}},_.onHandlerDestroying=function(){this.stopLoad(),y.prototype.onHandlerDestroying.call(this)},_.onHandlerDestroyed=function(){this.state=A.STOPPED,this.hls.off(p.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,y.prototype.onHandlerDestroyed.call(this)},_.loadKey=function(I,b){this.log("Loading key for "+I.sn+" of ["+b.startSN+"-"+b.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level),this.state=A.KEY_LOADING,this.fragCurrent=I,this.hls.trigger(p.Events.KEY_LOADING,{frag:I})},_.loadFragment=function(I,b,R){this._loadFragForPlayback(I,b,R)},_._loadFragForPlayback=function(I,b,R){var P=this,w=function(k){if(P.fragContextChanged(I)){P.warn("Fragment "+I.sn+(k.part?" p: "+k.part.index:"")+" of level "+I.level+" was dropped during download."),P.fragmentTracker.removeFragment(I);return}I.stats.chunkCount++,P._handleFragmentLoadProgress(k)};this._doFragLoad(I,b,R,w).then(function(F){if(!!F){P.fragLoadError=0;var k=P.state;if(P.fragContextChanged(I)){(k===A.FRAG_LOADING||k===A.BACKTRACKING||!P.fragCurrent&&k===A.PARSING)&&(P.fragmentTracker.removeFragment(I),P.state=A.IDLE);return}if("payload"in F&&(P.log("Loaded fragment "+I.sn+" of level "+I.level),P.hls.trigger(p.Events.FRAG_LOADED,F),P.state===A.BACKTRACKING)){P.fragmentTracker.backtrack(I,F),P.resetFragmentLoading(I);return}P._handleFragmentLoadComplete(F)}}).catch(function(F){P.warn(F),P.resetFragmentLoading(I)})},_.flushMainBuffer=function(I,b,R){if(R===void 0&&(R=null),!!(I-b)){var P={startOffset:I,endOffset:b,type:R};this.fragLoadError=0,this.hls.trigger(p.Events.BUFFER_FLUSHING,P)}},_._loadInitSegment=function(I){var b=this;this._doFragLoad(I).then(function(R){if(!R||b.fragContextChanged(I)||!b.levels)throw new Error("init load aborted");return R}).then(function(R){var P=b.hls,w=R.payload,F=I.decryptdata;if(w&&w.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var k=self.performance.now();return b.decrypter.webCryptoDecrypt(new Uint8Array(w),F.key.buffer,F.iv.buffer).then(function(B){var U=self.performance.now();return P.trigger(p.Events.FRAG_DECRYPTED,{frag:I,payload:B,stats:{tstart:k,tdecrypt:U}}),R.payload=B,R})}return R}).then(function(R){var P=b.fragCurrent,w=b.hls,F=b.levels;if(!F)throw new Error("init load aborted, missing levels");var k=F[I.level].details;console.assert(k,"Level details are defined when init segment is loaded");var B=I.stats;b.state=A.IDLE,b.fragLoadError=0,I.data=new Uint8Array(R.payload),B.parsing.start=B.buffering.start=self.performance.now(),B.parsing.end=B.buffering.end=self.performance.now(),R.frag===P&&w.trigger(p.Events.FRAG_BUFFERED,{stats:B,frag:P,part:null,id:I.type}),b.tick()}).catch(function(R){b.warn(R),b.resetFragmentLoading(I)})},_.fragContextChanged=function(I){var b=this.fragCurrent;return!I||!b||I.level!==b.level||I.sn!==b.sn||I.urlId!==b.urlId},_.fragBufferedComplete=function(I,b){var R=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+I.type+" sn: "+I.sn+(b?" part: "+b.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level+" "+t.default.toString(M.BufferHelper.getBuffered(R))),this.state=A.IDLE,this.tick()},_._handleFragmentLoadComplete=function(I){var b=this.transmuxer;if(!!b){var R=I.frag,P=I.part,w=I.partsLoaded,F=!w||w.length===0||w.some(function(B){return!B}),k=new n.ChunkMetadata(R.level,R.sn,R.stats.chunkCount+1,0,P?P.index:-1,!F);b.flush(k)}},_._handleFragmentLoadProgress=function(I){},_._doFragLoad=function(I,b,R,P){var w=this;if(R===void 0&&(R=null),!this.levels)throw new Error("frag load aborted, missing levels");if(R=Math.max(I.start,R||0),this.config.lowLatencyMode&&b){var F=b.partList;if(F&&P){R>I.end&&b.fragmentHint&&(I=b.fragmentHint);var k=this.getNextPart(F,I,R);if(k>-1){var B=F[k];return this.log("Loading part sn: "+I.sn+" p: "+B.index+" cc: "+I.cc+" of playlist ["+b.startSN+"-"+b.endSN+"] parts [0-"+k+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),this.nextLoadPosition=B.start+B.duration,this.state=A.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:I,part:F[k],targetBufferTime:R}),this.doFragPartsLoad(I,F,k,P).catch(function(U){return w.handleFragLoadError(U)})}else if(!I.url||this.loadedEndOfParts(F,R))return Promise.resolve(null)}}return this.log("Loading fragment "+I.sn+" cc: "+I.cc+" "+(b?"of ["+b.startSN+"-"+b.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),Object(T.isFiniteNumber)(I.sn)&&!this.bitrateTest&&(this.nextLoadPosition=I.start+I.duration),this.state=A.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:I,targetBufferTime:R}),this.fragmentLoader.load(I,P).catch(function(U){return w.handleFragLoadError(U)})},_.doFragPartsLoad=function(I,b,R,P){var w=this;return new Promise(function(F,k){var B=[],U=function j(K){var N=b[K];w.fragmentLoader.loadPart(I,N,P).then(function(Z){B[N.index]=Z;var $=Z.part;w.hls.trigger(p.Events.FRAG_LOADED,Z);var Y=b[K+1];if(Y&&Y.fragment===I)j(K+1);else return F({frag:I,part:$,partsLoaded:B})}).catch(k)};U(R)})},_.handleFragLoadError=function(I){var b=I.data;return b&&b.details===u.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(b.frag,b.part):this.hls.trigger(p.Events.ERROR,b),null},_._handleTransmuxerFlush=function(I){var b=this.getCurrentContext(I);if(!b||this.state!==A.PARSING){this.fragCurrent||(this.state=A.IDLE);return}var R=b.frag,P=b.part,w=b.level,F=self.performance.now();R.stats.parsing.end=F,P&&(P.stats.parsing.end=F),this.updateLevelTiming(R,P,w,I.partial)},_.getCurrentContext=function(I){var b=this.levels,R=I.level,P=I.sn,w=I.part;if(!b||!b[R])return this.warn("Levels object was unset while buffering fragment "+P+" of level "+R+". The current chunk will not be buffered."),null;var F=b[R],k=w>-1?Object(v.getPartWith)(F,P,w):null,B=k?k.fragment:Object(v.getFragmentWithSN)(F,P,this.fragCurrent);return B?{frag:B,part:k,level:F}:null},_.bufferFragmentData=function(I,b,R,P){if(!(!I||this.state!==A.PARSING)){var w=I.data1,F=I.data2,k=w;if(w&&F&&(k=Object(f.appendUint8Array)(w,F)),!(!k||!k.length)){var B={type:I.type,frag:b,part:R,chunkMeta:P,parent:b.type,data:k};this.hls.trigger(p.Events.BUFFER_APPENDING,B),I.dropped&&I.independent&&!R&&this.flushBufferGap(b)}}},_.flushBufferGap=function(I){var b=this.media;if(!!b){if(!M.BufferHelper.isBuffered(b,b.currentTime)){this.flushMainBuffer(0,I.start);return}var R=b.currentTime,P=M.BufferHelper.bufferInfo(b,R,0),w=I.duration,F=Math.min(this.config.maxFragLookUpTolerance*2,w*.25),k=Math.max(Math.min(I.start-F,P.end-F),R+F);I.start-k>F&&this.flushMainBuffer(k,I.start)}},_.getFwdBufferInfo=function(I,b){var R=this.config,P=this.getLoadPosition();if(!Object(T.isFiniteNumber)(P))return null;var w=M.BufferHelper.bufferInfo(I,P,R.maxBufferHole);if(w.len===0&&w.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(P,b);if(F&&w.nextStart<F.end)return M.BufferHelper.bufferInfo(I,P,Math.max(w.nextStart,R.maxBufferHole))}return w},_.getMaxBufferLength=function(I){var b=this.config,R;return I?R=Math.max(8*b.maxBufferSize/I,b.maxBufferLength):R=b.maxBufferLength,Math.min(R,b.maxMaxBufferLength)},_.reduceMaxBufferLength=function(I){var b=this.config,R=I||b.maxBufferLength;return b.maxMaxBufferLength>=R?(b.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+b.maxMaxBufferLength+"s"),!0):!1},_.getNextFragment=function(I,b){var R,P,w=b.fragments,F=w.length;if(!F)return null;var k=this.config,B=w[0].start,U;if(b.live){var j=k.initialLiveManifestSize;if(F<j)return this.warn("Not enough fragments to start playback (have: "+F+", need: "+j+")"),null;!b.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(U=this.getInitialLiveFragment(b,w),this.startPosition=U?this.hls.liveSyncPosition||U.start:I)}else I<=B&&(U=w[0]);if(!U){var K=k.lowLatencyMode?b.partEnd:b.fragmentEnd;U=this.getFragmentAtPosition(I,K,b)}return(R=U)!==null&&R!==void 0&&R.initSegment&&!((P=U)!==null&&P!==void 0&&P.initSegment.data)&&!this.bitrateTest&&(U=U.initSegment),U},_.getNextPart=function(I,b,R){for(var P=-1,w=!1,F=!0,k=0,B=I.length;k<B;k++){var U=I[k];if(F=F&&!U.independent,P>-1&&R<U.start)break;var j=U.loaded;!j&&(w||U.independent||F)&&U.fragment===b&&(P=k),w=j}return P},_.loadedEndOfParts=function(I,b){var R=I[I.length-1];return R&&b>R.start&&R.loaded},_.getInitialLiveFragment=function(I,b){var R=this.fragPrevious,P=null;if(R){if(I.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+R.programDateTime),P=Object(c.findFragmentByPDT)(b,R.endProgramDateTime,this.config.maxFragLookUpTolerance)),!P){var w=R.sn+1;if(w>=I.startSN&&w<=I.endSN){var F=b[w-I.startSN];R.cc===F.cc&&(P=F,this.log("Live playlist, switching playlist, load frag with next SN: "+P.sn))}P||(P=Object(c.findFragWithCC)(b,R.cc),P&&this.log("Live playlist, switching playlist, load frag with same CC: "+P.sn))}}else{var k=this.hls.liveSyncPosition;k!==null&&(P=this.getFragmentAtPosition(k,this.bitrateTest?I.fragmentEnd:I.edge,I))}return P},_.getFragmentAtPosition=function(I,b,R){var P=this.config,w=this.fragPrevious,F=R.fragments,k=R.endSN,B=R.fragmentHint,U=P.maxFragLookUpTolerance,j=!!(P.lowLatencyMode&&R.partList&&B);j&&B&&!this.bitrateTest&&(F=F.concat(B),k=B.sn);var K;if(I<b){var N=I>b-U?0:U;K=Object(c.findFragmentByPTS)(w,F,I,N)}else K=F[F.length-1];if(K){var Z=K.sn-R.startSN,$=w&&K.level===w.level,Y=F[Z+1],ee=this.fragmentTracker.getState(K);if(ee===m.FragmentState.BACKTRACKED){K=null;for(var Q=Z;F[Q]&&this.fragmentTracker.getState(F[Q])===m.FragmentState.BACKTRACKED;)w?K=F[Q--]:K=F[--Q];K||(K=Y)}else w&&K.sn===w.sn&&!j&&$&&(K.sn<k&&this.fragmentTracker.getState(Y)!==m.FragmentState.OK?(this.log("SN "+K.sn+" just loaded, load next one: "+Y.sn),K=Y):K=null)}return K},_.synchronizeToLiveEdge=function(I){var b=this.config,R=this.media;if(!!R){var P=this.hls.liveSyncPosition,w=R.currentTime,F=I.fragments[0].start,k=I.edge,B=w>=F-b.maxFragLookUpTolerance&&w<=k;if(P!==null&&R.duration>P&&(w<P||!B)){var U=b.liveMaxLatencyDuration!==void 0?b.liveMaxLatencyDuration:b.liveMaxLatencyDurationCount*I.targetduration;(!B&&R.readyState<4||w<k-U)&&(this.loadedmetadata||(this.nextLoadPosition=P),R.readyState&&(this.warn("Playback: "+w.toFixed(3)+" is located too far from the end of live sliding playlist: "+k+", reset currentTime to : "+P.toFixed(3)),R.currentTime=P))}}},_.alignPlaylists=function(I,b){var R=this.levels,P=this.levelLastLoaded,w=this.fragPrevious,F=P!==null?R[P]:null,k=I.fragments.length;if(!k)return this.warn("No fragments in live playlist"),0;var B=I.fragments[0].start,U=!b,j=I.alignedSliding&&Object(T.isFiniteNumber)(B);if(U||!j&&!B){Object(l.alignStream)(w,F,I);var K=I.fragments[0].start;return this.log("Live playlist sliding: "+K.toFixed(2)+" start-sn: "+(b?b.startSN:"na")+"->"+I.startSN+" prev-sn: "+(w?w.sn:"na")+" fragments: "+k),K}return B},_.waitForCdnTuneIn=function(I){var b=3;return I.live&&I.canBlockReload&&I.tuneInGoal>Math.max(I.partHoldBack,I.partTarget*b)},_.setStartPosition=function(I,b){var R=this.startPosition;if(R<b&&(R=-1),R===-1||this.lastCurrentTime===-1){var P=I.startTimeOffset;Object(T.isFiniteNumber)(P)?(R=b+P,P<0&&(R+=I.totalduration),R=Math.min(Math.max(b,R),b+I.totalduration),this.log("Start time offset "+P+" found in playlist, adjust startPosition to "+R),this.startPosition=R):I.live?R=this.hls.liveSyncPosition||b:this.startPosition=R=0,this.lastCurrentTime=R}this.nextLoadPosition=R},_.getLoadPosition=function(){var I=this.media,b=0;return this.loadedmetadata&&I?b=I.currentTime:this.nextLoadPosition&&(b=this.nextLoadPosition),b},_.handleFragLoadAborted=function(I,b){this.transmuxer&&I.sn!=="initSegment"&&I.stats.aborted&&(this.warn("Fragment "+I.sn+(b?" part"+b.index:"")+" of level "+I.level+" was aborted"),this.resetFragmentLoading(I))},_.resetFragmentLoading=function(I){(!this.fragCurrent||!this.fragContextChanged(I))&&(this.state=A.IDLE)},_.onFragmentOrKeyLoadError=function(I,b){if(!b.fatal){var R=b.frag;if(!(!R||R.type!==I)){var P=this.fragCurrent;console.assert(P&&R.sn===P.sn&&R.level===P.level&&R.urlId===P.urlId,"Frag load error must match current frag to retry");var w=this.config;if(this.fragLoadError+1<=w.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(R.level))return;var F=Math.min(Math.pow(2,this.fragLoadError)*w.fragLoadingRetryDelay,w.fragLoadingMaxRetryTimeout);this.warn("Fragment "+R.sn+" of "+I+" "+R.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=A.FRAG_LOADING_WAITING_RETRY}else b.levelRetry?(I===r.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=A.IDLE):(S.logger.error(b.details+" reaches max retry, redispatch as fatal ..."),b.fatal=!0,this.hls.stopLoad(),this.state=A.ERROR)}}},_.afterBufferFlushed=function(I,b,R){if(!!I){var P=M.BufferHelper.getBuffered(I);this.fragmentTracker.detectEvictedFragments(b,P,R),this.state===A.ENDED&&this.resetLoadingState()}},_.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=A.IDLE},_.resetLiveStartWhenNotLoaded=function(I){if(!this.loadedmetadata){this.startFragRequested=!1;var b=this.levels?this.levels[I].details:null;if(b!=null&&b.live)return this.startPosition=-1,this.setStartPosition(b,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},_.updateLevelTiming=function(I,b,R,P){var w=this,F=R.details;console.assert(!!F,"level.details must be defined");var k=Object.keys(I.elementaryStreams).reduce(function(B,U){var j=I.elementaryStreams[U];if(j){var K=j.endPTS-j.startPTS;if(K<=0)return w.warn("Could not parse fragment "+I.sn+" "+U+" duration reliably ("+K+") resetting transmuxer to fallback to playlist timing"),w.resetTransmuxer(),B||!1;var N=P?0:Object(v.updateFragPTSDTS)(F,I,j.startPTS,j.endPTS,j.startDTS,j.endDTS);return w.hls.trigger(p.Events.LEVEL_PTS_UPDATED,{details:F,level:R,drift:N,type:U,frag:I,start:j.startPTS,end:j.endPTS}),!0}return B},!1);k?(this.state=A.PARSED,this.hls.trigger(p.Events.FRAG_PARSED,{frag:I,part:b})):this.resetLoadingState()},_.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},s(E,[{key:"state",get:function(){return this._state},set:function(I){var b=this._state;b!==I&&(this._state=I,this.log(b+"->"+I))}}]),E}(h.default)},"./src/controller/buffer-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return c});var T=x("./src/polyfills/number.ts"),h=x("./src/events.ts"),m=x("./src/utils/logger.ts"),M=x("./src/errors.ts"),S=x("./src/utils/buffer-helper.ts"),p=x("./src/utils/mediasource-helper.ts"),u=x("./src/loader/fragment.ts"),n=x("./src/controller/buffer-operation-queue.ts"),f=Object(p.getMediaSource)(),l=/([ha]vc.)(?:\.[^.,]+)+/,c=function(){function v(i){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var r=t.hls,e=t.media,s=t.mediaSource;m.logger.log("[buffer-controller]: Media source opened"),e&&(t.updateMediaElementDuration(),r.trigger(h.Events.MEDIA_ATTACHED,{media:e})),s&&s.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){m.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){m.logger.log("[buffer-controller]: Media source ended")},this.hls=i,this._initSourceBuffer(),this.registerListeners()}var d=v.prototype;return d.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},d.destroy=function(){this.unregisterListeners(),this.details=null},d.registerListeners=function(){var t=this.hls;t.on(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(h.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(h.Events.BUFFER_RESET,this.onBufferReset,this),t.on(h.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(h.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(h.Events.BUFFER_EOS,this.onBufferEos,this),t.on(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(h.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(h.Events.FRAG_PARSED,this.onFragParsed,this),t.on(h.Events.FRAG_CHANGED,this.onFragChanged,this)},d.unregisterListeners=function(){var t=this.hls;t.off(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(h.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(h.Events.BUFFER_RESET,this.onBufferReset,this),t.off(h.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(h.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(h.Events.BUFFER_EOS,this.onBufferEos,this),t.off(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(h.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(h.Events.FRAG_PARSED,this.onFragParsed,this),t.off(h.Events.FRAG_CHANGED,this.onFragChanged,this)},d._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new n.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},d.onManifestParsed=function(t,r){var e=2;(r.audio&&!r.video||!r.altAudio)&&(e=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e,this.details=null,m.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},d.onMediaAttaching=function(t,r){var e=this.media=r.media;if(e&&f){var s=this.mediaSource=new f;s.addEventListener("sourceopen",this._onMediaSourceOpen),s.addEventListener("sourceended",this._onMediaSourceEnded),s.addEventListener("sourceclose",this._onMediaSourceClose),e.src=self.URL.createObjectURL(s),this._objectUrl=e.src}},d.onMediaDetaching=function(){var t=this.media,r=this.mediaSource,e=this._objectUrl;if(r){if(m.logger.log("[buffer-controller]: media source detaching"),r.readyState==="open")try{r.endOfStream()}catch(s){m.logger.warn("[buffer-controller]: onMediaDetaching: "+s.message+" while calling endOfStream")}this.onBufferReset(),r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(e&&self.URL.revokeObjectURL(e),t.src===e?(t.removeAttribute("src"),t.load()):m.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(h.Events.MEDIA_DETACHED,void 0)},d.onBufferReset=function(){var t=this;this.getSourceBufferTypes().forEach(function(r){var e=t.sourceBuffer[r];try{e&&(t.removeBufferListeners(r),t.mediaSource&&t.mediaSource.removeSourceBuffer(e),t.sourceBuffer[r]=void 0)}catch(s){m.logger.warn("[buffer-controller]: Failed to reset the "+r+" buffer",s)}}),this._initSourceBuffer()},d.onBufferCodecs=function(t,r){var e=this,s=this.getSourceBufferTypes().length;Object.keys(r).forEach(function(o){if(s){var a=e.tracks[o];if(a&&typeof a.buffer.changeType=="function"){var g=r[o],A=g.codec,D=g.levelCodec,y=g.container,E=(a.levelCodec||a.codec).replace(l,"$1"),_=(D||A).replace(l,"$1");if(E!==_){var L=y+";codecs="+(D||A);e.appendChangeType(o,L)}}}else e.pendingTracks[o]=r[o]}),!s&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},d.appendChangeType=function(t,r){var e=this,s=this.operationQueue,o={execute:function(){var g=e.sourceBuffer[t];g&&(m.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+r),g.changeType(r)),s.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(g){m.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",g)}};s.append(o,t)},d.onBufferAppending=function(t,r){var e=this,s=this.hls,o=this.operationQueue,a=this.tracks,g=r.data,A=r.type,D=r.frag,y=r.part,E=r.chunkMeta,_=E.buffering[A],L=self.performance.now();_.start=L;var I=D.stats.buffering,b=y?y.stats.buffering:null;I.start===0&&(I.start=L),b&&b.start===0&&(b.start=L);var R=a.audio,P=A==="audio"&&E.id===1&&(R==null?void 0:R.container)==="audio/mpeg",w={execute:function(){if(_.executeStart=self.performance.now(),P){var k=e.sourceBuffer[A];if(k){var B=D.start-k.timestampOffset;Math.abs(B)>=.1&&(m.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+D.start+" (delta: "+B+") sn: "+D.sn+")"),k.timestampOffset=D.start)}}e.appendExecutor(g,A)},onStart:function(){},onComplete:function(){var k=self.performance.now();_.executeEnd=_.end=k,I.first===0&&(I.first=k),b&&b.first===0&&(b.first=k);var B=e.sourceBuffer,U={};for(var j in B)U[j]=S.BufferHelper.getBuffered(B[j]);e.appendError=0,e.hls.trigger(h.Events.BUFFER_APPENDED,{type:A,frag:D,part:y,chunkMeta:E,parent:D.type,timeRanges:U})},onError:function(k){m.logger.error("[buffer-controller]: Error encountered while trying to append to the "+A+" SourceBuffer",k);var B={type:M.ErrorTypes.MEDIA_ERROR,parent:D.type,details:M.ErrorDetails.BUFFER_APPEND_ERROR,err:k,fatal:!1};k.code===DOMException.QUOTA_EXCEEDED_ERR?B.details=M.ErrorDetails.BUFFER_FULL_ERROR:(e.appendError++,B.details=M.ErrorDetails.BUFFER_APPEND_ERROR,e.appendError>s.config.appendErrorMaxRetry&&(m.logger.error("[buffer-controller]: Failed "+s.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),B.fatal=!0)),s.trigger(h.Events.ERROR,B)}};o.append(w,A)},d.onBufferFlushing=function(t,r){var e=this,s=this.operationQueue,o=function(g){return{execute:e.removeExecutor.bind(e,g,r.startOffset,r.endOffset),onStart:function(){},onComplete:function(){e.hls.trigger(h.Events.BUFFER_FLUSHED,{type:g})},onError:function(D){m.logger.warn("[buffer-controller]: Failed to remove from "+g+" SourceBuffer",D)}}};r.type?s.append(o(r.type),r.type):this.getSourceBufferTypes().forEach(function(a){s.append(o(a),a)})},d.onFragParsed=function(t,r){var e=this,s=r.frag,o=r.part,a=[],g=o?o.elementaryStreams:s.elementaryStreams;g[u.ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(g[u.ElementaryStreamTypes.AUDIO]&&a.push("audio"),g[u.ElementaryStreamTypes.VIDEO]&&a.push("video"));var A=function(){var y=self.performance.now();s.stats.buffering.end=y,o&&(o.stats.buffering.end=y);var E=o?o.stats:s.stats;e.hls.trigger(h.Events.FRAG_BUFFERED,{frag:s,part:o,stats:E,id:s.type})};a.length===0&&m.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+s.type+" level: "+s.level+" sn: "+s.sn),this.blockBuffers(A,a)},d.onFragChanged=function(t,r){this.flushBackBuffer()},d.onBufferEos=function(t,r){var e=this,s=this.getSourceBufferTypes().reduce(function(o,a){var g=e.sourceBuffer[a];return(!r.type||r.type===a)&&g&&!g.ended&&(g.ended=!0,m.logger.log("[buffer-controller]: "+a+" sourceBuffer now EOS")),o&&!!(!g||g.ended)},!0);s&&this.blockBuffers(function(){var o=e.mediaSource;!o||o.readyState!=="open"||o.endOfStream()})},d.onLevelUpdated=function(t,r){var e=r.details;!e.fragments.length||(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},d.flushBackBuffer=function(){var t=this.hls,r=this.details,e=this.media,s=this.sourceBuffer;if(!(!e||r===null)){var o=this.getSourceBufferTypes();if(!!o.length){var a=r.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if(!(!Object(T.isFiniteNumber)(a)||a<0)){var g=e.currentTime,A=r.levelTargetDuration,D=Math.max(a,A),y=Math.floor(g/A)*A-D;o.forEach(function(E){var _=s[E];if(_){var L=S.BufferHelper.getBuffered(_);L.length>0&&y>L.start(0)&&(t.trigger(h.Events.BACK_BUFFER_REACHED,{bufferEnd:y}),r.live&&t.trigger(h.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:y}),t.trigger(h.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:y,type:E}))}})}}}},d.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var t=this.details,r=this.hls,e=this.media,s=this.mediaSource,o=t.fragments[0].start+t.totalduration,a=e.duration,g=Object(T.isFiniteNumber)(s.duration)?s.duration:0;t.live&&r.config.liveDurationInfinity?(m.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),s.duration=1/0,this.updateSeekableRange(t)):(o>g&&o>a||!Object(T.isFiniteNumber)(a))&&(m.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),s.duration=o)}},d.updateSeekableRange=function(t){var r=this.mediaSource,e=t.fragments,s=e.length;if(s&&t.live&&r!==null&&r!==void 0&&r.setLiveSeekableRange){var o=Math.max(0,e[0].start),a=Math.max(o,o+t.totalduration);r.setLiveSeekableRange(o,a)}},d.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,r=this.operationQueue,e=this.pendingTracks,s=Object.keys(e).length;if(s&&!t||s===2){this.createSourceBuffers(e),this.pendingTracks={};var o=this.getSourceBufferTypes();if(o.length===0){this.hls.trigger(h.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}o.forEach(function(a){r.executeNext(a)})}},d.createSourceBuffers=function(t){var r=this.sourceBuffer,e=this.mediaSource;if(!e)throw Error("createSourceBuffers called when mediaSource was null");var s=0;for(var o in t)if(!r[o]){var a=t[o];if(!a)throw Error("source buffer exists for track "+o+", however track does not");var g=a.levelCodec||a.codec,A=a.container+";codecs="+g;m.logger.log("[buffer-controller]: creating sourceBuffer("+A+")");try{var D=r[o]=e.addSourceBuffer(A),y=o;this.addBufferListener(y,"updatestart",this._onSBUpdateStart),this.addBufferListener(y,"updateend",this._onSBUpdateEnd),this.addBufferListener(y,"error",this._onSBUpdateError),this.tracks[o]={buffer:D,codec:g,container:a.container,levelCodec:a.levelCodec,id:a.id},s++}catch(E){m.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+E.message),this.hls.trigger(h.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:E,mimeType:A})}}s&&this.hls.trigger(h.Events.BUFFER_CREATED,{tracks:this.tracks})},d._onSBUpdateStart=function(t){var r=this.operationQueue,e=r.current(t);e.onStart()},d._onSBUpdateEnd=function(t){var r=this.operationQueue,e=r.current(t);e.onComplete(),r.shiftAndExecuteNext(t)},d._onSBUpdateError=function(t,r){m.logger.error("[buffer-controller]: "+t+" SourceBuffer error",r),this.hls.trigger(h.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var e=this.operationQueue.current(t);e&&e.onError(r)},d.removeExecutor=function(t,r,e){var s=this.media,o=this.mediaSource,a=this.operationQueue,g=this.sourceBuffer,A=g[t];if(!s||!o||!A){m.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),a.shiftAndExecuteNext(t);return}var D=Object(T.isFiniteNumber)(s.duration)?s.duration:1/0,y=Object(T.isFiniteNumber)(o.duration)?o.duration:1/0,E=Math.max(0,r),_=Math.min(e,D,y);_>E?(m.logger.log("[buffer-controller]: Removing ["+E+","+_+"] from the "+t+" SourceBuffer"),console.assert(!A.updating,t+" sourceBuffer must not be updating"),A.remove(E,_)):a.shiftAndExecuteNext(t)},d.appendExecutor=function(t,r){var e=this.operationQueue,s=this.sourceBuffer,o=s[r];if(!o){m.logger.warn("[buffer-controller]: Attempting to append to the "+r+" SourceBuffer, but it does not exist"),e.shiftAndExecuteNext(r);return}o.ended=!1,console.assert(!o.updating,r+" sourceBuffer must not be updating"),o.appendBuffer(t)},d.blockBuffers=function(t,r){var e=this;if(r===void 0&&(r=this.getSourceBufferTypes()),!r.length){m.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(t);return}var s=this.operationQueue,o=r.map(function(a){return s.appendBlocker(a)});Promise.all(o).then(function(){t(),r.forEach(function(a){var g=e.sourceBuffer[a];(!g||!g.updating)&&s.shiftAndExecuteNext(a)})})},d.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},d.addBufferListener=function(t,r,e){var s=this.sourceBuffer[t];if(!!s){var o=e.bind(this,t);this.listeners[t].push({event:r,listener:o}),s.addEventListener(r,o)}},d.removeBufferListeners=function(t){var r=this.sourceBuffer[t];!r||this.listeners[t].forEach(function(e){r.removeEventListener(e.event,e.listener)})},v}()},"./src/controller/buffer-operation-queue.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return h});var T=x("./src/utils/logger.ts"),h=function(){function m(S){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=S}var M=m.prototype;return M.append=function(p,u){var n=this.queues[u];n.push(p),n.length===1&&this.buffers[u]&&this.executeNext(u)},M.insertAbort=function(p,u){var n=this.queues[u];n.unshift(p),this.executeNext(u)},M.appendBlocker=function(p){var u,n=new Promise(function(l){u=l}),f={execute:u,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(f,p),n},M.executeNext=function(p){var u=this.buffers,n=this.queues,f=u[p],l=n[p];if(l.length){var c=l[0];try{c.execute()}catch(v){T.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),c.onError(v),(!f||!f.updating)&&(l.shift(),this.executeNext(p))}}},M.shiftAndExecuteNext=function(p){this.queues[p].shift(),this.executeNext(p)},M.current=function(p){return this.queues[p][0]},m}()},"./src/controller/cap-level-controller.ts":function(O,C,x){x.r(C);var T=x("./src/events.ts");function h(S,p){for(var u=0;u<p.length;u++){var n=p[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(S,n.key,n)}}function m(S,p,u){return p&&h(S.prototype,p),u&&h(S,u),S}var M=function(){function S(u){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=u,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var p=S.prototype;return p.setStreamController=function(n){this.streamController=n},p.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},p.registerListeners=function(){var n=this.hls;n.on(T.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.on(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(T.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.unregisterListener=function(){var n=this.hls;n.off(T.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.off(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(T.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.onFpsDropLevelCapping=function(n,f){S.isLevelAllowed(f.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(f.droppedLevel)},p.onMediaAttaching=function(n,f){this.media=f.media instanceof HTMLVideoElement?f.media:null},p.onManifestParsed=function(n,f){var l=this.hls;this.restrictedLevels=[],this.firstLevel=f.firstLevel,l.config.capLevelToPlayerSize&&f.video&&this.startCapping()},p.onBufferCodecs=function(n,f){var l=this.hls;l.config.capLevelToPlayerSize&&f.video&&this.startCapping()},p.onMediaDetaching=function(){this.stopCapping()},p.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var n=this.hls.levels;if(n.length){var f=this.hls;f.autoLevelCapping=this.getMaxLevel(n.length-1),f.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=f.autoLevelCapping}}},p.getMaxLevel=function(n){var f=this,l=this.hls.levels;if(!l.length)return-1;var c=l.filter(function(v,d){return S.isLevelAllowed(d,f.restrictedLevels)&&d<=n});return this.clientRect=null,S.getMaxLevelByMediaSize(c,this.mediaWidth,this.mediaHeight)},p.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},p.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},p.getDimensions=function(){if(this.clientRect)return this.clientRect;var n=this.media,f={width:0,height:0};if(n){var l=n.getBoundingClientRect();f.width=l.width,f.height=l.height,!f.width&&!f.height&&(f.width=l.right-l.left||n.width||0,f.height=l.bottom-l.top||n.height||0)}return this.clientRect=f,f},S.isLevelAllowed=function(n,f){return f===void 0&&(f=[]),f.indexOf(n)===-1},S.getMaxLevelByMediaSize=function(n,f,l){if(!n||!n.length)return-1;for(var c=function(r,e){return e?r.width!==e.width||r.height!==e.height:!0},v=n.length-1,d=0;d<n.length;d+=1){var i=n[d];if((i.width>=f||i.height>=l)&&c(i,n[d+1])){v=d;break}}return v},m(S,[{key:"mediaWidth",get:function(){return this.getDimensions().width*S.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*S.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var n=1;try{n=self.devicePixelRatio}catch{}return n}}]),S}();C.default=M},"./src/controller/cmcd-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return c});var T=x("./src/events.ts"),h=x("./src/types/cmcd.ts"),m=x("./src/utils/buffer-helper.ts"),M=x("./src/utils/logger.ts");function S(v,d){for(var i=0;i<d.length;i++){var t=d[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(v,t.key,t)}}function p(v,d,i){return d&&S(v.prototype,d),i&&S(v,i),v}function u(v,d){var i=typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(i)return(i=i.call(v)).next.bind(i);if(Array.isArray(v)||(i=n(v))||d&&v&&typeof v.length=="number"){i&&(v=i);var t=0;return function(){return t>=v.length?{done:!0}:{done:!1,value:v[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(v,d){if(!!v){if(typeof v=="string")return f(v,d);var i=Object.prototype.toString.call(v).slice(8,-1);if(i==="Object"&&v.constructor&&(i=v.constructor.name),i==="Map"||i==="Set")return Array.from(v);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(v,d)}}function f(v,d){(d==null||d>v.length)&&(d=v.length);for(var i=0,t=new Array(d);i<d;i++)t[i]=v[i];return t}function l(){return l=Object.assign||function(v){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(v[t]=i[t])}return v},l.apply(this,arguments)}var c=function(){function v(i){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1},this.applyPlaylistData=function(s){try{t.apply(s,{ot:h.CMCDObjectType.MANIFEST,su:!t.initialized})}catch(o){M.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(s){try{var o=s.frag,a=t.hls.levels[o.level],g=t.getObjectType(o),A={d:o.duration*1e3,ot:g};(g===h.CMCDObjectType.VIDEO||g===h.CMCDObjectType.AUDIO||g==h.CMCDObjectType.MUXED)&&(A.br=a.bitrate/1e3,A.tb=t.getTopBandwidth(g)/1e3,A.bl=t.getBufferLength(g)),t.apply(s,A)}catch(D){M.logger.warn("Could not generate segment CMCD data.",D)}},this.hls=i;var r=this.config=i.config,e=r.cmcd;e!=null&&(r.pLoader=this.createPlaylistLoader(),r.fLoader=this.createFragmentLoader(),this.sid=e.sessionId||v.uuid(),this.cid=e.contentId,this.useHeaders=e.useHeaders===!0,this.registerListeners())}var d=v.prototype;return d.registerListeners=function(){var t=this.hls;t.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.on(T.Events.BUFFER_CREATED,this.onBufferCreated,this)},d.unregisterListeners=function(){var t=this.hls;t.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.off(T.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},d.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},d.onMediaAttached=function(t,r){this.media=r.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},d.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},d.onBufferCreated=function(t,r){var e,s;this.audioBuffer=(e=r.tracks.audio)===null||e===void 0?void 0:e.buffer,this.videoBuffer=(s=r.tracks.video)===null||s===void 0?void 0:s.buffer},d.createData=function(){var t;return{v:h.CMCDVersion,sf:h.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)===null||t===void 0?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},d.apply=function(t,r){r===void 0&&(r={}),l(r,this.createData());var e=r.ot===h.CMCDObjectType.INIT||r.ot===h.CMCDObjectType.VIDEO||r.ot===h.CMCDObjectType.MUXED;if(this.starved&&e&&(r.bs=!0,r.su=!0,this.starved=!1),r.su==null&&(r.su=this.buffering),this.useHeaders){var s=v.toHeaders(r);if(!Object.keys(s).length)return;t.headers||(t.headers={}),l(t.headers,s)}else{var o=v.toQuery(r);if(!o)return;t.url=v.appendQueryToUri(t.url,o)}},d.getObjectType=function(t){var r=t.type;if(r==="subtitle")return h.CMCDObjectType.TIMED_TEXT;if(t.sn==="initSegment")return h.CMCDObjectType.INIT;if(r==="audio")return h.CMCDObjectType.AUDIO;if(r==="main")return this.hls.audioTracks.length?h.CMCDObjectType.VIDEO:h.CMCDObjectType.MUXED},d.getTopBandwidth=function(t){var r=0,e,s=this.hls;if(t===h.CMCDObjectType.AUDIO)e=s.audioTracks;else{var o=s.maxAutoLevel,a=o>-1?o+1:s.levels.length;e=s.levels.slice(0,a)}for(var g=u(e),A;!(A=g()).done;){var D=A.value;D.bitrate>r&&(r=D.bitrate)}return r>0?r:NaN},d.getBufferLength=function(t){var r=this.hls.media,e=t===h.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!e||!r)return NaN;var s=m.BufferHelper.bufferInfo(e,r.currentTime,this.config.maxBufferHole);return s.len*1e3},d.createPlaylistLoader=function(){var t=this.config.pLoader,r=this.applyPlaylistData,e=t||this.config.loader;return function(){function s(a){this.loader=void 0,this.loader=new e(a)}var o=s.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(g,A,D){r(g),this.loader.load(g,A,D)},p(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},d.createFragmentLoader=function(){var t=this.config.fLoader,r=this.applyFragmentData,e=t||this.config.loader;return function(){function s(a){this.loader=void 0,this.loader=new e(a)}var o=s.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(g,A,D){r(g),this.loader.load(g,A,D)},p(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},v.uuid=function(){var t=URL.createObjectURL(new Blob),r=t.toString();return URL.revokeObjectURL(t),r.substr(r.lastIndexOf("/")+1)},v.serialize=function(t){for(var r=[],e=function(P){return!Number.isNaN(P)&&P!=null&&P!==""&&P!==!1},s=function(P){return Math.round(P)},o=function(P){return s(P/100)*100},a=function(P){return encodeURIComponent(P)},g={br:s,d:s,bl:o,dl:o,mtp:o,nor:a,rtp:o,tb:s},A=Object.keys(t||{}).sort(),D=u(A),y;!(y=D()).done;){var E=y.value,_=t[E];if(!!e(_)&&!(E==="v"&&_===1)&&!(E=="pr"&&_===1)){var L=g[E];L&&(_=L(_));var I=typeof _,b=void 0;E==="ot"||E==="sf"||E==="st"?b=E+"="+_:I==="boolean"?b=E:I==="number"?b=E+"="+_:b=E+"="+JSON.stringify(_),r.push(b)}}return r.join(",")},v.toHeaders=function(t){for(var r=Object.keys(t),e={},s=["Object","Request","Session","Status"],o=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},g=0,A=r;g<A.length;g++){var D=A[g],y=a[D]!=null?a[D]:1;o[y][D]=t[D]}for(var E=0;E<o.length;E++){var _=v.serialize(o[E]);_&&(e["CMCD-"+s[E]]=_)}return e},v.toQuery=function(t){return"CMCD="+encodeURIComponent(v.serialize(t))},v.appendQueryToUri=function(t,r){if(!r)return t;var e=t.includes("?")?"&":"?";return""+t+e+r},v}()},"./src/controller/eme-controller.ts":function(O,C,x){x.r(C);var T=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/utils/logger.ts"),M=x("./src/utils/mediakeys-helper.ts");function S(c,v){for(var d=0;d<v.length;d++){var i=v[d];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(c,i.key,i)}}function p(c,v,d){return v&&S(c.prototype,v),d&&S(c,d),c}var u=3,n=function(v,d,i){var t={audioCapabilities:[],videoCapabilities:[]};return v.forEach(function(r){t.audioCapabilities.push({contentType:'audio/mp4; codecs="'+r+'"',robustness:i.audioRobustness||""})}),d.forEach(function(r){t.videoCapabilities.push({contentType:'video/mp4; codecs="'+r+'"',robustness:i.videoRobustness||""})}),[t]},f=function(v,d,i,t){switch(v){case M.KeySystems.WIDEVINE:return n(d,i,t);default:throw new Error("Unknown key-system: "+v)}},l=function(){function c(d){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=d,this._config=d.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var v=c.prototype;return v.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},v._registerListeners=function(){this.hls.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this)},v._unregisterListeners=function(){this.hls.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this)},v.getLicenseServerUrl=function(i){switch(i){case M.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+i+'"')},v._attemptKeySystemAccess=function(i,t,r){var e=this,s=f(i,t,r,this._drmSystemOptions);m.logger.log("Requesting encrypted media key-system access");var o=this.requestMediaKeySystemAccess(i,s);this.mediaKeysPromise=o.then(function(a){return e._onMediaKeySystemAccessObtained(i,a)}),o.catch(function(a){m.logger.error('Failed to obtain key-system "'+i+'" access:',a)})},v._onMediaKeySystemAccessObtained=function(i,t){var r=this;m.logger.log('Access for key-system "'+i+'" obtained');var e={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:i};this._mediaKeysList.push(e);var s=Promise.resolve().then(function(){return t.createMediaKeys()}).then(function(o){return e.mediaKeys=o,m.logger.log('Media-keys created for key-system "'+i+'"'),r._onMediaKeysCreated(),o});return s.catch(function(o){m.logger.error("Failed to create media-keys:",o)}),s},v._onMediaKeysCreated=function(){var i=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),i._onNewMediaKeySession(t.mediaKeysSession))})},v._onNewMediaKeySession=function(i){var t=this;m.logger.log("New key-system session "+i.sessionId),i.addEventListener("message",function(r){t._onKeySessionMessage(i,r.message)},!1)},v._onKeySessionMessage=function(i,t){m.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(r){m.logger.log("Received license data (length: "+(r&&r.byteLength)+"), updating key-session"),i.update(r)})},v.onMediaEncrypted=function(i){var t=this;if(m.logger.log('Media is encrypted using "'+i.initDataType+'" init data type'),!this.mediaKeysPromise){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var r=function(s){!t._media||(t._attemptSetMediaKeys(s),t._generateRequestWithPreferredKeySession(i.initDataType,i.initData))};this.mediaKeysPromise.then(r).catch(r)},v._attemptSetMediaKeys=function(i){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}m.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},v._generateRequestWithPreferredKeySession=function(i,t){var r=this,e=this._mediaKeysList[0];if(!e){m.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(e.mediaKeysSessionInitialized){m.logger.warn("Key-Session already initialized but requested again");return}var s=e.mediaKeysSession;if(!s){m.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!t){m.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}m.logger.log('Generating key-session request for "'+i+'" init data type'),e.mediaKeysSessionInitialized=!0,s.generateRequest(i,t).then(function(){m.logger.debug("Key-session generation succeeded")}).catch(function(o){m.logger.error("Error generating key-session request:",o),r.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},v._createLicenseXhr=function(i,t,r){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,e,i,t,r);var s=this._licenseXhrSetup;if(s)try{s.call(this.hls,e,i),s=void 0}catch(o){m.logger.error(o)}try{e.readyState||e.open("POST",i,!0),s&&s.call(this.hls,e,i)}catch(o){throw new Error("issue setting up KeySystem license XHR "+o)}return e},v._onLicenseRequestReadyStageChange=function(i,t,r,e){switch(i.readyState){case 4:if(i.status===200){this._requestLicenseFailureCount=0,m.logger.log("License request succeeded");var s=i.response,o=this._licenseResponseCallback;if(o)try{s=o.call(this.hls,i,t)}catch(g){m.logger.error(g)}e(s)}else{if(m.logger.error("License Request XHR failed ("+t+"). Status: "+i.status+" ("+i.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u){this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var a=u-this._requestLicenseFailureCount+1;m.logger.warn("Retrying license request, "+a+" attempts left"),this._requestLicense(r,e)}break}},v._generateLicenseRequestChallenge=function(i,t){switch(i.mediaKeySystemDomain){case M.KeySystems.WIDEVINE:return t}throw new Error("unsupported key-system: "+i.mediaKeySystemDomain)},v._requestLicense=function(i,t){m.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r){m.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var e=this.getLicenseServerUrl(r.mediaKeySystemDomain),s=this._createLicenseXhr(e,i,t);m.logger.log("Sending license request to URL: "+e);var o=this._generateLicenseRequestChallenge(r,i);s.send(o)}catch(a){m.logger.error("Failure requesting DRM license: "+a),this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},v.onMediaAttached=function(i,t){if(!!this._emeEnabled){var r=t.media;this._media=r,r.addEventListener("encrypted",this._onMediaEncrypted)}},v.onMediaDetached=function(){var i=this._media,t=this._mediaKeysList;!i||(i.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(r){if(r.mediaKeysSession)return r.mediaKeysSession.close().catch(function(){})})).then(function(){return i.setMediaKeys(null)}).catch(function(){}))},v.onManifestParsed=function(i,t){if(!!this._emeEnabled){var r=t.levels.map(function(s){return s.audioCodec}).filter(function(s){return!!s}),e=t.levels.map(function(s){return s.videoCodec}).filter(function(s){return!!s});this._attemptKeySystemAccess(M.KeySystems.WIDEVINE,r,e)}},p(c,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),c}();C.default=l},"./src/controller/fps-controller.ts":function(O,C,x){x.r(C);var T=x("./src/events.ts"),h=x("./src/utils/logger.ts"),m=function(){function M(p){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=p,this.registerListeners()}var S=M.prototype;return S.setStreamController=function(u){this.streamController=u},S.registerListeners=function(){this.hls.on(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},S.unregisterListeners=function(){this.hls.off(T.Events.MEDIA_ATTACHING,this.onMediaAttaching)},S.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},S.onMediaAttaching=function(u,n){var f=this.hls.config;if(f.capLevelOnFPSDrop){var l=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=l,l&&typeof l.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),f.fpsDroppedMonitoringPeriod)}},S.checkFPS=function(u,n,f){var l=performance.now();if(n){if(this.lastTime){var c=l-this.lastTime,v=f-this.lastDroppedFrames,d=n-this.lastDecodedFrames,i=1e3*v/c,t=this.hls;if(t.trigger(T.Events.FPS_DROP,{currentDropped:v,currentDecoded:d,totalDroppedFrames:f}),i>0&&v>t.config.fpsDroppedMonitoringThreshold*d){var r=t.currentLevel;h.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+r),r>0&&(t.autoLevelCapping===-1||t.autoLevelCapping>=r)&&(r=r-1,t.trigger(T.Events.FPS_DROP_LEVEL_CAPPING,{level:r,droppedLevel:t.currentLevel}),t.autoLevelCapping=r,this.streamController.nextLevelSwitch())}}this.lastTime=l,this.lastDroppedFrames=f,this.lastDecodedFrames=n}},S.checkFPSInterval=function(){var u=this.media;if(u)if(this.isVideoPlaybackQualityAvailable){var n=u.getVideoPlaybackQuality();this.checkFPS(u,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(u,u.webkitDecodedFrameCount,u.webkitDroppedFrameCount)},M}();C.default=m},"./src/controller/fragment-finders.ts":function(O,C,x){x.r(C),x.d(C,"findFragmentByPDT",function(){return m}),x.d(C,"findFragmentByPTS",function(){return M}),x.d(C,"fragmentWithinToleranceTest",function(){return S}),x.d(C,"pdtWithinToleranceTest",function(){return p}),x.d(C,"findFragWithCC",function(){return u});var T=x("./src/polyfills/number.ts"),h=x("./src/utils/binary-search.ts");function m(n,f,l){if(f===null||!Array.isArray(n)||!n.length||!Object(T.isFiniteNumber)(f))return null;var c=n[0].programDateTime;if(f<(c||0))return null;var v=n[n.length-1].endProgramDateTime;if(f>=(v||0))return null;l=l||0;for(var d=0;d<n.length;++d){var i=n[d];if(p(f,l,i))return i}return null}function M(n,f,l,c){l===void 0&&(l=0),c===void 0&&(c=0);var v=null;if(n?v=f[n.sn-f[0].sn+1]||null:l===0&&f[0].start===0&&(v=f[0]),v&&S(l,c,v)===0)return v;var d=h.default.search(f,S.bind(null,l,c));return d||v}function S(n,f,l){n===void 0&&(n=0),f===void 0&&(f=0);var c=Math.min(f,l.duration+(l.deltaPTS?l.deltaPTS:0));return l.start+l.duration-c<=n?1:l.start-c>n&&l.start?-1:0}function p(n,f,l){var c=Math.min(f,l.duration+(l.deltaPTS?l.deltaPTS:0))*1e3,v=l.endProgramDateTime||0;return v-c>n}function u(n,f){return h.default.search(n,function(l){return l.cc<f?1:l.cc>f?-1:0})}},"./src/controller/fragment-tracker.ts":function(O,C,x){x.r(C),x.d(C,"FragmentState",function(){return m}),x.d(C,"FragmentTracker",function(){return M});var T=x("./src/events.ts"),h=x("./src/types/loader.ts"),m;(function(u){u.NOT_LOADED="NOT_LOADED",u.BACKTRACKED="BACKTRACKED",u.APPENDING="APPENDING",u.PARTIAL="PARTIAL",u.OK="OK"})(m||(m={}));var M=function(){function u(f){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=f,this._registerListeners()}var n=u.prototype;return n._registerListeners=function(){var l=this.hls;l.on(T.Events.BUFFER_APPENDED,this.onBufferAppended,this),l.on(T.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.on(T.Events.FRAG_LOADED,this.onFragLoaded,this)},n._unregisterListeners=function(){var l=this.hls;l.off(T.Events.BUFFER_APPENDED,this.onBufferAppended,this),l.off(T.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.off(T.Events.FRAG_LOADED,this.onFragLoaded,this)},n.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},n.getAppendedFrag=function(l,c){if(c===h.PlaylistLevelType.MAIN){var v=this.activeFragment,d=this.activeParts;if(!v)return null;if(d)for(var i=d.length;i--;){var t=d[i],r=t?t.end:v.appendedPTS;if(t.start<=l&&r!==void 0&&l<=r)return i>9&&(this.activeParts=d.slice(i-9)),t}else if(v.start<=l&&v.appendedPTS!==void 0&&l<=v.appendedPTS)return v}return this.getBufferedFrag(l,c)},n.getBufferedFrag=function(l,c){for(var v=this.fragments,d=Object.keys(v),i=d.length;i--;){var t=v[d[i]];if((t==null?void 0:t.body.type)===c&&t.buffered){var r=t.body;if(r.start<=l&&l<=r.end)return r}}return null},n.detectEvictedFragments=function(l,c,v){var d=this;Object.keys(this.fragments).forEach(function(i){var t=d.fragments[i];if(!!t){if(!t.buffered){t.body.type===v&&d.removeFragment(t.body);return}var r=t.range[l];!r||r.time.some(function(e){var s=!d.isTimeBuffered(e.startPTS,e.endPTS,c);return s&&d.removeFragment(t.body),s})}})},n.detectPartialFragments=function(l){var c=this,v=this.timeRanges,d=l.frag,i=l.part;if(!(!v||d.sn==="initSegment")){var t=p(d),r=this.fragments[t];!r||(Object.keys(v).forEach(function(e){var s=d.elementaryStreams[e];if(!!s){var o=v[e],a=i!==null||s.partial===!0;r.range[e]=c.getBufferedTimes(d,i,a,o)}}),r.backtrack=r.loaded=null,Object.keys(r.range).length?r.buffered=!0:this.removeFragment(r.body))}},n.fragBuffered=function(l){var c=p(l),v=this.fragments[c];v&&(v.backtrack=v.loaded=null,v.buffered=!0)},n.getBufferedTimes=function(l,c,v,d){for(var i={time:[],partial:v},t=c?c.start:l.start,r=c?c.end:l.end,e=l.minEndPTS||r,s=l.maxStartPTS||t,o=0;o<d.length;o++){var a=d.start(o)-this.bufferPadding,g=d.end(o)+this.bufferPadding;if(s>=a&&e<=g){i.time.push({startPTS:Math.max(t,d.start(o)),endPTS:Math.min(r,d.end(o))});break}else if(t<g&&r>a)i.partial=!0,i.time.push({startPTS:Math.max(t,d.start(o)),endPTS:Math.min(r,d.end(o))});else if(r<=a)break}return i},n.getPartialFragment=function(l){var c=null,v,d,i,t=0,r=this.bufferPadding,e=this.fragments;return Object.keys(e).forEach(function(s){var o=e[s];!o||S(o)&&(d=o.body.start-r,i=o.body.end+r,l>=d&&l<=i&&(v=Math.min(l-d,i-l),t<=v&&(c=o.body,t=v)))}),c},n.getState=function(l){var c=p(l),v=this.fragments[c];return v?v.buffered?S(v)?m.PARTIAL:m.OK:v.backtrack?m.BACKTRACKED:m.APPENDING:m.NOT_LOADED},n.backtrack=function(l,c){var v=p(l),d=this.fragments[v];if(!d||d.backtrack)return null;var i=d.backtrack=c||d.loaded;return d.loaded=null,i},n.getBacktrackData=function(l){var c=p(l),v=this.fragments[c];if(v){var d,i=v.backtrack;if(i!=null&&(d=i.payload)!==null&&d!==void 0&&d.byteLength)return i;this.removeFragment(l)}return null},n.isTimeBuffered=function(l,c,v){for(var d,i,t=0;t<v.length;t++){if(d=v.start(t)-this.bufferPadding,i=v.end(t)+this.bufferPadding,l>=d&&c<=i)return!0;if(c<=d)return!1}return!1},n.onFragLoaded=function(l,c){var v=c.frag,d=c.part;if(!(v.sn==="initSegment"||v.bitrateTest||d)){var i=p(v);this.fragments[i]={body:v,loaded:c,backtrack:null,buffered:!1,range:Object.create(null)}}},n.onBufferAppended=function(l,c){var v=this,d=c.frag,i=c.part,t=c.timeRanges;if(d.type===h.PlaylistLevelType.MAIN)if(this.activeFragment=d,i){var r=this.activeParts;r||(this.activeParts=r=[]),r.push(i)}else this.activeParts=null;this.timeRanges=t,Object.keys(t).forEach(function(e){var s=t[e];if(v.detectEvictedFragments(e,s),!i)for(var o=0;o<s.length;o++)d.appendedPTS=Math.max(s.end(o),d.appendedPTS||0)})},n.onFragBuffered=function(l,c){this.detectPartialFragments(c)},n.hasFragment=function(l){var c=p(l);return!!this.fragments[c]},n.removeFragmentsInRange=function(l,c,v){var d=this;Object.keys(this.fragments).forEach(function(i){var t=d.fragments[i];if(!!t&&t.buffered){var r=t.body;r.type===v&&r.start<c&&r.end>l&&d.removeFragment(r)}})},n.removeFragment=function(l){var c=p(l);l.stats.loaded=0,l.clearElementaryStreamInfo(),delete this.fragments[c]},n.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},u}();function S(u){var n,f;return u.buffered&&(((n=u.range.video)===null||n===void 0?void 0:n.partial)||((f=u.range.audio)===null||f===void 0?void 0:f.partial))}function p(u){return u.type+"_"+u.level+"_"+u.urlId+"_"+u.sn}},"./src/controller/gap-controller.ts":function(O,C,x){x.r(C),x.d(C,"STALL_MINIMUM_DURATION_MS",function(){return S}),x.d(C,"MAX_START_GAP_JUMP",function(){return p}),x.d(C,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return u}),x.d(C,"SKIP_BUFFER_RANGE_START",function(){return n}),x.d(C,"default",function(){return f});var T=x("./src/utils/buffer-helper.ts"),h=x("./src/errors.ts"),m=x("./src/events.ts"),M=x("./src/utils/logger.ts"),S=250,p=2,u=.1,n=.05,f=function(){function l(v,d,i,t){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=v,this.media=d,this.fragmentTracker=i,this.hls=t}var c=l.prototype;return c.destroy=function(){this.hls=this.fragmentTracker=this.media=null},c.poll=function(d){var i=this.config,t=this.media,r=this.stalled,e=t.currentTime,s=t.seeking,o=this.seeking&&!s,a=!this.seeking&&s;if(this.seeking=s,e!==d){if(this.moved=!0,r!==null){if(this.stallReported){var g=self.performance.now()-r;M.logger.warn("playback not stuck anymore @"+e+", after "+Math.round(g)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((a||o)&&(this.stalled=null),!(t.paused||t.ended||t.playbackRate===0||!T.BufferHelper.getBuffered(t).length)){var A=T.BufferHelper.bufferInfo(t,e,0),D=A.len>0,y=A.nextStart||0;if(!(!D&&!y)){if(s){var E=A.len>p,_=!y||y-e>p&&!this.fragmentTracker.getPartialFragment(e);if(E||_)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var L,I=Math.max(y,A.start||0)-e,b=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,R=b==null||(L=b.details)===null||L===void 0?void 0:L.live,P=R?b.details.targetduration*2:p;if(I>0&&I<=P){this._trySkipBufferHole(null);return}}var w=self.performance.now();if(r===null){this.stalled=w;return}var F=w-r;!s&&F>=S&&this._reportStall(A.len);var k=T.BufferHelper.bufferInfo(t,e,i.maxBufferHole);this._tryFixBufferStall(k,F)}}},c._tryFixBufferStall=function(d,i){var t=this.config,r=this.fragmentTracker,e=this.media,s=e.currentTime,o=r.getPartialFragment(s);if(o){var a=this._trySkipBufferHole(o);if(a)return}d.len>t.maxBufferHole&&i>t.highBufferWatchdogPeriod*1e3&&(M.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},c._reportStall=function(d){var i=this.hls,t=this.media,r=this.stallReported;r||(this.stallReported=!0,M.logger.warn("Playback stalling at @"+t.currentTime+" due to low buffer (buffer="+d+")"),i.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:d}))},c._trySkipBufferHole=function(d){for(var i=this.config,t=this.hls,r=this.media,e=r.currentTime,s=0,o=T.BufferHelper.getBuffered(r),a=0;a<o.length;a++){var g=o.start(a);if(e+i.maxBufferHole>=s&&e<g){var A=Math.max(g+n,r.currentTime+u);return M.logger.warn("skipping hole, adjusting currentTime from "+e+" to "+A),this.moved=!0,this.stalled=null,r.currentTime=A,d&&t.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+e+" to "+A,frag:d}),A}s=o.end(a)}return 0},c._tryNudgeBuffer=function(){var d=this.config,i=this.hls,t=this.media,r=t.currentTime,e=(this.nudgeRetry||0)+1;if(this.nudgeRetry=e,e<d.nudgeMaxRetry){var s=r+e*d.nudgeOffset;M.logger.warn("Nudging 'currentTime' from "+r+" to "+s),t.currentTime=s,i.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else M.logger.error("Playhead still not moving while enough data buffered @"+r+" after "+d.nudgeMaxRetry+" nudges"),i.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},l}()},"./src/controller/id3-track-controller.ts":function(O,C,x){x.r(C);var T=x("./src/events.ts"),h=x("./src/utils/texttrack-utils.ts"),m=x("./src/demux/id3.ts"),M=.25,S=function(){function p(n){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=n,this._registerListeners()}var u=p.prototype;return u.destroy=function(){this._unregisterListeners()},u._registerListeners=function(){var f=this.hls;f.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(T.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.on(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u._unregisterListeners=function(){var f=this.hls;f.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(T.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.off(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u.onMediaAttached=function(f,l){this.media=l.media},u.onMediaDetaching=function(){!this.id3Track||(Object(h.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},u.getID3Track=function(f){if(!!this.media){for(var l=0;l<f.length;l++){var c=f[l];if(c.kind==="metadata"&&c.label==="id3")return Object(h.sendAddTrackEvent)(c,this.media),c}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(f,l){if(!!this.media){var c=l.frag,v=l.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var d=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,i=0;i<v.length;i++){var t=m.getID3Frames(v[i].data);if(t){var r=v[i].pts,e=i<v.length-1?v[i+1].pts:c.end,s=e-r;s<=0&&(e=r+M);for(var o=0;o<t.length;o++){var a=t[o];if(!m.isTimeStampFrame(a)){var g=new d(r,e,"");g.value=a,this.id3Track.addCue(g)}}}}}},u.onBufferFlushing=function(f,l){var c=l.startOffset,v=l.endOffset,d=l.type;if(!d||d==="audio"){var i=this.id3Track;i&&Object(h.removeCuesInRange)(i,c,v)}},p}();C.default=S},"./src/controller/latency-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return p});var T=x("./src/errors.ts"),h=x("./src/events.ts"),m=x("./src/utils/logger.ts");function M(u,n){for(var f=0;f<n.length;f++){var l=n[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}function S(u,n,f){return n&&M(u.prototype,n),f&&M(u,f),u}var p=function(){function u(f){var l=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return l.timeupdate()},this.hls=f,this.config=f.config,this.registerListeners()}var n=u.prototype;return n.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},n.registerListeners=function(){this.hls.on(h.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(h.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(h.Events.ERROR,this.onError,this)},n.unregisterListeners=function(){this.hls.off(h.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(h.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(h.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(h.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(h.Events.ERROR,this.onError)},n.onMediaAttached=function(l,c){this.media=c.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},n.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},n.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},n.onLevelUpdated=function(l,c){var v=c.details;this.levelDetails=v,v.advanced&&this.timeupdate(),!v.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},n.onError=function(l,c){c.details===T.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,m.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},n.timeupdate=function(){var l=this.media,c=this.levelDetails;if(!(!l||!c)){this.currentTime=l.currentTime;var v=this.computeLatency();if(v!==null){this._latency=v;var d=this.config,i=d.lowLatencyMode,t=d.maxLiveSyncPlaybackRate;if(!(!i||t===1)){var r=this.targetLatency;if(r!==null){var e=v-r,s=Math.min(this.maxLatency,r+c.targetduration),o=e<s;if(c.live&&o&&e>.05&&this.forwardBufferLength>1){var a=Math.min(2,Math.max(1,t)),g=Math.round(2/(1+Math.exp(-.75*e-this.edgeStalled))*20)/20;l.playbackRate=Math.min(a,Math.max(1,g))}else l.playbackRate!==1&&l.playbackRate!==0&&(l.playbackRate=1)}}}}},n.estimateLiveEdge=function(){var l=this.levelDetails;return l===null?null:l.edge+l.age},n.computeLatency=function(){var l=this.estimateLiveEdge();return l===null?null:l-this.currentTime},S(u,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var l=this.config,c=this.levelDetails;return l.liveMaxLatencyDuration!==void 0?l.liveMaxLatencyDuration:c?l.liveMaxLatencyDurationCount*c.targetduration:0}},{key:"targetLatency",get:function(){var l=this.levelDetails;if(l===null)return null;var c=l.holdBack,v=l.partHoldBack,d=l.targetduration,i=this.config,t=i.liveSyncDuration,r=i.liveSyncDurationCount,e=i.lowLatencyMode,s=this.hls.userConfig,o=e&&v||c;(s.liveSyncDuration||s.liveSyncDurationCount||o===0)&&(o=t!==void 0?t:r*d);var a=d,g=1;return o+Math.min(this.stallCount*g,a)}},{key:"liveSyncPosition",get:function(){var l=this.estimateLiveEdge(),c=this.targetLatency,v=this.levelDetails;if(l===null||c===null||v===null)return null;var d=v.edge,i=l-c-this.edgeStalled,t=d-v.totalduration,r=d-(this.config.lowLatencyMode&&v.partTarget||v.targetduration);return Math.min(Math.max(t,i),r)}},{key:"drift",get:function(){var l=this.levelDetails;return l===null?1:l.drift}},{key:"edgeStalled",get:function(){var l=this.levelDetails;if(l===null)return 0;var c=(this.config.lowLatencyMode&&l.partTarget||l.targetduration)*3;return Math.max(l.age-c,0)}},{key:"forwardBufferLength",get:function(){var l=this.media,c=this.levelDetails;if(!l||!c)return 0;var v=l.buffered.length;return v?l.buffered.end(v-1):c.edge-this.currentTime}}]),u}()},"./src/controller/level-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return i});var T=x("./src/types/level.ts"),h=x("./src/events.ts"),m=x("./src/errors.ts"),M=x("./src/utils/codecs.ts"),S=x("./src/controller/level-helper.ts"),p=x("./src/controller/base-playlist-controller.ts"),u=x("./src/types/loader.ts");function n(){return n=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},n.apply(this,arguments)}function f(t,r){for(var e=0;e<r.length;e++){var s=r[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function l(t,r,e){return r&&f(t.prototype,r),e&&f(t,e),t}function c(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,v(t,r)}function v(t,r){return v=Object.setPrototypeOf||function(s,o){return s.__proto__=o,s},v(t,r)}var d=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i=function(t){c(r,t);function r(s){var o;return o=t.call(this,s,"[level-controller]")||this,o._levels=[],o._firstLevel=-1,o._startLevel=void 0,o.currentLevelIndex=-1,o.manualLevelIndex=-1,o.onParsedComplete=void 0,o._registerListeners(),o}var e=r.prototype;return e._registerListeners=function(){var o=this.hls;o.on(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(h.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(h.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(h.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(h.Events.ERROR,this.onError,this)},e._unregisterListeners=function(){var o=this.hls;o.off(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(h.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(h.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(h.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(h.Events.ERROR,this.onError,this)},e.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,t.prototype.destroy.call(this)},e.startLoad=function(){var o=this._levels;o.forEach(function(a){a.loadError=0}),t.prototype.startLoad.call(this)},e.onManifestLoaded=function(o,a){var g=[],A=[],D=[],y,E={},_,L=!1,I=!1,b=!1;if(a.levels.forEach(function(F){var k=F.attrs;L=L||!!(F.width&&F.height),I=I||!!F.videoCodec,b=b||!!F.audioCodec,d&&F.audioCodec&&F.audioCodec.indexOf("mp4a.40.34")!==-1&&(F.audioCodec=void 0);var B=F.bitrate+"-"+F.attrs.RESOLUTION+"-"+F.attrs.CODECS;_=E[B],_?_.url.push(F.url):(_=new T.Level(F),E[B]=_,g.push(_)),k&&(k.AUDIO&&Object(S.addGroupId)(_,"audio",k.AUDIO),k.SUBTITLES&&Object(S.addGroupId)(_,"text",k.SUBTITLES))}),(L||I)&&b&&(g=g.filter(function(F){var k=F.videoCodec,B=F.width,U=F.height;return!!k||!!(B&&U)})),g=g.filter(function(F){var k=F.audioCodec,B=F.videoCodec;return(!k||Object(M.isCodecSupportedInMp4)(k,"audio"))&&(!B||Object(M.isCodecSupportedInMp4)(B,"video"))}),a.audioTracks&&(A=a.audioTracks.filter(function(F){return!F.audioCodec||Object(M.isCodecSupportedInMp4)(F.audioCodec,"audio")}),Object(S.assignTrackIdsByGroup)(A)),a.subtitles&&(D=a.subtitles,Object(S.assignTrackIdsByGroup)(D)),g.length>0){y=g[0].bitrate,g.sort(function(F,k){return F.bitrate-k.bitrate}),this._levels=g;for(var R=0;R<g.length;R++)if(g[R].bitrate===y){this._firstLevel=R,this.log("manifest loaded, "+g.length+" level(s) found, first bitrate: "+y);break}var P=b&&!I,w={levels:g,audioTracks:A,subtitleTracks:D,firstLevel:this._firstLevel,stats:a.stats,audio:b,video:I,altAudio:!P&&A.some(function(F){return!!F.url})};this.hls.trigger(h.Events.MANIFEST_PARSED,w),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(h.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:a.url,reason:"no level with compatible codecs found in manifest"})},e.onError=function(o,a){if(t.prototype.onError.call(this,o,a),!a.fatal){var g=a.context,A=this._levels[this.currentLevelIndex];if(g&&(g.type===u.PlaylistContextType.AUDIO_TRACK&&A.audioGroupIds&&g.groupId===A.audioGroupIds[A.urlId]||g.type===u.PlaylistContextType.SUBTITLE_TRACK&&A.textGroupIds&&g.groupId===A.textGroupIds[A.urlId])){this.redundantFailover(this.currentLevelIndex);return}var D=!1,y=!0,E;switch(a.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:if(a.frag){var _=this._levels[a.frag.level];_?(_.fragmentError++,_.fragmentError>this.hls.config.fragLoadingMaxRetry&&(E=a.frag.level)):E=a.frag.level}break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:g&&(g.deliveryDirectives&&(y=!1),E=g.level),D=!0;break;case m.ErrorDetails.REMUX_ALLOC_ERROR:E=a.level,D=!0;break}E!==void 0&&this.recoverLevel(a,E,D,y)}},e.recoverLevel=function(o,a,g,A){var D=o.details,y=this._levels[a];if(y.loadError++,g){var E=this.retryLoadingOrFail(o);if(E)o.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(A){var _=y.url.length;if(_>1&&y.loadError<_)o.levelRetry=!0,this.redundantFailover(a);else if(this.manualLevelIndex===-1){var L=a===0?this._levels.length-1:a-1;this.currentLevelIndex!==L&&this._levels[L].loadError===0&&(this.warn(D+": switch to "+L),o.levelRetry=!0,this.hls.nextAutoLevel=L)}}},e.redundantFailover=function(o){var a=this._levels[o],g=a.url.length;if(g>1){var A=(a.urlId+1)%g;this.warn("Switching to redundant URL-id "+A),this._levels.forEach(function(D){D.urlId=A}),this.level=o}},e.onFragLoaded=function(o,a){var g=a.frag;if(g!==void 0&&g.type===u.PlaylistLevelType.MAIN){var A=this._levels[g.level];A!==void 0&&(A.fragmentError=0,A.loadError=0)}},e.onLevelLoaded=function(o,a){var g,A=a.level,D=a.details,y=this._levels[A];if(!y){var E;this.warn("Invalid level index "+A),(E=a.deliveryDirectives)!==null&&E!==void 0&&E.skip&&(D.deltaUpdateFailed=!0);return}A===this.currentLevelIndex?(y.fragmentError===0&&(y.loadError=0,this.retryCount=0),this.playlistLoaded(A,a,y.details)):(g=a.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(D.deltaUpdateFailed=!0)},e.onAudioTrackSwitched=function(o,a){var g=this.hls.levels[this.currentLevelIndex];if(!!g&&g.audioGroupIds){for(var A=-1,D=this.hls.audioTracks[a.id].groupId,y=0;y<g.audioGroupIds.length;y++)if(g.audioGroupIds[y]===D){A=y;break}A!==g.urlId&&(g.urlId=A,this.startLoad())}},e.loadPlaylist=function(o){var a=this.currentLevelIndex,g=this._levels[a];if(this.canLoad&&g&&g.url.length>0){var A=g.urlId,D=g.url[A];if(o)try{D=o.addDirectives(D)}catch(y){this.warn("Could not construct new URL with HLS Delivery Directives: "+y)}this.log("Attempt loading level index "+a+(o?" at sn "+o.msn+" part "+o.part:"")+" with URL-id "+A+" "+D),this.clearTimer(),this.hls.trigger(h.Events.LEVEL_LOADING,{url:D,level:a,id:A,deliveryDirectives:o||null})}},e.removeLevel=function(o,a){var g=function(y,E){return E!==a},A=this._levels.filter(function(D,y){return y!==o?!0:D.url.length>1&&a!==void 0?(D.url=D.url.filter(g),D.audioGroupIds&&(D.audioGroupIds=D.audioGroupIds.filter(g)),D.textGroupIds&&(D.textGroupIds=D.textGroupIds.filter(g)),D.urlId=0,!0):!1}).map(function(D,y){var E=D.details;return E!=null&&E.fragments&&E.fragments.forEach(function(_){_.level=y}),D});this._levels=A,this.hls.trigger(h.Events.LEVELS_UPDATED,{levels:A})},l(r,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(o){var a,g=this._levels;if(g.length!==0&&!(this.currentLevelIndex===o&&(a=g[o])!==null&&a!==void 0&&a.details)){if(o<0||o>=g.length){var A=o<0;if(this.hls.trigger(h.Events.ERROR,{type:m.ErrorTypes.OTHER_ERROR,details:m.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:A,reason:"invalid level idx"}),A)return;o=Math.min(o,g.length-1)}this.clearTimer();var D=this.currentLevelIndex,y=g[D],E=g[o];this.log("switching to level "+o+" from "+D),this.currentLevelIndex=o;var _=n({},E,{level:o,maxBitrate:E.maxBitrate,uri:E.uri,urlId:E.urlId});delete _._urlId,this.hls.trigger(h.Events.LEVEL_SWITCHING,_);var L=E.details;if(!L||L.live){var I=this.switchParams(E.uri,y==null?void 0:y.details);this.loadPlaylist(I)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(o){this.manualLevelIndex=o,this._startLevel===void 0&&(this._startLevel=o),o!==-1&&(this.level=o)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(o){this._firstLevel=o}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var o=this.hls.config.startLevel;return o!==void 0?o:this._firstLevel}else return this._startLevel},set:function(o){this._startLevel=o}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(o){this.level=o,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=o)}}]),r}(p.default)},"./src/controller/level-helper.ts":function(O,C,x){x.r(C),x.d(C,"addGroupId",function(){return m}),x.d(C,"assignTrackIdsByGroup",function(){return M}),x.d(C,"updatePTS",function(){return S}),x.d(C,"updateFragPTSDTS",function(){return u}),x.d(C,"mergeDetails",function(){return n}),x.d(C,"mapPartIntersection",function(){return f}),x.d(C,"mapFragmentIntersection",function(){return l}),x.d(C,"adjustSliding",function(){return c}),x.d(C,"addSliding",function(){return v}),x.d(C,"computeReloadInterval",function(){return d}),x.d(C,"getFragmentWithSN",function(){return i}),x.d(C,"getPartWith",function(){return t});var T=x("./src/polyfills/number.ts"),h=x("./src/utils/logger.ts");function m(r,e,s){switch(e){case"audio":r.audioGroupIds||(r.audioGroupIds=[]),r.audioGroupIds.push(s);break;case"text":r.textGroupIds||(r.textGroupIds=[]),r.textGroupIds.push(s);break}}function M(r){var e={};r.forEach(function(s){var o=s.groupId||"";s.id=e[o]=e[o]||0,e[o]++})}function S(r,e,s){var o=r[e],a=r[s];p(o,a)}function p(r,e){var s=e.startPTS;if(Object(T.isFiniteNumber)(s)){var o=0,a;e.sn>r.sn?(o=s-r.start,a=r):(o=r.start-s,a=e),a.duration!==o&&(a.duration=o)}else if(e.sn>r.sn){var g=r.cc===e.cc;g&&r.minEndPTS?e.start=r.start+(r.minEndPTS-r.start):e.start=r.start+r.duration}else e.start=Math.max(r.start-e.duration,0)}function u(r,e,s,o,a,g){var A=o-s;A<=0&&(h.logger.warn("Fragment should have a positive duration",e),o=s+e.duration,g=a+e.duration);var D=s,y=o,E=e.startPTS,_=e.endPTS;if(Object(T.isFiniteNumber)(E)){var L=Math.abs(E-s);Object(T.isFiniteNumber)(e.deltaPTS)?e.deltaPTS=Math.max(L,e.deltaPTS):e.deltaPTS=L,D=Math.max(s,E),s=Math.min(s,E),a=Math.min(a,e.startDTS),y=Math.min(o,_),o=Math.max(o,_),g=Math.max(g,e.endDTS)}e.duration=o-s;var I=s-e.start;e.appendedPTS=o,e.start=e.startPTS=s,e.maxStartPTS=D,e.startDTS=a,e.endPTS=o,e.minEndPTS=y,e.endDTS=g;var b=e.sn;if(!r||b<r.startSN||b>r.endSN)return 0;var R,P=b-r.startSN,w=r.fragments;for(w[P]=e,R=P;R>0;R--)p(w[R],w[R-1]);for(R=P;R<w.length-1;R++)p(w[R],w[R+1]);return r.fragmentHint&&p(w[w.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,I}function n(r,e){for(var s=null,o=r.fragments,a=o.length-1;a>=0;a--){var g=o[a].initSegment;if(g){s=g;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;var A=0,D;if(l(r,e,function(R,P){R.relurl&&(A=R.cc-P.cc),Object(T.isFiniteNumber)(R.startPTS)&&Object(T.isFiniteNumber)(R.endPTS)&&(P.start=P.startPTS=R.startPTS,P.startDTS=R.startDTS,P.appendedPTS=R.appendedPTS,P.maxStartPTS=R.maxStartPTS,P.endPTS=R.endPTS,P.endDTS=R.endDTS,P.minEndPTS=R.minEndPTS,P.duration=R.endPTS-R.startPTS,P.duration&&(D=P),e.PTSKnown=e.alignedSliding=!0),P.elementaryStreams=R.elementaryStreams,P.loader=R.loader,P.stats=R.stats,P.urlId=R.urlId,R.initSegment&&(P.initSegment=R.initSegment,s=R.initSegment)}),s){var y=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;y.forEach(function(R){var P;(!R.initSegment||R.initSegment.relurl===((P=s)===null||P===void 0?void 0:P.relurl))&&(R.initSegment=s)})}if(e.skippedSegments&&(e.deltaUpdateFailed=e.fragments.some(function(R){return!R}),e.deltaUpdateFailed)){h.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var E=e.skippedSegments;E--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}var _=e.fragments;if(A){h.logger.warn("discontinuity sliding from playlist, take drift into account");for(var L=0;L<_.length;L++)_[L].cc+=A}e.skippedSegments&&(e.startCC=e.fragments[0].cc),f(r.partList,e.partList,function(R,P){P.elementaryStreams=R.elementaryStreams,P.stats=R.stats}),D?u(e,D,D.startPTS,D.endPTS,D.startDTS,D.endDTS):c(r,e),_.length&&(e.totalduration=e.edge-_[0].start),e.driftStartTime=r.driftStartTime,e.driftStart=r.driftStart;var I=e.advancedDateTime;if(e.advanced&&I){var b=e.edge;e.driftStart||(e.driftStartTime=I,e.driftStart=b),e.driftEndTime=I,e.driftEnd=b}else e.driftEndTime=r.driftEndTime,e.driftEnd=r.driftEnd,e.advancedDateTime=r.advancedDateTime}function f(r,e,s){if(r&&e)for(var o=0,a=0,g=r.length;a<=g;a++){var A=r[a],D=e[a+o];A&&D&&A.index===D.index&&A.fragment.sn===D.fragment.sn?s(A,D):o--}}function l(r,e,s){for(var o=e.skippedSegments,a=Math.max(r.startSN,e.startSN)-e.startSN,g=(r.fragmentHint?1:0)+(o?e.endSN:Math.min(r.endSN,e.endSN))-e.startSN,A=e.startSN-r.startSN,D=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,y=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments,E=a;E<=g;E++){var _=y[A+E],L=D[E];o&&!L&&E<o&&(L=e.fragments[E]=_),_&&L&&s(_,L)}}function c(r,e){var s=e.startSN+e.skippedSegments-r.startSN,o=r.fragments;s<0||s>=o.length||v(e,o[s].start)}function v(r,e){if(e){for(var s=r.fragments,o=r.skippedSegments;o<s.length;o++)s[o].start+=e;r.fragmentHint&&(r.fragmentHint.start+=e)}}function d(r,e){var s=1e3*r.levelTargetDuration,o=s/2,a=r.age,g=a>0&&a<s*3,A=e.loading.end-e.loading.start,D,y=r.availabilityDelay;if(r.updated===!1)if(g){var E=333*r.misses;D=Math.max(Math.min(o,A*2),E),r.availabilityDelay=(r.availabilityDelay||0)+D}else D=o;else g?(y=Math.min(y||s/2,a),r.availabilityDelay=y,D=y+s-a):D=s-A;return Math.round(D)}function i(r,e,s){if(!r||!r.details)return null;var o=r.details,a=o.fragments[e-o.startSN];return a||(a=o.fragmentHint,a&&a.sn===e)?a:e<o.startSN&&s&&s.sn===e?s:null}function t(r,e,s){if(!r||!r.details)return null;var o=r.details.partList;if(o)for(var a=o.length;a--;){var g=o[a];if(g.index===s&&g.fragment.sn===e)return g}return null}},"./src/controller/stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return o});var T=x("./src/polyfills/number.ts"),h=x("./src/controller/base-stream-controller.ts"),m=x("./src/is-supported.ts"),M=x("./src/events.ts"),S=x("./src/utils/buffer-helper.ts"),p=x("./src/controller/fragment-tracker.ts"),u=x("./src/types/loader.ts"),n=x("./src/loader/fragment.ts"),f=x("./src/demux/transmuxer-interface.ts"),l=x("./src/types/transmuxer.ts"),c=x("./src/controller/gap-controller.ts"),v=x("./src/errors.ts"),d=x("./src/utils/logger.ts");function i(a,g){for(var A=0;A<g.length;A++){var D=g[A];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(a,D.key,D)}}function t(a,g,A){return g&&i(a.prototype,g),A&&i(a,A),a}function r(a,g){a.prototype=Object.create(g.prototype),a.prototype.constructor=a,e(a,g)}function e(a,g){return e=Object.setPrototypeOf||function(D,y){return D.__proto__=y,D},e(a,g)}var s=100,o=function(a){r(g,a);function g(D,y){var E;return E=a.call(this,D,y,"[stream-controller]")||this,E.audioCodecSwap=!1,E.gapController=null,E.level=-1,E._forceStartLoad=!1,E.altAudio=!1,E.audioOnly=!1,E.fragPlaying=null,E.onvplaying=null,E.onvseeked=null,E.fragLastKbps=0,E.stalled=!1,E.couldBacktrack=!1,E.audioCodecSwitch=!1,E.videoBuffer=null,E._registerListeners(),E}var A=g.prototype;return A._registerListeners=function(){var y=this.hls;y.on(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),y.on(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.on(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.on(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.on(M.Events.LEVEL_LOADING,this.onLevelLoading,this),y.on(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.on(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),y.on(M.Events.ERROR,this.onError,this),y.on(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),y.on(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),y.on(M.Events.BUFFER_CREATED,this.onBufferCreated,this),y.on(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),y.on(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),y.on(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A._unregisterListeners=function(){var y=this.hls;y.off(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),y.off(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.off(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.off(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.off(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.off(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),y.off(M.Events.ERROR,this.onError,this),y.off(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),y.off(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),y.off(M.Events.BUFFER_CREATED,this.onBufferCreated,this),y.off(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),y.off(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),y.off(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},A.startLoad=function(y){if(this.levels){var E=this.lastCurrentTime,_=this.hls;if(this.stopLoad(),this.setInterval(s),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var L=_.startLevel;L===-1&&(_.config.testBandwidth?(L=0,this.bitrateTest=!0):L=_.nextAutoLevel),this.level=_.nextLoadLevel=L,this.loadedmetadata=!1}E>0&&y===-1&&(this.log("Override startPosition with lastCurrentTime @"+E.toFixed(3)),y=E),this.state=h.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=y,this.tick()}else this._forceStartLoad=!0,this.state=h.State.STOPPED},A.stopLoad=function(){this._forceStartLoad=!1,a.prototype.stopLoad.call(this)},A.doTick=function(){switch(this.state){case h.State.IDLE:this.doTickIdle();break;case h.State.WAITING_LEVEL:{var y,E=this.levels,_=this.level,L=E==null||(y=E[_])===null||y===void 0?void 0:y.details;if(L&&(!L.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(L))break;this.state=h.State.IDLE;break}break}case h.State.FRAG_LOADING_WAITING_RETRY:{var I,b=self.performance.now(),R=this.retryDate;(!R||b>=R||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=h.State.IDLE)}break}this.onTickEnd()},A.onTickEnd=function(){a.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},A.doTickIdle=function(){var y,E,_=this.hls,L=this.levelLastLoaded,I=this.levels,b=this.media,R=_.config,P=_.nextLoadLevel;if(!(L===null||!b&&(this.startFragRequested||!R.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!I||!I[P])){var w=I[P];this.level=_.nextLoadLevel=P;var F=w.details;if(!F||this.state===h.State.WAITING_LEVEL||F.live&&this.levelLastLoaded!==P){this.state=h.State.WAITING_LEVEL;return}var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:b,u.PlaylistLevelType.MAIN);if(k!==null){var B=k.len,U=this.getMaxBufferLength(w.maxBitrate);if(!(B>=U)){if(this._streamEnded(k,F)){var j={};this.altAudio&&(j.type="video"),this.hls.trigger(M.Events.BUFFER_EOS,j),this.state=h.State.ENDED;return}var K=k.end,N=this.getNextFragment(K,F);if(this.couldBacktrack&&!this.fragPrevious&&N&&N.sn!=="initSegment"){var Z=N.sn-F.startSN;Z>1&&(N=F.fragments[Z-1],this.fragmentTracker.removeFragment(N))}if(N&&this.fragmentTracker.getState(N)===p.FragmentState.OK&&this.nextLoadPosition>K){var $=this.audioOnly&&!this.altAudio?n.ElementaryStreamTypes.AUDIO:n.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(b,$,u.PlaylistLevelType.MAIN),N=this.getNextFragment(this.nextLoadPosition,F)}!N||(N.initSegment&&!N.initSegment.data&&!this.bitrateTest&&(N=N.initSegment),((y=N.decryptdata)===null||y===void 0?void 0:y.keyFormat)==="identity"&&!((E=N.decryptdata)!==null&&E!==void 0&&E.key)?this.loadKey(N,F):this.loadFragment(N,F,K))}}}},A.loadFragment=function(y,E,_){var L,I=this.fragmentTracker.getState(y);if(this.fragCurrent=y,I===p.FragmentState.BACKTRACKED){var b=this.fragmentTracker.getBacktrackData(y);if(b){this._handleFragmentLoadProgress(b),this._handleFragmentLoadComplete(b);return}else I=p.FragmentState.NOT_LOADED}I===p.FragmentState.NOT_LOADED||I===p.FragmentState.PARTIAL?y.sn==="initSegment"?this._loadInitSegment(y):this.bitrateTest?(y.bitrateTest=!0,this.log("Fragment "+y.sn+" of level "+y.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(y)):(this.startFragRequested=!0,a.prototype.loadFragment.call(this,y,E,_)):I===p.FragmentState.APPENDING?this.reduceMaxBufferLength(y.duration)&&this.fragmentTracker.removeFragment(y):((L=this.media)===null||L===void 0?void 0:L.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},A.getAppendedFrag=function(y){var E=this.fragmentTracker.getAppendedFrag(y,u.PlaylistLevelType.MAIN);return E&&"fragment"in E?E.fragment:E},A.getBufferedFrag=function(y){return this.fragmentTracker.getBufferedFrag(y,u.PlaylistLevelType.MAIN)},A.followingBufferedFrag=function(y){return y?this.getBufferedFrag(y.end+.5):null},A.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},A.nextLevelSwitch=function(){var y=this.levels,E=this.media;if(E!=null&&E.readyState){var _,L=this.getAppendedFrag(E.currentTime);if(L&&L.start>1&&this.flushMainBuffer(0,L.start-1),!E.paused&&y){var I=this.hls.nextLoadLevel,b=y[I],R=this.fragLastKbps;R&&this.fragCurrent?_=this.fragCurrent.duration*b.maxBitrate/(1e3*R)+1:_=0}else _=0;var P=this.getBufferedFrag(E.currentTime+_);if(P){var w=this.followingBufferedFrag(P);if(w){this.abortCurrentFrag();var F=w.maxStartPTS?w.maxStartPTS:w.start,k=w.duration,B=Math.max(P.end,F+Math.min(Math.max(k-this.config.maxFragLookUpTolerance,k*.5),k*.75));this.flushMainBuffer(B,Number.POSITIVE_INFINITY)}}}},A.abortCurrentFrag=function(){var y=this.fragCurrent;this.fragCurrent=null,y!=null&&y.loader&&y.loader.abort(),this.state===h.State.KEY_LOADING&&(this.state=h.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},A.flushMainBuffer=function(y,E){a.prototype.flushMainBuffer.call(this,y,E,this.altAudio?"video":null)},A.onMediaAttached=function(y,E){a.prototype.onMediaAttached.call(this,y,E);var _=E.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),_.addEventListener("playing",this.onvplaying),_.addEventListener("seeked",this.onvseeked),this.gapController=new c.default(this.config,_,this.fragmentTracker,this.hls)},A.onMediaDetaching=function(){var y=this.media;y&&(y.removeEventListener("playing",this.onvplaying),y.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),a.prototype.onMediaDetaching.call(this)},A.onMediaPlaying=function(){this.tick()},A.onMediaSeeked=function(){var y=this.media,E=y?y.currentTime:null;Object(T.isFiniteNumber)(E)&&this.log("Media seeked to "+E.toFixed(3)),this.tick()},A.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},A.onManifestParsed=function(y,E){var _=!1,L=!1,I;E.levels.forEach(function(b){I=b.audioCodec,I&&(I.indexOf("mp4a.40.2")!==-1&&(_=!0),I.indexOf("mp4a.40.5")!==-1&&(L=!0))}),this.audioCodecSwitch=_&&L&&!Object(m.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=E.levels,this.startFragRequested=!1},A.onLevelLoading=function(y,E){var _=this.levels;if(!(!_||this.state!==h.State.IDLE)){var L=_[E.level];(!L.details||L.details.live&&this.levelLastLoaded!==E.level||this.waitForCdnTuneIn(L.details))&&(this.state=h.State.WAITING_LEVEL)}},A.onLevelLoaded=function(y,E){var _,L=this.levels,I=E.level,b=E.details,R=b.totalduration;if(!L){this.warn("Levels were reset while loading level "+I);return}this.log("Level "+I+" loaded ["+b.startSN+","+b.endSN+"], cc ["+b.startCC+", "+b.endCC+"] duration:"+R);var P=this.fragCurrent;P&&(this.state===h.State.FRAG_LOADING||this.state===h.State.FRAG_LOADING_WAITING_RETRY)&&P.level!==E.level&&P.loader&&(this.state=h.State.IDLE,P.loader.abort());var w=L[I],F=0;if(b.live||(_=w.details)!==null&&_!==void 0&&_.live){if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed)return;F=this.alignPlaylists(b,w.details)}if(w.details=b,this.levelLastLoaded=I,this.hls.trigger(M.Events.LEVEL_UPDATED,{details:b,level:I}),this.state===h.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(b))return;this.state=h.State.IDLE}this.startFragRequested?b.live&&this.synchronizeToLiveEdge(b):this.setStartPosition(b,F),this.tick()},A._handleFragmentLoadProgress=function(y){var E,_=y.frag,L=y.part,I=y.payload,b=this.levels;if(!b){this.warn("Levels were reset while fragment load was in progress. Fragment "+_.sn+" of level "+_.level+" will not be buffered");return}var R=b[_.level],P=R.details;if(!P){this.warn("Dropping fragment "+_.sn+" of level "+_.level+" after level details were reset");return}var w=R.videoCodec,F=P.PTSKnown||!P.live,k=(E=_.initSegment)===null||E===void 0?void 0:E.data,B=this._getAudioCodec(R),U=this.transmuxer=this.transmuxer||new f.default(this.hls,u.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),j=L?L.index:-1,K=j!==-1,N=new l.ChunkMetadata(_.level,_.sn,_.stats.chunkCount,I.byteLength,j,K),Z=this.initPTS[_.cc];U.push(I,k,B,w,_,L,P.totalduration,F,N,Z)},A.onAudioTrackSwitching=function(y,E){var _=this.altAudio,L=!!E.url,I=E.id;if(!L){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var b=this.fragCurrent;b!=null&&b.loader&&(this.log("Switching to main audio track, cancel main fragment load"),b.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var R=this.hls;_&&R.trigger(M.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),R.trigger(M.Events.AUDIO_TRACK_SWITCHED,{id:I})}},A.onAudioTrackSwitched=function(y,E){var _=E.id,L=!!this.hls.audioTracks[_].url;if(L){var I=this.videoBuffer;I&&this.mediaBuffer!==I&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=I)}this.altAudio=L,this.tick()},A.onBufferCreated=function(y,E){var _=E.tracks,L,I,b=!1;for(var R in _){var P=_[R];if(P.id==="main"){if(I=R,L=P,R==="video"){var w=_[R];w&&(this.videoBuffer=w.buffer)}}else b=!0}b&&L?(this.log("Alternate track found, use "+I+".buffered to schedule main fragment loading"),this.mediaBuffer=L.buffer):this.mediaBuffer=this.media},A.onFragBuffered=function(y,E){var _=E.frag,L=E.part;if(!(_&&_.type!==u.PlaylistLevelType.MAIN)){if(this.fragContextChanged(_)){this.warn("Fragment "+_.sn+(L?" p: "+L.index:"")+" of level "+_.level+" finished buffering, but was aborted. state: "+this.state),this.state===h.State.PARSED&&(this.state=h.State.IDLE);return}var I=L?L.stats:_.stats;this.fragLastKbps=Math.round(8*I.total/(I.buffering.end-I.loading.first)),_.sn!=="initSegment"&&(this.fragPrevious=_),this.fragBufferedComplete(_,L)}},A.onError=function(y,E){switch(E.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:case v.ErrorDetails.KEY_LOAD_ERROR:case v.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.MAIN,E);break;case v.ErrorDetails.LEVEL_LOAD_ERROR:case v.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==h.State.ERROR&&(E.fatal?(this.warn(""+E.details),this.state=h.State.ERROR):!E.levelRetry&&this.state===h.State.WAITING_LEVEL&&(this.state=h.State.IDLE));break;case v.ErrorDetails.BUFFER_FULL_ERROR:if(E.parent==="main"&&(this.state===h.State.PARSING||this.state===h.State.PARSED)){var _=!0,L=this.getFwdBufferInfo(this.media,u.PlaylistLevelType.MAIN);L&&L.len>.5&&(_=!this.reduceMaxBufferLength(L.len)),_&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},A.checkBuffer=function(){var y=this.media,E=this.gapController;if(!(!y||!E||!y.readyState)){var _=S.BufferHelper.getBuffered(y);!this.loadedmetadata&&_.length?(this.loadedmetadata=!0,this.seekToStartPos()):E.poll(this.lastCurrentTime),this.lastCurrentTime=y.currentTime}},A.onFragLoadEmergencyAborted=function(){this.state=h.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},A.onBufferFlushed=function(y,E){var _=E.type;if(_!==n.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var L=(_===n.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(L,_,u.PlaylistLevelType.MAIN)}},A.onLevelsUpdated=function(y,E){this.levels=E.levels},A.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},A.seekToStartPos=function(){var y=this.media,E=y.currentTime,_=this.startPosition;if(_>=0&&E<_){if(y.seeking){d.logger.log("could not seek to "+_+", already seeking at "+E);return}var L=S.BufferHelper.getBuffered(y),I=L.length?L.start(0):0,b=I-_;b>0&&(b<this.config.maxBufferHole||b<this.config.maxFragLookUpTolerance)&&(d.logger.log("adjusting start position by "+b+" to match buffer start"),_+=b,this.startPosition=_),this.log("seek to target start position "+_+" from current time "+E),y.currentTime=_}},A._getAudioCodec=function(y){var E=this.config.defaultAudioCodec||y.audioCodec;return this.audioCodecSwap&&E&&(this.log("Swapping audio codec"),E.indexOf("mp4a.40.5")!==-1?E="mp4a.40.2":E="mp4a.40.5"),E},A._loadBitrateTestFrag=function(y){var E=this;this._doFragLoad(y).then(function(_){var L=E.hls;if(!(!_||L.nextLoadLevel||E.fragContextChanged(y))){E.fragLoadError=0,E.state=h.State.IDLE,E.startFragRequested=!1,E.bitrateTest=!1;var I=y.stats;I.parsing.start=I.parsing.end=I.buffering.start=I.buffering.end=self.performance.now(),L.trigger(M.Events.FRAG_LOADED,_)}})},A._handleTransmuxComplete=function(y){var E,_="main",L=this.hls,I=y.remuxResult,b=y.chunkMeta,R=this.getCurrentContext(b);if(!R){this.warn("The loading context changed while buffering fragment "+b.sn+" of level "+b.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(b.level);return}var P=R.frag,w=R.part,F=R.level,k=I.video,B=I.text,U=I.id3,j=I.initSegment,K=this.altAudio?void 0:I.audio;if(!this.fragContextChanged(P)){if(this.state=h.State.PARSING,j){j.tracks&&(this._bufferInitSegment(F,j.tracks,P,b),L.trigger(M.Events.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:_,tracks:j.tracks}));var N=j.initPTS,Z=j.timescale;Object(T.isFiniteNumber)(N)&&(this.initPTS[P.cc]=N,L.trigger(M.Events.INIT_PTS_FOUND,{frag:P,id:_,initPTS:N,timescale:Z}))}if(k&&I.independent!==!1){if(F.details){var $=k.startPTS,Y=k.endPTS,ee=k.startDTS,Q=k.endDTS;if(w)w.elementaryStreams[k.type]={startPTS:$,endPTS:Y,startDTS:ee,endDTS:Q};else if(k.firstKeyFrame&&k.independent&&(this.couldBacktrack=!0),k.dropped&&k.independent){var G=this.getLoadPosition()+this.config.maxBufferHole;if(G<$){this.backtrack(P);return}P.setElementaryStreamInfo(k.type,P.start,Y,P.start,Q,!0)}P.setElementaryStreamInfo(k.type,$,Y,ee,Q),this.bufferFragmentData(k,P,w,b)}}else if(I.independent===!1){this.backtrack(P);return}if(K){var q=K.startPTS,te=K.endPTS,ie=K.startDTS,ne=K.endDTS;w&&(w.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:q,endPTS:te,startDTS:ie,endDTS:ne}),P.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,q,te,ie,ne),this.bufferFragmentData(K,P,w,b)}if(U!=null&&(E=U.samples)!==null&&E!==void 0&&E.length){var le={frag:P,id:_,samples:U.samples};L.trigger(M.Events.FRAG_PARSING_METADATA,le)}if(B){var se={frag:P,id:_,samples:B.samples};L.trigger(M.Events.FRAG_PARSING_USERDATA,se)}}},A._bufferInitSegment=function(y,E,_,L){var I=this;if(this.state===h.State.PARSING){this.audioOnly=!!E.audio&&!E.video,this.altAudio&&!this.audioOnly&&delete E.audio;var b=E.audio,R=E.video,P=E.audiovideo;if(b){var w=y.audioCodec,F=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(w&&(w.indexOf("mp4a.40.5")!==-1?w="mp4a.40.2":w="mp4a.40.5"),b.metadata.channelCount!==1&&F.indexOf("firefox")===-1&&(w="mp4a.40.5")),F.indexOf("android")!==-1&&b.container!=="audio/mpeg"&&(w="mp4a.40.2",this.log("Android: force audio codec to "+w)),y.audioCodec&&y.audioCodec!==w&&this.log('Swapping manifest audio codec "'+y.audioCodec+'" for "'+w+'"'),b.levelCodec=w,b.id="main",this.log("Init audio buffer, container:"+b.container+", codecs[selected/level/parsed]=["+(w||"")+"/"+(y.audioCodec||"")+"/"+b.codec+"]")}R&&(R.levelCodec=y.videoCodec,R.id="main",this.log("Init video buffer, container:"+R.container+", codecs[level/parsed]=["+(y.videoCodec||"")+"/"+R.codec+"]")),P&&this.log("Init audiovideo buffer, container:"+P.container+", codecs[level/parsed]=["+(y.attrs.CODECS||"")+"/"+P.codec+"]"),this.hls.trigger(M.Events.BUFFER_CODECS,E),Object.keys(E).forEach(function(k){var B=E[k],U=B.initSegment;U!=null&&U.byteLength&&I.hls.trigger(M.Events.BUFFER_APPENDING,{type:k,data:U,frag:_,part:null,chunkMeta:L,parent:_.type})}),this.tick()}},A.backtrack=function(y){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(y);var E=this.fragmentTracker.backtrack(y);this.fragPrevious=null,this.nextLoadPosition=y.start,E?this.resetFragmentLoading(y):this.state=h.State.BACKTRACKING},A.checkFragmentChanged=function(){var y=this.media,E=null;if(y&&y.readyState>1&&y.seeking===!1){var _=y.currentTime;if(S.BufferHelper.isBuffered(y,_)?E=this.getAppendedFrag(_):S.BufferHelper.isBuffered(y,_+.1)&&(E=this.getAppendedFrag(_+.1)),E){var L=this.fragPlaying,I=E.level;(!L||E.sn!==L.sn||L.level!==I||E.urlId!==L.urlId)&&(this.hls.trigger(M.Events.FRAG_CHANGED,{frag:E}),(!L||L.level!==I)&&this.hls.trigger(M.Events.LEVEL_SWITCHED,{level:I}),this.fragPlaying=E)}}},t(g,[{key:"nextLevel",get:function(){var y=this.nextBufferedFrag;return y?y.level:-1}},{key:"currentLevel",get:function(){var y=this.media;if(y){var E=this.getAppendedFrag(y.currentTime);if(E)return E.level}return-1}},{key:"nextBufferedFrag",get:function(){var y=this.media;if(y){var E=this.getAppendedFrag(y.currentTime);return this.followingBufferedFrag(E)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),g}(h.default)},"./src/controller/subtitle-stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"SubtitleStreamController",function(){return t});var T=x("./src/events.ts"),h=x("./src/utils/buffer-helper.ts"),m=x("./src/controller/fragment-finders.ts"),M=x("./src/utils/discontinuities.ts"),S=x("./src/controller/level-helper.ts"),p=x("./src/controller/fragment-tracker.ts"),u=x("./src/controller/base-stream-controller.ts"),n=x("./src/types/loader.ts"),f=x("./src/types/level.ts");function l(r,e){for(var s=0;s<e.length;s++){var o=e[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function c(r,e,s){return e&&l(r.prototype,e),s&&l(r,s),r}function v(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,d(r,e)}function d(r,e){return d=Object.setPrototypeOf||function(o,a){return o.__proto__=a,o},d(r,e)}var i=500,t=function(r){v(e,r);function e(o,a){var g;return g=r.call(this,o,a,"[subtitle-stream-controller]")||this,g.levels=[],g.currentTrackId=-1,g.tracksBuffered=[],g.mainDetails=null,g._registerListeners(),g}var s=e.prototype;return s.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function(){var a=this.hls;a.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.on(T.Events.ERROR,this.onError,this),a.on(T.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.on(T.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.on(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.on(T.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.on(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s._unregisterListeners=function(){var a=this.hls;a.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.off(T.Events.ERROR,this.onError,this),a.off(T.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.off(T.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.off(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.off(T.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.off(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s.startLoad=function(){this.stopLoad(),this.state=u.State.IDLE,this.setInterval(i),this.tick()},s.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},s.onLevelLoaded=function(a,g){this.mainDetails=g.details},s.onSubtitleFragProcessed=function(a,g){var A=g.frag,D=g.success;if(this.fragPrevious=A,this.state=u.State.IDLE,!!D){var y=this.tracksBuffered[this.currentTrackId];if(!!y){for(var E,_=A.start,L=0;L<y.length;L++)if(_>=y[L].start&&_<=y[L].end){E=y[L];break}var I=A.start+A.duration;E?E.end=I:(E={start:_,end:I},y.push(E)),this.fragmentTracker.fragBuffered(A)}}},s.onBufferFlushing=function(a,g){var A=g.startOffset,D=g.endOffset;if(A===0&&D!==Number.POSITIVE_INFINITY){var y=this.currentTrackId,E=this.levels;if(!E.length||!E[y]||!E[y].details)return;var _=E[y].details,L=_.targetduration,I=D-L;if(I<=0)return;g.endOffsetSubtitles=Math.max(0,I),this.tracksBuffered.forEach(function(b){for(var R=0;R<b.length;){if(b[R].end<=I){b.shift();continue}else if(b[R].start<I)b[R].start=I;else break;R++}}),this.fragmentTracker.removeFragmentsInRange(A,I,n.PlaylistLevelType.SUBTITLE)}},s.onError=function(a,g){var A,D=g.frag;!D||D.type!==n.PlaylistLevelType.SUBTITLE||((A=this.fragCurrent)!==null&&A!==void 0&&A.loader&&this.fragCurrent.loader.abort(),this.state=u.State.IDLE)},s.onSubtitleTracksUpdated=function(a,g){var A=this,D=g.subtitleTracks;this.tracksBuffered=[],this.levels=D.map(function(y){return new f.Level(y)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(y){A.tracksBuffered[y.id]=[]}),this.mediaBuffer=null},s.onSubtitleTrackSwitch=function(a,g){if(this.currentTrackId=g.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var A=this.levels[this.currentTrackId];A!=null&&A.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,A&&this.setInterval(i)},s.onSubtitleTrackLoaded=function(a,g){var A,D=g.details,y=g.id,E=this.currentTrackId,_=this.levels;if(!!_.length){var L=_[E];if(!(y>=_.length||y!==E||!L)){if(this.mediaBuffer=this.mediaBufferTimeRanges,D.live||(A=L.details)!==null&&A!==void 0&&A.live){var I=this.mainDetails;if(D.deltaUpdateFailed||!I)return;var b=I.fragments[0];if(!L.details)D.hasProgramDateTime&&I.hasProgramDateTime?Object(M.alignMediaPlaylistByPDT)(D,I):b&&Object(S.addSliding)(D,b.start);else{var R=this.alignPlaylists(D,L.details);R===0&&b&&Object(S.addSliding)(D,b.start)}}if(L.details=D,this.levelLastLoaded=y,this.tick(),D.live&&!this.fragCurrent&&this.media&&this.state===u.State.IDLE){var P=Object(m.findFragmentByPTS)(null,D.fragments,this.media.currentTime,0);P||(this.warn("Subtitle playlist not aligned with playback"),L.details=void 0)}}}},s._handleFragmentLoadComplete=function(a){var g=a.frag,A=a.payload,D=g.decryptdata,y=this.hls;if(!this.fragContextChanged(g)&&A&&A.byteLength>0&&D&&D.key&&D.iv&&D.method==="AES-128"){var E=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(A),D.key.buffer,D.iv.buffer).then(function(_){var L=performance.now();y.trigger(T.Events.FRAG_DECRYPTED,{frag:g,payload:_,stats:{tstart:E,tdecrypt:L}})})}},s.doTick=function(){if(!this.media){this.state=u.State.IDLE;return}if(this.state===u.State.IDLE){var a,g=this.currentTrackId,A=this.levels;if(!A.length||!A[g]||!A[g].details)return;var D=A[g].details,y=D.targetduration,E=this.config,_=this.media,L=h.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,_.currentTime-y,E.maxBufferHole),I=L.end,b=L.len,R=this.getMaxBufferLength()+y;if(b>R)return;console.assert(D,"Subtitle track details are defined on idle subtitle stream controller tick");var P=D.fragments,w=P.length,F=D.edge,k,B=this.fragPrevious;if(I<F){var U=E.maxFragLookUpTolerance;k=Object(m.findFragmentByPTS)(B,P,I,U),!k&&B&&B.start<P[0].start&&(k=P[0])}else k=P[w-1];(a=k)!==null&&a!==void 0&&a.encrypted?this.loadKey(k,D):k&&this.fragmentTracker.getState(k)===p.FragmentState.NOT_LOADED&&this.loadFragment(k,D,I)}},s.loadFragment=function(a,g,A){this.fragCurrent=a,r.prototype.loadFragment.call(this,a,g,A)},c(e,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),e}(u.default)},"./src/controller/subtitle-track-controller.ts":function(O,C,x){x.r(C);var T=x("./src/events.ts"),h=x("./src/utils/texttrack-utils.ts"),m=x("./src/controller/base-playlist-controller.ts"),M=x("./src/types/loader.ts");function S(c,v){for(var d=0;d<v.length;d++){var i=v[d];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(c,i.key,i)}}function p(c,v,d){return v&&S(c.prototype,v),d&&S(c,d),c}function u(c,v){c.prototype=Object.create(v.prototype),c.prototype.constructor=c,n(c,v)}function n(c,v){return n=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},n(c,v)}var f=function(c){u(v,c);function v(i){var t;return t=c.call(this,i,"[subtitle-track-controller]")||this,t.media=null,t.tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.selectDefaultTrack=!0,t.queuedDefaultTrack=-1,t.trackChangeListener=function(){return t.onTextTracksChanged()},t.asyncPollTrackChange=function(){return t.pollTrackChange(0)},t.useTextTrackPolling=!1,t.subtitlePollingInterval=-1,t.subtitleDisplay=!0,t.registerListeners(),t}var d=v.prototype;return d.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,c.prototype.destroy.call(this)},d.registerListeners=function(){var t=this.hls;t.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(T.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(T.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var t=this.hls;t.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(T.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(T.Events.ERROR,this.onError,this)},d.onMediaAttached=function(t,r){this.media=r.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},d.pollTrackChange=function(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)},d.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var t=l(this.media.textTracks);t.forEach(function(r){Object(h.clearCurrentCues)(r)}),this.subtitleTrack=-1,this.media=null}},d.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},d.onManifestParsed=function(t,r){this.tracks=r.subtitleTracks},d.onSubtitleTrackLoaded=function(t,r){var e=r.id,s=r.details,o=this.trackId,a=this.tracksInGroup[o];if(!a){this.warn("Invalid subtitle track id "+e);return}var g=a.details;a.details=r.details,this.log("subtitle track "+e+" loaded ["+s.startSN+"-"+s.endSN+"]"),e===this.trackId&&(this.retryCount=0,this.playlistLoaded(e,r,g))},d.onLevelLoading=function(t,r){this.switchLevel(r.level)},d.onLevelSwitching=function(t,r){this.switchLevel(r.level)},d.switchLevel=function(t){var r=this.hls.levels[t];if(!!(r!=null&&r.textGroupIds)){var e=r.textGroupIds[r.urlId];if(this.groupId!==e){var s=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,o=this.tracks.filter(function(A){return!e||A.groupId===e});this.tracksInGroup=o;var a=this.findTrackId(s==null?void 0:s.name)||this.findTrackId();this.groupId=e;var g={subtitleTracks:o};this.log("Updating subtitle tracks, "+o.length+' track(s) found in "'+e+'" group-id'),this.hls.trigger(T.Events.SUBTITLE_TRACKS_UPDATED,g),a!==-1&&this.setSubtitleTrack(a,s)}}},d.findTrackId=function(t){for(var r=this.tracksInGroup,e=0;e<r.length;e++){var s=r[e];if((!this.selectDefaultTrack||s.default)&&(!t||t===s.name))return s.id}return-1},d.onError=function(t,r){c.prototype.onError.call(this,t,r),!(r.fatal||!r.context)&&r.context.type===M.PlaylistContextType.SUBTITLE_TRACK&&r.context.id===this.trackId&&r.context.groupId===this.groupId&&this.retryLoadingOrFail(r)},d.loadPlaylist=function(t){var r=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(r)){var e=r.id,s=r.groupId,o=r.url;if(t)try{o=t.addDirectives(o)}catch(a){this.warn("Could not construct new URL with HLS Delivery Directives: "+a)}this.log("Loading subtitle playlist for id "+e),this.hls.trigger(T.Events.SUBTITLE_TRACK_LOADING,{url:o,id:e,groupId:s,deliveryDirectives:t||null})}},d.toggleTrackModes=function(t){var r=this,e=this.media,s=this.subtitleDisplay,o=this.trackId;if(!!e){var a=l(e.textTracks),g=a.filter(function(y){return y.groupId===r.groupId});if(t===-1)[].slice.call(a).forEach(function(y){y.mode="disabled"});else{var A=g[o];A&&(A.mode="disabled")}var D=g[t];D&&(D.mode=s?"showing":"hidden")}},d.setSubtitleTrack=function(t,r){var e,s=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(this.trackId!==t&&this.toggleTrackModes(t),!(this.trackId===t&&(t===-1||(e=s[t])!==null&&e!==void 0&&e.details)||t<-1||t>=s.length)){this.clearTimer();var o=s[t];if(this.log("Switching to subtitle track "+t),this.trackId=t,o){var a=o.id,g=o.groupId,A=g===void 0?"":g,D=o.name,y=o.type,E=o.url;this.hls.trigger(T.Events.SUBTITLE_TRACK_SWITCH,{id:a,groupId:A,name:D,type:y,url:E});var _=this.switchParams(o.url,r==null?void 0:r.details);this.loadPlaylist(_)}else this.hls.trigger(T.Events.SUBTITLE_TRACK_SWITCH,{id:t})}},d.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var t=-1,r=l(this.media.textTracks),e=0;e<r.length;e++)if(r[e].mode==="hidden")t=e;else if(r[e].mode==="showing"){t=e;break}this.subtitleTrack!==t&&(this.subtitleTrack=t)}},p(v,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1;var r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,r)}}]),v}(m.default);function l(c){for(var v=[],d=0;d<c.length;d++){var i=c[d];i.kind==="subtitles"&&i.label&&v.push(c[d])}return v}C.default=f},"./src/controller/timeline-controller.ts":function(O,C,x){x.r(C),x.d(C,"TimelineController",function(){return l});var T=x("./src/polyfills/number.ts"),h=x("./src/events.ts"),m=x("./src/utils/cea-608-parser.ts"),M=x("./src/utils/output-filter.ts"),S=x("./src/utils/webvtt-parser.ts"),p=x("./src/utils/texttrack-utils.ts"),u=x("./src/utils/imsc1-ttml-parser.ts"),n=x("./src/types/loader.ts"),f=x("./src/utils/logger.ts"),l=function(){function i(r){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=d(),this.captionsProperties=void 0,this.hls=r,this.config=r.config,this.Cues=r.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var e=new M.default(this,"textTrack1"),s=new M.default(this,"textTrack2"),o=new M.default(this,"textTrack3"),a=new M.default(this,"textTrack4");this.cea608Parser1=new m.default(1,e,s),this.cea608Parser2=new m.default(3,o,a)}r.on(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),r.on(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),r.on(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),r.on(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),r.on(h.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),r.on(h.Events.FRAG_LOADING,this.onFragLoading,this),r.on(h.Events.FRAG_LOADED,this.onFragLoaded,this),r.on(h.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),r.on(h.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),r.on(h.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),r.on(h.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),r.on(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=i.prototype;return t.destroy=function(){var e=this.hls;e.off(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(h.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(h.Events.FRAG_LOADING,this.onFragLoading,this),e.off(h.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(h.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(h.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(h.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(h.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,s,o,a,g){for(var A=!1,D=g.length;D--;){var y=g[D],E=v(y[0],y[1],s,o);if(E>=0&&(y[0]=Math.min(y[0],s),y[1]=Math.max(y[1],o),A=!0,E/(o-s)>.5))return}if(A||g.push([s,o]),this.config.renderTextTracksNatively){var _=this.captionsTracks[e];this.Cues.newCue(_,s,o,a)}else{var L=this.Cues.newCue(null,s,o,a);this.hls.trigger(h.Events.CUES_PARSED,{type:"captions",cues:L,track:e})}},t.onInitPtsFound=function(e,s){var o=this,a=s.frag,g=s.id,A=s.initPTS,D=s.timescale,y=this.unparsedVttFrags;g==="main"&&(this.initPTS[a.cc]=A,this.timescale[a.cc]=D),y.length&&(this.unparsedVttFrags=[],y.forEach(function(E){o.onFragLoaded(h.Events.FRAG_LOADED,E)}))},t.getExistingTrack=function(e){var s=this.media;if(s)for(var o=0;o<s.textTracks.length;o++){var a=s.textTracks[o];if(a[e])return a}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var s=this.captionsProperties,o=this.captionsTracks,a=this.media,g=s[e],A=g.label,D=g.languageCode,y=this.getExistingTrack(e);if(y)o[e]=y,Object(p.clearCurrentCues)(o[e]),Object(p.sendAddTrackEvent)(o[e],a);else{var E=this.createTextTrack("captions",A,D);E&&(E[e]=!0,o[e]=E)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var s=this.captionsProperties[e];if(!!s){var o=s.label,a={_id:e,label:o,kind:"captions",default:s.media?!!s.media.default:!1,closedCaptions:s.media};this.nonNativeCaptionsTracks[e]=a,this.hls.trigger(h.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[a]})}}},t.createTextTrack=function(e,s,o){var a=this.media;if(!!a)return a.addTextTrack(e,s,o)},t.onMediaAttaching=function(e,s){this.media=s.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(s){Object(p.clearCurrentCues)(e[s]),delete e[s]}),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=d(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(!!e){var s=e.textTracks;if(s)for(var o=0;o<s.length;o++)Object(p.clearCurrentCues)(s[o])}},t.onSubtitleTracksUpdated=function(e,s){var o=this;this.textTracks=[];var a=s.subtitleTracks||[],g=a.some(function(E){return E.textCodec===u.IMSC1_CODEC});if(this.config.enableWebVTT||g&&this.config.enableIMSC1){var A=this.tracks&&a&&this.tracks.length===a.length;if(this.tracks=a||[],this.config.renderTextTracksNatively){var D=this.media?this.media.textTracks:[];this.tracks.forEach(function(E,_){var L;if(_<D.length){for(var I=null,b=0;b<D.length;b++)if(c(D[b],E)){I=D[b];break}I&&(L=I)}L?Object(p.clearCurrentCues)(L):(L=o.createTextTrack("subtitles",E.name,E.lang),L&&(L.mode="disabled")),L&&(L.groupId=E.groupId,o.textTracks.push(L))})}else if(!A&&this.tracks&&this.tracks.length){var y=this.tracks.map(function(E){return{label:E.name,kind:E.type.toLowerCase(),default:E.default,subtitleTrack:E}});this.hls.trigger(h.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:y})}}},t.onManifestLoaded=function(e,s){var o=this;this.config.enableCEA708Captions&&s.captions&&s.captions.forEach(function(a){var g=/(?:CC|SERVICE)([1-4])/.exec(a.instreamId);if(!!g){var A="textTrack"+g[1],D=o.captionsProperties[A];!D||(D.label=a.name,a.lang&&(D.languageCode=a.lang),D.media=a)}})},t.onFragLoading=function(e,s){var o=this.cea608Parser1,a=this.cea608Parser2,g=this.lastSn,A=this.lastPartIndex;if(!(!this.enabled||!(o&&a))&&s.frag.type===n.PlaylistLevelType.MAIN){var D,y,E=s.frag.sn,_=(D=s==null||(y=s.part)===null||y===void 0?void 0:y.index)!=null?D:-1;E===g+1||E===g&&_===A+1||(o.reset(),a.reset()),this.lastSn=E,this.lastPartIndex=_}},t.onFragLoaded=function(e,s){var o=s.frag,a=s.payload,g=this.initPTS,A=this.unparsedVttFrags;if(o.type===n.PlaylistLevelType.SUBTITLE)if(a.byteLength){if(!Object(T.isFiniteNumber)(g[o.cc])){A.push(s),g.length&&this.hls.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Missing initial subtitle PTS")});return}var D=o.decryptdata,y="stats"in s;if(D==null||D.key==null||D.method!=="AES-128"||y){var E=this.tracks[o.level],_=this.vttCCs;_[o.cc]||(_[o.cc]={start:o.start,prevCC:this.prevCC,new:!0},this.prevCC=o.cc),E&&E.textCodec===u.IMSC1_CODEC?this._parseIMSC1(o,a):this._parseVTTs(o,a,_)}}else this.hls.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,s){var o=this,a=this.hls;Object(u.parseIMSC1)(s,this.initPTS[e.cc],this.timescale[e.cc],function(g){o._appendCues(g,e.level),a.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(g){f.logger.log("Failed to parse IMSC1: "+g),a.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:g})})},t._parseVTTs=function(e,s,o){var a=this,g=this.hls;Object(S.parseWebVTT)(s,this.initPTS[e.cc],this.timescale[e.cc],o,e.cc,e.start,function(A){a._appendCues(A,e.level),g.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(A){a._fallbackToIMSC1(e,s),f.logger.log("Failed to parse VTT cue: "+A),g.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:A})})},t._fallbackToIMSC1=function(e,s){var o=this,a=this.tracks[e.level];a.textCodec||Object(u.parseIMSC1)(s,this.initPTS[e.cc],this.timescale[e.cc],function(){a.textCodec=u.IMSC1_CODEC,o._parseIMSC1(e,s)},function(){a.textCodec="wvtt"})},t._appendCues=function(e,s){var o=this.hls;if(this.config.renderTextTracksNatively){var a=this.textTracks[s];if(a.mode==="disabled")return;e.forEach(function(D){return Object(p.addCueToTrack)(a,D)})}else{var g=this.tracks[s],A=g.default?"default":"subtitles"+s;o.trigger(h.Events.CUES_PARSED,{type:"subtitles",cues:e,track:A})}},t.onFragDecrypted=function(e,s){var o=s.frag;if(o.type===n.PlaylistLevelType.SUBTITLE){if(!Object(T.isFiniteNumber)(this.initPTS[o.cc])){this.unparsedVttFrags.push(s);return}this.onFragLoaded(h.Events.FRAG_LOADED,s)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,s){var o=this.cea608Parser1,a=this.cea608Parser2;if(!(!this.enabled||!(o&&a)))for(var g=0;g<s.samples.length;g++){var A=s.samples[g].bytes;if(A){var D=this.extractCea608Data(A);o.addData(s.samples[g].pts,D[0]),a.addData(s.samples[g].pts,D[1])}}},t.onBufferFlushing=function(e,s){var o=s.startOffset,a=s.endOffset,g=s.endOffsetSubtitles,A=s.type,D=this.media;if(!(!D||D.currentTime<a)){if(!A||A==="video"){var y=this.captionsTracks;Object.keys(y).forEach(function(_){return Object(p.removeCuesInRange)(y[_],o,a)})}if(this.config.renderTextTracksNatively&&o===0&&g!==void 0){var E=this.textTracks;Object.keys(E).forEach(function(_){return Object(p.removeCuesInRange)(E[_],o,g)})}}},t.extractCea608Data=function(e){for(var s=e[0]&31,o=2,a=[[],[]],g=0;g<s;g++){var A=e[o++],D=127&e[o++],y=127&e[o++],E=(4&A)!==0,_=3&A;D===0&&y===0||E&&(_===0||_===1)&&(a[_].push(D),a[_].push(y))}return a},i}();function c(i,t){return i&&i.label===t.name&&!(i.textTrack1||i.textTrack2)}function v(i,t,r,e){return Math.min(t,e)-Math.max(i,r)}function d(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return T});var T=function(){function h(M,S){this.subtle=void 0,this.aesIV=void 0,this.subtle=M,this.aesIV=S}var m=h.prototype;return m.decrypt=function(S,p){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},p,S)},h}()},"./src/crypt/aes-decryptor.ts":function(O,C,x){x.r(C),x.d(C,"removePadding",function(){return h}),x.d(C,"default",function(){return m});var T=x("./src/utils/typed-array.ts");function h(M){var S=M.byteLength,p=S&&new DataView(M.buffer).getUint8(S-1);return p?Object(T.sliceUint8)(M,0,S-p):M}var m=function(){function M(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var S=M.prototype;return S.uint8ArrayToUint32Array_=function(u){for(var n=new DataView(u),f=new Uint32Array(4),l=0;l<4;l++)f[l]=n.getUint32(l*4);return f},S.initTable=function(){var u=this.sBox,n=this.invSBox,f=this.subMix,l=f[0],c=f[1],v=f[2],d=f[3],i=this.invSubMix,t=i[0],r=i[1],e=i[2],s=i[3],o=new Uint32Array(256),a=0,g=0,A=0;for(A=0;A<256;A++)A<128?o[A]=A<<1:o[A]=A<<1^283;for(A=0;A<256;A++){var D=g^g<<1^g<<2^g<<3^g<<4;D=D>>>8^D&255^99,u[a]=D,n[D]=a;var y=o[a],E=o[y],_=o[E],L=o[D]*257^D*16843008;l[a]=L<<24|L>>>8,c[a]=L<<16|L>>>16,v[a]=L<<8|L>>>24,d[a]=L,L=_*16843009^E*65537^y*257^a*16843008,t[D]=L<<24|L>>>8,r[D]=L<<16|L>>>16,e[D]=L<<8|L>>>24,s[D]=L,a?(a=y^o[o[o[_^y]]],g^=o[o[g]]):a=g=1}},S.expandKey=function(u){for(var n=this.uint8ArrayToUint32Array_(u),f=!0,l=0;l<n.length&&f;)f=n[l]===this.key[l],l++;if(!f){this.key=n;var c=this.keySize=n.length;if(c!==4&&c!==6&&c!==8)throw new Error("Invalid aes key size="+c);var v=this.ksRows=(c+6+1)*4,d,i,t=this.keySchedule=new Uint32Array(v),r=this.invKeySchedule=new Uint32Array(v),e=this.sBox,s=this.rcon,o=this.invSubMix,a=o[0],g=o[1],A=o[2],D=o[3],y,E;for(d=0;d<v;d++){if(d<c){y=t[d]=n[d];continue}E=y,d%c===0?(E=E<<8|E>>>24,E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255],E^=s[d/c|0]<<24):c>6&&d%c===4&&(E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255]),t[d]=y=(t[d-c]^E)>>>0}for(i=0;i<v;i++)d=v-i,i&3?E=t[d]:E=t[d-4],i<4||d<=4?r[i]=E:r[i]=a[e[E>>>24]]^g[e[E>>>16&255]]^A[e[E>>>8&255]]^D[e[E&255]],r[i]=r[i]>>>0}},S.networkToHostOrderSwap=function(u){return u<<24|(u&65280)<<8|(u&16711680)>>8|u>>>24},S.decrypt=function(u,n,f){for(var l=this.keySize+6,c=this.invKeySchedule,v=this.invSBox,d=this.invSubMix,i=d[0],t=d[1],r=d[2],e=d[3],s=this.uint8ArrayToUint32Array_(f),o=s[0],a=s[1],g=s[2],A=s[3],D=new Int32Array(u),y=new Int32Array(D.length),E,_,L,I,b,R,P,w,F,k,B,U,j,K,N=this.networkToHostOrderSwap;n<D.length;){for(F=N(D[n]),k=N(D[n+1]),B=N(D[n+2]),U=N(D[n+3]),b=F^c[0],R=U^c[1],P=B^c[2],w=k^c[3],j=4,K=1;K<l;K++)E=i[b>>>24]^t[R>>16&255]^r[P>>8&255]^e[w&255]^c[j],_=i[R>>>24]^t[P>>16&255]^r[w>>8&255]^e[b&255]^c[j+1],L=i[P>>>24]^t[w>>16&255]^r[b>>8&255]^e[R&255]^c[j+2],I=i[w>>>24]^t[b>>16&255]^r[R>>8&255]^e[P&255]^c[j+3],b=E,R=_,P=L,w=I,j=j+4;E=v[b>>>24]<<24^v[R>>16&255]<<16^v[P>>8&255]<<8^v[w&255]^c[j],_=v[R>>>24]<<24^v[P>>16&255]<<16^v[w>>8&255]<<8^v[b&255]^c[j+1],L=v[P>>>24]<<24^v[w>>16&255]<<16^v[b>>8&255]<<8^v[R&255]^c[j+2],I=v[w>>>24]<<24^v[b>>16&255]<<16^v[R>>8&255]<<8^v[P&255]^c[j+3],y[n]=N(E^o),y[n+1]=N(I^a),y[n+2]=N(L^g),y[n+3]=N(_^A),o=F,a=k,g=B,A=U,n=n+4}return y.buffer},M}()},"./src/crypt/decrypter.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return n});var T=x("./src/crypt/aes-crypto.ts"),h=x("./src/crypt/fast-aes-key.ts"),m=x("./src/crypt/aes-decryptor.ts"),M=x("./src/utils/logger.ts"),S=x("./src/utils/mp4-tools.ts"),p=x("./src/utils/typed-array.ts"),u=16,n=function(){function f(c,v,d){var i=d===void 0?{}:d,t=i.removePKCS7Padding,r=t===void 0?!0:t;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=c,this.config=v,this.removePKCS7Padding=r,r)try{var e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var l=f.prototype;return l.destroy=function(){this.observer=null},l.isSync=function(){return this.config.enableSoftwareAES},l.flush=function(){var v=this.currentResult;if(!v){this.reset();return}var d=new Uint8Array(v);return this.reset(),this.removePKCS7Padding?Object(m.removePadding)(d):d},l.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},l.decrypt=function(v,d,i,t){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(v),d,i);var r=this.flush();r&&t(r.buffer)}else this.webCryptoDecrypt(new Uint8Array(v),d,i).then(t)},l.softwareDecrypt=function(v,d,i){var t=this.currentIV,r=this.currentResult,e=this.remainderData;this.logOnce("JS AES decrypt"),e&&(v=Object(S.appendUint8Array)(e,v),this.remainderData=null);var s=this.getValidChunk(v);if(!s.length)return null;t&&(i=t);var o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new m.default),o.expandKey(d);var a=r;return this.currentResult=o.decrypt(s.buffer,0,i),this.currentIV=Object(p.sliceUint8)(s,-16).buffer,a||null},l.webCryptoDecrypt=function(v,d,i){var t=this,r=this.subtle;return(this.key!==d||!this.fastAesKey)&&(this.key=d,this.fastAesKey=new h.default(r,d)),this.fastAesKey.expandKey().then(function(e){if(!r)return Promise.reject(new Error("web crypto not initialized"));var s=new T.default(r,i);return s.decrypt(v.buffer,e)}).catch(function(e){return t.onWebCryptoError(e,v,d,i)})},l.onWebCryptoError=function(v,d,i,t){return M.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",v),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(d,i,t)},l.getValidChunk=function(v){var d=v,i=v.length-v.length%u;return i!==v.length&&(d=Object(p.sliceUint8)(v,0,i),this.remainderData=Object(p.sliceUint8)(v,i)),d},l.logOnce=function(v){!this.logEnabled||(M.logger.log("[decrypter.ts]: "+v),this.logEnabled=!1)},f}()},"./src/crypt/fast-aes-key.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return T});var T=function(){function h(M,S){this.subtle=void 0,this.key=void 0,this.subtle=M,this.key=S}var m=h.prototype;return m.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},h}()},"./src/demux/aacdemuxer.ts":function(O,C,x){x.r(C);var T=x("./src/demux/base-audio-demuxer.ts"),h=x("./src/demux/adts.ts"),m=x("./src/utils/logger.ts"),M=x("./src/demux/id3.ts");function S(n,f){n.prototype=Object.create(f.prototype),n.prototype.constructor=n,p(n,f)}function p(n,f){return p=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c},p(n,f)}var u=function(n){S(f,n);function f(c,v){var d;return d=n.call(this)||this,d.observer=void 0,d.config=void 0,d.observer=c,d.config=v,d}var l=f.prototype;return l.resetInitSegment=function(v,d,i){n.prototype.resetInitSegment.call(this,v,d,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:v,duration:i,inputTimeScale:9e4,dropped:0}},f.probe=function(v){if(!v)return!1;for(var d=M.getID3Data(v,0)||[],i=d.length,t=v.length;i<t;i++)if(h.probe(v,i))return m.logger.log("ADTS sync word found !"),!0;return!1},l.canParse=function(v,d){return h.canParse(v,d)},l.appendFrame=function(v,d,i){h.initTrackConfig(v,this.observer,d,i,v.manifestCodec);var t=h.appendFrame(v,d,i,this.initPTS,this.frameIndex);if(t&&t.missing===0)return t},f}(T.default);u.minProbeByteLength=9,C.default=u},"./src/demux/adts.ts":function(O,C,x){x.r(C),x.d(C,"getAudioConfig",function(){return M}),x.d(C,"isHeaderPattern",function(){return S}),x.d(C,"getHeaderLength",function(){return p}),x.d(C,"getFullFrameLength",function(){return u}),x.d(C,"canGetFrameLength",function(){return n}),x.d(C,"isHeader",function(){return f}),x.d(C,"canParse",function(){return l}),x.d(C,"probe",function(){return c}),x.d(C,"initTrackConfig",function(){return v}),x.d(C,"getFrameDuration",function(){return d}),x.d(C,"parseFrameHeader",function(){return i}),x.d(C,"appendFrame",function(){return t});var T=x("./src/utils/logger.ts"),h=x("./src/errors.ts"),m=x("./src/events.ts");function M(r,e,s,o){var a,g,A,D,y=navigator.userAgent.toLowerCase(),E=o,_=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((e[s+2]&192)>>>6)+1;var L=(e[s+2]&60)>>>2;if(L>_.length-1){r.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+L});return}return A=(e[s+2]&1)<<2,A|=(e[s+3]&192)>>>6,T.logger.log("manifest codec:"+o+", ADTS type:"+a+", samplingIndex:"+L),/firefox/i.test(y)?L>=6?(a=5,D=new Array(4),g=L-3):(a=2,D=new Array(2),g=L):y.indexOf("android")!==-1?(a=2,D=new Array(2),g=L):(a=5,D=new Array(4),o&&(o.indexOf("mp4a.40.29")!==-1||o.indexOf("mp4a.40.5")!==-1)||!o&&L>=6?g=L-3:((o&&o.indexOf("mp4a.40.2")!==-1&&(L>=6&&A===1||/vivaldi/i.test(y))||!o&&A===1)&&(a=2,D=new Array(2)),g=L)),D[0]=a<<3,D[0]|=(L&14)>>1,D[1]|=(L&1)<<7,D[1]|=A<<3,a===5&&(D[1]|=(g&14)>>1,D[2]=(g&1)<<7,D[2]|=2<<2,D[3]=0),{config:D,samplerate:_[L],channelCount:A,codec:"mp4a.40."+a,manifestCodec:E}}function S(r,e){return r[e]===255&&(r[e+1]&246)===240}function p(r,e){return r[e+1]&1?7:9}function u(r,e){return(r[e+3]&3)<<11|r[e+4]<<3|(r[e+5]&224)>>>5}function n(r,e){return e+5<r.length}function f(r,e){return e+1<r.length&&S(r,e)}function l(r,e){return n(r,e)&&S(r,e)&&u(r,e)<=r.length-e}function c(r,e){if(f(r,e)){var s=p(r,e);if(e+s>=r.length)return!1;var o=u(r,e);if(o<=s)return!1;var a=e+o;return a===r.length||f(r,a)}return!1}function v(r,e,s,o,a){if(!r.samplerate){var g=M(e,s,o,a);if(!g)return;r.config=g.config,r.samplerate=g.samplerate,r.channelCount=g.channelCount,r.codec=g.codec,r.manifestCodec=g.manifestCodec,T.logger.log("parsed codec:"+r.codec+", rate:"+g.samplerate+", channels:"+g.channelCount)}}function d(r){return 1024*9e4/r}function i(r,e,s,o,a){var g=p(r,e),A=u(r,e);if(A-=g,A>0){var D=s+o*a;return{headerLength:g,frameLength:A,stamp:D}}}function t(r,e,s,o,a){var g=d(r.samplerate),A=i(e,s,o,a,g);if(A){var D=A.frameLength,y=A.headerLength,E=A.stamp,_=y+D,L=Math.max(0,s+_-e.length),I;L?(I=new Uint8Array(_-y),I.set(e.subarray(s+y,e.length),0)):I=e.subarray(s+y,s+_);var b={unit:I,pts:E};return L||r.samples.push(b),{sample:b,length:_,missing:L}}}},"./src/demux/base-audio-demuxer.ts":function(O,C,x){x.r(C),x.d(C,"initPTSFn",function(){return u});var T=x("./src/polyfills/number.ts"),h=x("./src/demux/id3.ts"),m=x("./src/demux/dummy-demuxed-track.ts"),M=x("./src/utils/mp4-tools.ts"),S=x("./src/utils/typed-array.ts"),p=function(){function n(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var f=n.prototype;return f.resetInitSegment=function(c,v,d){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},f.resetTimeStamp=function(){},f.resetContiguity=function(){},f.canParse=function(c,v){return!1},f.appendFrame=function(c,v,d){},f.demux=function(c,v){this.cachedData&&(c=Object(M.appendUint8Array)(this.cachedData,c),this.cachedData=null);var d=h.getID3Data(c,0),i=d?d.length:0,t,r,e=this._audioTrack,s=this._id3Track,o=d?h.getTimeStamp(d):void 0,a=c.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=u(o,v)),d&&d.length>0&&s.samples.push({pts:this.initPTS,dts:this.initPTS,data:d}),r=this.initPTS;i<a;){if(this.canParse(c,i)){var g=this.appendFrame(e,c,i);g?(this.frameIndex++,r=g.sample.pts,i+=g.length,t=i):i=a}else h.canParse(c,i)?(d=h.getID3Data(c,i),s.samples.push({pts:r,dts:r,data:d}),i+=d.length,t=i):i++;if(i===a&&t!==a){var A=Object(S.sliceUint8)(c,t);this.cachedData?this.cachedData=Object(M.appendUint8Array)(this.cachedData,A):this.cachedData=A}}return{audioTrack:e,avcTrack:Object(m.dummyTrack)(),id3Track:s,textTrack:Object(m.dummyTrack)()}},f.demuxSampleAes=function(c,v,d){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},f.flush=function(c){var v=this.cachedData;return v&&(this.cachedData=null,this.demux(v,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(m.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(m.dummyTrack)()}},f.destroy=function(){},n}(),u=function(f,l){return Object(T.isFiniteNumber)(f)?f*90:l*9e4};C.default=p},"./src/demux/chunk-cache.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return T});var T=function(){function m(){this.chunks=[],this.dataLength=0}var M=m.prototype;return M.push=function(p){this.chunks.push(p),this.dataLength+=p.length},M.flush=function(){var p=this.chunks,u=this.dataLength,n;if(p.length)p.length===1?n=p[0]:n=h(p,u);else return new Uint8Array(0);return this.reset(),n},M.reset=function(){this.chunks.length=0,this.dataLength=0},m}();function h(m,M){for(var S=new Uint8Array(M),p=0,u=0;u<m.length;u++){var n=m[u];S.set(n,p),p+=n.length}return S}},"./src/demux/dummy-demuxed-track.ts":function(O,C,x){x.r(C),x.d(C,"dummyTrack",function(){return T});function T(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(O,C,x){x.r(C);var T=x("./src/utils/logger.ts"),h=function(){function m(S){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=S,this.bytesAvailable=S.byteLength,this.word=0,this.bitsAvailable=0}var M=m.prototype;return M.loadWord=function(){var p=this.data,u=this.bytesAvailable,n=p.byteLength-u,f=new Uint8Array(4),l=Math.min(4,u);if(l===0)throw new Error("no bytes available");f.set(p.subarray(n,n+l)),this.word=new DataView(f.buffer).getUint32(0),this.bitsAvailable=l*8,this.bytesAvailable-=l},M.skipBits=function(p){var u;this.bitsAvailable>p?(this.word<<=p,this.bitsAvailable-=p):(p-=this.bitsAvailable,u=p>>3,p-=u>>3,this.bytesAvailable-=u,this.loadWord(),this.word<<=p,this.bitsAvailable-=p)},M.readBits=function(p){var u=Math.min(this.bitsAvailable,p),n=this.word>>>32-u;return p>32&&T.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=u,this.bitsAvailable>0?this.word<<=u:this.bytesAvailable>0&&this.loadWord(),u=p-u,u>0&&this.bitsAvailable?n<<u|this.readBits(u):n},M.skipLZ=function(){var p;for(p=0;p<this.bitsAvailable;++p)if((this.word&2147483648>>>p)!==0)return this.word<<=p,this.bitsAvailable-=p,p;return this.loadWord(),p+this.skipLZ()},M.skipUEG=function(){this.skipBits(1+this.skipLZ())},M.skipEG=function(){this.skipBits(1+this.skipLZ())},M.readUEG=function(){var p=this.skipLZ();return this.readBits(p+1)-1},M.readEG=function(){var p=this.readUEG();return 1&p?1+p>>>1:-1*(p>>>1)},M.readBoolean=function(){return this.readBits(1)===1},M.readUByte=function(){return this.readBits(8)},M.readUShort=function(){return this.readBits(16)},M.readUInt=function(){return this.readBits(32)},M.skipScalingList=function(p){for(var u=8,n=8,f,l=0;l<p;l++)n!==0&&(f=this.readEG(),n=(u+f+256)%256),u=n===0?u:n},M.readSPS=function(){var p=0,u=0,n=0,f=0,l,c,v,d=this.readUByte.bind(this),i=this.readBits.bind(this),t=this.readUEG.bind(this),r=this.readBoolean.bind(this),e=this.skipBits.bind(this),s=this.skipEG.bind(this),o=this.skipUEG.bind(this),a=this.skipScalingList.bind(this);d();var g=d();if(i(5),e(3),d(),o(),g===100||g===110||g===122||g===244||g===44||g===83||g===86||g===118||g===128){var A=t();if(A===3&&e(1),o(),o(),e(1),r())for(c=A!==3?8:12,v=0;v<c;v++)r()&&(v<6?a(16):a(64))}o();var D=t();if(D===0)t();else if(D===1)for(e(1),s(),s(),l=t(),v=0;v<l;v++)s();o(),e(1);var y=t(),E=t(),_=i(1);_===0&&e(1),e(1),r()&&(p=t(),u=t(),n=t(),f=t());var L=[1,1];if(r()&&r()){var I=d();switch(I){case 1:L=[1,1];break;case 2:L=[12,11];break;case 3:L=[10,11];break;case 4:L=[16,11];break;case 5:L=[40,33];break;case 6:L=[24,11];break;case 7:L=[20,11];break;case 8:L=[32,11];break;case 9:L=[80,33];break;case 10:L=[18,11];break;case 11:L=[15,11];break;case 12:L=[64,33];break;case 13:L=[160,99];break;case 14:L=[4,3];break;case 15:L=[3,2];break;case 16:L=[2,1];break;case 255:{L=[d()<<8|d(),d()<<8|d()];break}}}return{width:Math.ceil((y+1)*16-p*2-u*2),height:(2-_)*(E+1)*16-(_?2:4)*(n+f),pixelRatio:L}},M.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},m}();C.default=h},"./src/demux/id3.ts":function(O,C,x){x.r(C),x.d(C,"isHeader",function(){return T}),x.d(C,"isFooter",function(){return h}),x.d(C,"getID3Data",function(){return m}),x.d(C,"canParse",function(){return S}),x.d(C,"getTimeStamp",function(){return p}),x.d(C,"isTimeStampFrame",function(){return u}),x.d(C,"getID3Frames",function(){return f}),x.d(C,"decodeFrame",function(){return l}),x.d(C,"utf8ArrayToStr",function(){return t}),x.d(C,"testables",function(){return r});var T=function(a,g){return g+10<=a.length&&a[g]===73&&a[g+1]===68&&a[g+2]===51&&a[g+3]<255&&a[g+4]<255&&a[g+6]<128&&a[g+7]<128&&a[g+8]<128&&a[g+9]<128},h=function(a,g){return g+10<=a.length&&a[g]===51&&a[g+1]===68&&a[g+2]===73&&a[g+3]<255&&a[g+4]<255&&a[g+6]<128&&a[g+7]<128&&a[g+8]<128&&a[g+9]<128},m=function(a,g){for(var A=g,D=0;T(a,g);){D+=10;var y=M(a,g+6);D+=y,h(a,g+10)&&(D+=10),g+=D}if(D>0)return a.subarray(A,A+D)},M=function(a,g){var A=0;return A=(a[g]&127)<<21,A|=(a[g+1]&127)<<14,A|=(a[g+2]&127)<<7,A|=a[g+3]&127,A},S=function(a,g){return T(a,g)&&M(a,g+6)+10<=a.length-g},p=function(a){for(var g=f(a),A=0;A<g.length;A++){var D=g[A];if(u(D))return i(D)}},u=function(a){return a&&a.key==="PRIV"&&a.info==="com.apple.streaming.transportStreamTimestamp"},n=function(a){var g=String.fromCharCode(a[0],a[1],a[2],a[3]),A=M(a,4),D=10;return{type:g,size:A,data:a.subarray(D,D+A)}},f=function(a){for(var g=0,A=[];T(a,g);){var D=M(a,g+6);g+=10;for(var y=g+D;g+8<y;){var E=n(a.subarray(g)),_=l(E);_&&A.push(_),g+=E.size+10}h(a,g)&&(g+=10)}return A},l=function(a){return a.type==="PRIV"?c(a):a.type[0]==="W"?d(a):v(a)},c=function(a){if(!(a.size<2)){var g=t(a.data,!0),A=new Uint8Array(a.data.subarray(g.length+1));return{key:a.type,info:g,data:A.buffer}}},v=function(a){if(!(a.size<2)){if(a.type==="TXXX"){var g=1,A=t(a.data.subarray(g),!0);g+=A.length+1;var D=t(a.data.subarray(g));return{key:a.type,info:A,data:D}}var y=t(a.data.subarray(1));return{key:a.type,data:y}}},d=function(a){if(a.type==="WXXX"){if(a.size<2)return;var g=1,A=t(a.data.subarray(g),!0);g+=A.length+1;var D=t(a.data.subarray(g));return{key:a.type,info:A,data:D}}var y=t(a.data);return{key:a.type,data:y}},i=function(a){if(a.data.byteLength===8){var g=new Uint8Array(a.data),A=g[3]&1,D=(g[4]<<23)+(g[5]<<15)+(g[6]<<7)+g[7];return D/=45,A&&(D+=4772185884e-2),Math.round(D)}},t=function(a,g){g===void 0&&(g=!1);var A=s();if(A){var D=A.decode(a);if(g){var y=D.indexOf("\0");return y!==-1?D.substring(0,y):D}return D.replace(/\0/g,"")}for(var E=a.length,_,L,I,b="",R=0;R<E;){if(_=a[R++],_===0&&g)return b;if(_===0||_===3)continue;switch(_>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(_);break;case 12:case 13:L=a[R++],b+=String.fromCharCode((_&31)<<6|L&63);break;case 14:L=a[R++],I=a[R++],b+=String.fromCharCode((_&15)<<12|(L&63)<<6|(I&63)<<0);break}}return b},r={decodeTextFrame:v},e;function s(){return!e&&typeof self.TextDecoder!="undefined"&&(e=new self.TextDecoder("utf-8")),e}},"./src/demux/mp3demuxer.ts":function(O,C,x){x.r(C);var T=x("./src/demux/base-audio-demuxer.ts"),h=x("./src/demux/id3.ts"),m=x("./src/utils/logger.ts"),M=x("./src/demux/mpegaudio.ts");function S(n,f){n.prototype=Object.create(f.prototype),n.prototype.constructor=n,p(n,f)}function p(n,f){return p=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c},p(n,f)}var u=function(n){S(f,n);function f(){return n.apply(this,arguments)||this}var l=f.prototype;return l.resetInitSegment=function(v,d,i){n.prototype.resetInitSegment.call(this,v,d,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:v,duration:i,inputTimeScale:9e4,dropped:0}},f.probe=function(v){if(!v)return!1;for(var d=h.getID3Data(v,0)||[],i=d.length,t=v.length;i<t;i++)if(M.probe(v,i))return m.logger.log("MPEG Audio sync word found !"),!0;return!1},l.canParse=function(v,d){return M.canParse(v,d)},l.appendFrame=function(v,d,i){if(this.initPTS!==null)return M.appendFrame(v,d,i,this.initPTS,this.frameIndex)},f}(T.default);u.minProbeByteLength=4,C.default=u},"./src/demux/mp4demuxer.ts":function(O,C,x){x.r(C);var T=x("./src/utils/mp4-tools.ts"),h=x("./src/demux/dummy-demuxed-track.ts"),m=function(){function M(p,u){this.remainderData=null,this.config=void 0,this.config=u}var S=M.prototype;return S.resetTimeStamp=function(){},S.resetInitSegment=function(){},S.resetContiguity=function(){},M.probe=function(u){return Object(T.findBox)({data:u,start:0,end:Math.min(u.length,16384)},["moof"]).length>0},S.demux=function(u){var n=u,f=Object(h.dummyTrack)();if(this.config.progressive){this.remainderData&&(n=Object(T.appendUint8Array)(this.remainderData,u));var l=Object(T.segmentValidRange)(n);this.remainderData=l.remainder,f.samples=l.valid||new Uint8Array}else f.samples=n;return{audioTrack:Object(h.dummyTrack)(),avcTrack:f,id3Track:Object(h.dummyTrack)(),textTrack:Object(h.dummyTrack)()}},S.flush=function(){var u=Object(h.dummyTrack)();return u.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(h.dummyTrack)(),avcTrack:u,id3Track:Object(h.dummyTrack)(),textTrack:Object(h.dummyTrack)()}},S.demuxSampleAes=function(u,n,f){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},S.destroy=function(){},M}();m.minProbeByteLength=1024,C.default=m},"./src/demux/mpegaudio.ts":function(O,C,x){x.r(C),x.d(C,"appendFrame",function(){return p}),x.d(C,"parseHeader",function(){return u}),x.d(C,"isHeaderPattern",function(){return n}),x.d(C,"isHeader",function(){return f}),x.d(C,"canParse",function(){return l}),x.d(C,"probe",function(){return c});var T=null,h=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],m=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],S=[0,1,1,4];function p(v,d,i,t,r){if(!(i+24>d.length)){var e=u(d,i);if(e&&i+e.frameLength<=d.length){var s=e.samplesPerFrame*9e4/e.sampleRate,o=t+r*s,a={unit:d.subarray(i,i+e.frameLength),pts:o,dts:o};return v.config=[],v.channelCount=e.channelCount,v.samplerate=e.sampleRate,v.samples.push(a),{sample:a,length:e.frameLength,missing:0}}}}function u(v,d){var i=v[d+1]>>3&3,t=v[d+1]>>1&3,r=v[d+2]>>4&15,e=v[d+2]>>2&3;if(i!==1&&r!==0&&r!==15&&e!==3){var s=v[d+2]>>1&1,o=v[d+3]>>6,a=i===3?3-t:t===3?3:4,g=h[a*14+r-1]*1e3,A=i===3?0:i===2?1:2,D=m[A*3+e],y=o===3?1:2,E=M[i][t],_=S[t],L=E*8*_,I=Math.floor(E*g/D+s)*_;if(T===null){var b=navigator.userAgent||"",R=b.match(/Chrome\/(\d+)/i);T=R?parseInt(R[1]):0}var P=!!T&&T<=87;return P&&t===2&&g>=224e3&&o===0&&(v[d+3]=v[d+3]|128),{sampleRate:D,channelCount:y,frameLength:I,samplesPerFrame:L}}}function n(v,d){return v[d]===255&&(v[d+1]&224)===224&&(v[d+1]&6)!==0}function f(v,d){return d+1<v.length&&n(v,d)}function l(v,d){var i=4;return n(v,d)&&i<=v.length-d}function c(v,d){if(d+1<v.length&&n(v,d)){var i=4,t=u(v,d),r=i;t!=null&&t.frameLength&&(r=t.frameLength);var e=d+r;return e===v.length||f(v,e)}return!1}},"./src/demux/sample-aes.ts":function(O,C,x){x.r(C);var T=x("./src/crypt/decrypter.ts"),h=x("./src/demux/tsdemuxer.ts"),m=function(){function M(p,u,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new T.default(p,u,{removePKCS7Padding:!1})}var S=M.prototype;return S.decryptBuffer=function(u,n){this.decrypter.decrypt(u,this.keyData.key.buffer,this.keyData.iv.buffer,n)},S.decryptAacSample=function(u,n,f,l){var c=u[n].unit,v=c.subarray(16,c.length-c.length%16),d=v.buffer.slice(v.byteOffset,v.byteOffset+v.length),i=this;this.decryptBuffer(d,function(t){var r=new Uint8Array(t);c.set(r,16),l||i.decryptAacSamples(u,n+1,f)})},S.decryptAacSamples=function(u,n,f){for(;;n++){if(n>=u.length){f();return}if(!(u[n].unit.length<32)){var l=this.decrypter.isSync();if(this.decryptAacSample(u,n,f,l),!l)return}}},S.getAvcEncryptedData=function(u){for(var n=Math.floor((u.length-48)/160)*16+16,f=new Int8Array(n),l=0,c=32;c<u.length-16;c+=160,l+=16)f.set(u.subarray(c,c+16),l);return f},S.getAvcDecryptedUnit=function(u,n){for(var f=new Uint8Array(n),l=0,c=32;c<u.length-16;c+=160,l+=16)u.set(f.subarray(l,l+16),c);return u},S.decryptAvcSample=function(u,n,f,l,c,v){var d=Object(h.discardEPB)(c.data),i=this.getAvcEncryptedData(d),t=this;this.decryptBuffer(i.buffer,function(r){c.data=t.getAvcDecryptedUnit(d,r),v||t.decryptAvcSamples(u,n,f+1,l)})},S.decryptAvcSamples=function(u,n,f,l){if(u instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,f=0){if(n>=u.length){l();return}for(var c=u[n].units;!(f>=c.length);f++){var v=c[f];if(!(v.data.length<=48||v.type!==1&&v.type!==5)){var d=this.decrypter.isSync();if(this.decryptAvcSample(u,n,f,l,v,d),!d)return}}}},M}();C.default=m},"./src/demux/transmuxer-interface.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return f});var T=x("./node_modules/webworkify-webpack/index.js"),h=x("./src/events.ts"),m=x("./src/demux/transmuxer.ts"),M=x("./src/utils/logger.ts"),S=x("./src/errors.ts"),p=x("./src/utils/mediasource-helper.ts"),u=x("./node_modules/eventemitter3/index.js"),n=Object(p.getMediaSource)()||{isTypeSupported:function(){return!1}},f=function(){function l(v,d,i,t){var r=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=v,this.id=d,this.onTransmuxComplete=i,this.onFlush=t;var e=v.config,s=function(D,y){y=y||{},y.frag=r.frag,y.id=r.id,v.trigger(D,y)};this.observer=new u.EventEmitter,this.observer.on(h.Events.FRAG_DECRYPTED,s),this.observer.on(h.Events.ERROR,s);var o={mp4:n.isTypeSupported("video/mp4"),mpeg:n.isTypeSupported("audio/mpeg"),mp3:n.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(e.enableWorker&&typeof Worker!="undefined"){M.logger.log("demuxing in webworker");var g;try{g=this.worker=T("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),g.addEventListener("message",this.onwmsg),g.onerror=function(A){v.trigger(h.Events.ERROR,{type:S.ErrorTypes.OTHER_ERROR,details:S.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(A.message+"  ("+A.filename+":"+A.lineno+")")})},g.postMessage({cmd:"init",typeSupported:o,vendor:a,id:d,config:JSON.stringify(e)})}catch(A){M.logger.warn("Error in worker:",A),M.logger.error("Error while initializing DemuxerWorker, fallback to inline"),g&&self.URL.revokeObjectURL(g.objectURL),this.transmuxer=new m.default(this.observer,o,e,a,d),this.worker=null}}else this.transmuxer=new m.default(this.observer,o,e,a,d)}var c=l.prototype;return c.destroy=function(){var d=this.worker;if(d)d.removeEventListener("message",this.onwmsg),d.terminate(),this.worker=null;else{var i=this.transmuxer;i&&(i.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.observer=null},c.push=function(d,i,t,r,e,s,o,a,g,A){var D,y,E=this;g.transmuxing.start=self.performance.now();var _=this.transmuxer,L=this.worker,I=s?s.start:e.start,b=e.decryptdata,R=this.frag,P=!(R&&e.cc===R.cc),w=!(R&&g.level===R.level),F=R?g.sn-R.sn:-1,k=this.part?g.part-this.part.index:1,B=!w&&(F===1||F===0&&k===1),U=self.performance.now();(w||F||e.stats.parsing.start===0)&&(e.stats.parsing.start=U),s&&(k||!B)&&(s.stats.parsing.start=U);var j=!(R&&((D=e.initSegment)===null||D===void 0?void 0:D.url)===((y=R.initSegment)===null||y===void 0?void 0:y.url)),K=new m.TransmuxState(P,B,a,w,I,j);if(!B||P||j){M.logger.log("[transmuxer-interface, "+e.type+"]: Starting new transmux session for sn: "+g.sn+" p: "+g.part+" level: "+g.level+" id: "+g.id+`
        discontinuity: `+P+`
        trackSwitch: `+w+`
        contiguous: `+B+`
        accurateTimeOffset: `+a+`
        timeOffset: `+I+`
        initSegmentChange: `+j);var N=new m.TransmuxConfig(t,r,i,o,A);this.configureTransmuxer(N)}if(this.frag=e,this.part=s,L)L.postMessage({cmd:"demux",data:d,decryptdata:b,chunkMeta:g,state:K},d instanceof ArrayBuffer?[d]:[]);else if(_){var Z=_.push(d,b,g,K);Object(m.isPromise)(Z)?Z.then(function($){E.handleTransmuxComplete($)}):this.handleTransmuxComplete(Z)}},c.flush=function(d){var i=this;d.transmuxing.start=self.performance.now();var t=this.transmuxer,r=this.worker;if(r)r.postMessage({cmd:"flush",chunkMeta:d});else if(t){var e=t.flush(d);Object(m.isPromise)(e)?e.then(function(s){i.handleFlushResult(s,d)}):this.handleFlushResult(e,d)}},c.handleFlushResult=function(d,i){var t=this;d.forEach(function(r){t.handleTransmuxComplete(r)}),this.onFlush(i)},c.onWorkerMessage=function(d){var i=d.data,t=this.hls;switch(i.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(i.data);break}case"flush":{this.onFlush(i.data);break}default:{i.data=i.data||{},i.data.frag=this.frag,i.data.id=this.id,t.trigger(i.event,i.data);break}}},c.configureTransmuxer=function(d){var i=this.worker,t=this.transmuxer;i?i.postMessage({cmd:"configure",config:d}):t&&t.configure(d)},c.handleTransmuxComplete=function(d){d.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(d)},l}()},"./src/demux/transmuxer-worker.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var T=x("./src/demux/transmuxer.ts"),h=x("./src/events.ts"),m=x("./src/utils/logger.ts"),M=x("./node_modules/eventemitter3/index.js");function S(l){var c=new M.EventEmitter,v=function(i,t){l.postMessage({event:i,data:t})};c.on(h.Events.FRAG_DECRYPTED,v),c.on(h.Events.ERROR,v),l.addEventListener("message",function(d){var i=d.data;switch(i.cmd){case"init":{var t=JSON.parse(i.config);l.transmuxer=new T.default(c,i.typeSupported,t,i.vendor,i.id),Object(m.enableLogs)(t.debug),v("init",null);break}case"configure":{l.transmuxer.configure(i.config);break}case"demux":{var r=l.transmuxer.push(i.data,i.decryptdata,i.chunkMeta,i.state);Object(T.isPromise)(r)?r.then(function(o){p(l,o)}):p(l,r);break}case"flush":{var e=i.chunkMeta,s=l.transmuxer.flush(e);Object(T.isPromise)(s)?s.then(function(o){n(l,o,e)}):n(l,s,e);break}}})}function p(l,c){if(!f(c.remuxResult)){var v=[],d=c.remuxResult,i=d.audio,t=d.video;i&&u(v,i),t&&u(v,t),l.postMessage({event:"transmuxComplete",data:c},v)}}function u(l,c){c.data1&&l.push(c.data1.buffer),c.data2&&l.push(c.data2.buffer)}function n(l,c,v){c.forEach(function(d){p(l,d)}),l.postMessage({event:"flush",data:v})}function f(l){return!l.audio&&!l.video&&!l.text&&!l.id3&&!l.initSegment}},"./src/demux/transmuxer.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return r}),x.d(C,"isPromise",function(){return o}),x.d(C,"TransmuxConfig",function(){return a}),x.d(C,"TransmuxState",function(){return g});var T=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/crypt/decrypter.ts"),M=x("./src/demux/aacdemuxer.ts"),S=x("./src/demux/mp4demuxer.ts"),p=x("./src/demux/tsdemuxer.ts"),u=x("./src/demux/mp3demuxer.ts"),n=x("./src/remux/mp4-remuxer.ts"),f=x("./src/remux/passthrough-remuxer.ts"),l=x("./src/demux/chunk-cache.ts"),c=x("./src/utils/mp4-tools.ts"),v=x("./src/utils/logger.ts"),d;try{d=self.performance.now.bind(self.performance)}catch{v.logger.debug("Unable to use Performance API on this environment"),d=self.Date.now}var i=[{demux:p.default,remux:n.default},{demux:S.default,remux:f.default},{demux:M.default,remux:n.default},{demux:u.default,remux:n.default}],t=1024;i.forEach(function(A){var D=A.demux;t=Math.max(t,D.minProbeByteLength)});var r=function(){function A(y,E,_,L,I){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new l.default,this.observer=y,this.typeSupported=E,this.config=_,this.vendor=L,this.id=I}var D=A.prototype;return D.configure=function(E){this.transmuxConfig=E,this.decrypter&&this.decrypter.reset()},D.push=function(E,_,L,I){var b=this,R=L.transmuxing;R.executeStart=d();var P=new Uint8Array(E),w=this.cache,F=this.config,k=this.currentTransmuxState,B=this.transmuxConfig;I&&(this.currentTransmuxState=I);var U=e(P,_);if(U&&U.method==="AES-128"){var j=this.getDecrypter();if(F.enableSoftwareAES){var K=j.softwareDecrypt(P,U.key.buffer,U.iv.buffer);if(!K)return R.executeEnd=d(),s(L);P=new Uint8Array(K)}else return this.decryptionPromise=j.webCryptoDecrypt(P,U.key.buffer,U.iv.buffer).then(function(ae){var fe=b.push(ae,null,L);return b.decryptionPromise=null,fe}),this.decryptionPromise}var N=I||k,Z=N.contiguous,$=N.discontinuity,Y=N.trackSwitch,ee=N.accurateTimeOffset,Q=N.timeOffset,G=N.initSegmentChange,q=B.audioCodec,te=B.videoCodec,ie=B.defaultInitPts,ne=B.duration,le=B.initSegmentData;if(($||Y||G)&&this.resetInitSegment(le,q,te,ne),($||G)&&this.resetInitialTimestamp(ie),Z||this.resetContiguity(),this.needsProbing(P,$,Y)){if(w.dataLength){var se=w.flush();P=Object(c.appendUint8Array)(se,P)}this.configureTransmuxer(P,B)}var oe=this.transmux(P,U,Q,ee,L),J=this.currentTransmuxState;return J.contiguous=!0,J.discontinuity=!1,J.trackSwitch=!1,R.executeEnd=d(),oe},D.flush=function(E){var _=this,L=E.transmuxing;L.executeStart=d();var I=this.decrypter,b=this.cache,R=this.currentTransmuxState,P=this.decryptionPromise;if(P)return P.then(function(){return _.flush(E)});var w=[],F=R.timeOffset;if(I){var k=I.flush();k&&w.push(this.push(k,null,E))}var B=b.dataLength;b.reset();var U=this.demuxer,j=this.remuxer;if(!U||!j)return B>=t&&this.observer.emit(T.Events.ERROR,T.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),L.executeEnd=d(),[s(E)];var K=U.flush(F);return o(K)?K.then(function(N){return _.flushRemux(w,N,E),w}):(this.flushRemux(w,K,E),w)},D.flushRemux=function(E,_,L){var I=_.audioTrack,b=_.avcTrack,R=_.id3Track,P=_.textTrack,w=this.currentTransmuxState,F=w.accurateTimeOffset,k=w.timeOffset;v.logger.log("[transmuxer.ts]: Flushed fragment "+L.sn+(L.part>-1?" p: "+L.part:"")+" of level "+L.level);var B=this.remuxer.remux(I,b,R,P,k,F,!0,this.id);E.push({remuxResult:B,chunkMeta:L}),L.transmuxing.executeEnd=d()},D.resetInitialTimestamp=function(E){var _=this.demuxer,L=this.remuxer;!_||!L||(_.resetTimeStamp(E),L.resetTimeStamp(E))},D.resetContiguity=function(){var E=this.demuxer,_=this.remuxer;!E||!_||(E.resetContiguity(),_.resetNextTimestamp())},D.resetInitSegment=function(E,_,L,I){var b=this.demuxer,R=this.remuxer;!b||!R||(b.resetInitSegment(_,L,I),R.resetInitSegment(E,_,L))},D.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},D.transmux=function(E,_,L,I,b){var R;return _&&_.method==="SAMPLE-AES"?R=this.transmuxSampleAes(E,_,L,I,b):R=this.transmuxUnencrypted(E,L,I,b),R},D.transmuxUnencrypted=function(E,_,L,I){var b=this.demuxer.demux(E,_,!1,!this.config.progressive),R=b.audioTrack,P=b.avcTrack,w=b.id3Track,F=b.textTrack,k=this.remuxer.remux(R,P,w,F,_,L,!1,this.id);return{remuxResult:k,chunkMeta:I}},D.transmuxSampleAes=function(E,_,L,I,b){var R=this;return this.demuxer.demuxSampleAes(E,_,L).then(function(P){var w=R.remuxer.remux(P.audioTrack,P.avcTrack,P.id3Track,P.textTrack,L,I,!1,R.id);return{remuxResult:w,chunkMeta:b}})},D.configureTransmuxer=function(E,_){for(var L=this.config,I=this.observer,b=this.typeSupported,R=this.vendor,P=_.audioCodec,w=_.defaultInitPts,F=_.duration,k=_.initSegmentData,B=_.videoCodec,U,j=0,K=i.length;j<K;j++)if(i[j].demux.probe(E)){U=i[j];break}U||(v.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),U={demux:S.default,remux:f.default});var N=this.demuxer,Z=this.remuxer,$=U.remux,Y=U.demux;(!Z||!(Z instanceof $))&&(this.remuxer=new $(I,L,b,R)),(!N||!(N instanceof Y))&&(this.demuxer=new Y(I,L,b),this.probe=Y.probe),this.resetInitSegment(k,P,B,F),this.resetInitialTimestamp(w)},D.needsProbing=function(E,_,L){return!this.demuxer||!this.remuxer||_||L},D.getDecrypter=function(){var E=this.decrypter;return E||(E=this.decrypter=new m.default(this.observer,this.config)),E},A}();function e(A,D){var y=null;return A.byteLength>0&&D!=null&&D.key!=null&&D.iv!==null&&D.method!=null&&(y=D),y}var s=function(D){return{remuxResult:{},chunkMeta:D}};function o(A){return"then"in A&&A.then instanceof Function}var a=function(D,y,E,_,L){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=D,this.videoCodec=y,this.initSegmentData=E,this.duration=_,this.defaultInitPts=L},g=function(D,y,E,_,L,I){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=D,this.contiguous=y,this.accurateTimeOffset=E,this.trackSwitch=_,this.timeOffset=L,this.initSegmentChange=I}},"./src/demux/tsdemuxer.ts":function(O,C,x){x.r(C),x.d(C,"discardEPB",function(){return s});var T=x("./src/demux/adts.ts"),h=x("./src/demux/mpegaudio.ts"),m=x("./src/demux/exp-golomb.ts"),M=x("./src/demux/id3.ts"),S=x("./src/demux/sample-aes.ts"),p=x("./src/events.ts"),u=x("./src/utils/mp4-tools.ts"),n=x("./src/utils/logger.ts"),f=x("./src/errors.ts"),l={video:1,audio:2,id3:3,text:4},c=function(){function o(g,A,D){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=g,this.config=A,this.typeSupported=D}o.probe=function(A){var D=o.syncOffset(A);return D<0?!1:(D&&n.logger.warn("MPEG2-TS detected but first sync word found @ offset "+D+", junk ahead ?"),!0)},o.syncOffset=function(A){for(var D=Math.min(1e3,A.length-564),y=0;y<D;){if(A[y]===71&&A[y+188]===71&&A[y+2*188]===71)return y;y++}return-1},o.createTrack=function(A,D){return{container:A==="video"||A==="audio"?"video/mp2t":void 0,type:A,id:l[A],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:A==="audio"?D:void 0}};var a=o.prototype;return a.resetInitSegment=function(A,D,y){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=o.createTrack("video",y),this._audioTrack=o.createTrack("audio",y),this._id3Track=o.createTrack("id3",y),this._txtTrack=o.createTrack("text",y),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=A,this.videoCodec=D,this._duration=y},a.resetTimeStamp=function(){},a.resetContiguity=function(){var A=this._audioTrack,D=this._avcTrack,y=this._id3Track;A&&(A.pesData=null),D&&(D.pesData=null),y&&(y.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},a.demux=function(A,D,y,E){y===void 0&&(y=!1),E===void 0&&(E=!1),y||(this.sampleAes=null);var _,L=this._avcTrack,I=this._audioTrack,b=this._id3Track,R=L.pid,P=L.pesData,w=I.pid,F=b.pid,k=I.pesData,B=b.pesData,U=!1,j=this.pmtParsed,K=this._pmtId,N=A.length;if(this.remainderData&&(A=Object(u.appendUint8Array)(this.remainderData,A),N=A.length,this.remainderData=null),N<188&&!E)return this.remainderData=A,{audioTrack:I,avcTrack:L,id3Track:b,textTrack:this._txtTrack};var Z=Math.max(0,o.syncOffset(A));N-=(N+Z)%188,N<A.byteLength&&!E&&(this.remainderData=new Uint8Array(A.buffer,N,A.buffer.byteLength-N));for(var $=0,Y=Z;Y<N;Y+=188)if(A[Y]===71){var ee=!!(A[Y+1]&64),Q=((A[Y+1]&31)<<8)+A[Y+2],G=(A[Y+3]&48)>>4,q=void 0;if(G>1){if(q=Y+5+A[Y+4],q===Y+188)continue}else q=Y+4;switch(Q){case R:ee&&(P&&(_=t(P))&&this.parseAVCPES(_,!1),P={data:[],size:0}),P&&(P.data.push(A.subarray(q,Y+188)),P.size+=Y+188-q);break;case w:ee&&(k&&(_=t(k))&&(I.isAAC?this.parseAACPES(_):this.parseMPEGPES(_)),k={data:[],size:0}),k&&(k.data.push(A.subarray(q,Y+188)),k.size+=Y+188-q);break;case F:ee&&(B&&(_=t(B))&&this.parseID3PES(_),B={data:[],size:0}),B&&(B.data.push(A.subarray(q,Y+188)),B.size+=Y+188-q);break;case 0:ee&&(q+=A[q]+1),K=this._pmtId=d(A,q);break;case K:{ee&&(q+=A[q]+1);var te=i(A,q,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,y);R=te.avc,R>0&&(L.pid=R),w=te.audio,w>0&&(I.pid=w,I.isAAC=te.isAAC),F=te.id3,F>0&&(b.pid=F),U&&!j&&(n.logger.log("reparse from beginning"),U=!1,Y=Z-188),j=this.pmtParsed=!0;break}case 17:case 8191:break;default:U=!0;break}}else $++;$>0&&this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+$+" TS packet/s that do not start with 0x47"}),L.pesData=P,I.pesData=k,b.pesData=B;var ie={audioTrack:I,avcTrack:L,id3Track:b,textTrack:this._txtTrack};return E&&this.extractRemainingSamples(ie),ie},a.flush=function(){var A=this.remainderData;this.remainderData=null;var D;return A?D=this.demux(A,-1,!1,!0):D={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},a.extractRemainingSamples=function(A){var D=A.audioTrack,y=A.avcTrack,E=A.id3Track,_=y.pesData,L=D.pesData,I=E.pesData,b;_&&(b=t(_))?(this.parseAVCPES(b,!0),y.pesData=null):y.pesData=_,L&&(b=t(L))?(D.isAAC?this.parseAACPES(b):this.parseMPEGPES(b),D.pesData=null):(L!=null&&L.size&&n.logger.log("last AAC PES packet truncated,might overlap between fragments"),D.pesData=L),I&&(b=t(I))?(this.parseID3PES(b),E.pesData=null):E.pesData=I},a.demuxSampleAes=function(A,D,y){var E=this.demux(A,y,!0,!this.config.progressive),_=this.sampleAes=new S.default(this.observer,this.config,D);return this.decrypt(E,_)},a.decrypt=function(A,D){return new Promise(function(y){var E=A.audioTrack,_=A.avcTrack;E.samples&&E.isAAC?D.decryptAacSamples(E.samples,0,function(){_.samples?D.decryptAvcSamples(_.samples,0,0,function(){y(A)}):y(A)}):_.samples&&D.decryptAvcSamples(_.samples,0,0,function(){y(A)})})},a.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},a.parseAVCPES=function(A,D){var y=this,E=this._avcTrack,_=this.parseAVCNALu(A.data),L=this.avcSample,I,b=!1;A.data=null,L&&_.length&&!E.audFound&&(r(L,E),L=this.avcSample=v(!1,A.pts,A.dts,"")),_.forEach(function(R){switch(R.type){case 1:{I=!0,L||(L=y.avcSample=v(!0,A.pts,A.dts,"")),L.frame=!0;var P=R.data;if(b&&P.length>4){var w=new m.default(P).readSliceType();(w===2||w===4||w===7||w===9)&&(L.key=!0)}break}case 5:I=!0,L||(L=y.avcSample=v(!0,A.pts,A.dts,"")),L.key=!0,L.frame=!0;break;case 6:{I=!0;var F=new m.default(s(R.data));F.readUByte();for(var k=0,B=0,U=!1,j=0;!U&&F.bytesAvailable>1;){k=0;do j=F.readUByte(),k+=j;while(j===255);B=0;do j=F.readUByte(),B+=j;while(j===255);if(k===4&&F.bytesAvailable!==0){U=!0;var K=F.readUByte();if(K===181){var N=F.readUShort();if(N===49){var Z=F.readUInt();if(Z===1195456820){var $=F.readUByte();if($===3){for(var Y=F.readUByte(),ee=F.readUByte(),Q=31&Y,G=[Y,ee],q=0;q<Q;q++)G.push(F.readUByte()),G.push(F.readUByte()),G.push(F.readUByte());e(y._txtTrack.samples,{type:3,pts:A.pts,bytes:G})}}}}}else if(k===5&&F.bytesAvailable!==0){if(U=!0,B>16){for(var te=[],ie=0;ie<16;ie++)te.push(F.readUByte().toString(16)),(ie===3||ie===5||ie===7||ie===9)&&te.push("-");for(var ne=B-16,le=new Uint8Array(ne),se=0;se<ne;se++)le[se]=F.readUByte();e(y._txtTrack.samples,{pts:A.pts,payloadType:k,uuid:te.join(""),userData:Object(M.utf8ArrayToStr)(le),userDataBytes:le})}}else if(B<F.bytesAvailable)for(var oe=0;oe<B;oe++)F.readUByte()}break}case 7:if(I=!0,b=!0,!E.sps){var J=new m.default(R.data),ae=J.readSPS();E.width=ae.width,E.height=ae.height,E.pixelRatio=ae.pixelRatio,E.sps=[R.data],E.duration=y._duration;for(var fe=R.data.subarray(1,4),de="avc1.",ve=0;ve<3;ve++){var ue=fe[ve].toString(16);ue.length<2&&(ue="0"+ue),de+=ue}E.codec=de}break;case 8:I=!0,E.pps||(E.pps=[R.data]);break;case 9:I=!1,E.audFound=!0,L&&r(L,E),L=y.avcSample=v(!1,A.pts,A.dts,"");break;case 12:I=!1;break;default:I=!1,L&&(L.debug+="unknown NAL "+R.type+" ");break}if(L&&I){var Te=L.units;Te.push(R)}}),D&&L&&(r(L,E),this.avcSample=null)},a.getLastNalUnit=function(){var A,D=this.avcSample,y;if(!D||D.units.length===0){var E=this._avcTrack.samples;D=E[E.length-1]}if((A=D)!==null&&A!==void 0&&A.units){var _=D.units;y=_[_.length-1]}return y},a.parseAVCNALu=function(A){var D=A.byteLength,y=this._avcTrack,E=y.naluState||0,_=E,L=[],I=0,b,R,P,w=-1,F=0;for(E===-1&&(w=0,F=A[0]&31,E=0,I=1);I<D;){if(b=A[I++],!E){E=b?0:1;continue}if(E===1){E=b?0:2;continue}if(!b)E=3;else if(b===1){if(w>=0){var k={data:A.subarray(w,I-E-1),type:F};L.push(k)}else{var B=this.getLastNalUnit();if(B&&(_&&I<=4-_&&B.state&&(B.data=B.data.subarray(0,B.data.byteLength-_)),R=I-E-1,R>0)){var U=new Uint8Array(B.data.byteLength+R);U.set(B.data,0),U.set(A.subarray(0,R),B.data.byteLength),B.data=U,B.state=0}}I<D?(P=A[I]&31,w=I,F=P,E=0):E=-1}else E=0}if(w>=0&&E>=0){var j={data:A.subarray(w,D),type:F,state:E};L.push(j)}if(L.length===0){var K=this.getLastNalUnit();if(K){var N=new Uint8Array(K.data.byteLength+A.byteLength);N.set(K.data,0),N.set(A,K.data.byteLength),K.data=N}}return y.naluState=E,L},a.parseAACPES=function(A){var D=0,y=this._audioTrack,E=this.aacOverFlow,_=A.data;if(E){this.aacOverFlow=null;var L=E.sample.unit.byteLength,I=Math.min(E.missing,L),b=L-I;E.sample.unit.set(_.subarray(0,I),b),y.samples.push(E.sample),D=E.missing}var R,P;for(R=D,P=_.length;R<P-1&&!T.isHeader(_,R);R++);if(R!==D){var w,F;if(R<P-1?(w="AAC PES did not start with ADTS header,offset:"+R,F=!1):(w="no ADTS header found in AAC PES",F=!0),n.logger.warn("parsing error:"+w),this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:F,reason:w}),F)return}T.initTrackConfig(y,this.observer,_,R,this.audioCodec);var k;if(A.pts!==void 0)k=A.pts;else if(E){var B=T.getFrameDuration(y.samplerate);k=E.sample.pts+B}else{n.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var U=0;R<P;)if(T.isHeader(_,R)){if(R+5<P){var j=T.appendFrame(y,_,R,k,U);if(j)if(j.missing)this.aacOverFlow=j;else{R+=j.length,U++;continue}}break}else R++},a.parseMPEGPES=function(A){var D=A.data,y=D.length,E=0,_=0,L=A.pts;if(L===void 0){n.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;_<y;)if(h.isHeader(D,_)){var I=h.appendFrame(this._audioTrack,D,_,L,E);if(I)_+=I.length,E++;else break}else _++},a.parseID3PES=function(A){if(A.pts===void 0){n.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(A)},o}();c.minProbeByteLength=188;function v(o,a,g,A){return{key:o,frame:!1,pts:a,dts:g,units:[],debug:A,length:0}}function d(o,a){return(o[a+10]&31)<<8|o[a+11]}function i(o,a,g,A){var D={audio:-1,avc:-1,id3:-1,isAAC:!0},y=(o[a+1]&15)<<8|o[a+2],E=a+3+y-4,_=(o[a+10]&15)<<8|o[a+11];for(a+=12+_;a<E;){var L=(o[a+1]&31)<<8|o[a+2];switch(o[a]){case 207:if(!A){n.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:D.audio===-1&&(D.audio=L);break;case 21:D.id3===-1&&(D.id3=L);break;case 219:if(!A){n.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:D.avc===-1&&(D.avc=L);break;case 3:case 4:g?D.audio===-1&&(D.audio=L,D.isAAC=!1):n.logger.log("MPEG audio found, not supported in this browser");break;case 36:n.logger.warn("Unsupported HEVC stream type found");break}a+=((o[a+3]&15)<<8|o[a+4])+5}return D}function t(o){var a=0,g,A,D,y,E,_=o.data;if(!o||o.size===0)return null;for(;_[0].length<19&&_.length>1;){var L=new Uint8Array(_[0].length+_[1].length);L.set(_[0]),L.set(_[1],_[0].length),_[0]=L,_.splice(1,1)}g=_[0];var I=(g[0]<<16)+(g[1]<<8)+g[2];if(I===1){if(A=(g[4]<<8)+g[5],A&&A>o.size-6)return null;var b=g[7];b&192&&(y=(g[9]&14)*536870912+(g[10]&255)*4194304+(g[11]&254)*16384+(g[12]&255)*128+(g[13]&254)/2,b&64?(E=(g[14]&14)*536870912+(g[15]&255)*4194304+(g[16]&254)*16384+(g[17]&255)*128+(g[18]&254)/2,y-E>60*9e4&&(n.logger.warn(Math.round((y-E)/9e4)+"s delta between PTS and DTS, align them"),y=E)):E=y),D=g[8];var R=D+9;if(o.size<=R)return null;o.size-=R;for(var P=new Uint8Array(o.size),w=0,F=_.length;w<F;w++){g=_[w];var k=g.byteLength;if(R)if(R>k){R-=k;continue}else g=g.subarray(R),k-=R,R=0;P.set(g,a),a+=k}return A&&(A-=D+3),{data:P,pts:y,dts:E,len:A}}return null}function r(o,a){if(o.units.length&&o.frame){if(o.pts===void 0){var g=a.samples,A=g.length;if(A){var D=g[A-1];o.pts=D.pts,o.dts=D.dts}else{a.dropped++;return}}a.samples.push(o)}o.debug.length&&n.logger.log(o.pts+"/"+o.dts+":"+o.debug)}function e(o,a){var g=o.length;if(g>0){if(a.pts>=o[g-1].pts)o.push(a);else for(var A=g-1;A>=0;A--)if(a.pts<o[A].pts){o.splice(A,0,a);break}}else o.push(a)}function s(o){for(var a=o.byteLength,g=[],A=1;A<a-2;)o[A]===0&&o[A+1]===0&&o[A+2]===3?(g.push(A+2),A+=2):A++;if(g.length===0)return o;var D=a-g.length,y=new Uint8Array(D),E=0;for(A=0;A<D;E++,A++)E===g[0]&&(E++,g.shift()),y[A]=o[E];return y}C.default=c},"./src/errors.ts":function(O,C,x){x.r(C),x.d(C,"ErrorTypes",function(){return T}),x.d(C,"ErrorDetails",function(){return h});var T;(function(m){m.NETWORK_ERROR="networkError",m.MEDIA_ERROR="mediaError",m.KEY_SYSTEM_ERROR="keySystemError",m.MUX_ERROR="muxError",m.OTHER_ERROR="otherError"})(T||(T={}));var h;(function(m){m.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",m.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",m.KEY_SYSTEM_NO_SESSION="keySystemNoSession",m.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",m.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",m.MANIFEST_LOAD_ERROR="manifestLoadError",m.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",m.MANIFEST_PARSING_ERROR="manifestParsingError",m.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",m.LEVEL_EMPTY_ERROR="levelEmptyError",m.LEVEL_LOAD_ERROR="levelLoadError",m.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",m.LEVEL_SWITCH_ERROR="levelSwitchError",m.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",m.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",m.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",m.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",m.FRAG_LOAD_ERROR="fragLoadError",m.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",m.FRAG_DECRYPT_ERROR="fragDecryptError",m.FRAG_PARSING_ERROR="fragParsingError",m.REMUX_ALLOC_ERROR="remuxAllocError",m.KEY_LOAD_ERROR="keyLoadError",m.KEY_LOAD_TIMEOUT="keyLoadTimeOut",m.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",m.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",m.BUFFER_APPEND_ERROR="bufferAppendError",m.BUFFER_APPENDING_ERROR="bufferAppendingError",m.BUFFER_STALLED_ERROR="bufferStalledError",m.BUFFER_FULL_ERROR="bufferFullError",m.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",m.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",m.INTERNAL_EXCEPTION="internalException",m.INTERNAL_ABORTED="aborted",m.UNKNOWN="unknown"})(h||(h={}))},"./src/events.ts":function(O,C,x){x.r(C),x.d(C,"Events",function(){return T});var T;(function(h){h.MEDIA_ATTACHING="hlsMediaAttaching",h.MEDIA_ATTACHED="hlsMediaAttached",h.MEDIA_DETACHING="hlsMediaDetaching",h.MEDIA_DETACHED="hlsMediaDetached",h.BUFFER_RESET="hlsBufferReset",h.BUFFER_CODECS="hlsBufferCodecs",h.BUFFER_CREATED="hlsBufferCreated",h.BUFFER_APPENDING="hlsBufferAppending",h.BUFFER_APPENDED="hlsBufferAppended",h.BUFFER_EOS="hlsBufferEos",h.BUFFER_FLUSHING="hlsBufferFlushing",h.BUFFER_FLUSHED="hlsBufferFlushed",h.MANIFEST_LOADING="hlsManifestLoading",h.MANIFEST_LOADED="hlsManifestLoaded",h.MANIFEST_PARSED="hlsManifestParsed",h.LEVEL_SWITCHING="hlsLevelSwitching",h.LEVEL_SWITCHED="hlsLevelSwitched",h.LEVEL_LOADING="hlsLevelLoading",h.LEVEL_LOADED="hlsLevelLoaded",h.LEVEL_UPDATED="hlsLevelUpdated",h.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",h.LEVELS_UPDATED="hlsLevelsUpdated",h.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",h.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",h.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",h.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",h.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",h.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",h.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",h.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",h.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",h.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",h.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",h.CUES_PARSED="hlsCuesParsed",h.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",h.INIT_PTS_FOUND="hlsInitPtsFound",h.FRAG_LOADING="hlsFragLoading",h.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",h.FRAG_LOADED="hlsFragLoaded",h.FRAG_DECRYPTED="hlsFragDecrypted",h.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",h.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",h.FRAG_PARSING_METADATA="hlsFragParsingMetadata",h.FRAG_PARSED="hlsFragParsed",h.FRAG_BUFFERED="hlsFragBuffered",h.FRAG_CHANGED="hlsFragChanged",h.FPS_DROP="hlsFpsDrop",h.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",h.ERROR="hlsError",h.DESTROYING="hlsDestroying",h.KEY_LOADING="hlsKeyLoading",h.KEY_LOADED="hlsKeyLoaded",h.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",h.BACK_BUFFER_REACHED="hlsBackBufferReached"})(T||(T={}))},"./src/hls.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return e});var T=x("./node_modules/url-toolkit/src/url-toolkit.js"),h=x("./src/loader/playlist-loader.ts"),m=x("./src/loader/key-loader.ts"),M=x("./src/controller/id3-track-controller.ts"),S=x("./src/controller/latency-controller.ts"),p=x("./src/controller/level-controller.ts"),u=x("./src/controller/fragment-tracker.ts"),n=x("./src/controller/stream-controller.ts"),f=x("./src/is-supported.ts"),l=x("./src/utils/logger.ts"),c=x("./src/config.ts"),v=x("./node_modules/eventemitter3/index.js"),d=x("./src/events.ts"),i=x("./src/errors.ts");function t(s,o){for(var a=0;a<o.length;a++){var g=o[a];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(s,g.key,g)}}function r(s,o,a){return o&&t(s.prototype,o),a&&t(s,a),s}var e=function(){s.isSupported=function(){return Object(f.isSupported)()};function s(a){a===void 0&&(a={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new v.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var g=this.config=Object(c.mergeConfig)(s.DefaultConfig,a);this.userConfig=a,Object(l.enableLogs)(g.debug),this._autoLevelCapping=-1,g.progressive&&Object(c.enableStreamingMode)(g);var A=g.abrController,D=g.bufferController,y=g.capLevelController,E=g.fpsController,_=this.abrController=new A(this),L=this.bufferController=new D(this),I=this.capLevelController=new y(this),b=new E(this),R=new h.default(this),P=new m.default(this),w=new M.default(this),F=this.levelController=new p.default(this),k=new u.FragmentTracker(this),B=this.streamController=new n.default(this,k);I.setStreamController(B),b.setStreamController(B);var U=[F,B];this.networkControllers=U;var j=[R,P,_,L,I,b,w,k];this.audioTrackController=this.createController(g.audioTrackController,null,U),this.createController(g.audioStreamController,k,U),this.subtitleTrackController=this.createController(g.subtitleTrackController,null,U),this.createController(g.subtitleStreamController,k,U),this.createController(g.timelineController,null,j),this.emeController=this.createController(g.emeController,null,j),this.cmcdController=this.createController(g.cmcdController,null,j),this.latencyController=this.createController(S.default,null,j),this.coreComponents=j}var o=s.prototype;return o.createController=function(g,A,D){if(g){var y=A?new g(this,A):new g(this);return D&&D.push(y),y}return null},o.on=function(g,A,D){D===void 0&&(D=this),this._emitter.on(g,A,D)},o.once=function(g,A,D){D===void 0&&(D=this),this._emitter.once(g,A,D)},o.removeAllListeners=function(g){this._emitter.removeAllListeners(g)},o.off=function(g,A,D,y){D===void 0&&(D=this),this._emitter.off(g,A,D,y)},o.listeners=function(g){return this._emitter.listeners(g)},o.emit=function(g,A,D){return this._emitter.emit(g,A,D)},o.trigger=function(g,A){if(this.config.debug)return this.emit(g,g,A);try{return this.emit(g,g,A)}catch(D){l.logger.error("An internal error happened while handling event "+g+'. Error message: "'+D.message+'". Here is a stacktrace:',D),this.trigger(d.Events.ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:g,error:D})}return!1},o.listenerCount=function(g){return this._emitter.listenerCount(g)},o.destroy=function(){l.logger.log("destroy"),this.trigger(d.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(g){return g.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(g){return g.destroy()}),this.coreComponents.length=0},o.attachMedia=function(g){l.logger.log("attachMedia"),this._media=g,this.trigger(d.Events.MEDIA_ATTACHING,{media:g})},o.detachMedia=function(){l.logger.log("detachMedia"),this.trigger(d.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function(g){this.stopLoad();var A=this.media,D=this.url,y=this.url=T.buildAbsoluteURL(self.location.href,g,{alwaysNormalize:!0});l.logger.log("loadSource:"+y),A&&D&&D!==y&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(A)),this.trigger(d.Events.MANIFEST_LOADING,{url:g})},o.startLoad=function(g){g===void 0&&(g=-1),l.logger.log("startLoad("+g+")"),this.networkControllers.forEach(function(A){A.startLoad(g)})},o.stopLoad=function(){l.logger.log("stopLoad"),this.networkControllers.forEach(function(g){g.stopLoad()})},o.swapAudioCodec=function(){l.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function(){l.logger.log("recoverMediaError");var g=this._media;this.detachMedia(),g&&this.attachMedia(g)},o.removeLevel=function(g,A){A===void 0&&(A=0),this.levelController.removeLevel(g,A)},r(s,[{key:"levels",get:function(){var g=this.levelController.levels;return g||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(g){l.logger.log("set currentLevel:"+g),this.loadLevel=g,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(g){l.logger.log("set nextLevel:"+g),this.levelController.manualLevel=g,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(g){l.logger.log("set loadLevel:"+g),this.levelController.manualLevel=g}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(g){this.levelController.nextLoadLevel=g}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(g){l.logger.log("set firstLevel:"+g),this.levelController.firstLevel=g}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(g){l.logger.log("set startLevel:"+g),g!==-1&&(g=Math.max(g,this.minAutoLevel)),this.levelController.startLevel=g}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(g){var A=!!g;A!==this.config.capLevelToPlayerSize&&(A?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=A)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(g){this._autoLevelCapping!==g&&(l.logger.log("set autoLevelCapping:"+g),this._autoLevelCapping=g)}},{key:"bandwidthEstimate",get:function(){var g=this.abrController.bwEstimator;return g?g.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var g=this.levels,A=this.config.minAutoBitrate;if(!g)return 0;for(var D=g.length,y=0;y<D;y++)if(g[y].maxBitrate>A)return y;return 0}},{key:"maxAutoLevel",get:function(){var g=this.levels,A=this.autoLevelCapping,D;return A===-1&&g&&g.length?D=g.length-1:D=A,D}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(g){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,g)}},{key:"audioTracks",get:function(){var g=this.audioTrackController;return g?g.audioTracks:[]}},{key:"audioTrack",get:function(){var g=this.audioTrackController;return g?g.audioTrack:-1},set:function(g){var A=this.audioTrackController;A&&(A.audioTrack=g)}},{key:"subtitleTracks",get:function(){var g=this.subtitleTrackController;return g?g.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var g=this.subtitleTrackController;return g?g.subtitleTrack:-1},set:function(g){var A=this.subtitleTrackController;A&&(A.subtitleTrack=g)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var g=this.subtitleTrackController;return g?g.subtitleDisplay:!1},set:function(g){var A=this.subtitleTrackController;A&&(A.subtitleDisplay=g)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(g){this.config.lowLatencyMode=g}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return d.Events}},{key:"ErrorTypes",get:function(){return i.ErrorTypes}},{key:"ErrorDetails",get:function(){return i.ErrorDetails}},{key:"DefaultConfig",get:function(){return s.defaultConfig?s.defaultConfig:c.hlsDefaultConfig},set:function(g){s.defaultConfig=g}}]),s}();e.defaultConfig=void 0},"./src/is-supported.ts":function(O,C,x){x.r(C),x.d(C,"isSupported",function(){return m}),x.d(C,"changeTypeSupported",function(){return M});var T=x("./src/utils/mediasource-helper.ts");function h(){return self.SourceBuffer||self.WebKitSourceBuffer}function m(){var S=Object(T.getMediaSource)();if(!S)return!1;var p=h(),u=S&&typeof S.isTypeSupported=="function"&&S.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!p||p.prototype&&typeof p.prototype.appendBuffer=="function"&&typeof p.prototype.remove=="function";return!!u&&!!n}function M(){var S,p=h();return typeof(p==null||(S=p.prototype)===null||S===void 0?void 0:S.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return c}),x.d(C,"LoadError",function(){return d});var T=x("./src/polyfills/number.ts"),h=x("./src/errors.ts");function m(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,n(i,t)}function M(i){var t=typeof Map=="function"?new Map:void 0;return M=function(e){if(e===null||!u(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return S(e,arguments,f(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),n(s,e)},M(i)}function S(i,t,r){return p()?S=Reflect.construct:S=function(s,o,a){var g=[null];g.push.apply(g,o);var A=Function.bind.apply(s,g),D=new A;return a&&n(D,a.prototype),D},S.apply(null,arguments)}function p(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function u(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function n(i,t){return n=Object.setPrototypeOf||function(e,s){return e.__proto__=s,e},n(i,t)}function f(i){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},f(i)}var l=Math.pow(2,17),c=function(){function i(r){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=r}var t=i.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,s){var o=this,a=e.url;if(!a)return Promise.reject(new d({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,networkDetails:null},"Fragment does not have a "+(a?"part list":"url")));this.abort();var g=this.config,A=g.fLoader,D=g.loader;return new Promise(function(y,E){o.loader&&o.loader.destroy();var _=o.loader=e.loader=A?new A(g):new D(g),L=v(e),I={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:l};e.stats=_.stats,_.load(L,I,{onSuccess:function(R,P,w,F){o.resetLoader(e,_),y({frag:e,part:null,payload:R.data,networkDetails:F})},onError:function(R,P,w){o.resetLoader(e,_),E(new d({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:R,networkDetails:w}))},onAbort:function(R,P,w){o.resetLoader(e,_),E(new d({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,networkDetails:w}))},onTimeout:function(R,P,w){o.resetLoader(e,_),E(new d({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,networkDetails:w}))},onProgress:function(R,P,w,F){s&&s({frag:e,part:null,payload:w,networkDetails:F})}})})},t.loadPart=function(e,s,o){var a=this;this.abort();var g=this.config,A=g.fLoader,D=g.loader;return new Promise(function(y,E){a.loader&&a.loader.destroy();var _=a.loader=e.loader=A?new A(g):new D(g),L=v(e,s),I={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:l};s.stats=_.stats,_.load(L,I,{onSuccess:function(R,P,w,F){a.resetLoader(e,_),a.updateStatsFromPart(e,s);var k={frag:e,part:s,payload:R.data,networkDetails:F};o(k),y(k)},onError:function(R,P,w){a.resetLoader(e,_),E(new d({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:s,response:R,networkDetails:w}))},onAbort:function(R,P,w){e.stats.aborted=s.stats.aborted,a.resetLoader(e,_),E(new d({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:s,networkDetails:w}))},onTimeout:function(R,P,w){a.resetLoader(e,_),E(new d({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:s,networkDetails:w}))}})})},t.updateStatsFromPart=function(e,s){var o=e.stats,a=s.stats,g=a.total;if(o.loaded+=a.loaded,g){var A=Math.round(e.duration/s.duration),D=Math.min(Math.round(o.loaded/g),A),y=A-D,E=y*Math.round(o.loaded/D);o.total=o.loaded+E}else o.total=Math.max(o.loaded,o.total);var _=o.loading,L=a.loading;_.start?_.first+=L.first-L.start:(_.start=L.start,_.first=L.first),_.end=L.end},t.resetLoader=function(e,s){e.loader=null,this.loader===s&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),s.destroy()},i}();function v(i,t){t===void 0&&(t=null);var r=t||i,e={frag:i,part:t,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},s=r.byteRangeStartOffset,o=r.byteRangeEndOffset;return Object(T.isFiniteNumber)(s)&&Object(T.isFiniteNumber)(o)&&(e.rangeStart=s,e.rangeEnd=o),e}var d=function(i){m(t,i);function t(r){for(var e,s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];return e=i.call.apply(i,[this].concat(o))||this,e.data=void 0,e.data=r,e}return t}(M(Error))},"./src/loader/fragment.ts":function(O,C,x){x.r(C),x.d(C,"ElementaryStreamTypes",function(){return l}),x.d(C,"BaseSegment",function(){return c}),x.d(C,"Fragment",function(){return v}),x.d(C,"Part",function(){return d});var T=x("./src/polyfills/number.ts"),h=x("./node_modules/url-toolkit/src/url-toolkit.js"),m=x("./src/utils/logger.ts"),M=x("./src/loader/level-key.ts"),S=x("./src/loader/load-stats.ts");function p(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,u(i,t)}function u(i,t){return u=Object.setPrototypeOf||function(e,s){return e.__proto__=s,e},u(i,t)}function n(i,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(i,e.key,e)}}function f(i,t,r){return t&&n(i.prototype,t),r&&n(i,r),i}var l;(function(i){i.AUDIO="audio",i.VIDEO="video",i.AUDIOVIDEO="audiovideo"})(l||(l={}));var c=function(){function i(r){var e;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(e={},e[l.AUDIO]=null,e[l.VIDEO]=null,e[l.AUDIOVIDEO]=null,e),this.baseurl=r}var t=i.prototype;return t.setByteRange=function(e,s){var o=e.split("@",2),a=[];o.length===1?a[0]=s?s.byteRangeEndOffset:0:a[0]=parseInt(o[1]),a[1]=parseInt(o[0])+a[0],this._byteRange=a},f(i,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(h.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),i}(),v=function(i){p(t,i);function t(e,s){var o;return o=i.call(this,s)||this,o._decryptdata=null,o.rawProgramDateTime=null,o.programDateTime=null,o.tagList=[],o.duration=0,o.sn=0,o.levelkey=void 0,o.type=void 0,o.loader=null,o.level=-1,o.cc=0,o.startPTS=void 0,o.endPTS=void 0,o.appendedPTS=void 0,o.startDTS=void 0,o.endDTS=void 0,o.start=0,o.deltaPTS=void 0,o.maxStartPTS=void 0,o.minEndPTS=void 0,o.stats=new S.LoadStats,o.urlId=0,o.data=void 0,o.bitrateTest=!1,o.title=null,o.initSegment=null,o.type=e,o}var r=t.prototype;return r.createInitializationVector=function(s){for(var o=new Uint8Array(16),a=12;a<16;a++)o[a]=s>>8*(15-a)&255;return o},r.setDecryptDataFromLevelKey=function(s,o){var a=s;return(s==null?void 0:s.method)==="AES-128"&&s.uri&&!s.iv&&(a=M.LevelKey.fromURI(s.uri),a.method=s.method,a.iv=this.createInitializationVector(o),a.keyFormat="identity"),a},r.setElementaryStreamInfo=function(s,o,a,g,A,D){D===void 0&&(D=!1);var y=this.elementaryStreams,E=y[s];if(!E){y[s]={startPTS:o,endPTS:a,startDTS:g,endDTS:A,partial:D};return}E.startPTS=Math.min(E.startPTS,o),E.endPTS=Math.max(E.endPTS,a),E.startDTS=Math.min(E.startDTS,g),E.endDTS=Math.max(E.endDTS,A)},r.clearElementaryStreamInfo=function(){var s=this.elementaryStreams;s[l.AUDIO]=null,s[l.VIDEO]=null,s[l.AUDIOVIDEO]=null},f(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var s=this.sn;typeof s!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&m.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),s=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,s)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(T.isFiniteNumber)(this.programDateTime))return null;var s=Object(T.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+s*1e3}},{key:"encrypted",get:function(){var s;return!!((s=this.decryptdata)!==null&&s!==void 0&&s.keyFormat&&this.decryptdata.uri)}}]),t}(c),d=function(i){p(t,i);function t(r,e,s,o,a){var g;g=i.call(this,s)||this,g.fragOffset=0,g.duration=0,g.gap=!1,g.independent=!1,g.relurl=void 0,g.fragment=void 0,g.index=void 0,g.stats=new S.LoadStats,g.duration=r.decimalFloatingPoint("DURATION"),g.gap=r.bool("GAP"),g.independent=r.bool("INDEPENDENT"),g.relurl=r.enumeratedString("URI"),g.fragment=e,g.index=o;var A=r.enumeratedString("BYTERANGE");return A&&g.setByteRange(A,a),a&&(g.fragOffset=a.fragOffset+a.duration),g}return f(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(c)},"./src/loader/key-loader.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return M});var T=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/utils/logger.ts"),M=function(){function S(u){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=u,this._registerListeners()}var p=S.prototype;return p._registerListeners=function(){this.hls.on(T.Events.KEY_LOADING,this.onKeyLoading,this)},p._unregisterListeners=function(){this.hls.off(T.Events.KEY_LOADING,this.onKeyLoading)},p.destroy=function(){this._unregisterListeners();for(var n in this.loaders){var f=this.loaders[n];f&&f.destroy()}this.loaders={}},p.onKeyLoading=function(n,f){var l=f.frag,c=l.type,v=this.loaders[c];if(!l.decryptdata){m.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var d=l.decryptdata.uri;if(d!==this.decrypturl||this.decryptkey===null){var i=this.hls.config;if(v&&(m.logger.warn("abort previous key loader for type:"+c),v.abort()),!d){m.logger.warn("key uri is falsy");return}var t=i.loader,r=l.loader=this.loaders[c]=new t(i);this.decrypturl=d,this.decryptkey=null;var e={url:d,frag:l,responseType:"arraybuffer"},s={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:i.fragLoadingRetryDelay,maxRetryDelay:i.fragLoadingMaxRetryTimeout,highWaterMark:0},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};r.load(e,s,o)}else this.decryptkey&&(l.decryptdata.key=this.decryptkey,this.hls.trigger(T.Events.KEY_LOADED,{frag:l}))},p.loadsuccess=function(n,f,l){var c=l.frag;if(!c.decryptdata){m.logger.error("after key load, decryptdata unset");return}this.decryptkey=c.decryptdata.key=new Uint8Array(n.data),c.loader=null,delete this.loaders[c.type],this.hls.trigger(T.Events.KEY_LOADED,{frag:c})},p.loaderror=function(n,f){var l=f.frag,c=l.loader;c&&c.abort(),delete this.loaders[l.type],this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:l,response:n})},p.loadtimeout=function(n,f){var l=f.frag,c=l.loader;c&&c.abort(),delete this.loaders[l.type],this.hls.trigger(T.Events.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:l})},S}()},"./src/loader/level-details.ts":function(O,C,x){x.r(C),x.d(C,"LevelDetails",function(){return S});var T=x("./src/polyfills/number.ts");function h(p,u){for(var n=0;n<u.length;n++){var f=u[n];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(p,f.key,f)}}function m(p,u,n){return u&&h(p.prototype,u),n&&h(p,n),p}var M=10,S=function(){function p(n){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=n}var u=p.prototype;return u.reloaded=function(f){if(!f){this.advanced=!0,this.updated=!0;return}var l=this.lastPartSn-f.lastPartSn,c=this.lastPartIndex-f.lastPartIndex;this.updated=this.endSN!==f.endSN||!!c||!!l,this.advanced=this.endSN>f.endSN||l>0||l===0&&c>0,this.updated||this.advanced?this.misses=Math.floor(f.misses*.6):this.misses=f.misses+1,this.availabilityDelay=f.availabilityDelay},m(p,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(T.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||M}},{key:"drift",get:function(){var f=this.driftEndTime-this.driftStartTime;if(f>0){var l=this.driftEnd-this.driftStart;return l*1e3/f}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var f;return(f=this.fragments)!==null&&f!==void 0&&f.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),p}()},"./src/loader/level-key.ts":function(O,C,x){x.r(C),x.d(C,"LevelKey",function(){return M});var T=x("./node_modules/url-toolkit/src/url-toolkit.js");function h(S,p){for(var u=0;u<p.length;u++){var n=p[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(S,n.key,n)}}function m(S,p,u){return p&&h(S.prototype,p),u&&h(S,u),S}var M=function(){S.fromURL=function(u,n){return new S(u,n)},S.fromURI=function(u){return new S(u)};function S(p,u){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,u?this._uri=Object(T.buildAbsoluteURL)(p,u,{alwaysNormalize:!0}):this._uri=p}return m(S,[{key:"uri",get:function(){return this._uri}}]),S}()},"./src/loader/load-stats.ts":function(O,C,x){x.r(C),x.d(C,"LoadStats",function(){return T});var T=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return t});var T=x("./src/polyfills/number.ts"),h=x("./node_modules/url-toolkit/src/url-toolkit.js"),m=x("./src/loader/fragment.ts"),M=x("./src/loader/level-details.ts"),S=x("./src/loader/level-key.ts"),p=x("./src/utils/attr-list.ts"),u=x("./src/utils/logger.ts"),n=x("./src/utils/codecs.ts"),f=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,l=/#EXT-X-MEDIA:(.*)/g,c=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),v=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),d=/\.(mp4|m4s|m4v|m4a)$/i;function i(a){var g,A;return d.test((g=(A=h.parseURL(a))===null||A===void 0?void 0:A.path)!=null?g:"")}var t=function(){function a(){}return a.findGroup=function(A,D){for(var y=0;y<A.length;y++){var E=A[y];if(E.id===D)return E}},a.convertAVC1ToAVCOTI=function(A){var D=A.split(".");if(D.length>2){var y=D.shift()+".";return y+=parseInt(D.shift()).toString(16),y+=("000"+parseInt(D.shift()).toString(16)).substr(-4),y}return A},a.resolve=function(A,D){return h.buildAbsoluteURL(D,A,{alwaysNormalize:!0})},a.parseMasterPlaylist=function(A,D){var y=[],E={},_=!1;f.lastIndex=0;for(var L;(L=f.exec(A))!=null;)if(L[1]){var I=new p.AttrList(L[1]),b={attrs:I,bitrate:I.decimalInteger("AVERAGE-BANDWIDTH")||I.decimalInteger("BANDWIDTH"),name:I.NAME,url:a.resolve(L[2],D)},R=I.decimalResolution("RESOLUTION");R&&(b.width=R.width,b.height=R.height),r((I.CODECS||"").split(/[ ,]+/).filter(function(w){return w}),b),b.videoCodec&&b.videoCodec.indexOf("avc1")!==-1&&(b.videoCodec=a.convertAVC1ToAVCOTI(b.videoCodec)),y.push(b)}else if(L[3]){var P=new p.AttrList(L[3]);P["DATA-ID"]&&(_=!0,E[P["DATA-ID"]]=P)}return{levels:y,sessionData:_?E:null}},a.parseMasterPlaylistMedia=function(A,D,y,E){E===void 0&&(E=[]);var _,L=[],I=0;for(l.lastIndex=0;(_=l.exec(A))!==null;){var b=new p.AttrList(_[1]);if(b.TYPE===y){var R={attrs:b,bitrate:0,id:I++,groupId:b["GROUP-ID"],instreamId:b["INSTREAM-ID"],name:b.NAME||b.LANGUAGE||"",type:y,default:b.bool("DEFAULT"),autoselect:b.bool("AUTOSELECT"),forced:b.bool("FORCED"),lang:b.LANGUAGE,url:b.URI?a.resolve(b.URI,D):""};if(E.length){var P=a.findGroup(E,R.groupId)||E[0];e(R,P,"audioCodec"),e(R,P,"textCodec")}L.push(R)}}return L},a.parseLevelPlaylist=function(A,D,y,E,_){var L=new M.LevelDetails(D),I=L.fragments,b=null,R=0,P=0,w=0,F=0,k=null,B=new m.Fragment(E,D),U,j,K,N=-1,Z=!1;for(c.lastIndex=0,L.m3u8=A;(U=c.exec(A))!==null;){Z&&(Z=!1,B=new m.Fragment(E,D),B.start=w,B.sn=R,B.cc=F,B.level=y,b&&(B.initSegment=b,B.rawProgramDateTime=b.rawProgramDateTime));var $=U[1];if($){B.duration=parseFloat($);var Y=(" "+U[2]).slice(1);B.title=Y||null,B.tagList.push(Y?["INF",$,Y]:["INF",$])}else if(U[3])Object(T.isFiniteNumber)(B.duration)&&(B.start=w,K&&(B.levelkey=K),B.sn=R,B.level=y,B.cc=F,B.urlId=_,I.push(B),B.relurl=(" "+U[3]).slice(1),o(B,k),k=B,w+=B.duration,R++,P=0,Z=!0);else if(U[4]){var ee=(" "+U[4]).slice(1);k?B.setByteRange(ee,k):B.setByteRange(ee)}else if(U[5])B.rawProgramDateTime=(" "+U[5]).slice(1),B.tagList.push(["PROGRAM-DATE-TIME",B.rawProgramDateTime]),N===-1&&(N=I.length);else{if(U=U[0].match(v),!U){u.logger.warn("No matches on slow regex match for level playlist!");continue}for(j=1;j<U.length&&typeof U[j]=="undefined";j++);var Q=(" "+U[j]).slice(1),G=(" "+U[j+1]).slice(1),q=U[j+2]?(" "+U[j+2]).slice(1):"";switch(Q){case"PLAYLIST-TYPE":L.type=G.toUpperCase();break;case"MEDIA-SEQUENCE":R=L.startSN=parseInt(G);break;case"SKIP":{var te=new p.AttrList(G),ie=te.decimalInteger("SKIPPED-SEGMENTS");if(Object(T.isFiniteNumber)(ie)){L.skippedSegments=ie;for(var ne=ie;ne--;)I.unshift(null);R+=ie}var le=te.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(L.recentlyRemovedDateranges=le.split("	"));break}case"TARGETDURATION":L.targetduration=parseFloat(G);break;case"VERSION":L.version=parseInt(G);break;case"EXTM3U":break;case"ENDLIST":L.live=!1;break;case"#":(G||q)&&B.tagList.push(q?[G,q]:[G]);break;case"DIS":F++;case"GAP":B.tagList.push([Q]);break;case"BITRATE":B.tagList.push([Q,G]);break;case"DISCONTINUITY-SEQ":F=parseInt(G);break;case"KEY":{var se,oe=new p.AttrList(G),J=oe.enumeratedString("METHOD"),ae=oe.URI,fe=oe.hexadecimalInteger("IV"),de=oe.enumeratedString("KEYFORMATVERSIONS"),ve=oe.enumeratedString("KEYID"),ue=(se=oe.enumeratedString("KEYFORMAT"))!=null?se:"identity",Te=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(Te.indexOf(ue)>-1){u.logger.warn("Keyformat "+ue+" is not supported from the manifest");continue}else if(ue!=="identity")continue;J&&(K=S.LevelKey.fromURL(D,ae),ae&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(J)>=0&&(K.method=J,K.keyFormat=ue,ve&&(K.keyID=ve),de&&(K.keyFormatVersions=de),K.iv=fe));break}case"START":{var he=new p.AttrList(G),Ee=he.decimalFloatingPoint("TIME-OFFSET");Object(T.isFiniteNumber)(Ee)&&(L.startTimeOffset=Ee);break}case"MAP":{var W=new p.AttrList(G);B.relurl=W.URI,W.BYTERANGE&&B.setByteRange(W.BYTERANGE),B.level=y,B.sn="initSegment",K&&(B.levelkey=K),B.initSegment=null,b=B,Z=!0;break}case"SERVER-CONTROL":{var z=new p.AttrList(G);L.canBlockReload=z.bool("CAN-BLOCK-RELOAD"),L.canSkipUntil=z.optionalFloat("CAN-SKIP-UNTIL",0),L.canSkipDateRanges=L.canSkipUntil>0&&z.bool("CAN-SKIP-DATERANGES"),L.partHoldBack=z.optionalFloat("PART-HOLD-BACK",0),L.holdBack=z.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var V=new p.AttrList(G);L.partTarget=V.decimalFloatingPoint("PART-TARGET");break}case"PART":{var X=L.partList;X||(X=L.partList=[]);var H=P>0?X[X.length-1]:void 0,re=P++,ce=new m.Part(new p.AttrList(G),B,D,re,H);X.push(ce),B.duration+=ce.duration;break}case"PRELOAD-HINT":{var me=new p.AttrList(G);L.preloadHint=me;break}case"RENDITION-REPORT":{var xe=new p.AttrList(G);L.renditionReports=L.renditionReports||[],L.renditionReports.push(xe);break}default:u.logger.warn("line parsed but not handled: "+U);break}}}k&&!k.relurl?(I.pop(),w-=k.duration,L.partList&&(L.fragmentHint=k)):L.partList&&(o(B,k),B.cc=F,L.fragmentHint=B);var Se=I.length,_e=I[0],Le=I[Se-1];if(w+=L.skippedSegments*L.targetduration,w>0&&Se&&Le){L.averagetargetduration=w/Se;var be=Le.sn;L.endSN=be!=="initSegment"?be:0,_e&&(L.startCC=_e.cc,_e.initSegment||L.fragments.every(function(Oe){return Oe.relurl&&i(Oe.relurl)})&&(u.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),B=new m.Fragment(E,D),B.relurl=Le.relurl,B.level=y,B.sn="initSegment",_e.initSegment=B,L.needSidxRanges=!0))}else L.endSN=0,L.startCC=0;return L.fragmentHint&&(w+=L.fragmentHint.duration),L.totalduration=w,L.endCC=F,N>0&&s(I,N),L},a}();function r(a,g){["video","audio","text"].forEach(function(A){var D=a.filter(function(E){return Object(n.isCodecType)(E,A)});if(D.length){var y=D.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});g[A+"Codec"]=y.length>0?y[0]:D[0],a=a.filter(function(E){return D.indexOf(E)===-1})}}),g.unknownCodecs=a}function e(a,g,A){var D=g[A];D&&(a[A]=D)}function s(a,g){for(var A=a[g],D=g;D--;){var y=a[D];if(!y)return;y.programDateTime=A.programDateTime-y.duration*1e3,A=y}}function o(a,g){a.rawProgramDateTime?a.programDateTime=Date.parse(a.rawProgramDateTime):g!=null&&g.programDateTime&&(a.programDateTime=g.endProgramDateTime),Object(T.isFiniteNumber)(a.programDateTime)||(a.programDateTime=null,a.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(O,C,x){x.r(C);var T=x("./src/polyfills/number.ts"),h=x("./src/events.ts"),m=x("./src/errors.ts"),M=x("./src/utils/logger.ts"),S=x("./src/utils/mp4-tools.ts"),p=x("./src/loader/m3u8-parser.ts"),u=x("./src/types/loader.ts"),n=x("./src/utils/attr-list.ts");function f(v){var d=v.type;switch(d){case u.PlaylistContextType.AUDIO_TRACK:return u.PlaylistLevelType.AUDIO;case u.PlaylistContextType.SUBTITLE_TRACK:return u.PlaylistLevelType.SUBTITLE;default:return u.PlaylistLevelType.MAIN}}function l(v,d){var i=v.url;return(i===void 0||i.indexOf("data:")===0)&&(i=d.url),i}var c=function(){function v(i){this.hls=void 0,this.loaders=Object.create(null),this.hls=i,this.registerListeners()}var d=v.prototype;return d.registerListeners=function(){var t=this.hls;t.on(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(h.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(h.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(h.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.unregisterListeners=function(){var t=this.hls;t.off(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(h.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(h.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(h.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.createInternalLoader=function(t){var r=this.hls.config,e=r.pLoader,s=r.loader,o=e||s,a=new o(r);return t.loader=a,this.loaders[t.type]=a,a},d.getInternalLoader=function(t){return this.loaders[t.type]},d.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},d.destroyInternalLoaders=function(){for(var t in this.loaders){var r=this.loaders[t];r&&r.destroy(),this.resetInternalLoader(t)}},d.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},d.onManifestLoading=function(t,r){var e=r.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:u.PlaylistContextType.MANIFEST,url:e,deliveryDirectives:null})},d.onLevelLoading=function(t,r){var e=r.id,s=r.level,o=r.url,a=r.deliveryDirectives;this.load({id:e,groupId:null,level:s,responseType:"text",type:u.PlaylistContextType.LEVEL,url:o,deliveryDirectives:a})},d.onAudioTrackLoading=function(t,r){var e=r.id,s=r.groupId,o=r.url,a=r.deliveryDirectives;this.load({id:e,groupId:s,level:null,responseType:"text",type:u.PlaylistContextType.AUDIO_TRACK,url:o,deliveryDirectives:a})},d.onSubtitleTrackLoading=function(t,r){var e=r.id,s=r.groupId,o=r.url,a=r.deliveryDirectives;this.load({id:e,groupId:s,level:null,responseType:"text",type:u.PlaylistContextType.SUBTITLE_TRACK,url:o,deliveryDirectives:a})},d.load=function(t){var r,e=this.hls.config,s=this.getInternalLoader(t);if(s){var o=s.context;if(o&&o.url===t.url){M.logger.trace("[playlist-loader]: playlist request ongoing");return}M.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),s.abort()}var a,g,A,D;switch(t.type){case u.PlaylistContextType.MANIFEST:a=e.manifestLoadingMaxRetry,g=e.manifestLoadingTimeOut,A=e.manifestLoadingRetryDelay,D=e.manifestLoadingMaxRetryTimeout;break;case u.PlaylistContextType.LEVEL:case u.PlaylistContextType.AUDIO_TRACK:case u.PlaylistContextType.SUBTITLE_TRACK:a=0,g=e.levelLoadingTimeOut;break;default:a=e.levelLoadingMaxRetry,g=e.levelLoadingTimeOut,A=e.levelLoadingRetryDelay,D=e.levelLoadingMaxRetryTimeout;break}if(s=this.createInternalLoader(t),(r=t.deliveryDirectives)!==null&&r!==void 0&&r.part){var y;if(t.type===u.PlaylistContextType.LEVEL&&t.level!==null?y=this.hls.levels[t.level].details:t.type===u.PlaylistContextType.AUDIO_TRACK&&t.id!==null?y=this.hls.audioTracks[t.id].details:t.type===u.PlaylistContextType.SUBTITLE_TRACK&&t.id!==null&&(y=this.hls.subtitleTracks[t.id].details),y){var E=y.partTarget,_=y.targetduration;E&&_&&(g=Math.min(Math.max(E*3,_*.8)*1e3,g))}}var L={timeout:g,maxRetry:a,retryDelay:A,maxRetryDelay:D,highWaterMark:0},I={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};s.load(t,L,I)},d.loadsuccess=function(t,r,e,s){if(s===void 0&&(s=null),e.isSidxRequest){this.handleSidxRequest(t,e),this.handlePlaylistLoaded(t,r,e,s);return}this.resetInternalLoader(e.type);var o=t.data;if(o.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(t,e,"no EXTM3U delimiter",s);return}r.parsing.start=performance.now(),o.indexOf("#EXTINF:")>0||o.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,r,e,s):this.handleMasterPlaylist(t,r,e,s)},d.loaderror=function(t,r,e){e===void 0&&(e=null),this.handleNetworkError(r,e,!1,t)},d.loadtimeout=function(t,r,e){e===void 0&&(e=null),this.handleNetworkError(r,e,!0)},d.handleMasterPlaylist=function(t,r,e,s){var o=this.hls,a=t.data,g=l(t,e),A=p.default.parseMasterPlaylist(a,g),D=A.levels,y=A.sessionData;if(!D.length){this.handleManifestParsingError(t,e,"no level found in manifest",s);return}var E=D.map(function(P){return{id:P.attrs.AUDIO,audioCodec:P.audioCodec}}),_=D.map(function(P){return{id:P.attrs.SUBTITLES,textCodec:P.textCodec}}),L=p.default.parseMasterPlaylistMedia(a,g,"AUDIO",E),I=p.default.parseMasterPlaylistMedia(a,g,"SUBTITLES",_),b=p.default.parseMasterPlaylistMedia(a,g,"CLOSED-CAPTIONS");if(L.length){var R=L.some(function(P){return!P.url});!R&&D[0].audioCodec&&!D[0].attrs.AUDIO&&(M.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),L.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new n.AttrList({}),bitrate:0,url:""}))}o.trigger(h.Events.MANIFEST_LOADED,{levels:D,audioTracks:L,subtitles:I,captions:b,url:g,stats:r,networkDetails:s,sessionData:y})},d.handleTrackOrLevelPlaylist=function(t,r,e,s){var o=this.hls,a=e.id,g=e.level,A=e.type,D=l(t,e),y=Object(T.isFiniteNumber)(a)?a:0,E=Object(T.isFiniteNumber)(g)?g:y,_=f(e),L=p.default.parseLevelPlaylist(t.data,D,E,_,y);if(!L.fragments.length){o.trigger(h.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:D,reason:"no fragments found in level",level:typeof e.level=="number"?e.level:void 0});return}if(A===u.PlaylistContextType.MANIFEST){var I={attrs:new n.AttrList({}),bitrate:0,details:L,name:"",url:D};o.trigger(h.Events.MANIFEST_LOADED,{levels:[I],audioTracks:[],url:D,stats:r,networkDetails:s,sessionData:null})}if(r.parsing.end=performance.now(),L.needSidxRanges){var b,R=(b=L.fragments[0].initSegment)===null||b===void 0?void 0:b.url;this.load({url:R,isSidxRequest:!0,type:A,level:g,levelDetails:L,id:a,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}e.levelDetails=L,this.handlePlaylistLoaded(t,r,e,s)},d.handleSidxRequest=function(t,r){var e=Object(S.parseSegmentIndex)(new Uint8Array(t.data));if(!!e){var s=e.references,o=r.levelDetails;s.forEach(function(a,g){var A=a.info,D=o.fragments[g];D.byteRange.length===0&&D.setByteRange(String(1+A.end-A.start)+"@"+String(A.start)),D.initSegment&&D.initSegment.setByteRange(String(e.moovEndOffset)+"@0")})}},d.handleManifestParsingError=function(t,r,e,s){this.hls.trigger(h.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:r.type===u.PlaylistContextType.MANIFEST,url:t.url,reason:e,response:t,context:r,networkDetails:s})},d.handleNetworkError=function(t,r,e,s){e===void 0&&(e=!1),M.logger.warn("[playlist-loader]: A network "+(e?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var o=m.ErrorDetails.UNKNOWN,a=!1,g=this.getInternalLoader(t);switch(t.type){case u.PlaylistContextType.MANIFEST:o=e?m.ErrorDetails.MANIFEST_LOAD_TIMEOUT:m.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case u.PlaylistContextType.LEVEL:o=e?m.ErrorDetails.LEVEL_LOAD_TIMEOUT:m.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case u.PlaylistContextType.AUDIO_TRACK:o=e?m.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:m.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;case u.PlaylistContextType.SUBTITLE_TRACK:o=e?m.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:m.ErrorDetails.SUBTITLE_LOAD_ERROR,a=!1;break}g&&this.resetInternalLoader(t.type);var A={type:m.ErrorTypes.NETWORK_ERROR,details:o,fatal:a,url:t.url,loader:g,context:t,networkDetails:r};s&&(A.response=s),this.hls.trigger(h.Events.ERROR,A)},d.handlePlaylistLoaded=function(t,r,e,s){var o=e.type,a=e.level,g=e.id,A=e.groupId,D=e.loader,y=e.levelDetails,E=e.deliveryDirectives;if(!(y!=null&&y.targetduration)){this.handleManifestParsingError(t,e,"invalid target duration",s);return}if(!!D)switch(y.live&&(D.getCacheAge&&(y.ageHeader=D.getCacheAge()||0),(!D.getCacheAge||isNaN(y.ageHeader))&&(y.ageHeader=0)),o){case u.PlaylistContextType.MANIFEST:case u.PlaylistContextType.LEVEL:this.hls.trigger(h.Events.LEVEL_LOADED,{details:y,level:a||0,id:g||0,stats:r,networkDetails:s,deliveryDirectives:E});break;case u.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(h.Events.AUDIO_TRACK_LOADED,{details:y,id:g||0,groupId:A||"",stats:r,networkDetails:s,deliveryDirectives:E});break;case u.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(h.Events.SUBTITLE_TRACK_LOADED,{details:y,id:g||0,groupId:A||"",stats:r,networkDetails:s,deliveryDirectives:E});break}},v}();C.default=c},"./src/polyfills/number.ts":function(O,C,x){x.r(C),x.d(C,"isFiniteNumber",function(){return T}),x.d(C,"MAX_SAFE_INTEGER",function(){return h});var T=Number.isFinite||function(m){return typeof m=="number"&&isFinite(m)},h=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(O,C,x){x.r(C);var T=function(){function h(){}return h.getSilentFrame=function(M,S){switch(M){case"mp4a.40.2":if(S===1)return new Uint8Array([0,200,0,128,35,128]);if(S===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(S===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(S===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(S===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(S===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(S===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(S===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(S===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},h}();C.default=T},"./src/remux/mp4-generator.ts":function(O,C,x){x.r(C);var T=Math.pow(2,32)-1,h=function(){function m(){}return m.init=function(){m.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var S;for(S in m.types)m.types.hasOwnProperty(S)&&(m.types[S]=[S.charCodeAt(0),S.charCodeAt(1),S.charCodeAt(2),S.charCodeAt(3)]);var p=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),u=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);m.HDLR_TYPES={video:p,audio:u};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f=new Uint8Array([0,0,0,0,0,0,0,0]);m.STTS=m.STSC=m.STCO=f,m.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),m.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),m.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),m.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var l=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),v=new Uint8Array([0,0,0,1]);m.FTYP=m.box(m.types.ftyp,l,v,l,c),m.DINF=m.box(m.types.dinf,m.box(m.types.dref,n))},m.box=function(S){for(var p=8,u=arguments.length,n=new Array(u>1?u-1:0),f=1;f<u;f++)n[f-1]=arguments[f];for(var l=n.length,c=l;l--;)p+=n[l].byteLength;var v=new Uint8Array(p);for(v[0]=p>>24&255,v[1]=p>>16&255,v[2]=p>>8&255,v[3]=p&255,v.set(S,4),l=0,p=8;l<c;l++)v.set(n[l],p),p+=n[l].byteLength;return v},m.hdlr=function(S){return m.box(m.types.hdlr,m.HDLR_TYPES[S])},m.mdat=function(S){return m.box(m.types.mdat,S)},m.mdhd=function(S,p){p*=S;var u=Math.floor(p/(T+1)),n=Math.floor(p%(T+1));return m.box(m.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,S>>24&255,S>>16&255,S>>8&255,S&255,u>>24,u>>16&255,u>>8&255,u&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))},m.mdia=function(S){return m.box(m.types.mdia,m.mdhd(S.timescale,S.duration),m.hdlr(S.type),m.minf(S))},m.mfhd=function(S){return m.box(m.types.mfhd,new Uint8Array([0,0,0,0,S>>24,S>>16&255,S>>8&255,S&255]))},m.minf=function(S){return S.type==="audio"?m.box(m.types.minf,m.box(m.types.smhd,m.SMHD),m.DINF,m.stbl(S)):m.box(m.types.minf,m.box(m.types.vmhd,m.VMHD),m.DINF,m.stbl(S))},m.moof=function(S,p,u){return m.box(m.types.moof,m.mfhd(S),m.traf(u,p))},m.moov=function(S){for(var p=S.length,u=[];p--;)u[p]=m.trak(S[p]);return m.box.apply(null,[m.types.moov,m.mvhd(S[0].timescale,S[0].duration)].concat(u).concat(m.mvex(S)))},m.mvex=function(S){for(var p=S.length,u=[];p--;)u[p]=m.trex(S[p]);return m.box.apply(null,[m.types.mvex].concat(u))},m.mvhd=function(S,p){p*=S;var u=Math.floor(p/(T+1)),n=Math.floor(p%(T+1)),f=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,S>>24&255,S>>16&255,S>>8&255,S&255,u>>24,u>>16&255,u>>8&255,u&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return m.box(m.types.mvhd,f)},m.sdtp=function(S){var p=S.samples||[],u=new Uint8Array(4+p.length),n,f;for(n=0;n<p.length;n++)f=p[n].flags,u[n+4]=f.dependsOn<<4|f.isDependedOn<<2|f.hasRedundancy;return m.box(m.types.sdtp,u)},m.stbl=function(S){return m.box(m.types.stbl,m.stsd(S),m.box(m.types.stts,m.STTS),m.box(m.types.stsc,m.STSC),m.box(m.types.stsz,m.STSZ),m.box(m.types.stco,m.STCO))},m.avc1=function(S){var p=[],u=[],n,f,l;for(n=0;n<S.sps.length;n++)f=S.sps[n],l=f.byteLength,p.push(l>>>8&255),p.push(l&255),p=p.concat(Array.prototype.slice.call(f));for(n=0;n<S.pps.length;n++)f=S.pps[n],l=f.byteLength,u.push(l>>>8&255),u.push(l&255),u=u.concat(Array.prototype.slice.call(f));var c=m.box(m.types.avcC,new Uint8Array([1,p[3],p[4],p[5],255,224|S.sps.length].concat(p).concat([S.pps.length]).concat(u))),v=S.width,d=S.height,i=S.pixelRatio[0],t=S.pixelRatio[1];return m.box(m.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,v>>8&255,v&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,m.box(m.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),m.box(m.types.pasp,new Uint8Array([i>>24,i>>16&255,i>>8&255,i&255,t>>24,t>>16&255,t>>8&255,t&255])))},m.esds=function(S){var p=S.config.length;return new Uint8Array([0,0,0,0,3,23+p,0,1,0,4,15+p,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([p]).concat(S.config).concat([6,1,2]))},m.mp4a=function(S){var p=S.samplerate;return m.box(m.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]),m.box(m.types.esds,m.esds(S)))},m.mp3=function(S){var p=S.samplerate;return m.box(m.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]))},m.stsd=function(S){return S.type==="audio"?!S.isAAC&&S.codec==="mp3"?m.box(m.types.stsd,m.STSD,m.mp3(S)):m.box(m.types.stsd,m.STSD,m.mp4a(S)):m.box(m.types.stsd,m.STSD,m.avc1(S))},m.tkhd=function(S){var p=S.id,u=S.duration*S.timescale,n=S.width,f=S.height,l=Math.floor(u/(T+1)),c=Math.floor(u%(T+1));return m.box(m.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,p>>24&255,p>>16&255,p>>8&255,p&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,f>>8&255,f&255,0,0]))},m.traf=function(S,p){var u=m.sdtp(S),n=S.id,f=Math.floor(p/(T+1)),l=Math.floor(p%(T+1));return m.box(m.types.traf,m.box(m.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),m.box(m.types.tfdt,new Uint8Array([1,0,0,0,f>>24,f>>16&255,f>>8&255,f&255,l>>24,l>>16&255,l>>8&255,l&255])),m.trun(S,u.length+16+20+8+16+8+8),u)},m.trak=function(S){return S.duration=S.duration||4294967295,m.box(m.types.trak,m.tkhd(S),m.mdia(S))},m.trex=function(S){var p=S.id;return m.box(m.types.trex,new Uint8Array([0,0,0,0,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},m.trun=function(S,p){var u=S.samples||[],n=u.length,f=12+16*n,l=new Uint8Array(f),c,v,d,i,t,r;for(p+=8+f,l.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255],0),c=0;c<n;c++)v=u[c],d=v.duration,i=v.size,t=v.flags,r=v.cts,l.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t.isLeading<<2|t.dependsOn,t.isDependedOn<<6|t.hasRedundancy<<4|t.paddingValue<<1|t.isNonSync,t.degradPrio&240<<8,t.degradPrio&15,r>>>24&255,r>>>16&255,r>>>8&255,r&255],12+16*c);return m.box(m.types.trun,l)},m.initSegment=function(S){m.types||m.init();var p=m.moov(S),u=new Uint8Array(m.FTYP.byteLength+p.byteLength);return u.set(m.FTYP),u.set(p,m.FTYP.byteLength),u},m}();h.types=void 0,h.HDLR_TYPES=void 0,h.STTS=void 0,h.STSC=void 0,h.STCO=void 0,h.STSZ=void 0,h.VMHD=void 0,h.SMHD=void 0,h.STSD=void 0,h.FTYP=void 0,h.DINF=void 0,C.default=h},"./src/remux/mp4-remuxer.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return r}),x.d(C,"normalizePts",function(){return e});var T=x("./src/polyfills/number.ts"),h=x("./src/remux/aac-helper.ts"),m=x("./src/remux/mp4-generator.ts"),M=x("./src/events.ts"),S=x("./src/errors.ts"),p=x("./src/utils/logger.ts"),u=x("./src/types/loader.ts"),n=x("./src/utils/timescale-conversion.ts");function f(){return f=Object.assign||function(g){for(var A=1;A<arguments.length;A++){var D=arguments[A];for(var y in D)Object.prototype.hasOwnProperty.call(D,y)&&(g[y]=D[y])}return g},f.apply(this,arguments)}var l=10*1e3,c=1024,v=1152,d=null,i=null,t=!1,r=function(){function g(D,y,E,_){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=D,this.config=y,this.typeSupported=E,this.ISGenerated=!1,d===null){var L=navigator.userAgent||"",I=L.match(/Chrome\/(\d+)/i);d=I?parseInt(I[1]):0}if(i===null){var b=navigator.userAgent.match(/Safari\/(\d+)/i);i=b?parseInt(b[1]):0}t=!!d&&d<75||!!i&&i<600}var A=g.prototype;return A.destroy=function(){},A.resetTimeStamp=function(y){p.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=y},A.resetNextTimestamp=function(){p.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},A.resetInitSegment=function(){p.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},A.getVideoStartPts=function(y){var E=!1,_=y.reduce(function(L,I){var b=I.pts-L;return b<-4294967296?(E=!0,e(L,I.pts)):b>0?L:I.pts},y[0].pts);return E&&p.logger.debug("PTS rollover detected"),_},A.remux=function(y,E,_,L,I,b,R,P){var w,F,k,B,U,j,K=I,N=I,Z=y.pid>-1,$=E.pid>-1,Y=E.samples.length,ee=y.samples.length>0,Q=Y>1,G=(!Z||ee)&&(!$||Q)||this.ISGenerated||R;if(G){this.ISGenerated||(k=this.generateIS(y,E,I));var q=this.isVideoContiguous,te=-1;if(Q&&(te=s(E.samples),!q&&this.config.forceKeyFrameOnDiscontinuity))if(j=!0,te>0){p.logger.warn("[mp4-remuxer]: Dropped "+te+" out of "+Y+" video samples due to a missing keyframe");var ie=this.getVideoStartPts(E.samples);E.samples=E.samples.slice(te),E.dropped+=te,N+=(E.samples[0].pts-ie)/(E.timescale||9e4)}else te===-1&&(p.logger.warn("[mp4-remuxer]: No keyframe found out of "+Y+" video samples"),j=!1);if(this.ISGenerated){if(ee&&Q){var ne=this.getVideoStartPts(E.samples),le=e(y.samples[0].pts,ne)-ne,se=le/E.inputTimeScale;K+=Math.max(0,se),N+=Math.max(0,-se)}if(ee){if(y.samplerate||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),k=this.generateIS(y,E,I)),F=this.remuxAudio(y,K,this.isAudioContiguous,b,$||Q||P===u.PlaylistLevelType.AUDIO?N:void 0),Q){var oe=F?F.endPTS-F.startPTS:0;E.inputTimeScale||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),k=this.generateIS(y,E,I)),w=this.remuxVideo(E,N,q,oe)}}else Q&&(w=this.remuxVideo(E,N,q,0));w&&(w.firstKeyFrame=te,w.independent=te!==-1)}}return this.ISGenerated&&(_.samples.length&&(U=this.remuxID3(_,I)),L.samples.length&&(B=this.remuxText(L,I))),{audio:F,video:w,initSegment:k,independent:j,text:B,id3:U}},A.generateIS=function(y,E,_){var L=y.samples,I=E.samples,b=this.typeSupported,R={},P=!Object(T.isFiniteNumber)(this._initPTS),w="audio/mp4",F,k,B;if(P&&(F=k=1/0),y.config&&L.length&&(y.timescale=y.samplerate,y.isAAC||(b.mpeg?(w="audio/mpeg",y.codec=""):b.mp3&&(y.codec="mp3")),R.audio={id:"audio",container:w,codec:y.codec,initSegment:!y.isAAC&&b.mpeg?new Uint8Array(0):m.default.initSegment([y]),metadata:{channelCount:y.channelCount}},P&&(B=y.inputTimeScale,F=k=L[0].pts-Math.round(B*_))),E.sps&&E.pps&&I.length&&(E.timescale=E.inputTimeScale,R.video={id:"main",container:"video/mp4",codec:E.codec,initSegment:m.default.initSegment([E]),metadata:{width:E.width,height:E.height}},P)){B=E.inputTimeScale;var U=this.getVideoStartPts(I),j=Math.round(B*_);k=Math.min(k,e(I[0].dts,U)-j),F=Math.min(F,U-j)}if(Object.keys(R).length)return this.ISGenerated=!0,P&&(this._initPTS=F,this._initDTS=k),{tracks:R,initPTS:F,timescale:B}},A.remuxVideo=function(y,E,_,L){var I=y.inputTimeScale,b=y.samples,R=[],P=b.length,w=this._initPTS,F=this.nextAvcDts,k=8,B,U,j,K=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,Z=0,$=!1;if(!_||F===null){var Y=E*I,ee=b[0].pts-e(b[0].dts,b[0].pts);F=Y-ee}for(var Q=0;Q<P;Q++){var G=b[Q];if(G.pts=e(G.pts-w,F),G.dts=e(G.dts-w,F),G.dts>G.pts){var q=18e3;Z=Math.max(Math.min(Z,G.pts-G.dts),-1*q)}G.dts<b[Q>0?Q-1:Q].dts&&($=!0)}$&&b.sort(function(ke,Ne){var et=ke.dts-Ne.dts,tt=ke.pts-Ne.pts;return et||tt}),U=b[0].dts,j=b[b.length-1].dts;var te=Math.round((j-U)/(P-1));if(Z<0){if(Z<te*-2){p.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(n.toMsFromMpegTsClock)(-te,!0)+" ms");for(var ie=Z,ne=0;ne<P;ne++)b[ne].dts=ie=Math.max(ie,b[ne].pts-te),b[ne].pts=Math.max(ie,b[ne].pts)}else{p.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(n.toMsFromMpegTsClock)(Z,!0)+" ms to overcome this issue");for(var le=0;le<P;le++)b[le].dts=b[le].dts+Z}U=b[0].dts}if(_){var se=U-F,oe=se>te,J=se<-1;if(oe||J){oe?p.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(se,!0)+" ms ("+se+"dts) hole between fragments detected, filling it"):p.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(-se,!0)+" ms ("+se+"dts) overlapping between fragments detected"),U=F;var ae=b[0].pts-se;b[0].dts=U,b[0].pts=ae,p.logger.log("Video: First PTS/DTS adjusted: "+Object(n.toMsFromMpegTsClock)(ae,!0)+"/"+Object(n.toMsFromMpegTsClock)(U,!0)+", delta: "+Object(n.toMsFromMpegTsClock)(se,!0)+" ms")}}t&&(U=Math.max(0,U));for(var fe=0,de=0,ve=0;ve<P;ve++){for(var ue=b[ve],Te=ue.units,he=Te.length,Ee=0,W=0;W<he;W++)Ee+=Te[W].data.length;de+=Ee,fe+=he,ue.length=Ee,ue.dts=Math.max(ue.dts,U),ue.pts=Math.max(ue.pts,ue.dts,0),K=Math.min(ue.pts,K),N=Math.max(ue.pts,N)}j=b[P-1].dts;var z=de+4*fe+8,V;try{V=new Uint8Array(z)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:S.ErrorTypes.MUX_ERROR,details:S.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:z,reason:"fail allocating video mdat "+z});return}var X=new DataView(V.buffer);X.setUint32(0,z),V.set(m.default.types.mdat,4);for(var H=0;H<P;H++){for(var re=b[H],ce=re.units,me=0,xe=0,Se=ce.length;xe<Se;xe++){var _e=ce[xe],Le=_e.data,be=_e.data.byteLength;X.setUint32(k,be),k+=4,V.set(Le,k),k+=be,me+=4+be}if(H<P-1)B=b[H+1].dts-re.dts;else{var Oe=this.config,Ce=re.dts-b[H>0?H-1:H].dts;if(Oe.stretchShortVideoTrack&&this.nextAudioPts!==null){var Qe=Math.floor(Oe.maxBufferHole*I),Fe=(L?K+L*I:this.nextAudioPts)-re.pts;Fe>Qe?(B=Fe-Ce,B<0&&(B=Ce),p.logger.log("[mp4-remuxer]: It is approximately "+Fe/90+" ms to the next segment; using duration "+B/90+" ms for the last video frame.")):B=Ce}else B=Ce}var $e=Math.round(re.pts-re.dts);R.push(new o(re.key,B,me,$e))}if(R.length&&d&&d<70){var je=R[0].flags;je.dependsOn=2,je.isNonSync=0}console.assert(B!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=F=j+B,this.isVideoContiguous=!0;var Xe=m.default.moof(y.sequenceNumber++,U,f({},y,{samples:R})),Je="video",qe={data1:Xe,data2:V,startPTS:K/I,endPTS:(N+B)/I,startDTS:U/I,endDTS:F/I,type:Je,hasAudio:!1,hasVideo:!0,nb:R.length,dropped:y.dropped};return y.samples=[],y.dropped=0,console.assert(V.length,"MDAT length must not be zero"),qe},A.remuxAudio=function(y,E,_,L,I){var b=y.inputTimeScale,R=y.samplerate?y.samplerate:b,P=b/R,w=y.isAAC?c:v,F=w*P,k=this._initPTS,B=!y.isAAC&&this.typeSupported.mpeg,U=[],j=y.samples,K=B?0:8,N=this.nextAudioPts||-1,Z=E*b;if(this.isAudioContiguous=_=_||j.length&&N>0&&(L&&Math.abs(Z-N)<9e3||Math.abs(e(j[0].pts-k,Z)-N)<20*F),j.forEach(function(Le){Le.pts=e(Le.pts-k,Z)}),!_||N<0){if(j=j.filter(function(Le){return Le.pts>=0}),!j.length)return;I===0?N=0:L?N=Math.max(0,Z):N=j[0].pts}if(y.isAAC)for(var $=I!==void 0,Y=this.config.maxAudioFramesDrift,ee=0,Q=N;ee<j.length;ee++){var G=j[ee],q=G.pts,te=q-Q,ie=Math.abs(1e3*te/b);if(te<=-Y*F&&$)ee===0&&(p.logger.warn("Audio frame @ "+(q/b).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*te/b)+" ms."),this.nextAudioPts=N=Q=q);else if(te>=Y*F&&ie<l&&$){var ne=Math.round(te/F);Q=q-ne*F,Q<0&&(ne--,Q+=F),ee===0&&(this.nextAudioPts=N=Q),p.logger.warn("[mp4-remuxer]: Injecting "+ne+" audio frame @ "+(Q/b).toFixed(3)+"s due to "+Math.round(1e3*te/b)+" ms gap.");for(var le=0;le<ne;le++){var se=Math.max(Q,0),oe=h.default.getSilentFrame(y.manifestCodec||y.codec,y.channelCount);oe||(p.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=G.unit.subarray()),j.splice(ee,0,{unit:oe,pts:se}),Q+=F,ee++}}G.pts=Q,Q+=F}for(var J=null,ae=null,fe,de=0,ve=j.length;ve--;)de+=j[ve].unit.byteLength;for(var ue=0,Te=j.length;ue<Te;ue++){var he=j[ue],Ee=he.unit,W=he.pts;if(ae!==null){var z=U[ue-1];z.duration=Math.round((W-ae)/P)}else if(_&&y.isAAC&&(W=N),J=W,de>0){de+=K;try{fe=new Uint8Array(de)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:S.ErrorTypes.MUX_ERROR,details:S.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:de,reason:"fail allocating audio mdat "+de});return}if(!B){var V=new DataView(fe.buffer);V.setUint32(0,de),fe.set(m.default.types.mdat,4)}}else return;fe.set(Ee,K);var X=Ee.byteLength;K+=X,U.push(new o(!0,w,X,0)),ae=W}var H=U.length;if(!!H){var re=U[U.length-1];this.nextAudioPts=N=ae+P*re.duration;var ce=B?new Uint8Array(0):m.default.moof(y.sequenceNumber++,J/P,f({},y,{samples:U}));y.samples=[];var me=J/b,xe=N/b,Se="audio",_e={data1:ce,data2:fe,startPTS:me,endPTS:xe,startDTS:me,endDTS:xe,type:Se,hasAudio:!0,hasVideo:!1,nb:H};return this.isAudioContiguous=!0,console.assert(fe.length,"MDAT length must not be zero"),_e}},A.remuxEmptyAudio=function(y,E,_,L){var I=y.inputTimeScale,b=y.samplerate?y.samplerate:I,R=I/b,P=this.nextAudioPts,w=(P!==null?P:L.startDTS*I)+this._initDTS,F=L.endDTS*I+this._initDTS,k=R*c,B=Math.ceil((F-w)/k),U=h.default.getSilentFrame(y.manifestCodec||y.codec,y.channelCount);if(p.logger.warn("[mp4-remuxer]: remux empty Audio"),!U){p.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var j=[],K=0;K<B;K++){var N=w+K*k;j.push({unit:U,pts:N,dts:N})}return y.samples=j,this.remuxAudio(y,E,_,!1)},A.remuxID3=function(y,E){var _=y.samples.length;if(!!_){for(var L=y.inputTimeScale,I=this._initPTS,b=this._initDTS,R=0;R<_;R++){var P=y.samples[R];P.pts=e(P.pts-I,E*L)/L,P.dts=e(P.dts-b,E*L)/L}var w=y.samples;return y.samples=[],{samples:w}}},A.remuxText=function(y,E){var _=y.samples.length;if(!!_){for(var L=y.inputTimeScale,I=this._initPTS,b=0;b<_;b++){var R=y.samples[b];R.pts=e(R.pts-I,E*L)/L}y.samples.sort(function(w,F){return w.pts-F.pts});var P=y.samples;return y.samples=[],{samples:P}}},g}();function e(g,A){var D;if(A===null)return g;for(A<g?D=-8589934592:D=8589934592;Math.abs(g-A)>4294967296;)g+=D;return g}function s(g){for(var A=0;A<g.length;A++)if(g[A].key)return A;return-1}var o=function(A,D,y,E){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=D,this.size=y,this.cts=E,this.flags=new a(A)},a=function(A){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=A?2:1,this.isNonSync=A?0:1}},"./src/remux/passthrough-remuxer.ts":function(O,C,x){x.r(C);var T=x("./src/polyfills/number.ts"),h=x("./src/utils/mp4-tools.ts"),m=x("./src/loader/fragment.ts"),M=x("./src/utils/logger.ts"),S=function(){function n(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var f=n.prototype;return f.destroy=function(){},f.resetTimeStamp=function(c){this.initPTS=c,this.lastEndDTS=null},f.resetNextTimestamp=function(){this.lastEndDTS=null},f.resetInitSegment=function(c,v,d){this.audioCodec=v,this.videoCodec=d,this.generateInitSegment(c),this.emitInitSegment=!0},f.generateInitSegment=function(c){var v=this.audioCodec,d=this.videoCodec;if(!c||!c.byteLength){this.initTracks=void 0,this.initData=void 0;return}var i=this.initData=Object(h.parseInitSegment)(c);v||(v=u(i.audio,m.ElementaryStreamTypes.AUDIO)),d||(d=u(i.video,m.ElementaryStreamTypes.VIDEO));var t={};i.audio&&i.video?t.audiovideo={container:"video/mp4",codec:v+","+d,initSegment:c,id:"main"}:i.audio?t.audio={container:"audio/mp4",codec:v,initSegment:c,id:"audio"}:i.video?t.video={container:"video/mp4",codec:d,initSegment:c,id:"main"}:M.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=t},f.remux=function(c,v,d,i,t){var r=this.initPTS,e=this.lastEndDTS,s={audio:void 0,video:void 0,text:i,id3:d,initSegment:void 0};Object(T.isFiniteNumber)(e)||(e=this.lastEndDTS=t||0);var o=v.samples;if(!o||!o.length)return s;var a={initPTS:void 0,timescale:1},g=this.initData;if((!g||!g.length)&&(this.generateInitSegment(o),g=this.initData),!g||!g.length)return M.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),s;this.emitInitSegment&&(a.tracks=this.initTracks,this.emitInitSegment=!1),Object(T.isFiniteNumber)(r)||(this.initPTS=a.initPTS=r=p(g,o,e));var A=Object(h.getDuration)(o,g),D=e,y=A+D;Object(h.offsetStartDTS)(g,o,r),A>0?this.lastEndDTS=y:(M.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!g.audio,_=!!g.video,L="";E&&(L+="audio"),_&&(L+="video");var I={data1:o,startPTS:D,startDTS:D,endPTS:y,endDTS:y,type:L,hasAudio:E,hasVideo:_,nb:1,dropped:0};return s.audio=I.type==="audio"?I:void 0,s.video=I.type!=="audio"?I:void 0,s.text=i,s.id3=d,s.initSegment=a,s},n}(),p=function(f,l,c){return Object(h.getStartDTS)(f,l)-c};function u(n,f){var l=n==null?void 0:n.codec;return l&&l.length>4?l:l==="hvc1"?"hvc1.1.c.L120.90":l==="av01"?"av01.0.04M.08":l==="avc1"||f===m.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}C.default=S},"./src/task-loop.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return T});var T=function(){function h(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var m=h.prototype;return m.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},m.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},m.onHandlerDestroyed=function(){},m.hasInterval=function(){return!!this._tickInterval},m.hasNextTick=function(){return!!this._tickTimer},m.setInterval=function(S){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,S),!0)},m.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},m.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},m.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},m.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},m.doTick=function(){},h}()},"./src/types/cmcd.ts":function(O,C,x){x.r(C),x.d(C,"CMCDVersion",function(){return T}),x.d(C,"CMCDObjectType",function(){return h}),x.d(C,"CMCDStreamingFormat",function(){return m}),x.d(C,"CMCDStreamType",function(){return M});var T=1,h;(function(S){S.MANIFEST="m",S.AUDIO="a",S.VIDEO="v",S.MUXED="av",S.INIT="i",S.CAPTION="c",S.TIMED_TEXT="tt",S.KEY="k",S.OTHER="o"})(h||(h={}));var m;(function(S){S.DASH="d",S.HLS="h",S.SMOOTH="s",S.OTHER="o"})(m||(m={}));var M;(function(S){S.VOD="v",S.LIVE="l"})(M||(M={}))},"./src/types/level.ts":function(O,C,x){x.r(C),x.d(C,"HlsSkip",function(){return m}),x.d(C,"getSkipValue",function(){return M}),x.d(C,"HlsUrlParameters",function(){return S}),x.d(C,"Level",function(){return p});function T(u,n){for(var f=0;f<n.length;f++){var l=n[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}function h(u,n,f){return n&&T(u.prototype,n),f&&T(u,f),u}var m;(function(u){u.No="",u.Yes="YES",u.v2="v2"})(m||(m={}));function M(u,n){var f=u.canSkipUntil,l=u.canSkipDateRanges,c=u.endSN,v=n!==void 0?n-c:0;return f&&v<f?l?m.v2:m.Yes:m.No}var S=function(){function u(f,l,c){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=f,this.part=l,this.skip=c}var n=u.prototype;return n.addDirectives=function(l){var c=new self.URL(l);return this.msn!==void 0&&c.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&c.searchParams.set("_HLS_part",this.part.toString()),this.skip&&c.searchParams.set("_HLS_skip",this.skip),c.toString()},u}(),p=function(){function u(n){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[n.url],this.attrs=n.attrs,this.bitrate=n.bitrate,n.details&&(this.details=n.details),this.id=n.id||0,this.name=n.name,this.width=n.width||0,this.height=n.height||0,this.audioCodec=n.audioCodec,this.videoCodec=n.videoCodec,this.unknownCodecs=n.unknownCodecs,this.codecSet=[n.videoCodec,n.audioCodec].filter(function(f){return f}).join(",").replace(/\.[^.,]+/g,"")}return h(u,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(f){var l=f%this.url.length;this._urlId!==l&&(this.details=void 0,this._urlId=l)}}]),u}()},"./src/types/loader.ts":function(O,C,x){x.r(C),x.d(C,"PlaylistContextType",function(){return T}),x.d(C,"PlaylistLevelType",function(){return h});var T;(function(m){m.MANIFEST="manifest",m.LEVEL="level",m.AUDIO_TRACK="audioTrack",m.SUBTITLE_TRACK="subtitleTrack"})(T||(T={}));var h;(function(m){m.MAIN="main",m.AUDIO="audio",m.SUBTITLE="subtitle"})(h||(h={}))},"./src/types/transmuxer.ts":function(O,C,x){x.r(C),x.d(C,"ChunkMetadata",function(){return T});var T=function(M,S,p,u,n,f){u===void 0&&(u=0),n===void 0&&(n=-1),f===void 0&&(f=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=h(),this.buffering={audio:h(),video:h(),audiovideo:h()},this.level=M,this.sn=S,this.id=p,this.size=u,this.part=n,this.partial=f};function h(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(O,C,x){x.r(C),x.d(C,"AttrList",function(){return m});var T=/^(\d+)x(\d+)$/,h=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,m=function(){function M(p){typeof p=="string"&&(p=M.parseAttrList(p));for(var u in p)p.hasOwnProperty(u)&&(this[u]=p[u])}var S=M.prototype;return S.decimalInteger=function(u){var n=parseInt(this[u],10);return n>Number.MAX_SAFE_INTEGER?1/0:n},S.hexadecimalInteger=function(u){if(this[u]){var n=(this[u]||"0x").slice(2);n=(n.length&1?"0":"")+n;for(var f=new Uint8Array(n.length/2),l=0;l<n.length/2;l++)f[l]=parseInt(n.slice(l*2,l*2+2),16);return f}else return null},S.hexadecimalIntegerAsNumber=function(u){var n=parseInt(this[u],16);return n>Number.MAX_SAFE_INTEGER?1/0:n},S.decimalFloatingPoint=function(u){return parseFloat(this[u])},S.optionalFloat=function(u,n){var f=this[u];return f?parseFloat(f):n},S.enumeratedString=function(u){return this[u]},S.bool=function(u){return this[u]==="YES"},S.decimalResolution=function(u){var n=T.exec(this[u]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}},M.parseAttrList=function(u){var n,f={},l='"';for(h.lastIndex=0;(n=h.exec(u))!==null;){var c=n[2];c.indexOf(l)===0&&c.lastIndexOf(l)===c.length-1&&(c=c.slice(1,-1)),f[n[1]]=c}return f},M}()},"./src/utils/binary-search.ts":function(O,C,x){x.r(C);var T={search:function(m,M){for(var S=0,p=m.length-1,u=null,n=null;S<=p;){u=(S+p)/2|0,n=m[u];var f=M(n);if(f>0)S=u+1;else if(f<0)p=u-1;else return n}return null}};C.default=T},"./src/utils/buffer-helper.ts":function(O,C,x){x.r(C),x.d(C,"BufferHelper",function(){return m});var T=x("./src/utils/logger.ts"),h={length:0,start:function(){return 0},end:function(){return 0}},m=function(){function M(){}return M.isBuffered=function(p,u){try{if(p){for(var n=M.getBuffered(p),f=0;f<n.length;f++)if(u>=n.start(f)&&u<=n.end(f))return!0}}catch{}return!1},M.bufferInfo=function(p,u,n){try{if(p){var f=M.getBuffered(p),l=[],c;for(c=0;c<f.length;c++)l.push({start:f.start(c),end:f.end(c)});return this.bufferedInfo(l,u,n)}}catch{}return{len:0,start:u,end:u,nextStart:void 0}},M.bufferedInfo=function(p,u,n){u=Math.max(0,u),p.sort(function(a,g){var A=a.start-g.start;return A||g.end-a.end});var f=[];if(n)for(var l=0;l<p.length;l++){var c=f.length;if(c){var v=f[c-1].end;p[l].start-v<n?p[l].end>v&&(f[c-1].end=p[l].end):f.push(p[l])}else f.push(p[l])}else f=p;for(var d=0,i,t=u,r=u,e=0;e<f.length;e++){var s=f[e].start,o=f[e].end;if(u+n>=s&&u<o)t=s,r=o,d=r-u;else if(u+n<s){i=s;break}}return{len:d,start:t||0,end:r||0,nextStart:i}},M.getBuffered=function(p){try{return p.buffered}catch(u){return T.logger.log("failed to get media.buffered",u),h}},M}()},"./src/utils/cea-608-parser.ts":function(O,C,x){x.r(C),x.d(C,"Row",function(){return r}),x.d(C,"CaptionScreen",function(){return e});var T=x("./src/utils/logger.ts"),h={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},m=function(y){var E=y;return h.hasOwnProperty(y)&&(E=h[y]),String.fromCharCode(E)},M=15,S=100,p={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},n={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c;(function(D){D[D.ERROR=0]="ERROR",D[D.TEXT=1]="TEXT",D[D.WARNING=2]="WARNING",D[D.INFO=2]="INFO",D[D.DEBUG=3]="DEBUG",D[D.DATA=3]="DATA"})(c||(c={}));var v=function(){function D(){this.time=null,this.verboseLevel=c.ERROR}var y=D.prototype;return y.log=function(_,L){this.verboseLevel>=_&&T.logger.log(this.time+" ["+_+"] "+L)},D}(),d=function(y){for(var E=[],_=0;_<y.length;_++)E.push(y[_].toString(16));return E},i=function(){function D(E,_,L,I,b){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=E||"white",this.underline=_||!1,this.italics=L||!1,this.background=I||"black",this.flash=b||!1}var y=D.prototype;return y.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},y.setStyles=function(_){for(var L=["foreground","underline","italics","background","flash"],I=0;I<L.length;I++){var b=L[I];_.hasOwnProperty(b)&&(this[b]=_[b])}},y.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},y.equals=function(_){return this.foreground===_.foreground&&this.underline===_.underline&&this.italics===_.italics&&this.background===_.background&&this.flash===_.flash},y.copy=function(_){this.foreground=_.foreground,this.underline=_.underline,this.italics=_.italics,this.background=_.background,this.flash=_.flash},y.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},D}(),t=function(){function D(E,_,L,I,b,R){this.uchar=void 0,this.penState=void 0,this.uchar=E||" ",this.penState=new i(_,L,I,b,R)}var y=D.prototype;return y.reset=function(){this.uchar=" ",this.penState.reset()},y.setChar=function(_,L){this.uchar=_,this.penState.copy(L)},y.setPenState=function(_){this.penState.copy(_)},y.equals=function(_){return this.uchar===_.uchar&&this.penState.equals(_.penState)},y.copy=function(_){this.uchar=_.uchar,this.penState.copy(_.penState)},y.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},D}(),r=function(){function D(E){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var _=0;_<S;_++)this.chars.push(new t);this.logger=E,this.pos=0,this.currPenState=new i}var y=D.prototype;return y.equals=function(_){for(var L=!0,I=0;I<S;I++)if(!this.chars[I].equals(_.chars[I])){L=!1;break}return L},y.copy=function(_){for(var L=0;L<S;L++)this.chars[L].copy(_.chars[L])},y.isEmpty=function(){for(var _=!0,L=0;L<S;L++)if(!this.chars[L].isEmpty()){_=!1;break}return _},y.setCursor=function(_){this.pos!==_&&(this.pos=_),this.pos<0?(this.logger.log(c.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>S&&(this.logger.log(c.DEBUG,"Too large cursor position "+this.pos),this.pos=S)},y.moveCursor=function(_){var L=this.pos+_;if(_>1)for(var I=this.pos+1;I<L+1;I++)this.chars[I].setPenState(this.currPenState);this.setCursor(L)},y.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},y.insertChar=function(_){_>=144&&this.backSpace();var L=m(_);if(this.pos>=S){this.logger.log(c.ERROR,"Cannot insert "+_.toString(16)+" ("+L+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(L,this.currPenState),this.moveCursor(1)},y.clearFromPos=function(_){var L;for(L=_;L<S;L++)this.chars[L].reset()},y.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},y.clearToEndOfRow=function(){this.clearFromPos(this.pos)},y.getTextString=function(){for(var _=[],L=!0,I=0;I<S;I++){var b=this.chars[I].uchar;b!==" "&&(L=!1),_.push(b)}return L?"":_.join("")},y.setPenStyles=function(_){this.currPenState.setStyles(_);var L=this.chars[this.pos];L.setPenState(this.currPenState)},D}(),e=function(){function D(E){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var _=0;_<M;_++)this.rows.push(new r(E));this.logger=E,this.currRow=M-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var y=D.prototype;return y.reset=function(){for(var _=0;_<M;_++)this.rows[_].clear();this.currRow=M-1},y.equals=function(_){for(var L=!0,I=0;I<M;I++)if(!this.rows[I].equals(_.rows[I])){L=!1;break}return L},y.copy=function(_){for(var L=0;L<M;L++)this.rows[L].copy(_.rows[L])},y.isEmpty=function(){for(var _=!0,L=0;L<M;L++)if(!this.rows[L].isEmpty()){_=!1;break}return _},y.backSpace=function(){var _=this.rows[this.currRow];_.backSpace()},y.clearToEndOfRow=function(){var _=this.rows[this.currRow];_.clearToEndOfRow()},y.insertChar=function(_){var L=this.rows[this.currRow];L.insertChar(_)},y.setPen=function(_){var L=this.rows[this.currRow];L.setPenStyles(_)},y.moveCursor=function(_){var L=this.rows[this.currRow];L.moveCursor(_)},y.setCursor=function(_){this.logger.log(c.INFO,"setCursor: "+_);var L=this.rows[this.currRow];L.setCursor(_)},y.setPAC=function(_){this.logger.log(c.INFO,"pacData = "+JSON.stringify(_));var L=_.row-1;if(this.nrRollUpRows&&L<this.nrRollUpRows-1&&(L=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==L){for(var I=0;I<M;I++)this.rows[I].clear();var b=this.currRow+1-this.nrRollUpRows,R=this.lastOutputScreen;if(R){var P=R.rows[b].cueStartTime,w=this.logger.time;if(P&&w!==null&&P<w)for(var F=0;F<this.nrRollUpRows;F++)this.rows[L-this.nrRollUpRows+F+1].copy(R.rows[b+F])}}this.currRow=L;var k=this.rows[this.currRow];if(_.indent!==null){var B=_.indent,U=Math.max(B-1,0);k.setCursor(_.indent),_.color=k.chars[U].penState.foreground}var j={foreground:_.color,underline:_.underline,italics:_.italics,background:"black",flash:!1};this.setPen(j)},y.setBkgData=function(_){this.logger.log(c.INFO,"bkgData = "+JSON.stringify(_)),this.backSpace(),this.setPen(_),this.insertChar(32)},y.setRollUpRows=function(_){this.nrRollUpRows=_},y.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(c.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(c.TEXT,this.getDisplayText());var _=this.currRow+1-this.nrRollUpRows,L=this.rows.splice(_,1)[0];L.clear(),this.rows.splice(this.currRow,0,L),this.logger.log(c.INFO,"Rolling up")},y.getDisplayText=function(_){_=_||!1;for(var L=[],I="",b=-1,R=0;R<M;R++){var P=this.rows[R].getTextString();P&&(b=R+1,_?L.push("Row "+b+": '"+P+"'"):L.push(P.trim()))}return L.length>0&&(_?I="["+L.join(" | ")+"]":I=L.join(`
`)),I},y.getTextAndFormat=function(){return this.rows},D}(),s=function(){function D(E,_,L){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=E,this.outputFilter=_,this.mode=null,this.verbose=0,this.displayedMemory=new e(L),this.nonDisplayedMemory=new e(L),this.lastOutputScreen=new e(L),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=L}var y=D.prototype;return y.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},y.getHandler=function(){return this.outputFilter},y.setHandler=function(_){this.outputFilter=_},y.setPAC=function(_){this.writeScreen.setPAC(_)},y.setBkgData=function(_){this.writeScreen.setBkgData(_)},y.setMode=function(_){_!==this.mode&&(this.mode=_,this.logger.log(c.INFO,"MODE="+_),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=_)},y.insertChars=function(_){for(var L=0;L<_.length;L++)this.writeScreen.insertChar(_[L]);var I=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(c.INFO,I+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(c.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},y.ccRCL=function(){this.logger.log(c.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},y.ccBS=function(){this.logger.log(c.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},y.ccAOF=function(){},y.ccAON=function(){},y.ccDER=function(){this.logger.log(c.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},y.ccRU=function(_){this.logger.log(c.INFO,"RU("+_+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(_)},y.ccFON=function(){this.logger.log(c.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},y.ccRDC=function(){this.logger.log(c.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},y.ccTR=function(){this.logger.log(c.INFO,"TR"),this.setMode("MODE_TEXT")},y.ccRTD=function(){this.logger.log(c.INFO,"RTD"),this.setMode("MODE_TEXT")},y.ccEDM=function(){this.logger.log(c.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},y.ccCR=function(){this.logger.log(c.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},y.ccENM=function(){this.logger.log(c.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},y.ccEOC=function(){if(this.logger.log(c.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var _=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=_,this.writeScreen=this.nonDisplayedMemory,this.logger.log(c.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},y.ccTO=function(_){this.logger.log(c.INFO,"TO("+_+") - Tab Offset"),this.writeScreen.moveCursor(_)},y.ccMIDROW=function(_){var L={flash:!1};if(L.underline=_%2===1,L.italics=_>=46,L.italics)L.foreground="white";else{var I=Math.floor(_/2)-16,b=["white","green","blue","cyan","red","yellow","magenta"];L.foreground=b[I]}this.logger.log(c.INFO,"MIDROW: "+JSON.stringify(L)),this.writeScreen.setPen(L)},y.outputDataUpdate=function(_){_===void 0&&(_=!1);var L=this.logger.time;L!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=L:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,L,this.lastOutputScreen),_&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:L),this.lastOutputScreen.copy(this.displayedMemory))},y.cueSplitAtTime=function(_){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,_,this.displayedMemory),this.cueStartTime=_))},D}(),o=function(){function D(E,_,L){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var I=new v;this.channels=[null,new s(E,_,I),new s(E+1,L,I)],this.cmdHistory=A(),this.logger=I}var y=D.prototype;return y.getHandler=function(_){return this.channels[_].getHandler()},y.setHandler=function(_,L){this.channels[_].setHandler(L)},y.addData=function(_,L){var I,b,R,P=!1;this.logger.time=_;for(var w=0;w<L.length;w+=2)if(b=L[w]&127,R=L[w+1]&127,!(b===0&&R===0)){if(this.logger.log(c.DATA,"["+d([L[w],L[w+1]])+"] -> ("+d([b,R])+")"),I=this.parseCmd(b,R),I||(I=this.parseMidrow(b,R)),I||(I=this.parsePAC(b,R)),I||(I=this.parseBackgroundAttributes(b,R)),!I&&(P=this.parseChars(b,R),P)){var F=this.currentChannel;if(F&&F>0){var k=this.channels[F];k.insertChars(P)}else this.logger.log(c.WARNING,"No channel found yet. TEXT-MODE?")}!I&&!P&&this.logger.log(c.WARNING,"Couldn't parse cleaned data "+d([b,R])+" orig: "+d([L[w],L[w+1]]))}},y.parseCmd=function(_,L){var I=this.cmdHistory,b=(_===20||_===28||_===21||_===29)&&L>=32&&L<=47,R=(_===23||_===31)&&L>=33&&L<=35;if(!(b||R))return!1;if(g(_,L,I))return a(null,null,I),this.logger.log(c.DEBUG,"Repeated command ("+d([_,L])+") is dropped"),!0;var P=_===20||_===21||_===23?1:2,w=this.channels[P];return _===20||_===21||_===28||_===29?L===32?w.ccRCL():L===33?w.ccBS():L===34?w.ccAOF():L===35?w.ccAON():L===36?w.ccDER():L===37?w.ccRU(2):L===38?w.ccRU(3):L===39?w.ccRU(4):L===40?w.ccFON():L===41?w.ccRDC():L===42?w.ccTR():L===43?w.ccRTD():L===44?w.ccEDM():L===45?w.ccCR():L===46?w.ccENM():L===47&&w.ccEOC():w.ccTO(L-32),a(_,L,I),this.currentChannel=P,!0},y.parseMidrow=function(_,L){var I=0;if((_===17||_===25)&&L>=32&&L<=47){if(_===17?I=1:I=2,I!==this.currentChannel)return this.logger.log(c.ERROR,"Mismatch channel in midrow parsing"),!1;var b=this.channels[I];return b?(b.ccMIDROW(L),this.logger.log(c.DEBUG,"MIDROW ("+d([_,L])+")"),!0):!1}return!1},y.parsePAC=function(_,L){var I,b=this.cmdHistory,R=(_>=17&&_<=23||_>=25&&_<=31)&&L>=64&&L<=127,P=(_===16||_===24)&&L>=64&&L<=95;if(!(R||P))return!1;if(g(_,L,b))return a(null,null,b),!0;var w=_<=23?1:2;L>=64&&L<=95?I=w===1?p[_]:n[_]:I=w===1?u[_]:f[_];var F=this.channels[w];return F?(F.setPAC(this.interpretPAC(I,L)),a(_,L,b),this.currentChannel=w,!0):!1},y.interpretPAC=function(_,L){var I,b={color:null,italics:!1,indent:null,underline:!1,row:_};return L>95?I=L-96:I=L-64,b.underline=(I&1)===1,I<=13?b.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(I/2)]:I<=15?(b.italics=!0,b.color="white"):b.indent=Math.floor((I-16)/2)*4,b},y.parseChars=function(_,L){var I,b=null,R=null;if(_>=25?(I=2,R=_-8):(I=1,R=_),R>=17&&R<=19){var P;R===17?P=L+80:R===18?P=L+112:P=L+144,this.logger.log(c.INFO,"Special char '"+m(P)+"' in channel "+I),b=[P]}else _>=32&&_<=127&&(b=L===0?[_]:[_,L]);if(b){var w=d(b);this.logger.log(c.DEBUG,"Char codes =  "+w.join(",")),a(_,L,this.cmdHistory)}return b},y.parseBackgroundAttributes=function(_,L){var I=(_===16||_===24)&&L>=32&&L<=47,b=(_===23||_===31)&&L>=45&&L<=47;if(!(I||b))return!1;var R,P={};_===16||_===24?(R=Math.floor((L-32)/2),P.background=l[R],L%2===1&&(P.background=P.background+"_semi")):L===45?P.background="transparent":(P.foreground="black",L===47&&(P.underline=!0));var w=_<=23?1:2,F=this.channels[w];return F.setBkgData(P),a(_,L,this.cmdHistory),!0},y.reset=function(){for(var _=0;_<Object.keys(this.channels).length;_++){var L=this.channels[_];L&&L.reset()}this.cmdHistory=A()},y.cueSplitAtTime=function(_){for(var L=0;L<this.channels.length;L++){var I=this.channels[L];I&&I.cueSplitAtTime(_)}},D}();function a(D,y,E){E.a=D,E.b=y}function g(D,y,E){return E.a===D&&E.b===y}function A(){return{a:null,b:null}}C.default=o},"./src/utils/codecs.ts":function(O,C,x){x.r(C),x.d(C,"isCodecType",function(){return h}),x.d(C,"isCodecSupportedInMp4",function(){return m});var T={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function h(M,S){var p=T[S];return!!p&&p[M.slice(0,4)]===!0}function m(M,S){return MediaSource.isTypeSupported((S||"video")+'/mp4;codecs="'+M+'"')}},"./src/utils/cues.ts":function(O,C,x){x.r(C);var T=x("./src/utils/vttparser.ts"),h=x("./src/utils/webvtt-parser.ts"),m=x("./src/utils/texttrack-utils.ts"),M=/\s/,S={newCue:function(u,n,f,l){for(var c=[],v,d,i,t,r,e=self.VTTCue||self.TextTrackCue,s=0;s<l.rows.length;s++)if(v=l.rows[s],i=!0,t=0,r="",!v.isEmpty()){for(var o=0;o<v.chars.length;o++)M.test(v.chars[o].uchar)&&i?t++:(r+=v.chars[o].uchar,i=!1);v.cueStartTime=n,n===f&&(f+=1e-4),t>=16?t--:t++;var a=Object(T.fixLineBreaks)(r.trim()),g=Object(h.generateCueId)(n,f,a);(!u||!u.cues||!u.cues.getCueById(g))&&(d=new e(n,f,a),d.id=g,d.line=s+1,d.align="left",d.position=10+Math.min(80,Math.floor(t*8/32)*10),c.push(d))}return u&&c.length&&(c.sort(function(A,D){return A.line==="auto"||D.line==="auto"?0:A.line>8&&D.line>8?D.line-A.line:A.line-D.line}),c.forEach(function(A){return Object(m.addCueToTrack)(u,A)})),c}};C.default=S},"./src/utils/discontinuities.ts":function(O,C,x){x.r(C),x.d(C,"findFirstFragWithCC",function(){return M}),x.d(C,"shouldAlignOnDiscontinuities",function(){return S}),x.d(C,"findDiscontinuousReferenceFrag",function(){return p}),x.d(C,"adjustSlidingStart",function(){return n}),x.d(C,"alignStream",function(){return f}),x.d(C,"alignPDT",function(){return c}),x.d(C,"alignFragmentByPDTDelta",function(){return v}),x.d(C,"alignMediaPlaylistByPDT",function(){return d});var T=x("./src/polyfills/number.ts"),h=x("./src/utils/logger.ts"),m=x("./src/controller/level-helper.ts");function M(i,t){for(var r=null,e=0,s=i.length;e<s;e++){var o=i[e];if(o&&o.cc===t){r=o;break}}return r}function S(i,t,r){return!!(t.details&&(r.endCC>r.startCC||i&&i.cc<r.startCC))}function p(i,t){var r=i.fragments,e=t.fragments;if(!e.length||!r.length){h.logger.log("No fragments to align");return}var s=M(r,e[0].cc);if(!s||s&&!s.startPTS){h.logger.log("No frag in previous level to align on");return}return s}function u(i,t){if(i){var r=i.start+t;i.start=i.startPTS=r,i.endPTS=r+i.duration}}function n(i,t){for(var r=t.fragments,e=0,s=r.length;e<s;e++)u(r[e],i);t.fragmentHint&&u(t.fragmentHint,i),t.alignedSliding=!0}function f(i,t,r){!t||(l(i,r,t),!r.alignedSliding&&t.details&&c(r,t.details),!r.alignedSliding&&t.details&&!r.skippedSegments&&Object(m.adjustSliding)(t.details,r))}function l(i,t,r){if(S(i,r,t)){var e=p(r.details,t);e&&Object(T.isFiniteNumber)(e.start)&&(h.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),n(e.start,t))}}function c(i,t){if(!(!t.fragments.length||!i.hasProgramDateTime||!t.hasProgramDateTime)){var r=t.fragments[0].programDateTime,e=i.fragments[0].programDateTime,s=(e-r)/1e3+t.fragments[0].start;s&&Object(T.isFiniteNumber)(s)&&(h.logger.log("Adjusting PTS using programDateTime delta "+(e-r)+"ms, sliding:"+s.toFixed(3)+" "+i.url+" "),n(s,i))}}function v(i,t){var r=i.programDateTime;if(!!r){var e=(r-t)/1e3;i.start=i.startPTS=e,i.endPTS=e+i.duration}}function d(i,t){if(!(!t.fragments.length||!i.hasProgramDateTime||!t.hasProgramDateTime)){var r=t.fragments[0].programDateTime,e=t.fragments[0].start,s=r-e*1e3;i.fragments.forEach(function(o){v(o,s)}),i.fragmentHint&&v(i.fragmentHint,s),i.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(O,C,x){x.r(C);var T=x("./src/utils/ewma.ts"),h=function(){function m(S,p,u){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=u,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new T.default(S),this.fast_=new T.default(p)}var M=m.prototype;return M.update=function(p,u){var n=this.slow_,f=this.fast_;this.slow_.halfLife!==p&&(this.slow_=new T.default(p,n.getEstimate(),n.getTotalWeight())),this.fast_.halfLife!==u&&(this.fast_=new T.default(u,f.getEstimate(),f.getTotalWeight()))},M.sample=function(p,u){p=Math.max(p,this.minDelayMs_);var n=8*u,f=p/1e3,l=n/f;this.fast_.sample(f,l),this.slow_.sample(f,l)},M.canEstimate=function(){var p=this.fast_;return p&&p.getTotalWeight()>=this.minWeight_},M.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},M.destroy=function(){},m}();C.default=h},"./src/utils/ewma.ts":function(O,C,x){x.r(C);var T=function(){function h(M,S,p){S===void 0&&(S=0),p===void 0&&(p=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=M,this.alpha_=M?Math.exp(Math.log(.5)/M):0,this.estimate_=S,this.totalWeight_=p}var m=h.prototype;return m.sample=function(S,p){var u=Math.pow(this.alpha_,S);this.estimate_=p*(1-u)+u*this.estimate_,this.totalWeight_+=S},m.getTotalWeight=function(){return this.totalWeight_},m.getEstimate=function(){if(this.alpha_){var S=1-Math.pow(this.alpha_,this.totalWeight_);if(S)return this.estimate_/S}return this.estimate_},h}();C.default=T},"./src/utils/fetch-loader.ts":function(O,C,x){x.r(C),x.d(C,"fetchSupported",function(){return v});var T=x("./src/polyfills/number.ts"),h=x("./src/loader/load-stats.ts"),m=x("./src/demux/chunk-cache.ts");function M(e,s){e.prototype=Object.create(s.prototype),e.prototype.constructor=e,f(e,s)}function S(e){var s=typeof Map=="function"?new Map:void 0;return S=function(a){if(a===null||!n(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof s!="undefined"){if(s.has(a))return s.get(a);s.set(a,g)}function g(){return p(a,arguments,l(this).constructor)}return g.prototype=Object.create(a.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),f(g,a)},S(e)}function p(e,s,o){return u()?p=Reflect.construct:p=function(g,A,D){var y=[null];y.push.apply(y,A);var E=Function.bind.apply(g,y),_=new E;return D&&f(_,D.prototype),_},p.apply(null,arguments)}function u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function n(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function f(e,s){return f=Object.setPrototypeOf||function(a,g){return a.__proto__=g,a},f(e,s)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},l(e)}function c(){return c=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},c.apply(this,arguments)}function v(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var d=function(){function e(o){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=o.fetchSetup||t,this.controller=new self.AbortController,this.stats=new h.LoadStats}var s=e.prototype;return s.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},s.abortInternal=function(){var a=this.response;(!a||!a.ok)&&(this.stats.aborted=!0,this.controller.abort())},s.abort=function(){var a;this.abortInternal(),(a=this.callbacks)!==null&&a!==void 0&&a.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},s.load=function(a,g,A){var D=this,y=this.stats;if(y.loading.start)throw new Error("Loader can only be used once.");y.loading.start=self.performance.now();var E=i(a,this.controller.signal),_=A.onProgress,L=a.responseType==="arraybuffer",I=L?"byteLength":"length";this.context=a,this.config=g,this.callbacks=A,this.request=this.fetchSetup(a,E),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){D.abortInternal(),A.onTimeout(y,a,D.response)},g.timeout),self.fetch(this.request).then(function(b){if(D.response=D.loader=b,!b.ok){var R=b.status,P=b.statusText;throw new r(P||"fetch, bad network response",R,b)}return y.loading.first=Math.max(self.performance.now(),y.loading.start),y.total=parseInt(b.headers.get("Content-Length")||"0"),_&&Object(T.isFiniteNumber)(g.highWaterMark)?D.loadProgressively(b,y,a,g.highWaterMark,_):L?b.arrayBuffer():b.text()}).then(function(b){var R=D.response;self.clearTimeout(D.requestTimeout),y.loading.end=Math.max(self.performance.now(),y.loading.first),y.loaded=y.total=b[I];var P={url:R.url,data:b};_&&!Object(T.isFiniteNumber)(g.highWaterMark)&&_(y,a,b,R),A.onSuccess(P,y,a,R)}).catch(function(b){if(self.clearTimeout(D.requestTimeout),!y.aborted){var R=b.code||0;A.onError({code:R,text:b.message},a,b.details)}})},s.getCacheAge=function(){var a=null;if(this.response){var g=this.response.headers.get("age");a=g?parseFloat(g):null}return a},s.loadProgressively=function(a,g,A,D,y){D===void 0&&(D=0);var E=new m.default,_=a.body.getReader(),L=function I(){return _.read().then(function(b){if(b.done)return E.dataLength&&y(g,A,E.flush(),a),Promise.resolve(new ArrayBuffer(0));var R=b.value,P=R.length;return g.loaded+=P,P<D||E.dataLength?(E.push(R),E.dataLength>=D&&y(g,A,E.flush(),a)):y(g,A,R,a),I()}).catch(function(){return Promise.reject()})};return L()},e}();function i(e,s){var o={method:"GET",mode:"cors",credentials:"same-origin",signal:s,headers:new self.Headers(c({},e.headers))};return e.rangeEnd&&o.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),o}function t(e,s){return new self.Request(e.url,s)}var r=function(e){M(s,e);function s(o,a,g){var A;return A=e.call(this,o)||this,A.code=void 0,A.details=void 0,A.code=a,A.details=g,A}return s}(S(Error));C.default=d},"./src/utils/imsc1-ttml-parser.ts":function(O,C,x){x.r(C),x.d(C,"IMSC1_CODEC",function(){return n}),x.d(C,"parseIMSC1",function(){return v});var T=x("./src/utils/mp4-tools.ts"),h=x("./src/utils/vttparser.ts"),m=x("./src/utils/vttcue.ts"),M=x("./src/demux/id3.ts"),S=x("./src/utils/timescale-conversion.ts"),p=x("./src/utils/webvtt-parser.ts");function u(){return u=Object.assign||function(D){for(var y=1;y<arguments.length;y++){var E=arguments[y];for(var _ in E)Object.prototype.hasOwnProperty.call(E,_)&&(D[_]=E[_])}return D},u.apply(this,arguments)}var n="stpp.ttml.im1t",f=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,l=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,c={left:"start",center:"center",right:"end",start:"start",end:"end"};function v(D,y,E,_,L){var I=Object(T.findBox)(new Uint8Array(D),["mdat"]);if(I.length===0){L(new Error("Could not parse IMSC1 mdat"));return}var b=I[0],R=Object(M.utf8ArrayToStr)(new Uint8Array(D,b.start,b.end-b.start)),P=Object(S.toTimescaleFromScale)(y,1,E);try{_(d(R,P))}catch(w){L(w)}}function d(D,y){var E=new DOMParser,_=E.parseFromString(D,"text/xml"),L=_.getElementsByTagName("tt")[0];if(!L)throw new Error("Invalid ttml");var I={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},b=Object.keys(I).reduce(function(k,B){return k[B]=L.getAttribute("ttp:"+B)||I[B],k},{}),R=L.getAttribute("xml:space")!=="preserve",P=t(i(L,"styling","style")),w=t(i(L,"layout","region")),F=i(L,"body","[begin]");return[].map.call(F,function(k){var B=r(k,R);if(!B||!k.hasAttribute("begin"))return null;var U=a(k.getAttribute("begin"),b),j=a(k.getAttribute("dur"),b),K=a(k.getAttribute("end"),b);if(U===null)throw o(k);if(K===null){if(j===null)throw o(k);K=U+j}var N=new m.default(U-y,K-y,B);N.id=Object(p.generateCueId)(N.startTime,N.endTime,N.text);var Z=w[k.getAttribute("region")],$=P[k.getAttribute("style")];N.position=10,N.size=80;var Y=e(Z,$),ee=Y.textAlign;if(ee){var Q=c[ee];Q&&(N.lineAlign=Q),N.align=ee}return u(N,Y),N}).filter(function(k){return k!==null})}function i(D,y,E){var _=D.getElementsByTagName(y)[0];return _?[].slice.call(_.querySelectorAll(E)):[]}function t(D){return D.reduce(function(y,E){var _=E.getAttribute("xml:id");return _&&(y[_]=E),y},{})}function r(D,y){return[].slice.call(D.childNodes).reduce(function(E,_,L){var I;return _.nodeName==="br"&&L?E+`
`:(I=_.childNodes)!==null&&I!==void 0&&I.length?r(_,y):y?E+_.textContent.trim().replace(/\s+/g," "):E+_.textContent},"")}function e(D,y){var E="http://www.w3.org/ns/ttml#styling",_=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return _.reduce(function(L,I){var b=s(y,E,I)||s(D,E,I);return b&&(L[I]=b),L},{})}function s(D,y,E){return D.hasAttributeNS(y,E)?D.getAttributeNS(y,E):null}function o(D){return new Error("Could not parse ttml timestamp "+D)}function a(D,y){if(!D)return null;var E=Object(h.parseTimeStamp)(D);return E===null&&(f.test(D)?E=g(D,y):l.test(D)&&(E=A(D,y))),E}function g(D,y){var E=f.exec(D),_=(E[4]|0)+(E[5]|0)/y.subFrameRate;return(E[1]|0)*3600+(E[2]|0)*60+(E[3]|0)+_/y.frameRate}function A(D,y){var E=l.exec(D),_=Number(E[1]),L=E[2];switch(L){case"h":return _*3600;case"m":return _*60;case"ms":return _*1e3;case"f":return _/y.frameRate;case"t":return _/y.tickRate}return _}},"./src/utils/logger.ts":function(O,C,x){x.r(C),x.d(C,"enableLogs",function(){return p}),x.d(C,"logger",function(){return u});var T=function(){},h={trace:T,debug:T,log:T,warn:T,info:T,error:T},m=h;function M(n){var f=self.console[n];return f?f.bind(self.console,"["+n+"] >"):T}function S(n){for(var f=arguments.length,l=new Array(f>1?f-1:0),c=1;c<f;c++)l[c-1]=arguments[c];l.forEach(function(v){m[v]=n[v]?n[v].bind(n):M(v)})}function p(n){if(self.console&&n===!0||typeof n=="object"){S(n,"debug","log","info","warn","error");try{m.log()}catch{m=h}}else m=h}var u=m},"./src/utils/mediakeys-helper.ts":function(O,C,x){x.r(C),x.d(C,"KeySystems",function(){return T}),x.d(C,"requestMediaKeySystemAccess",function(){return h});var T;(function(m){m.WIDEVINE="com.widevine.alpha",m.PLAYREADY="com.microsoft.playready"})(T||(T={}));var h=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(O,C,x){x.r(C),x.d(C,"getMediaSource",function(){return T});function T(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(O,C,x){x.r(C),x.d(C,"bin2str",function(){return S}),x.d(C,"readUint16",function(){return p}),x.d(C,"readUint32",function(){return u}),x.d(C,"writeUint32",function(){return n}),x.d(C,"findBox",function(){return f}),x.d(C,"parseSegmentIndex",function(){return l}),x.d(C,"parseInitSegment",function(){return c}),x.d(C,"getStartDTS",function(){return v}),x.d(C,"getDuration",function(){return d}),x.d(C,"computeRawDurationFromSamples",function(){return i}),x.d(C,"offsetStartDTS",function(){return t}),x.d(C,"segmentValidRange",function(){return r}),x.d(C,"appendUint8Array",function(){return e});var T=x("./src/utils/typed-array.ts"),h=x("./src/loader/fragment.ts"),m=Math.pow(2,32)-1,M=[].push;function S(s){return String.fromCharCode.apply(null,s)}function p(s,o){"data"in s&&(o+=s.start,s=s.data);var a=s[o]<<8|s[o+1];return a<0?65536+a:a}function u(s,o){"data"in s&&(o+=s.start,s=s.data);var a=s[o]<<24|s[o+1]<<16|s[o+2]<<8|s[o+3];return a<0?4294967296+a:a}function n(s,o,a){"data"in s&&(o+=s.start,s=s.data),s[o]=a>>24,s[o+1]=a>>16&255,s[o+2]=a>>8&255,s[o+3]=a&255}function f(s,o){var a=[];if(!o.length)return a;var g,A,D;"data"in s?(g=s.data,A=s.start,D=s.end):(g=s,A=0,D=g.byteLength);for(var y=A;y<D;){var E=u(g,y),_=S(g.subarray(y+4,y+8)),L=E>1?y+E:D;if(_===o[0])if(o.length===1)a.push({data:g,start:y+8,end:L});else{var I=f({data:g,start:y+8,end:L},o.slice(1));I.length&&M.apply(a,I)}y=L}return a}function l(s){var o=f(s,["moov"]),a=o[0],g=a?a.end:null,A=f(s,["sidx"]);if(!A||!A[0])return null;var D=[],y=A[0],E=y.data[0],_=E===0?8:16,L=u(y,_);_+=4;var I=0,b=0;E===0?_+=8:_+=16,_+=2;var R=y.end+b,P=p(y,_);_+=2;for(var w=0;w<P;w++){var F=_,k=u(y,F);F+=4;var B=k&2147483647,U=(k&2147483648)>>>31;if(U===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var j=u(y,F);F+=4,D.push({referenceSize:B,subsegmentDuration:j,info:{duration:j/L,start:R,end:R+B-1}}),R+=B,F+=4,_=F}return{earliestPresentationTime:I,timescale:L,version:E,referencesCount:P,references:D,moovEndOffset:g}}function c(s){for(var o=[],a=f(s,["moov","trak"]),g=0;g<a.length;g++){var A=a[g],D=f(A,["tkhd"])[0];if(D){var y=D.data[D.start],E=y===0?12:20,_=u(D,E),L=f(A,["mdia","mdhd"])[0];if(L){y=L.data[L.start],E=y===0?12:20;var I=u(L,E),b=f(A,["mdia","hdlr"])[0];if(b){var R=S(b.data.subarray(b.start+8,b.start+12)),P={soun:h.ElementaryStreamTypes.AUDIO,vide:h.ElementaryStreamTypes.VIDEO}[R];if(P){var w=f(A,["mdia","minf","stbl","stsd"])[0],F=void 0;w&&(F=S(w.data.subarray(w.start+12,w.start+16))),o[_]={timescale:I,type:P},o[P]={timescale:I,id:_,codec:F}}}}}}var k=f(s,["moov","mvex","trex"]);return k.forEach(function(B){var U=u(B,4),j=o[U];j&&(j.default={duration:u(B,12),flags:u(B,20)})}),o}function v(s,o){return f(o,["moof","traf"]).reduce(function(a,g){var A=f(g,["tfdt"])[0],D=A.data[A.start],y=f(g,["tfhd"]).reduce(function(E,_){var L=u(_,4),I=s[L];if(I){var b=u(A,4);D===1&&(b*=Math.pow(2,32),b+=u(A,8));var R=I.timescale||9e4,P=b/R;if(isFinite(P)&&(E===null||P<E))return P}return E},null);return y!==null&&isFinite(y)&&(a===null||y<a)?y:a},null)||0}function d(s,o){for(var a=0,g=0,A=0,D=f(s,["moof","traf"]),y=0;y<D.length;y++){var E=D[y],_=f(E,["tfhd"])[0],L=u(_,4),I=o[L];if(!!I){var b=I.default,R=u(_,0)|(b==null?void 0:b.flags),P=b==null?void 0:b.duration;R&8&&(R&2?P=u(_,12):P=u(_,8));for(var w=I.timescale||9e4,F=f(E,["trun"]),k=0;k<F.length;k++){if(a=i(F[k]),!a&&P){var B=u(F[k],4);a=P*B}I.type===h.ElementaryStreamTypes.VIDEO?g+=a/w:I.type===h.ElementaryStreamTypes.AUDIO&&(A+=a/w)}}}if(g===0&&A===0){var U=l(s);if(U!=null&&U.references)return U.references.reduce(function(j,K){return j+K.info.duration||0},0)}return g||A}function i(s){var o=u(s,0),a=8;o&1&&(a+=4),o&4&&(a+=4);for(var g=0,A=u(s,4),D=0;D<A;D++){if(o&256){var y=u(s,a);g+=y,a+=4}o&512&&(a+=4),o&1024&&(a+=4),o&2048&&(a+=4)}return g}function t(s,o,a){f(o,["moof","traf"]).forEach(function(g){f(g,["tfhd"]).forEach(function(A){var D=u(A,4),y=s[D];if(!!y){var E=y.timescale||9e4;f(g,["tfdt"]).forEach(function(_){var L=_.data[_.start],I=u(_,4);if(L===0)n(_,4,I-a*E);else{I*=Math.pow(2,32),I+=u(_,8),I-=a*E,I=Math.max(I,0);var b=Math.floor(I/(m+1)),R=Math.floor(I%(m+1));n(_,4,b),n(_,8,R)}})}})})}function r(s){var o={valid:null,remainder:null},a=f(s,["moof"]);if(a){if(a.length<2)return o.remainder=s,o}else return o;var g=a[a.length-1];return o.valid=Object(T.sliceUint8)(s,0,g.start-8),o.remainder=Object(T.sliceUint8)(s,g.start-8),o}function e(s,o){var a=new Uint8Array(s.length+o.length);return a.set(s),a.set(o,s.length),a}},"./src/utils/output-filter.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return T});var T=function(){function h(M,S){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=M,this.trackName=S}var m=h.prototype;return m.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},m.newCue=function(S,p,u){(this.startTime===null||this.startTime>S)&&(this.startTime=S),this.endTime=p,this.screen=u,this.timelineController.createCaptionsTrack(this.trackName)},m.reset=function(){this.cueRanges=[],this.startTime=null},h}()},"./src/utils/texttrack-utils.ts":function(O,C,x){x.r(C),x.d(C,"sendAddTrackEvent",function(){return h}),x.d(C,"addCueToTrack",function(){return m}),x.d(C,"clearCurrentCues",function(){return M}),x.d(C,"removeCuesInRange",function(){return S}),x.d(C,"getCuesInRange",function(){return u});var T=x("./src/utils/logger.ts");function h(n,f){var l;try{l=new Event("addtrack")}catch{l=document.createEvent("Event"),l.initEvent("addtrack",!1,!1)}l.track=n,f.dispatchEvent(l)}function m(n,f){var l=n.mode;if(l==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(f.id))try{if(n.addCue(f),!n.cues.getCueById(f.id))throw new Error("addCue is failed for: "+f)}catch(v){T.logger.debug("[texttrack-utils]: "+v);var c=new self.TextTrackCue(f.startTime,f.endTime,f.text);c.id=f.id,n.addCue(c)}l==="disabled"&&(n.mode=l)}function M(n){var f=n.mode;if(f==="disabled"&&(n.mode="hidden"),n.cues)for(var l=n.cues.length;l--;)n.removeCue(n.cues[l]);f==="disabled"&&(n.mode=f)}function S(n,f,l){var c=n.mode;if(c==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0)for(var v=u(n.cues,f,l),d=0;d<v.length;d++)n.removeCue(v[d]);c==="disabled"&&(n.mode=c)}function p(n,f){if(f<n[0].startTime)return 0;var l=n.length-1;if(f>n[l].endTime)return-1;for(var c=0,v=l;c<=v;){var d=Math.floor((v+c)/2);if(f<n[d].startTime)v=d-1;else if(f>n[d].startTime&&c<l)c=d+1;else return d}return n[c].startTime-f<f-n[v].startTime?c:v}function u(n,f,l){var c=[],v=p(n,f);if(v>-1)for(var d=v,i=n.length;d<i;d++){var t=n[d];if(t.startTime>=f&&t.endTime<=l)c.push(t);else if(t.startTime>l)return c}return c}},"./src/utils/time-ranges.ts":function(O,C,x){x.r(C);var T={toString:function(m){for(var M="",S=m.length,p=0;p<S;p++)M+="["+m.start(p).toFixed(3)+","+m.end(p).toFixed(3)+"]";return M}};C.default=T},"./src/utils/timescale-conversion.ts":function(O,C,x){x.r(C),x.d(C,"toTimescaleFromBase",function(){return h}),x.d(C,"toTimescaleFromScale",function(){return m}),x.d(C,"toMsFromMpegTsClock",function(){return M}),x.d(C,"toMpegTsClockFromTimescale",function(){return S});var T=9e4;function h(p,u,n,f){n===void 0&&(n=1),f===void 0&&(f=!1);var l=p*u*n;return f?Math.round(l):l}function m(p,u,n,f){return n===void 0&&(n=1),f===void 0&&(f=!1),h(p,u,1/n,f)}function M(p,u){return u===void 0&&(u=!1),h(p,1e3,1/T,u)}function S(p,u){return u===void 0&&(u=1),h(p,T,1/u)}},"./src/utils/typed-array.ts":function(O,C,x){x.r(C),x.d(C,"sliceUint8",function(){return T});function T(h,m,M){return Uint8Array.prototype.slice?h.slice(m,M):new Uint8Array(Array.prototype.slice.call(h,m,M))}},"./src/utils/vttcue.ts":function(O,C,x){x.r(C),C.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var T=["","lr","rl"],h=["start","middle","end","left","right"];function m(n,f){if(typeof f!="string"||!Array.isArray(n))return!1;var l=f.toLowerCase();return~n.indexOf(l)?l:!1}function M(n){return m(T,n)}function S(n){return m(h,n)}function p(n){for(var f=arguments.length,l=new Array(f>1?f-1:0),c=1;c<f;c++)l[c-1]=arguments[c];for(var v=1;v<arguments.length;v++){var d=arguments[v];for(var i in d)n[i]=d[i]}return n}function u(n,f,l){var c=this,v={enumerable:!0};c.hasBeenReset=!1;var d="",i=!1,t=n,r=f,e=l,s=null,o="",a=!0,g="auto",A="start",D=50,y="middle",E=50,_="middle";Object.defineProperty(c,"id",p({},v,{get:function(){return d},set:function(I){d=""+I}})),Object.defineProperty(c,"pauseOnExit",p({},v,{get:function(){return i},set:function(I){i=!!I}})),Object.defineProperty(c,"startTime",p({},v,{get:function(){return t},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");t=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",p({},v,{get:function(){return r},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");r=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",p({},v,{get:function(){return e},set:function(I){e=""+I,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",p({},v,{get:function(){return s},set:function(I){s=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",p({},v,{get:function(){return o},set:function(I){var b=M(I);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");o=b,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",p({},v,{get:function(){return a},set:function(I){a=!!I,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",p({},v,{get:function(){return g},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");g=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",p({},v,{get:function(){return A},set:function(I){var b=S(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");A=b,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",p({},v,{get:function(){return D},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");D=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",p({},v,{get:function(){return y},set:function(I){var b=S(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");y=b,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",p({},v,{get:function(){return E},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");E=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",p({},v,{get:function(){return _},set:function(I){var b=S(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");_=b,this.hasBeenReset=!0}})),c.displayState=void 0}return u.prototype.getCueAsHTML=function(){var n=self.WebVTT;return n.convertCueToDOMTree(self,this.text)},u}()},"./src/utils/vttparser.ts":function(O,C,x){x.r(C),x.d(C,"parseTimeStamp",function(){return m}),x.d(C,"fixLineBreaks",function(){return f}),x.d(C,"VTTParser",function(){return l});var T=x("./src/utils/vttcue.ts"),h=function(){function c(){}var v=c.prototype;return v.decode=function(i,t){if(!i)return"";if(typeof i!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(i))},c}();function m(c){function v(i,t,r,e){return(i|0)*3600+(t|0)*60+(r|0)+parseFloat(e||0)}var d=c.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return d?parseFloat(d[2])>59?v(d[2],d[3],0,d[4]):v(d[1],d[2],d[3],d[4]):null}var M=function(){function c(){this.values=Object.create(null)}var v=c.prototype;return v.set=function(i,t){!this.get(i)&&t!==""&&(this.values[i]=t)},v.get=function(i,t,r){return r?this.has(i)?this.values[i]:t[r]:this.has(i)?this.values[i]:t},v.has=function(i){return i in this.values},v.alt=function(i,t,r){for(var e=0;e<r.length;++e)if(t===r[e]){this.set(i,t);break}},v.integer=function(i,t){/^-?\d+$/.test(t)&&this.set(i,parseInt(t,10))},v.percent=function(i,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var r=parseFloat(t);if(r>=0&&r<=100)return this.set(i,r),!0}return!1},c}();function S(c,v,d,i){var t=i?c.split(i):[c];for(var r in t)if(typeof t[r]=="string"){var e=t[r].split(d);if(e.length===2){var s=e[0],o=e[1];v(s,o)}}}var p=new T.default(0,0,""),u=p.align==="middle"?"middle":"center";function n(c,v,d){var i=c;function t(){var s=m(c);if(s===null)throw new Error("Malformed timestamp: "+i);return c=c.replace(/^[^\sa-zA-Z-]+/,""),s}function r(s,o){var a=new M;S(s,function(D,y){var E;switch(D){case"region":for(var _=d.length-1;_>=0;_--)if(d[_].id===y){a.set(D,d[_].region);break}break;case"vertical":a.alt(D,y,["rl","lr"]);break;case"line":E=y.split(","),a.integer(D,E[0]),a.percent(D,E[0])&&a.set("snapToLines",!1),a.alt(D,E[0],["auto"]),E.length===2&&a.alt("lineAlign",E[1],["start",u,"end"]);break;case"position":E=y.split(","),a.percent(D,E[0]),E.length===2&&a.alt("positionAlign",E[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":a.percent(D,y);break;case"align":a.alt(D,y,["start",u,"end","left","right"]);break}},/:/,/\s/),o.region=a.get("region",null),o.vertical=a.get("vertical","");var g=a.get("line","auto");g==="auto"&&p.line===-1&&(g=-1),o.line=g,o.lineAlign=a.get("lineAlign","start"),o.snapToLines=a.get("snapToLines",!0),o.size=a.get("size",100),o.align=a.get("align",u);var A=a.get("position","auto");A==="auto"&&p.position===50&&(A=o.align==="start"||o.align==="left"?0:o.align==="end"||o.align==="right"?100:50),o.position=A}function e(){c=c.replace(/^\s+/,"")}if(e(),v.startTime=t(),e(),c.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);c=c.substr(3),e(),v.endTime=t(),e(),r(c,v)}function f(c){return c.replace(/<br(?: \/)?>/gi,`
`)}var l=function(){function c(){this.state="INITIAL",this.buffer="",this.decoder=new h,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var v=c.prototype;return v.parse=function(i){var t=this;i&&(t.buffer+=t.decoder.decode(i,{stream:!0}));function r(){var A=t.buffer,D=0;for(A=f(A);D<A.length&&A[D]!=="\r"&&A[D]!==`
`;)++D;var y=A.substr(0,D);return A[D]==="\r"&&++D,A[D]===`
`&&++D,t.buffer=A.substr(D),y}function e(A){S(A,function(D,y){},/:/)}try{var s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=r();var o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=r(),t.state){case"HEADER":/:/.test(s)?e(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new T.default(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{n(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{var g=s.indexOf("-->")!==-1;if(!s||g&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},v.flush=function(){var i=this;try{if((i.cue||i.state==="HEADER")&&(i.buffer+=`

`,i.parse()),i.state==="INITIAL"||i.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){i.onparsingerror&&i.onparsingerror(t)}return i.onflush&&i.onflush(),this},c}()},"./src/utils/webvtt-parser.ts":function(O,C,x){x.r(C),x.d(C,"generateCueId",function(){return l}),x.d(C,"parseWebVTT",function(){return v});var T=x("./src/polyfills/number.ts"),h=x("./src/utils/vttparser.ts"),m=x("./src/demux/id3.ts"),M=x("./src/utils/timescale-conversion.ts"),S=x("./src/remux/mp4-remuxer.ts"),p=/\r\n|\n\r|\n|\r/g,u=function(i,t,r){return r===void 0&&(r=0),i.substr(r,t.length)===t},n=function(i){var t=parseInt(i.substr(-3)),r=parseInt(i.substr(-6,2)),e=parseInt(i.substr(-9,2)),s=i.length>9?parseInt(i.substr(0,i.indexOf(":"))):0;if(!Object(T.isFiniteNumber)(t)||!Object(T.isFiniteNumber)(r)||!Object(T.isFiniteNumber)(e)||!Object(T.isFiniteNumber)(s))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+i);return t+=1e3*r,t+=60*1e3*e,t+=60*60*1e3*s,t},f=function(i){for(var t=5381,r=i.length;r;)t=t*33^i.charCodeAt(--r);return(t>>>0).toString()};function l(d,i,t){return f(d.toString())+f(i.toString())+f(t)}var c=function(i,t,r){var e=i[t],s=i[e.prevCC];if(!s||!s.new&&e.new){i.ccOffset=i.presentationOffset=e.start,e.new=!1;return}for(;(o=s)!==null&&o!==void 0&&o.new;){var o;i.ccOffset+=e.start-s.start,e.new=!1,e=s,s=i[e.prevCC]}i.presentationOffset=r};function v(d,i,t,r,e,s,o,a){var g=new h.VTTParser,A=Object(m.utf8ArrayToStr)(new Uint8Array(d)).trim().replace(p,`
`).split(`
`),D=[],y=Object(M.toMpegTsClockFromTimescale)(i,t),E="00:00.000",_=0,L=0,I,b=!0,R=!1;g.oncue=function(P){var w=r[e],F=r.ccOffset,k=(_-y)/9e4;if(w!=null&&w.new&&(L!==void 0?F=r.ccOffset=w.start:c(r,e,k)),k&&(F=k-r.presentationOffset),R){var B=P.endTime-P.startTime,U=Object(S.normalizePts)((P.startTime+F-L)*9e4,s*9e4)/9e4;P.startTime=U,P.endTime=U+B}var j=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(j)),P.id||(P.id=l(P.startTime,P.endTime,j)),P.endTime>0&&D.push(P)},g.onparsingerror=function(P){I=P},g.onflush=function(){if(I){a(I);return}o(D)},A.forEach(function(P){if(b)if(u(P,"X-TIMESTAMP-MAP=")){b=!1,R=!0,P.substr(16).split(",").forEach(function(w){u(w,"LOCAL:")?E=w.substr(6):u(w,"MPEGTS:")&&(_=parseInt(w.substr(7)))});try{L=n(E)/1e3}catch(w){R=!1,I=w}return}else P===""&&(b=!1);g.parse(P+`
`)}),g.flush()}},"./src/utils/xhr-loader.ts":function(O,C,x){x.r(C);var T=x("./src/utils/logger.ts"),h=x("./src/loader/load-stats.ts"),m=/^age:\s*[\d.]+\s*$/m,M=function(){function S(u){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=u?u.xhrSetup:null,this.stats=new h.LoadStats,this.retryDelay=0}var p=S.prototype;return p.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},p.abortInternal=function(){var n=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),n&&(n.onreadystatechange=null,n.onprogress=null,n.readyState!==4&&(this.stats.aborted=!0,n.abort()))},p.abort=function(){var n;this.abortInternal(),(n=this.callbacks)!==null&&n!==void 0&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},p.load=function(n,f,l){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=n,this.config=f,this.callbacks=l,this.retryDelay=f.retryDelay,this.loadInternal()},p.loadInternal=function(){var n=this.config,f=this.context;if(!!n){var l=this.loader=new self.XMLHttpRequest,c=this.stats;c.loading.first=0,c.loaded=0;var v=this.xhrSetup;try{if(v)try{v(l,f.url)}catch{l.open("GET",f.url,!0),v(l,f.url)}l.readyState||l.open("GET",f.url,!0);var d=this.context.headers;if(d)for(var i in d)l.setRequestHeader(i,d[i])}catch(t){this.callbacks.onError({code:l.status,text:t.message},f,l);return}f.rangeEnd&&l.setRequestHeader("Range","bytes="+f.rangeStart+"-"+(f.rangeEnd-1)),l.onreadystatechange=this.readystatechange.bind(this),l.onprogress=this.loadprogress.bind(this),l.responseType=f.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),l.send()}},p.readystatechange=function(){var n=this.context,f=this.loader,l=this.stats;if(!(!n||!f)){var c=f.readyState,v=this.config;if(!l.aborted&&c>=2)if(self.clearTimeout(this.requestTimeout),l.loading.first===0&&(l.loading.first=Math.max(self.performance.now(),l.loading.start)),c===4){f.onreadystatechange=null,f.onprogress=null;var d=f.status;if(d>=200&&d<300){l.loading.end=Math.max(self.performance.now(),l.loading.first);var i,t;if(n.responseType==="arraybuffer"?(i=f.response,t=i.byteLength):(i=f.responseText,t=i.length),l.loaded=l.total=t,!this.callbacks)return;var r=this.callbacks.onProgress;if(r&&r(l,n,i,f),!this.callbacks)return;var e={url:f.responseURL,data:i};this.callbacks.onSuccess(e,l,n,f)}else l.retry>=v.maxRetry||d>=400&&d<499?(T.logger.error(d+" while loading "+n.url),this.callbacks.onError({code:d,text:f.statusText},n,f)):(T.logger.warn(d+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,v.maxRetryDelay),l.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),v.timeout)}},p.loadtimeout=function(){T.logger.warn("timeout while loading "+this.context.url);var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))},p.loadprogress=function(n){var f=this.stats;f.loaded=n.loaded,n.lengthComputable&&(f.total=n.total)},p.getCacheAge=function(){var n=null;if(this.loader&&m.test(this.loader.getAllResponseHeaders())){var f=this.loader.getResponseHeader("age");n=f?parseFloat(f):null}return n},S}();C.default=M}}).default})})(Ze);var Ct=Ue(Ze.exports);const Me=ye=>(lt("data-v-215ca4c6"),ye=ye(),ut(),ye),Pt=Me(()=>pe("div",{class:"artplayer-app"},null,-1)),wt={key:0,class:"zfile-video-switch-tools"},Ft=De("\u4E0A\u4E00\u4E2A\u89C6\u9891"),kt=De("\u4E0B\u4E00\u4E2A\u89C6\u9891"),Bt={class:"zfile-video-tools"},Ut=De(" \u76F4\u63A5\u4E0B\u8F7D "),jt=Me(()=>pe("img",{src:ct,alt:"\u4E0B\u8F7D"},null,-1)),Nt=De(" \u4F7F\u7528\u8FC5\u96F7\u4E0B\u8F7D "),Kt=Me(()=>pe("img",{src:ht,alt:"\u8FC5\u96F7"},null,-1)),Wt=De(" \u4F7F\u7528 motrix \u4E0B\u8F7D "),Gt=Me(()=>pe("img",{src:vt,alt:"motrix"},null,-1)),zt=De(" \u4F7F\u7528 PotPlayer \u64AD\u653E "),Vt=Me(()=>pe("img",{src:pt,alt:"PotPlayer"},null,-1)),Ht=De(" \u4F7F\u7528 IINA \u64AD\u653E "),Yt=Me(()=>pe("img",{src:gt,alt:"IINA"},null,-1)),Zt=De(" \u4F7F\u7528 VLC \u64AD\u653E "),Qt=Me(()=>pe("img",{src:mt,alt:"VLC"},null,-1)),$t=De(" \u4F7F\u7528 nPlayer \u64AD\u653E "),Xt=Me(()=>pe("img",{src:yt,alt:"nPlayer"},null,-1)),Jt=De(" \u4F7F\u7528 MXPlayer(Free) \u64AD\u653E "),qt=Me(()=>pe("img",{src:Et,alt:"MXPlayer(Free)"},null,-1)),er=De(" \u4F7F\u7528 MXPlayer(Pro) \u64AD\u653E "),tr=Me(()=>pe("img",{src:xt,alt:"MXPlayer(Pro)"},null,-1)),rr=Me(()=>pe("div",{class:"zfile-video-tools-tips"}," tips: \u53EF\u70B9\u51FB\u4E0A\u65B9\u7684\u8F6F\u4EF6\u56FE\u6807\u8FDB\u884C\u4E0B\u8F7D\u64AD\u653E, \u672C\u5730\u64AD\u653E\u5668\u89E3\u7801\u6548\u679C\u66F4\u4F73. ",-1)),ir={__name:"VideoPlayer",setup(ye){let Ie=rt(),O=it();const C=t=>{let r=[];return O.filterFileByType("video").forEach(e=>{r.push({default:e.name===t,html:e.name,url:e.url})}),r};let x=st(null);const T=t=>{switch(t){case"download":window.location=x.value.url;break;case"thunder":window.location=`thunder://${btoa("AA"+x.value.url+"ZZ")}`;break;case"motrix":window.location=`motrix://new-task?uri=${encodeURIComponent(x.value.url)}&out=${encodeURIComponent(x.value.name)}`;break;case"potplayer":window.location=`potplayer://${x.value.url}`;break;case"iina":window.location=`iina://weblink?url=${encodeURIComponent(x.value.url)}`;break;case"vlc":window.location=`vlc://${x.value.url}`;break;case"nplayer":window.location=`nplayer-${x.value.url}`;break;case"mxplayer":window.location="intent:"+x.value.url+"#Intent;package=com.mxtech.videoplayer.ad;S.title="+x.value.name+";end";break;case"mxplayer-pro":window.location="intent:"+x.value.url+"#Intent;package=com.mxtech.videoplayer.pro;S.title="+x.value.name+";end";break}},h=t=>{let r=O.filterFileByType("video");m();for(let e=0;e<r.length;e++)if(r[e].name===t)return{prev:r[e-1]||null,next:r[e+1]||null}},m=()=>{let t=JSON.parse(localStorage.getItem("_h5_player_play_progress_"));if(t){for(let r of Object.keys(t))r.endsWith(t[r].progress)&&delete t[r];localStorage.setItem("_h5_player_play_progress_",JSON.stringify(t))}},M=t=>{let r=[];return O.fileList.find((e,s)=>{let o=e.name.toLowerCase();(o===t+".vtt"||o===t+".srt"||o===t+".ass")&&r.push({default:r.length===0,url:e.url,html:o})}),r.length>0&&r.push({url:"",html:"\u5173\u95ED\u5B57\u5E55"}),r};let S='<i class="art-icon art-icon-video-list"><svg t="1650551038453" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12028" width="20" height="20"><path d="M111.395066 179.64038l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12029"></path><path d="M111.395066 468.067418l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12030"></path><path d="M111.395066 756.493433l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12031"></path></svg></i>',p=`<i class="art-icon art-icon-subtitle"><svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 48 48">
    <path d="M0 0h48v48H0z" fill="none"></path>
    <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
</svg></i>`,u='<i class="art-icon art-icon-next-video"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>',n='<i class="art-icon art-icon-prev-video" style="transform: scale(-1,1);"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>';const f=ze("zfile-video-auto-player-next",!1),l=ze("zfile-video-auto-player",!1);let c=null;const v=(t,r)=>{x.value={name:t,url:r},document.querySelector(".zfile-video-dialog .el-dialog__title").innerHTML=t,c&&c.destroy();let e="mp4";t.toLowerCase().endsWith("flv")?e="flv":t.toLowerCase().endsWith("m3u8")&&(e="hls");let s={container:".artplayer-app",title:t,url:r,type:e,setting:!0,playbackRate:!0,flip:!0,fullscreen:!0,fastForward:!0,autoOrientation:!0,aspectRatio:!0,fullscreenWeb:!0,theme:"#23ade5",lock:!0,subtitleOffset:!0,miniProgressBar:!0,autoplay:l.value,whitelist:["*"],moreVideoAttr:{"x5-video-player-type":"h5","x5-video-player-fullscreen":!1,"x5-video-orientation":"portraint",preload:"metadata",crossOrigin:"anonymous"},customType:{flv:function(a,g){if(Ve.isSupported()){const A=Ve.createPlayer({type:"flv",url:g});A.attachMediaElement(a),A.load()}else c.notice.show="\u4E0D\u652F\u6301\u64AD\u653E\u683C\u5F0F\uFF1Aflv"},m3u8:function(a,g){let A=new Ct;A.loadSource(g),A.attachMedia(a)}},contextmenu:[{html:"\u4E0B\u8F7D",click:function(){window.open(r)}}],settings:[{html:"\u81EA\u52A8\u64AD\u653E",tooltip:l.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:l.value,onSwitch:function(a,g,A){console.info(a,g,A);const D=!a.switch;return l.value=D,c.autoplay=D,a.tooltip=D?"\u5F00\u542F":"\u5173\u95ED",D}},{html:"\u81EA\u52A8\u64AD\u653E\u4E0B\u4E00\u4E2A\u89C6\u9891",tooltip:f.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:f.value,onSwitch:function(a,g,A){console.info(a,g,A);const D=!a.switch;return f.value=D,a.tooltip=D?"\u5F00\u542F":"\u5173\u95ED",D}}],controls:[{name:"video-list",position:"right",html:S,selector:C(t),onSelect:function(a,g){return v(a.html,a.url),S}}]},o=M(t);o.length>0&&o.length>1&&s.controls.push({name:"video-subtitle",position:"right",html:p,selector:o,onSelect:a=>(a.html==="\u5173\u95ED\u5B57\u5E55"?c.subtitle.show=!1:(c.subtitle.show=!0,c.subtitle.url=a.url),p)}),c=new _t(s),c.on("destory",()=>{}),Ie.isMobile.value===!1&&c.on("ready",()=>{let a=h(c.option.title);a.prev&&c.controls.add({name:"prev-video",position:"left",index:5,tooltip:"\u64AD\u653E\u4E0A\u4E00\u4E2A",html:n,click:()=>{i()}}),a.next&&c.controls.add({name:"next-video",position:"left",index:15,tooltip:"\u64AD\u653E\u4E0B\u4E00\u4E2A",html:u,click:()=>{d()}})}),c.on("video:ended",()=>{f.value&&d()}),o.length>0&&(c.subtitle.url=o[0].url)},d=()=>{const t=h(c.option.title).next;t&&v(t.name,t.url)},i=()=>{const t=h(c.option.title).prev;t&&v(t.name,t.url)};return at(()=>{v(O.currentClickRow.name,O.currentClickRow.url)}),(t,r)=>{const e=ft,s=dt;return Pe(),we("div",null,[Pt,Re(x)&&Re(Ie).isMobile.value?(Pe(),we("div",wt,[We(Ae(e,{icon:Re(Dt),onClick:i},{default:ge(()=>[Ft]),_:1},8,["icon"]),[[Ge,h(Re(x).name).prev]]),We(Ae(e,{icon:Re(Ot),onClick:d},{default:ge(()=>[kt]),_:1},8,["icon"]),[[Ge,h(Re(x).name).next]])])):ot("",!0),pe("div",Bt,[pe("div",{class:"zfile-video-tools-item",onClick:r[0]||(r[0]=o=>T("download"))},[Ae(s,{placement:"top"},{content:ge(()=>[Ut]),default:ge(()=>[jt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[1]||(r[1]=o=>T("thunder"))},[Ae(s,{placement:"top"},{content:ge(()=>[Nt]),default:ge(()=>[Kt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[2]||(r[2]=o=>T("motrix"))},[Ae(s,{placement:"top"},{content:ge(()=>[Wt]),default:ge(()=>[Gt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[3]||(r[3]=o=>T("potplayer"))},[Ae(s,{placement:"top"},{content:ge(()=>[zt]),default:ge(()=>[Vt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[4]||(r[4]=o=>T("iina"))},[Ae(s,{placement:"top"},{content:ge(()=>[Ht]),default:ge(()=>[Yt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[5]||(r[5]=o=>T("vlc"))},[Ae(s,{placement:"top"},{content:ge(()=>[Zt]),default:ge(()=>[Qt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[6]||(r[6]=o=>T("nplayer"))},[Ae(s,{placement:"top"},{content:ge(()=>[$t]),default:ge(()=>[Xt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[7]||(r[7]=o=>T("mxplayer"))},[Ae(s,{placement:"top"},{content:ge(()=>[Jt]),default:ge(()=>[qt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:r[8]||(r[8]=o=>T("mxplayer-pro"))},[Ae(s,{placement:"top"},{content:ge(()=>[er]),default:ge(()=>[tr]),_:1})])]),rr])}}};var Tr=nt(ir,[["__scopeId","data-v-215ca4c6"]]);export{Tr as default};
