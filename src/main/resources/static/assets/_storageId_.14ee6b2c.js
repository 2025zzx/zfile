import{r as g,L as P,P as Q,o as W,ae as H,Q as K,u as t,a as w,b as S,e as i,p as a,h as o,S as q,f as X,y as Y,F as ee,k as te,U as oe,V as ae,J as m}from"./index.43b3cbf5.js";import{b3 as C,b4 as le,l as ie,m as se,aR as re,r as ne}from"./base.4ef7f45b.js";/* empty css                *//* empty css               *//* empty css              *//* empty css            */import{E as de,a as me}from"./select.8acf8bd3.js";import"./scrollbar.83fe9165.js";import{E as pe}from"./popper.718d36e0.js";import{E as ce}from"./alert.b0fac511.js";import"./tooltip.f118fcb0.js";import{E as ue}from"./switch.87050cd5.js";import{S as fe}from"./SvgIcon.eefd5347.js";import{Z as F,a as _e}from"./ZFormItem.899c4541.js";import{o as ve,p as he,e as ge,q as xe}from"./admin-storage.442a3cb6.js";import{u as U,r as be}from"./common.9f3a7a35.js";import{S as we}from"./sortable.esm.a99254e8.js";import{E as D}from"./request.e2daed10.js";import{E as ye}from"./index.439070da.js";import ke from"./readme-editor-dialog.5b0917f1.js";import{b as M}from"./route-block.9b0645f8.js";import{_ as Ve}from"./plugin-vue_export-helper.21dcd24c.js";import{r as Re}from"./BadgeCheckIcon.8153a115.js";import{E as Ee}from"./index.da7dbe5d.js";import{v as Ie}from"./directive.378eb0e0.js";import"./index.88f36c37.js";import"./index.9c287fed.js";import"./index.566ad052.js";import"./event.776e7e11.js";import"./scroll.90c07eee.js";import"./isEqual.2263846a.js";import"./debounce.014e7b6e.js";import"./validator.b1ae6965.js";import"./focus-trap.4cfde4b4.js";import"./event.3ec63147.js";import"./index.5cf4e3bb.js";import"./index.d46124aa.js";import"./dialog.0ab1ba1d.js";import"./overlay.533d94fc.js";import"./refs.f6f7d296.js";let s=g([]),z=g(!1);function Se(p,f){let _=f.params.storageId;const y=()=>{ve(_).then(n=>{s.value=n.data,s.value.length===0&&b(),k()})},k=()=>{const n=document.querySelector(".z-form-body");we.create(n,{draggable:".expression-item",filter:".el-button, .editor-input",onEnd:e=>{if(e.oldIndex===e.newIndex)return;const v=s.value.splice(e.oldIndex-1,1)[0];s.value.splice(e.newIndex-1,0,v)}})},x=()=>{if(!s.value.find(e=>{if(U.isEmpty(e.description)||U.isEmpty(e.expression)||U.isEmpty(e.readmeText))return D.warning("\u8BF7\u68C0\u67E5\u6570\u636E\u586B\u5199\u662F\u5426\u5B8C\u6574"),!0})){z.value=!0;for(let e=0;e<s.value.length;e++){let v=s.value[e];v.id=e+1}he(_,s.value).then(()=>{ye.confirm("\u4FDD\u5B58\u6210\u529F, \u662F\u5426\u8FD4\u56DE\u5B58\u50A8\u6E90\u5217\u8868\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"success",callback:e=>{e==="confirm"&&p.push("/admin/storage-list")}})}).finally(()=>{z.value=!1})}},b=()=>{s.value.push({description:"\u8868\u8FBE\u5F0F - "+(s.value.length+1),expression:"",readmeText:"",displayMode:"top",storageId:_})};return{loading:z,loadReadmeData:y,readmeList:s,addReadmeItem:b,deleteReadmeItem:n=>{s.value.splice(n,1)},saveReadmeData:x}}const d=p=>(oe("data-v-1813f32f"),p=p(),ae(),p),Ce={class:"flex justify-between"},Ue=d(()=>a("span",null,"\u76EE\u5F55\u6587\u6863",-1)),ze=d(()=>a("span",{class:"mr-4 text-sm text-gray-500"},"\u517C\u5BB9\u4E3A\u8BFB\u53D6 readme.md",-1)),Te=d(()=>a("div",{class:"rules-tips"},"Glob \u8868\u8FBE\u5F0F\u89C4\u5219\uFF1A",-1)),Be=d(()=>a("div",{class:"rules-tips"},[a("b",null,"/"),m(": \u6839\u76EE\u5F55, \u5982 /, \u8868\u793A\u6839\u8DEF\u5F84\u4E0B\u4F1A\u52A0\u8F7D\u6B64\u6587\u6863\u663E\u793A.")],-1)),qe=d(()=>a("div",{class:"rules-tips"},[a("b",null,"*"),m("\uFF1A\u5355\u7EA7\u8DEF\u5F84\u901A\u914D\u7B26\uFF0C\u5982\u8868\u8FBE\u5F0F /*\uFF0C\u8868\u793A\u6839\u8DEF\u5F84\u4E0B\u7684\u76F4\u63A5\u5B50\u6587\u4EF6\u5939\u4F1A\u52A0\u8F7D\u6B64\u6587\u6863\u663E\u793A.")],-1)),Fe=d(()=>a("div",{class:"rules-tips"},[a("b",null,"**"),m("\uFF1A\u591A\u7EA7\u8DEF\u5F84\u901A\u914D\u7B26\uFF0C\u5982\u8868\u8FBE\u5F0F /music/**\uFF0C\u8868\u793A /music \u6587\u4EF6\u5939\u53CA\u4EE5\u4E0B\u6240\u6709\u6587\u4EF6\u5939\u90FD\u4F1A\u52A0\u8F7D\u6B64\u6587\u6863.")],-1)),Me=d(()=>a("div",{class:"rules-tips"},"\u6CE8\uFF1A\u7CFB\u7EDF\u5339\u914D\u5230\u7B2C\u4E00\u4E2A\u7B26\u5408\u7684\u89C4\u5219\u5C31\u4F1A\u53D6\u6587\u6863\u8FDB\u884C\u663E\u793A\uFF0C\u6240\u4EE5\u8BF7\u8C03\u6574\u597D\u89C4\u5219\u987A\u5E8F\uFF0C\u4E0B\u65B9\u89C4\u5219\u53EF\u8FDB\u884C\u62D6\u62FD\u6392\u5E8F\u3002",-1)),De={class:"rules-tips-link"},Le={target:"_blank",class:"link",href:"http://www.ruanyifeng.com/blog/2018/09/bash-wildcards.html"},Ne=d(()=>a("span",null,"\u53C2\u8003\u6587\u7AE0 (Wikipedia)",-1)),Ze={target:"_blank",class:"link",href:"http://www.ruanyifeng.com/blog/2018/09/bash-wildcards.html"},Ge=m("\u53C2\u8003\u6587\u7AE0 (\u962E\u4E00\u5CF0)"),$e={target:"_blank",class:"link",href:"https://github.com/whinc/blog/issues/18"},je=m("\u53C2\u8003\u6587\u7AE0 (Github)"),Ae={class:"sm:flex sm:space-x-2 sm:border-b-0 sm:pb-0 border-b pb-2"},Je=m("\u6DFB\u52A0\u66F4\u591A"),Oe=m("\u4FDD\u5B58\u8BBE\u7F6E"),L={__name:"[storageId]",setup(p){let f=P(),_=Q();const{loading:y,loadReadmeData:k,readmeList:x,addReadmeItem:b,deleteReadmeItem:T,saveReadmeData:n}=Se(_,f);W(()=>{k()});let e=g(!1);ge(f.params.storageId).then(h=>{e.value=h.data.compatibilityReadme||!1});const v=()=>{xe(f.params.storageId,e.value).then(h=>{D.success("\u4FDD\u5B58\u6210\u529F")})};let V=g({}),c=g(!1);const N=h=>{c.value=!0,V.value=h};return(h,u)=>{const Z=fe,G=H("router-link"),$=ue,B=pe,j=ce,R=Ee,E=de,A=me,I=ne,J=Ie;return K((w(),S(_e,{model:t(x),class:"zfile-admin-readme-form"},{"form-title":i(()=>[a("div",Ce,[a("div",null,[o(G,{to:"/admin/storage-list"},{default:i(()=>[o(Z,{class:"inline mr-2 cursor-pointer",name:"file-type-back"})]),_:1}),Ue]),o(B,{placement:"top",content:"\u542F\u7528\u540E\u4E0B\u53D1\u7684\u89C4\u5219\u8BBE\u7F6E\u4F1A\u5931\u6548\uFF0C\u4EC5\u4F1A\u4E3A\u8BFB\u53D6\u76EE\u5F55\u4E0B\u7684 readme.md \u6587\u4EF6\u6765\u6E32\u67D3\u6587\u6863, \u4E14\u56FA\u5B9A\u5728\u5E95\u90E8\u663E\u793A."},{default:i(()=>[a("div",null,[ze,o($,{onChange:v,"active-text":"\u662F","inline-prompt":"","inactive-text":"\u5426",modelValue:t(e),"onUpdate:modelValue":u[0]||(u[0]=l=>q(e)?e.value=l:e=l)},null,8,["modelValue"])])]),_:1})])]),"form-sub-title":i(()=>[o(j,{closable:!1,type:"info"},{default:i(()=>[Te,Be,qe,Fe,Me,a("div",De,[a("a",Le,[o(t(C),{class:"inline mr-1"}),Ne]),a("a",Ze,[o(t(C),{class:"inline mr-1"}),Ge]),a("a",$e,[o(t(C),{class:"inline mr-1"}),je])])]),_:1})]),footer:i(()=>[o(I,{type:"primary",size:"default",icon:t(Re),onClick:t(n)},{default:i(()=>[Oe]),_:1},8,["icon","onClick"])]),default:i(()=>[(w(!0),X(ee,null,Y(t(x),(l,O)=>(w(),S(F,{required:!0,key:l,class:"expression-item"},{default:i(()=>[a("div",Ae,[o(B,{content:"\u6B64\u5904\u53EF\u586B\u5199\u8868\u8FBE\u4E66\u63CF\u8FF0\uFF0C\u7528\u4E8E\u8F85\u52A9\u8BB0\u5FC6\uFF0C\u9632\u6B62\u65F6\u95F4\u8FC7\u957F\u540E\u4E0D\u77E5\u9053\u8868\u8FBE\u5F0F\u542B\u4E49.",placement:"top"},{default:i(()=>[o(R,{"prefix-icon":t(le),placeholder:"\u8BF7\u8F93\u5165\u8868\u8FBE\u5F0F\u63CF\u8FF0",modelValue:l.description,"onUpdate:modelValue":r=>l.description=r},null,8,["prefix-icon","modelValue","onUpdate:modelValue"])]),_:2},1024),o(R,{"prefix-icon":t(be),placeholder:"\u8BF7\u8F93\u5165\u8868\u8FBE\u5F0F",modelValue:l.expression,"onUpdate:modelValue":r=>l.expression=r},null,8,["prefix-icon","modelValue","onUpdate:modelValue"]),o(R,{class:"editor-input",onClick:r=>N(l),readonly:"","prefix-icon":t(ie),placeholder:"\u8BF7\u70B9\u51FB\u7F16\u8F91\u6587\u6863",modelValue:l.readmeText,"onUpdate:modelValue":r=>l.readmeText=r},null,8,["onClick","prefix-icon","modelValue","onUpdate:modelValue"]),o(A,{class:"editor-input",modelValue:l.displayMode,"onUpdate:modelValue":r=>l.displayMode=r},{default:i(()=>[o(E,{label:"\u9876\u90E8\u663E\u793A",value:"top"}),o(E,{label:"\u5E95\u90E8\u663E\u793A",value:"bottom"}),o(E,{label:"\u5F39\u7A97\u663E\u793A",value:"dialog"})]),_:2},1032,["modelValue","onUpdate:modelValue"]),o(I,{type:"danger",onClick:r=>t(T)(O),icon:t(se)},null,8,["onClick","icon"])])]),_:2},1024))),128)),o(F,null,{default:i(()=>[o(I,{type:"primary",size:"default",icon:t(re),onClick:t(b)},{default:i(()=>[Je]),_:1},8,["icon","onClick"])]),_:1}),t(c)?(w(),S(ke,{key:0,modelValue:t(V).readmeText,"onUpdate:modelValue":u[1]||(u[1]=l=>t(V).readmeText=l),visible:t(c),"onUpdate:visible":u[2]||(u[2]=l=>q(c)?c.value=l:c=l)},null,8,["modelValue","visible"])):te("",!0)]),_:1},8,["model"])),[[J,t(y)]])}}};typeof M=="function"&&M(L);var Bt=Ve(L,[["__scopeId","data-v-1813f32f"]]);export{Bt as default};
