import{d as M,s as q,a as B,b as I,l as O,c as P}from"./admin-storage.260bbac1.js";import{S as T}from"./sortable.esm.a99254e8.js";import{E as l}from"./index.11692625.js";import{E as o}from"./request.3708b2c4.js";import{r,c as A}from"./index.552205f5.js";let v=r("card"),C=r(!1),S=r(),i=r(!1),t=r([]),s=r("");function z(n){const x=()=>{n.push("/admin/storage-edit")},u=e=>{n.push("/admin/storage-edit/"+e.id)},d=e=>{l.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",callback:a=>{a==="confirm"&&M(e.id).then(c=>{o.success("\u5220\u9664\u6210\u529F"),w()})}})},L=e=>{l.confirm("\u662F\u5426\u786E\u8BA4\u5173\u95ED\uFF1F\u5173\u95ED\u540E\u586B\u5199\u7684\u6570\u636E\u4E0D\u4F1A\u4FDD\u7559\u3002",{type:"warning"}).then(a=>{e()}).catch(a=>{})},g=e=>{n.push("/admin/storage-filter/"+e.id)},h=e=>{n.push("/admin/storage-readme/"+e.id)},f=e=>{n.push("/admin/storage-password/"+e.id)},b=e=>{l.confirm(`\u662F\u5426\u786E\u8BA4${e.enable?"\u505C\u6B62":"\u542F\u7528"}\u5B58\u50A8\u6E90\u3002`,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",callback:a=>{if(a==="confirm"){let c=e.enable?"disable":"enable";q(e.id,c).then(()=>{o.success((e.enable?"\u505C\u6B62":"\u542F\u7528")+"\u6210\u529F"),e.enable=!e.enable})}}})},y=e=>{let a=e.enableCache?"enable":"disable";B(e.id,a).then(()=>{o.success("\u4FEE\u6539\u6210\u529F")})},k=e=>{let a=e.autoRefreshCache?"start":"stop";I(e.id,a).then(()=>{o.success("\u4FEE\u6539\u6210\u529F")})},p=e=>{S.value=e.id,C.value=!0},R=e=>{switch(e.operator){case"edit":u(e.storage);break;case"enable":b(e.storage);break;case"readmeManager":h(e.storage);break;case"cacheManager":p(e.storage);break;case"filterManager":g(e.storage);break;case"pwdManager":f(e.storage);break;case"delete":d(e.storage);break}},m=()=>{const e=document.querySelector(".storage-container");T.create(e,{draggable:".storage-item",filter:".add-storage-btn",onEnd:a=>{if(a.oldIndex===a.newIndex)return;const c=t.value.splice(a.oldIndex,1)[0];t.value.splice(a.newIndex,0,c),P(t.value).then(()=>{o.success("\u8C03\u6574\u6392\u5E8F\u6210\u529F")})}})},w=()=>{i.value=!0,O().then(e=>{t.value=e.data,m(),i.value=!1})},E=A(()=>s.value===""?t.value:t.value.filter(e=>!!(e.name&&e.name.toLowerCase().indexOf(s.value.toLowerCase())!==-1||e.remark&&e.remark.toLowerCase().indexOf(s.value.toLowerCase())!==-1||e.type&&e.type.description.toLowerCase().indexOf(s.value.toLowerCase())!==-1||e.type&&e.type.key.toLowerCase().indexOf(s.value.toLowerCase())!==-1)));return{init:w,loading:i,layout:v,changeLayout:e=>{v.value=e},searchKey:s,storageListSearchResult:E,handleOperator:R,addStorage:x,editStorage:u,deleteStorage:d,handleClose:L,showFilterPage:g,showReadmePage:h,showPasswordPage:f,switchEnableStatus:b,cacheManageVisible:C,currentCacheManageId:S,switchCacheEnableStatus:y,switchCacheAutoRefreshStatus:k,cacheManage:p}}export{z as u};
