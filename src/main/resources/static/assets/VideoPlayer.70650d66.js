import{f as Ue}from"./request.19cbe8c5.js";import"./base.197bc1e5.js";import"./tooltip.f118fcb0.js";import{E as Xe}from"./popper.91c84279.js";import{bN as je,M as we,K as Fe,_ as $e,o as Je,a as qe,f as et,p as pe,h as De,e as ge,S as tt,U as rt,J as Me}from"./index.bbf7818f.js";import{u as it}from"./useFileUpload.ba32a7f8.js";import"./focus-trap.fe4b8179.js";import"./event.3ec63147.js";import"./common.d0a2bd7a.js";import"./index.6dd6d04c.js";import"./index.9aca9b8e.js";import"./event.776e7e11.js";import"./index.c66de53e.js";import"./scroll.4cf9bb37.js";import"./validator.998eeed0.js";import"./index.eeb08216.js";import"./directive.b8a17520.js";var nt="/assets/video-download.3a226681.png",st="/assets/video-thunder.5e7f4cec.png",at="/assets/video-motrix.95ef7e61.png",ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAOeUlEQVR4Xu3dy5EjuRWF4TMGyA550ibIgPZirJjFODIeaDVOaDMvSREKRdRKGy0UVF1mZTV5yGS+ACSA/G/EV1F1p7unu4pA4nEB6nK5fIeG/UN/vvyuL5df9fXyi75///zHq9/00+UP/fye+9vVr3q7cZnw7deMvy/+jPiz4s+MPz/+PyH+v//Wnx7+PmiKPIEKRUMbG/nYuIdG7Q34GPF3GTuJ4e/4hc6hDfIEDjY29njaRqN6/cSu29gxDCMTOoUKyRMoLIbS8dSs7ameS/wbx5FC/Nv9+4Gi5AlkNj7hhzl1/w1+ztghMEI4hDyBDOJJF8PgWFDzBoB745SB0UER8gQSGRs9T/nthl0MOoOM5AnswJM+n7EzYJqQlDyBDWL+OqzYP75wkd6w5fjl4eeA1eQJLDQU4MRqdrvbdK0bipWYIuwgT2AGT/s6xc+EjmA1eQITYt+auX394mfE9GAxeQI3YsGJlfw2DT+zrywaviZP4MNw8IX5fevoCF6SJ04tXiTDqTqe+L0ZOwL/mZ+cPHFaNPxzGEqPWSP4IE+cTrwYWNw7H3YNruSJ0/i2j//44sB5xGvgxOsD8sQpsMCHe/FaOOX6gDzRNYb7eCVeGyebFsgTXRrO4DPcxzIxQvTXUKfkie4M12uxuo91TrJbIE90g6c+Uuh8NCBPdGE4l89TH2l0vDYgTzRvuLf+8YcI7NfdToE80awY8nNMF7nFa6yjugF5okkM+VFSvNY6mRLIE81hyI9jdFE8JE80g1V+1CBeg/7abIg80YRo/FT0oRYNrwvIE9Vjvo8aNbouIE9UbXiHXA7xoFZvrXUC8kS1WOxDG95aKiGWJ6pE40d7mtghkCeqM5zd928uUL8GzhHIE1Vhmw+tq7wTkCeqQeNHLyruBOSJKtD40ZtKC4bkicPR+NGrCkcC8sShaPzoXWWdgDxxGFb7cRYVdQLyxCHY58f5VFEnIE8UN5T3+jcH6F8FFYPyRFHU9uPcDi8blieKiUMTNH7g0ANE8kQRcXaaI73AINrCQfcJyBNFcJkHcC8uFfF2UoA8kR17/cBzB2wPyhNZsd0HvFZ4UVCeyIZFP2CJoouC8kQWLPoByxVcFJQnsuAde4B1Ci0KyhPJMe8HtspeLixPJDXM+/0fBWCZ7OsB8kQyzPuB/aJmxttWQvJEMuz3A2lkrA+QJ5LghB+QVqapgDyRBEN/IK1oU97OEpAnduNmHyCPDFMBeWIXVv2BvBJPBeSJXTjlB+SVeFdAntiMgh+glGQFQvLEJrHnz0EfoJS3VGcF5IlN2PMHykr0TkPyxGos/AHHSLAgKE+sxsIfcIwEC4LyxCpU/AHH2nmDkDyxChV/wLF2VgjKE4ux7QfUYvO2oDyxGE9/oA47rhCTJxbh6b/Pv969/WXw9yf/HVhv0yhAnpjFRR/7/Pevl4f4zw90BNhn4yhAnpjF03+7eOJPxf/+Ofx3/z3AcqtHAfLELJ7+2z17+nvEr2E0gC027AjIEy+x77/Pmohpgf9+YN6qUYA88RJVf/usjZgWxIKh/znAlJXVgfLEJJ7++20NpgVYY0V1oDwxiXf32W9vsEiIJVa8q5A88RQn/tJIEUwLsMTCk4LyxFNc9JlGyqB2AK8svEBUnniK237SSB3UDmDa28Xb8RPyxAMW/9LJFbFIyLQAbsFioDzxgMW/dHIHtQO4tWAxUJ64M1z2+fgHY5sSwbQAt2bOB8gTd1j8S6tkUDuAMLMYKE/cofIvrSOC0cC5zVQGyhOf2PtP76igduDcXtQEyBOfGP6nd3RQO3BOL6YB8sQnhv/p1RJMC87lxTRAnrhi+J9HTUHtwLlMTAPkiSuG/3nUGNQOnMPENECeuKL4J49ag9qB/k0UBckTFP9kVHtQO9C3J0VB8gS1/xm1EkwL+vTkbIA8wVt9Z9RSUDvQnydvKS5PcOtvRi0G04J+PLk1WHcJtv/yajVYJOyHbQfq9osLb/qRV+tB7UAP7q4N1+0XzP8z6yUoKW6XrQPo9gvKfzPrKZgWtMnKgvX5Bfv/+fUYLBK256YeQOMn7P8X0HNQO9COm3oAjZ9Q/19A70HtQBtuzgVo/IT6/wLOEkwL6nZzLkDjJxQAFXC2YJGwTjcFQbp+wgJgGWcMpgV1+lgIVHygArCQMwe1A3X5WAhUfLhQAVjG2YPagZpcKwIVH6gALIQYgkXC431UBCo+sANQCHEf1A4c52MnQPGBEuBCiMdgkfAYHzsBig8X3v67DGI6mBaUd+0A2AIsh5gPFgnLeW/7YguwIGJZMC0o43d9EYeACiLWBbUDeV07AGoAyiHWB7UD+fyi78UpwIKI7cEiYXrXDoAioHKI/UHtQDrvbZ8OoCQiTbBImMZv+klUARZEpA2mBfv8oZ9FFWBBRJ5gkXCbawfARSDlEPmCacF6722fDqAkIn9QO7DGW9QBcA6gFKJMUDuw1LUD8CRyIcoGb2U2iw6gJOKYoHZgEh1AScRxEaMB/3mADqAo4thgXeABHUBJxLERi4P+Mzk5OoCSiOPDfyYnRwdQEnFssA7wgA6gJOLYYEvwAYVAJRHHBQuAz1AJWBRRPjgx+MobZwFKIsoF5cDzroeBOA5cDlEmOBC0zLUD4EKQcoi8Qe3/Otf7AOgAyiHyBMP9ba5XgnEnYDlE+mC4v931UlCuBS+HSBfcALTftQPgjUHKIdIEw/00Pt4XgLcGK4XYF+zpp/aVNwctidgWDPfzuL43IG8PXg6xPhju5/P+8H//ePnuQjlwGcTyYLif33vbj4/fUQ5cCDEfDPfLiDb/2QFQDFQG8Tq4vLOcaPOfHQDFQGUQz4PhfnnR5j87AGoByiDugxLeI3293IwAqAUogfgWDPePFW3+swNgK7AMguF+LaLNf3YA7ASUceZguF+Tt8tHu9f4CTsBBZw1OLFXl48dgKDxE04FFnC24IKOOkVbf+gAWAjM7yzBcL9uHwuAQeMnLAQWcIZguF+/jwXAoPGTKxYC8+o5GO634aMEeKTbL6gIzKzHYLjflo8KwJFuv7hQEZhXb8Fwv0XXCsCRbr/gcpDMeglO7LUr2vhkBxBYB8inh2C43y6b/wd5gnWAjFoOSnjbZ/P/IE9QD5BRi8Fwvx83+/8jeYJ6gIxaC4b7fbnZ/x/JE1e8YWgerQTD/f5Em/Z2PtkBcC4gj9qD4X6/bur/b8kTV2wH5lFzcEFH32z7byRPfGI7ML0ag+F+/55s/43kiU9MA9KrKSjhPY+J4X+QJz4xDUivlmC4fy4Tw/8gT9xhGpDW0cFw/3xeDP+DPHGHaUBaRwXD/fN6MfwP8sQdpgFpHRGc2Du3F8P/IE884LLQdEoGF3Tg5vLPKfLEA84GpFMiGO5j9KT238kTD4azAbx9eAq5g+E+vvm8+/8VeeIpjginkSsY7sM9Ofr7jDzxFIuBaaQOhvuYMrP4N5InJrEYuF/KYLiPKQsW/0byxCQWA/dLEZzYw5wFi38jeeIl7gnYZ28w3Mecmco/J0+8xLXh+2wNSnix3N2133PkiZdiS5DzAdutDYb7WCPa5pNrv16RJ2ZxPmC7NcFwH2vN1P0/I0/MojBouxjKzwXDfWzztvbpH+SJRRgFbBNP9alguI89Njz9gzyxCKOA7WL/3oPhPvbZ9PQP8sRi7AhsF0P8aPQ88ZHGqpX/W/LEYuwIAMfbsPJ/S55YhVEAcLTNT/8gT6xGdSBwjIl3+1lDnliNMwLAMVbU/E+RJzbhpCBQ1ooTf6/IE5sM9wWwLQiU8bb0vP8ceWIzioOAMjYW/TwjT2zGtiCQ38rjvnPkiV1YEATySrDwd0ue2I0LRIE8Fl70uYY8sRtTASC9nRV/U+SJJJgKAGklHvqP5IlkmAoAaWQY+o/kiWSYCgD7ZRr6j+SJpJgKAPskKviZIk8kR4EQsE3Cgp8p8kQWnBgE1klU6z9HnsiC9QBguczz/lvyRDasBwBLJDvos4Q8kRU3CAFzdt3ws5Y8kR31AcBzGff7p8gT2cXchkVB4F6C6722kCeKYFEQ+Kbgop+TJ4qIfyy3CAGh6KKfkyeKYmcA5/aW65DPUvJEcewM4KwObvxBnjgE5cI4n6LbfVPkicOwPYizKFDjv5Q8cSg6AfTugL3+V+SJw9EJoFeVNf4gT1SBdxpCbyps/EGeqAYjAfSi0sYf5Imq0AmgdRU3/iBPVIdOAK2qaLV/ijxRJeoE0J4q9vnnyBPVomIQbTi8vHcNeaJqw9kBDhChVoce7NlCnqhefIM5SozaxGuyscYf5IkmcKkIahJ1Kwed599LnmhGfMPZIcDRKt/mmyNPNIfFQRyjqcW+KfJEk1gXQEmNzvefkSeaFVMCzhAgt4bn+8/IE82jaAh5xPZzE8U9a8gTXWBKgJRix6mTIb+TJ7rBLgFSaKCefw95ojuxUstoAGvFa6aDVf458kSXGA1gjXjqd7TQ94o80TXWBvBKx3P9KfLEKQw7BRwqwqjLFf4l5InTYFqAEK+Bkwz3n5EnTmP8oceQj4NF5xMFPScb7j8jT5xWDAFZH+jfSVb3l5InTi1GBcPhItYHejN07qec578iT+AydAQsFPaBhv+SPAETHQFTg/bQ8BeRJzCBNYI2xIIuc/zF5AnMiBcXx47rw6r+JvIEFhqqClknOFKMyE5UtpuDPIENGBWU9Hb9XjPMT0KewA7jqIDCovSG7+lXnvZpyRNIZOwMWDjcLhp9fA+Z22cjTyADRgZLDcP7eNLT6IuQJ5DZcAjpy/UQCqODsTT3x+v3hOF9cfIECosnXTzxztIhDPv0NPhKyBM42DhCiClDDIdb7hTi7z78G76nwddJnkCFouHcjhSiUQ3rCTXUILxd/y5jQx/n7zT2JsgTaMzYOQxvnR7lyvG0jSH2t45iKJiJkUR0GKPHhjwaf/3YsIfpSexoDA08/l808i78HzPcPJXn8KhQAAAAAElFTkSuQmCC",lt="/assets/video-iina.1db26170.png",ut="/assets/video-vlc.54e63a7e.png",ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAK2UlEQVR4Xu2dC3BUZxXHD4g4VlukLRTEIKhYochjeBRaCoggpQaqBSrQWFuCwLbFDpRhQIs4Y8YRO1Lr4JSWJkCJVihgy0PerxapUhqaQrCFIkUghM1rs7sJVCYcz3d3v+Tuud+9e/dFdpPvP/OfwAzs3j0//v9zv2x2ANDS0tLS0tLS0tLS0tLS0tLS0tJqEHrhi1gJM+jrOqyAf2A5vEFeSr8exP+sVopFg59C9pJR6UrYRu7F/55WCkQJWGABoPY1Ss9K+tqZP4ZWkkQwRtGAryuG7+QAgfmFqDj+eFoJiob7nmLgbl1KNTYdEVrzx9WKQ1gFvRVDjt2VcIx8P398rRhFdfWoZbiJ2AvbCcxd/Hm0XIqAeCxDTdz19Lj5qBd/7EoREOkApWWJXvwxKMVADFdXQmkRLX7Qiz+6UgHkagXgyWrAzTWAvw0APh1s8Im5Qb34HZUMINfJ5yoBd/sAl/sB5zYCUHpOELaT+/Jr0YL4gVwmAIcpBQUEYKFi6C5cPy8I+TNr9eKPkFsgAQLwPgFYTzX0K+tw43ctBH4WgLwlevGHZAfkGu2BjwjAVgLwXOQeSJrnRLqU4OSORGjDr7FFSQIRe+A8pWAfQXiRaugZxQCTaQajwU8FoeSJlrz4j1SBZw2lYJFiaKk0BxGGYZiA4Owg7JpdC/359TZ7zQuAhw8rleYQzCBMMKTr6ff5U2rhy/y6m61uJBAnEAoYODPsWQGom9FSFv+NAhIPDAKBPyXnkh8nT/dD6fQAzG7Wiz/VQDgIFQwzCDMMAULCkP4xOccPJVOb6+JPJRAOgsPgqZAwZCrMMH4ShvEIeSr5R+TJftg3obkt/lQA4RDcwFBVlDkVAoSwAYI8iW7Nf0B3hxNqoH68Dwqyq6Arf20ZqWQC4QDcgrCDoUrFw/5GGNnkB8hjyCN8UDe8BvImZ/riTxYQDoGDsNsV5oqyS4WAIVPxkN9IhQFiLHmUgEG+hzzEBwjVUAYXBzwB+5dk5uJPFAiHoAJhB0O1uM2pUFWUTIWAIUAMEhAudUU4PQeheBfCOz6Ew36EQ/4SeNufzV9v2iteIByCHQwVCGEOQqbCXFEShLBIhYAhQEA5+VwOQsk6hCNlCP8MEogAgRAmGG+HfZD8ln8/HKzOnMWfTCBOu8IpFbyieCp6VxKAiw8ifLQC4djHCO8SgH+F3QDD3whDgBDeXxPy3pp62Fv9KuyuS//FHw8QDiIWGHxfqCpqXLWoodEI/1mKcPwownvBEAThIyYYAoSEYU7FwTCIfQYMhN1UY7vIO6vrYIcvD/5eeQufQ9ooViDxgHBa3MJTKAntL/emGlqEcHIvpYCGVxQMgVDBcKqoAyYYe3xmGAjbydsMl8OW6sf5LNJCsQCxA+EEwy4VA6taIVzw0DLeRMvYSxDqCIJwbSOIoyYQFhh+sbitFSVTIWBIEDsEDF8Ixpaw36xCeKPqZUBsxWfSpHIDxCkV0hyEeV8ICA+Ku6GL06iGChBOnCEINPz360IgGmC4SIWqosyp2OuLhCFSIZMhQGw2QCBsqgz5b1WL+EyaVNGAcBgcCE+GhDGNauhm71iET36P8CHtgeJgCIJ0BIjaRhgyFSoY5oqyLm5TRclUmEA0pCIMYiN5A/n1iquwtjZ93te3A8IhcBAcxgzy3RX9qIZ+iXCK9sBxGswHtZEQLKkQIEwVxUEYMEypiKgotridKmpzdSgVEoYBgrxOuBzhLxUL+FyaTBwIh6ACISsqu0rcDT1FNbSRaqgsBECagzDD4KlQwVClQsKQqZAVpV7c1lREwKhA+KuAIVy5jc+lySSBcAgqGI/QmaBVGR3IzuVTDZ0mCDTYD65EglDBsOwKxeK2gxHv4hapUFXUegajkPzn8nf5XJpMAgiHIEGIu6O+5fcjnF9GNUR74EQwBEH4eIww3KTC6WzBFzdPRcTiDleUJRXhinpNwqC7u7XkV737+FyaTHNMQASEMVV0HihdjHBmD0KJrxGA2W5ACMebCleL2xe5uLc6VJQqFRLGGgPI83wuTaaJPvAYe+CTDQj/LrUO3+xYU6GCwUHEe7YwUuGwuEVFOaVCwlgtvl4eyufSdDp51WMZvMoGiBhg8IqKNRXRKsq8uI2zBUuFZXFHVFQIhHDBpfRZ6IbcAHEDIu6K8lthSBDy2x92i5tXVMPZIkpFGSDIq8pOQUGgAx9J08oJiNuKkiAaYIRBqCrK6cTNzxY8FU6L21xRAgSvKJEKM4z8SzvgT95OfBxNLzsgqoriIOJOhaKilItbpsIEgqfCrqJUqRBeVVYKr5RN42NIH6mAcBDxwrA7catguF3cvKKUi7vcurgLvNdglfcP8MfT6futd0MSiKgntxVlt7hVFSXPFqoTd6oXt4SRX3YI8i9nyAeEJJBYQDilQllRNqmwragYFrdTKlZ7vbQrHku7b7E7SgBJFAYHwSvKdnErUqFa3KqKclrcKz6sh8cWvzhs2LD2/OWmv4oFEAcQsVaUanFLGDIVzu/mWVMRraJWX0CY9xL2HTsa87vdcQQBBvKXmTkqDjQCsQOhSkXK381jqTC+/WFKRd4W7PDQw/jz/t3xU6BSAqC/BLPIGf7RawGEg7CkQjjOVERb3KqKsqSC/NIxhNz5mDNiIJ6F1gKA9HVyAfl2/tIyU8W1ViDRUhENhtPibkiFCYQqFYXnEBa+gNnjx+CBrDvMAMwmSnAPf0mZLQ7EDgYHwRe307t5blKxkXbB0k1497SpuGbAN/nguenB4GlyZv64qKMkEA4iGRUVbXGvPIRZT87F34wZhFegLR+6yqKeCsnp8x540iWAcBiuKoqnIlxRTot73SmEZ5ehZ9I4PNPtK3zY0VxCHskvv/lJAnGbiljOFlvLEJa9hlOnP4pvDfk2H7Bb0xPCAnJbfunNU0UExHUqoi1uSsLqA/jdZ+bj+ux7ETu348ON1a+Ts/glN28JIBxGxOKWMGwqatNx7J23DJfnjMcrfboj3vYZxC+0QmxtGW4sPk3+Hr/UlqEiOofYpULcRfHFvfMCtl1eiM8+mYtnRw5A7EYp6HIzpeEmxHZtENtahhuLqTthMflz/DJbjo4SEBUMWVEH6ZZ07U6ctXghvjNxNGKfLog9b0P8xi2IXQlEFwLRke6Q2iWcis3k7vzyWp4EEH62eLMIf/jc87hlxkTE+76F2K8zgaDDWc+OiHfeHoIhU5F4RZ0lj+eX1XIlgOw5i/e9XIj582fhlQcGIw7thjj4q4iDskIwenUKpeLO9o0VJVMRf0V9Sv41+fP8klq0/pszzoPf6YE4/OuI9xKIIWEQ/ama+lEqeplSISsq8VTsJPfg16JFwlFf8+Dw7qFUSBgRFRVOhYDRWaRCLO64YZwnT+bXoGUSjiAgsqKMVIQrykjFreFUJFxR/yP/jpzZnyG/EcIhWZ5QRYVTwSsq8cV9gKz/iwu3olR4lBWV+NmilJxDzqD3s9NA2Kejx5IKubjjO1tcI79A/hJ/Li0Xwrs6TYpc3OFUxFdRh8n9+HNoxSDs2aFHEs4W5eRc1PWUHGGnmw7HubjrySvIt/LH1EpA2AaGUirEyZkP3MlHyYP5Y2klSTTcmRj6F88Hz11N9mDG/7hNBoiG/H3yxwoIwuJw9wo5zT5P0cyFMOCzNPQJGLp13UBeSZ5HTsPPUmhpaWlpaWlpaWlpaWlpaWlpaWlpaWklqv8Da8GBU4g36CAAAAAASUVORK5CYII=",dt="/assets/video-mxplayer.5dfa69aa.png",ct="/assets/video-mxplayer-pro.10406916.png",Ne={exports:{}};/*!
 * artplayer.js v4.5.2
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(Te,Ie){(function(O,C,x,S,h){var m=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof we!="undefined"?we:{},M=typeof m.parcelRequire4dc0=="function"&&m.parcelRequire4dc0,T=M.cache||{},p=typeof je=="function"&&je.bind(Te);function f(o,v){if(!T[o]){if(!O[o]){var c=typeof m.parcelRequire4dc0=="function"&&m.parcelRequire4dc0;if(!v&&c)return c(o,!0);if(M)return M(o,!0);if(p&&typeof o=="string")return p(o);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}t.resolve=function(i){var e=O[o][1][i];return e!=null?e:i},t.cache={};var r=T[o]=new f.Module(o);O[o][0].call(r.exports,t,r,r.exports,this)}return T[o].exports;function t(i){var e=t.resolve(i);return e===!1?{}:f(e)}}f.isParcelRequire=!0,f.Module=function(o){this.id=o,this.bundle=f,this.exports={}},f.modules=O,f.cache=T,f.parent=M,f.register=function(o,v){O[o]=[function(c,u){u.exports=v},{}]},Object.defineProperty(f,"root",{get:function(){return m.parcelRequire4dc0}}),m.parcelRequire4dc0=f;for(var n=0;n<C.length;n++)f(C[n]);var d=f(x);Te.exports=d})({"6SN6P":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("bundle-text:./style/index.less"),m=S.interopDefault(h),M=O("option-validator"),T=S.interopDefault(M),p=O("./utils/emitter"),f=S.interopDefault(p),n=O("./utils"),d=O("./scheme"),o=S.interopDefault(d),v=O("./config"),c=S.interopDefault(v),u=O("./whitelist"),r=S.interopDefault(u),t=O("./template"),i=S.interopDefault(t),e=O("./i18n"),s=S.interopDefault(e),l=O("./player"),a=S.interopDefault(l),g=O("./control"),A=S.interopDefault(g),D=O("./contextmenu"),y=S.interopDefault(D),E=O("./info"),_=S.interopDefault(E),L=O("./subtitle"),I=S.interopDefault(L),b=O("./events"),R=S.interopDefault(b),P=O("./hotkey"),w=S.interopDefault(P),F=O("./layer"),k=S.interopDefault(F),B=O("./loading"),U=S.interopDefault(B),j=O("./notice"),K=S.interopDefault(j),N=O("./mask"),Z=S.interopDefault(N),X=O("./icons"),Y=S.interopDefault(X),ee=O("./setting"),Q=S.interopDefault(ee),G=O("./storage"),q=S.interopDefault(G),te=O("./plugins"),ie=S.interopDefault(te),ne=O("./mobile"),le=S.interopDefault(ne);let se=0;const oe=[];class J extends f.default{constructor(fe,de){super(),this.id=++se;const ve=n.mergeDeep(J.option,fe);this.option=(0,T.default)(ve,o.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new r.default(this),this.template=new i.default(this),this.events=new R.default(this),this.whitelist.state?(this.storage=new q.default(this),this.icons=new Y.default(this),this.i18n=new s.default(this),this.notice=new K.default(this),this.player=new a.default(this),this.layers=new k.default(this),this.controls=new A.default(this),this.contextmenu=new y.default(this),this.subtitle=new I.default(this),this.info=new _.default(this),this.loading=new U.default(this),this.hotkey=new w.default(this),this.mask=new Z.default(this),this.setting=new Q.default(this),this.plugins=new ie.default(this)):this.mobile=new le.default(this),typeof de=="function"&&this.on("ready",()=>de.call(this)),oe.push(this)}static get instances(){return oe}static get version(){return"4.5.2"}static get env(){return"production"}static get build(){return"1655888299105"}static get config(){return c.default}static get utils(){return n}static get scheme(){return o.default}static get Emitter(){return f.default}static get validator(){return T.default}static get kindOf(){return T.default.kindOf}static get html(){return i.default.html}static get option(){return{container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:n.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(fe=!0){this.events.destroy(),this.template.destroy(fe),oe.splice(oe.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(x.default=J,J.NOTICE_TIME=2e3,J.SETTING_WIDTH=250,J.SETTING_ITEM_WIDTH=200,J.SETTING_ITEM_HEIGHT=35,J.INDICATOR_SIZE=14,J.INDICATOR_SIZE_ICON=16,J.INDICATOR_SIZE_MOBILE=18,J.INDICATOR_SIZE_MOBILE_ICON=20,J.VOLUME_PANEL_WIDTH=60,J.VOLUME_HANDLE_WIDTH=12,J.RESIZE_TIME=500,J.SCROLL_TIME=200,J.SCROLL_GAP=50,J.AUTO_PLAYBACK_MAX=10,J.AUTO_PLAYBACK_TIMEOUT=3e3,J.RECONNECT_TIME_MAX=5,J.RECONNECT_SLEEP_TIME=1e3,J.CONTROL_HIDE_TIME=3e3,J.DB_CLICE_TIME=300,J.MOBILE_AUTO_PLAYBACKRATE=3,J.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,J.MOBILE_AUTO_ORIENTATION_TIME=200,J.INFO_LOOP_TIME=1e3,J.FAST_FORWARD_VALUE=3,J.FAST_FORWARD_TIME=1e3,typeof document!="undefined"&&!document.getElementById("artplayer-style")){const ae=document.createElement("style");ae.id="artplayer-style",ae.textContent=m.default,document.head.appendChild(ae)}typeof window!="undefined"&&(window.Artplayer=J),console.log(`%c ArtPlayer %c ${J.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"9EPUe","option-validator":"2A2W5","./utils/emitter":"7pHuB","./utils":"geSvU","./scheme":"3vPoh","./config":"eksZR","./whitelist":"fCKwj","./template":"bqHdK","./i18n":"4O9ZY","./player":"fzROd","./control":"kJ9J9","./contextmenu":"7rh9q","./info":"c896w","./subtitle":"2hqso","./events":"j2hlX","./hotkey":"aTHWZ","./layer":"f2kxw","./loading":"bOs9w","./notice":"ic4th","./mask":"iLfmB","./icons":"5lAmI","./setting":"d5XKP","./storage":"5M8nN","./plugins":"jWfEd","./mobile":"fkUkB","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9EPUe":[function(O,C,x){C.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:none}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-auto-size .art-video-player{transition:all .2s}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player .art-layer-autoPlayback{background-color:#000c;border-radius:3px;align-items:center;padding:10px;line-height:1;display:none;position:absolute;bottom:60px;left:20px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close{cursor:pointer;align-items:center;margin-right:10px;display:flex}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close svg{width:15px;height:15px;fill:#00c9ff}.art-video-player .art-layer-autoPlayback .art-autoPlayback-last{margin-right:10px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-jump{color:#00c9ff;cursor:pointer}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],"2A2W5":[function(O,C,x){C.exports=function(){function S(n){return(S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(n)}var h=Object.prototype.toString,m=function(n){if(n===void 0)return"undefined";if(n===null)return"null";var d=S(n);if(d==="boolean")return"boolean";if(d==="string")return"string";if(d==="number")return"number";if(d==="symbol")return"symbol";if(d==="function")return function(o){return M(o)==="GeneratorFunction"}(n)?"generatorfunction":"function";if(function(o){return Array.isArray?Array.isArray(o):o instanceof Array}(n))return"array";if(function(o){return!(!o.constructor||typeof o.constructor.isBuffer!="function")&&o.constructor.isBuffer(o)}(n))return"buffer";if(function(o){try{if(typeof o.length=="number"&&typeof o.callee=="function")return!0}catch(v){if(v.message.indexOf("callee")!==-1)return!0}return!1}(n))return"arguments";if(function(o){return o instanceof Date||typeof o.toDateString=="function"&&typeof o.getDate=="function"&&typeof o.setDate=="function"}(n))return"date";if(function(o){return o instanceof Error||typeof o.message=="string"&&o.constructor&&typeof o.constructor.stackTraceLimit=="number"}(n))return"error";if(function(o){return o instanceof RegExp||typeof o.flags=="string"&&typeof o.ignoreCase=="boolean"&&typeof o.multiline=="boolean"&&typeof o.global=="boolean"}(n))return"regexp";switch(M(n)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(o){return typeof o.throw=="function"&&typeof o.return=="function"&&typeof o.next=="function"}(n))return"generator";switch(d=h.call(n)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return d.slice(8,-1).toLowerCase().replace(/\s/g,"")};function M(n){return n.constructor?n.constructor.name:null}function T(n,d){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return p(n,d,o),f(n,d,o),function(v,c,u){var r=m(c),t=m(v);if(r==="object"){if(t!=="object")throw new Error("[Type Error]: '".concat(u.join("."),"' require 'object' type, but got '").concat(t,"'"));Object.keys(c).forEach(function(i){var e=v[i],s=c[i],l=u.slice();l.push(i),p(e,s,l),f(e,s,l),T(e,s,l)})}if(r==="array"){if(t!=="array")throw new Error("[Type Error]: '".concat(u.join("."),"' require 'array' type, but got '").concat(t,"'"));v.forEach(function(i,e){var s=v[e],l=c[e]||c[0],a=u.slice();a.push(e),p(s,l,a),f(s,l,a),T(s,l,a)})}}(n,d,o),n}function p(n,d,o){if(m(d)==="string"){var v=m(n);if(d[0]==="?"&&(d=d.slice(1)+"|undefined"),!(-1<d.indexOf("|")?d.split("|").map(function(c){return c.toLowerCase().trim()}).filter(Boolean).some(function(c){return v===c}):d.toLowerCase().trim()===v))throw new Error("[Type Error]: '".concat(o.join("."),"' require '").concat(d,"' type, but got '").concat(v,"'"))}}function f(n,d,o){if(m(d)==="function"){var v=d(n,m(n),o);if(v!==!0){var c=m(v);throw c==="string"?new Error(v):c==="error"?v:new Error("[Validator Error]: The scheme for '".concat(o.join("."),"' validator require return true, but got '").concat(v,"'"))}}}return T.kindOf=m,T}()},{}],"7pHuB":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=class{on(S,h,m){const M=this.e||(this.e={});return(M[S]||(M[S]=[])).push({fn:h,ctx:m}),this}once(S,h,m){const M=this;function T(...p){M.off(S,T),h.apply(m,p)}return T._=h,this.on(S,T,m)}emit(S,...h){const m=((this.e||(this.e={}))[S]||[]).slice();for(let M=0;M<m.length;M+=1)m[M].fn.apply(m[M].ctx,h);return this}off(S,h){const m=this.e||(this.e={}),M=m[S],T=[];if(M&&h)for(let p=0,f=M.length;p<f;p+=1)M[p].fn!==h&&M[p].fn._!==h&&T.push(M[p]);return T.length?m[S]=T:delete m[S],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(O,C,x){x.interopDefault=function(S){return S&&S.__esModule?S:{default:S}},x.defineInteropFlag=function(S){Object.defineProperty(S,"__esModule",{value:!0})},x.exportAll=function(S,h){return Object.keys(S).forEach(function(m){m==="default"||m==="__esModule"||h.hasOwnProperty(m)||Object.defineProperty(h,m,{enumerable:!0,get:function(){return S[m]}})}),h},x.export=function(S,h,m){Object.defineProperty(S,h,{enumerable:!0,get:m})}},{}],geSvU:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./dom");S.exportAll(h,x);var m=O("./error");S.exportAll(m,x);var M=O("./subtitle");S.exportAll(M,x);var T=O("./file");S.exportAll(T,x);var p=O("./property");S.exportAll(p,x);var f=O("./time");S.exportAll(f,x);var n=O("./format");S.exportAll(n,x);var d=O("./compatibility");S.exportAll(d,x)},{"./dom":"ff6Hs","./error":"lDQPM","./subtitle":"1dyFb","./file":"96gQe","./property":"lMM6V","./time":"41yFW","./format":"MRJhs","./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ff6Hs:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"query",()=>m),S.export(x,"queryAll",()=>M),S.export(x,"addClass",()=>T),S.export(x,"removeClass",()=>p),S.export(x,"hasClass",()=>f),S.export(x,"append",()=>n),S.export(x,"remove",()=>d),S.export(x,"setStyle",()=>o),S.export(x,"setStyles",()=>v),S.export(x,"getStyle",()=>c),S.export(x,"sublings",()=>u),S.export(x,"inverseClass",()=>r),S.export(x,"tooltip",()=>t),S.export(x,"isInViewport",()=>i),S.export(x,"includeFromEvent",()=>e),S.export(x,"replaceElement",()=>s);var h=O("./compatibility");function m(l,a=document){return a.querySelector(l)}function M(l,a=document){return Array.from(a.querySelectorAll(l))}function T(l,a){return l.classList.add(a)}function p(l,a){return l.classList.remove(a)}function f(l,a){return l.classList.contains(a)}function n(l,a){return a instanceof Element?l.appendChild(a):l.insertAdjacentHTML("beforeend",String(a)),l.lastElementChild||l.lastChild}function d(l){return l.parentNode.removeChild(l)}function o(l,a,g){return l.style[a]=g,l}function v(l,a){return Object.keys(a).forEach(g=>{o(l,g,a[g])}),l}function c(l,a,g=!0){const A=window.getComputedStyle(l,null).getPropertyValue(a);return g?parseFloat(A):A}function u(l){return Array.from(l.parentElement.children).filter(a=>a!==l)}function r(l,a){u(l).forEach(g=>p(g,a)),T(l,a)}function t(l,a,g="top"){h.isMobile||(l.setAttribute("aria-label",a),T(l,"hint--rounded"),T(l,`hint--${g}`))}function i(l,a=0){const g=l.getBoundingClientRect(),A=window.innerHeight||document.documentElement.clientHeight,D=window.innerWidth||document.documentElement.clientWidth,y=g.top-a<=A&&g.top+g.height+a>=0,E=g.left-a<=D+a&&g.left+g.width+a>=0;return y&&E}function e(l,a){return l.composedPath&&l.composedPath().indexOf(a)>-1}function s(l,a){return a.parentNode.replaceChild(l,a),l}},{"./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ki3pQ:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"userAgent",()=>h),S.export(x,"isMobile",()=>m),S.export(x,"isSafari",()=>M),S.export(x,"isWechat",()=>T),S.export(x,"isIE",()=>p),S.export(x,"isAndroid",()=>f),S.export(x,"isIOS",()=>n);const h=typeof window!="undefined"?window.navigator.userAgent:"",m=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(h),M=/^((?!chrome|android).)*safari/i.test(h),T=/MicroMessenger/i.test(h),p=/MSIE|Trident/i.test(h),f=/android/i.test(h),n=/iPad|iPhone|iPod/i.test(h)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lDQPM:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"ArtPlayerError",()=>h),S.export(x,"errorHandle",()=>m);class h extends Error{constructor(T,p){super(T),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,p||this.constructor),this.name="ArtPlayerError"}}function m(M,T){if(!M)throw new h(T);return M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1dyFb":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(T){return`WEBVTT \r
\r
`.concat((p=T,p.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(f,n,d)=>{let o=d.slice(0,3);return d.length===1&&(o=d+"00"),d.length===2&&(o=d+"0"),`${n},${o}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var p}function m(T){return URL.createObjectURL(new Blob([T],{type:"text/vtt"}))}function M(T){const p=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function f(n=""){return n.split(/[:.]/).map((d,o,v)=>{if(o===v.length-1){if(d.length===1)return`.${d}00`;if(d.length===2)return`.${d}0`}else if(d.length===1)return(o===0?"0":":0")+d;return o===0?d:o===v.length-1?`.${d}`:`:${d}`}).join("")}return`WEBVTT

${T.split(/\r?\n/).map(n=>{const d=n.match(p);return d?{start:f(d[1].trim()),end:f(d[2].trim()),text:d[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(o=>o.trim()).join(`
`)}:null}).filter(n=>n).map((n,d)=>n?`${d+1}
${n.start} --> ${n.end}
${n.text}`:"").filter(n=>n.trim()).join(`

`)}`}S.defineInteropFlag(x),S.export(x,"srtToVtt",()=>h),S.export(x,"vttToBlob",()=>m),S.export(x,"assToVtt",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"96gQe":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(M){return M.includes("?")?h(M.split("?")[0]):M.includes("#")?h(M.split("#")[0]):M.trim().toLowerCase().split(".").pop()}function m(M,T){const p=document.createElement("a");p.style.display="none",p.href=M,p.download=T,document.body.appendChild(p),p.click(),document.body.removeChild(p)}S.defineInteropFlag(x),S.export(x,"getExt",()=>h),S.export(x,"download",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lMM6V:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"def",()=>h),S.export(x,"has",()=>M),S.export(x,"get",()=>T),S.export(x,"mergeDeep",()=>p);const h=Object.defineProperty,{hasOwnProperty:m}=Object.prototype;function M(f,n){return m.call(f,n)}function T(f,n){return Object.getOwnPropertyDescriptor(f,n)}function p(...f){const n=d=>d&&typeof d=="object"&&!Array.isArray(d);return f.reduce((d,o)=>(Object.keys(o).forEach(v=>{const c=d[v],u=o[v];Array.isArray(c)&&Array.isArray(u)?d[v]=c.concat(...u):!n(c)||!n(u)||u instanceof Element?d[v]=u:d[v]=p(c,u)}),d),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"41yFW":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(T=0){return new Promise(p=>setTimeout(p,T))}function m(T,p,f){let n;function d(...o){clearTimeout(n),n=setTimeout(function(){n=null,T.apply(f,o)},p)}return d.clearTimeout=function(){clearTimeout(n)},d}function M(T,p){let f,n,d=!1;return function o(...v){if(d)return f=v,void(n=this);d=!0,T.apply(this,v),setTimeout(()=>{d=!1,f&&(o.apply(n,f),f=null,n=null)},p)}}S.defineInteropFlag(x),S.export(x,"sleep",()=>h),S.export(x,"debounce",()=>m),S.export(x,"throttle",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],MRJhs:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function h(T,p,f){return Math.max(Math.min(T,Math.max(p,f)),Math.min(p,f))}function m(T){const p=Math.floor(T/3600),f=Math.floor((T-3600*p)/60),n=Math.floor(T-3600*p-60*f);return(p>0?[p,f,n]:[f,n]).map(d=>d<10?`0${d}`:String(d)).join(":")}function M(T){return T.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}S.defineInteropFlag(x),S.export(x,"clamp",()=>h),S.export(x,"secondToTime",()=>m),S.export(x,"escape",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3vPoh":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"ComponentOption",()=>o);var h=O("../utils");const m="array",M="boolean",T="string",p="number",f="object",n="function";function d(v,c,u){return(0,h.errorHandle)(c===T||c===p||v instanceof Element,`${u.join(".")} require '${T}' or 'Element' type`)}const o={html:d,disable:`?${M}`,name:`?${T}`,index:`?${p}`,style:`?${f}`,click:`?${n}`,mounted:`?${n}`,tooltip:`?${T}|${p}`,width:`?${p}`,selector:`?${m}`,onSelect:`?${n}`,switch:`?${M}`,onSwitch:`?${n}`,range:`?${m}`,onRange:`?${n}`};x.default={container:d,url:T,poster:T,title:T,type:T,theme:T,lang:T,volume:p,isLive:M,muted:M,autoplay:M,autoSize:M,autoMini:M,loop:M,flip:M,playbackRate:M,aspectRatio:M,screenshot:M,setting:M,hotkey:M,pip:M,mutex:M,backdrop:M,fullscreen:M,fullscreenWeb:M,subtitleOffset:M,miniProgressBar:M,useSSR:M,playsInline:M,lock:M,fastForward:M,autoPlayback:M,autoOrientation:M,plugins:[n],whitelist:[`${T}|${n}|regexp`],layers:[o],contextmenu:[o],settings:[o],controls:[{...o,position:(v,c,u)=>{const r=["top","left","right"];return(0,h.errorHandle)(r.includes(v),`${u.join(".")} only accept ${r.toString()} as parameters`)}}],quality:[{default:`?${M}`,html:T,url:T}],highlight:[{time:p,text:T}],thumbnails:{url:T,number:p,column:p},subtitle:{url:T,type:T,style:f,encoding:T},moreVideoAttr:f,icons:f,customType:f}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eksZR:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fCKwj:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");x.default=class{constructor(h){this.art=h}get state(){const{option:h,constructor:{kindOf:m}}=this.art;return!S.isMobile||h.whitelist.some(M=>{switch(m(M)){case"string":return M==="*"||S.userAgent.indexOf(M)>-1;case"function":return M(S.userAgent);case"regexp":return M.test(S.userAgent);default:return!1}})}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bqHdK:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");class h{constructor(M){this.art=M;const{option:T,constructor:p,whitelist:f}=M;T.container instanceof Element?this.$container=T.container:(this.$container=(0,S.query)(T.container),(0,S.errorHandle)(this.$container,`No container element found by ${T.container}`));const n=this.$container.tagName.toLowerCase();(0,S.errorHandle)(n==="div",`Unsupported container element type, only support 'div' but got '${n}'`),(0,S.errorHandle)(p.instances.every(d=>d.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=M.id,this.$original=this.$container.cloneNode(!0),f.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.5.2</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(M){return(0,S.query)(M,this.$container)}desktop(){const{option:M}=this.art;M.useSSR||(this.$container.innerHTML=h.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),M.backdrop&&((0,S.addClass)(this.$setting,"art-backdrop-filter"),(0,S.addClass)(this.$contextmenu,"art-backdrop-filter"),(0,S.addClass)(this.$info,"art-backdrop-filter")),S.isMobile&&(0,S.addClass)(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(M){M?(0,S.replaceElement)(this.$original,this.$container):(0,S.addClass)(this.$player,"art-destroy")}}x.default=h},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4O9ZY":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../utils"),m=O("./zh-cn.json"),M=S.interopDefault(m),T=O("./zh-tw.json"),p=S.interopDefault(T),f=O("./pl.json"),n=S.interopDefault(f),d=O("./cs.json"),o=S.interopDefault(d);x.default=class{constructor(v){this.art=v,this.languages={"zh-cn":M.default,"zh-tw":p.default,pl:n.default,cs:o.default},this.init()}init(){const v=this.art.option.lang.toLowerCase();this.language=this.languages[v]||{}}get(v){return this.language[v]||v}update(v){this.languages=(0,h.mergeDeep)(this.languages,v),this.init()}}},{"../utils":"geSvU","./zh-cn.json":"e7BQ4","./zh-tw.json":"5kFyN","./pl.json":"3cd1e","./cs.json":"an7cR","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e7BQ4:[function(O,C,x){C.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F6C\u64AD\u653E"}')},{}],"5kFyN":[function(O,C,x){C.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F49\u64AD\u653E"}')},{}],"3cd1e":[function(O,C,x){C.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Last Seen":"Ostatnio widziany","Jump Play":"Skocz do gry"}')},{}],an7cR:[function(O,C,x){C.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Last Seen":"Naposledy vid\u011Bn","Jump Play":"Hra na skok"}')},{}],fzROd:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./urlMix"),m=S.interopDefault(h),M=O("./attrMix"),T=S.interopDefault(M),p=O("./playMix"),f=S.interopDefault(p),n=O("./pauseMix"),d=S.interopDefault(n),o=O("./toggleMix"),v=S.interopDefault(o),c=O("./seekMix"),u=S.interopDefault(c),r=O("./volumeMix"),t=S.interopDefault(r),i=O("./currentTimeMix"),e=S.interopDefault(i),s=O("./durationMix"),l=S.interopDefault(s),a=O("./switchMix"),g=S.interopDefault(a),A=O("./playbackRateMix"),D=S.interopDefault(A),y=O("./aspectRatioMix"),E=S.interopDefault(y),_=O("./screenshotMix"),L=S.interopDefault(_),I=O("./fullscreenMix"),b=S.interopDefault(I),R=O("./fullscreenWebMix"),P=S.interopDefault(R),w=O("./pipMix"),F=S.interopDefault(w),k=O("./loadedMix"),B=S.interopDefault(k),U=O("./playedMix"),j=S.interopDefault(U),K=O("./playingMix"),N=S.interopDefault(K),Z=O("./autoSizeMix"),X=S.interopDefault(Z),Y=O("./rectMix"),ee=S.interopDefault(Y),Q=O("./flipMix"),G=S.interopDefault(Q),q=O("./miniMix"),te=S.interopDefault(q),ie=O("./loopMix"),ne=S.interopDefault(ie),le=O("./posterMix"),se=S.interopDefault(le),oe=O("./autoHeightMix"),J=S.interopDefault(oe),ae=O("./themeMix"),fe=S.interopDefault(ae),de=O("./titleMix"),ve=S.interopDefault(de),ue=O("./normalSizeMix"),_e=S.interopDefault(ue),he=O("./subtitleOffsetMix"),ye=S.interopDefault(he),W=O("./optionInit"),z=S.interopDefault(W),V=O("./eventInit"),$=S.interopDefault(V);x.default=class{constructor(H){(0,m.default)(H),(0,T.default)(H),(0,f.default)(H),(0,d.default)(H),(0,v.default)(H),(0,u.default)(H),(0,t.default)(H),(0,e.default)(H),(0,l.default)(H),(0,g.default)(H),(0,D.default)(H),(0,E.default)(H),(0,L.default)(H),(0,b.default)(H),(0,P.default)(H),(0,F.default)(H),(0,B.default)(H),(0,j.default)(H),(0,N.default)(H),(0,X.default)(H),(0,ee.default)(H),(0,G.default)(H),(0,te.default)(H),(0,ne.default)(H),(0,se.default)(H),(0,J.default)(H),(0,fe.default)(H),(0,ve.default)(H),(0,_e.default)(H),(0,ye.default)(H),(0,$.default)(H),(0,z.default)(H)}}},{"./urlMix":"cChak","./attrMix":"e6Qkm","./playMix":"1FNSV","./pauseMix":"aPHUd","./toggleMix":"joISC","./seekMix":"4wG3e","./volumeMix":"42Xo1","./currentTimeMix":"8Z3pM","./durationMix":"hpnJy","./switchMix":"aCsa8","./playbackRateMix":"61TVa","./aspectRatioMix":"8BV9k","./screenshotMix":"bop8O","./fullscreenMix":"i63VK","./fullscreenWebMix":"bEKHA","./pipMix":"ibIuh","./loadedMix":"kwpxq","./playedMix":"e4Iws","./playingMix":"fueZP","./autoSizeMix":"l6TMg","./rectMix":"6URTt","./flipMix":"joth7","./miniMix":"durkk","./loopMix":"5EZwI","./posterMix":"22WMt","./autoHeightMix":"8pdNr","./themeMix":"eADqm","./titleMix":"8T9U6","./normalSizeMix":"iEQHG","./subtitleOffsetMix":"8CMLG","./optionInit":"aqLU7","./eventInit":"59ETf","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],cChak:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{option:m,template:{$video:M}}=h;(0,S.def)(h,"url",{get:()=>M.currentSrc,async set(T){const p=m.type||(0,S.getExt)(T),f=m.customType[p];p&&f?(await(0,S.sleep)(),h.loading.show=!0,f.call(h,M,T,h)):(h.url&&h.url!==T&&h.once("video:canplay",()=>{h.isReady&&h.emit("restart")}),M.src=T,h.option.url=T,h.emit("url",T))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e6Qkm:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{template:{$video:m}}=h;(0,S.def)(h,"attr",{value(M,T){if(T===void 0)return m[M];m[M]=T}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1FNSV":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,notice:M,option:T,constructor:{instances:p},template:{$video:f}}=h;(0,S.def)(h,"play",{value(){const n=f.play();if(n&&n.then&&n.then().catch(d=>{throw M.show=d,d}),T.mutex)for(let d=0;d<p.length;d++){const o=p[d];o!==h&&o.pause()}return M.show=m.get("Play"),h.emit("play"),n}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPHUd:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{template:{$video:m},i18n:M,notice:T}=h;(0,S.def)(h,"pause",{value(){const p=m.pause();return T.show=M.get("Pause"),h.emit("pause"),p}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joISC:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){(0,S.def)(h,"toggle",{value:()=>h.playing?h.pause():h.play()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4wG3e":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{notice:m}=h;(0,S.def)(h,"seek",{set(M){h.currentTime=M,h.emit("seek",h.currentTime),h.duration&&(m.show=`${(0,S.secondToTime)(h.currentTime)} / ${(0,S.secondToTime)(h.duration)}`)}}),(0,S.def)(h,"forward",{set(M){h.seek=h.currentTime+M}}),(0,S.def)(h,"backward",{set(M){h.seek=h.currentTime-M}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"42Xo1":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{template:{$video:m},i18n:M,notice:T,storage:p}=h;(0,S.def)(h,"volume",{get:()=>m.volume||0,set:f=>{m.volume=(0,S.clamp)(f,0,1),T.show=`${M.get("Volume")}: ${parseInt(100*m.volume,10)}`,m.volume!==0&&p.set("volume",m.volume),h.emit("volume",m.volume)}}),(0,S.def)(h,"muted",{get:()=>m.muted,set:f=>{m.muted=f,h.emit("volume",m.volume)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8Z3pM":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{$video:m}=h.template;(0,S.def)(h,"currentTime",{get:()=>m.currentTime||0,set:M=>{M=parseFloat(M),Number.isNaN(M)||(m.currentTime=(0,S.clamp)(M,0,h.duration))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],hpnJy:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){(0,S.def)(h,"duration",{get:()=>{const{duration:m}=h.template.$video;return m===1/0?0:m||0}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aCsa8:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,option:M,notice:T}=h;function p(f,n,d){return new Promise(o=>{if(f===h.url)return o(f);const{playing:v}=h;h.pause(),URL.revokeObjectURL(h.url),h.url=f,h.once("video:canplay",()=>{h.playbackRate=!1,h.aspectRatio=!1,h.flip="normal",h.autoSize=M.autoSize,h.currentTime=d,h.notice.show="",v&&h.play(),n&&(T.show=`${m.get("Switch Video")}: ${n}`),h.emit("switch",f),o(f)})})}(0,S.def)(h,"switchQuality",{value:(f,n)=>p(f,n,h.currentTime)}),(0,S.def)(h,"switchUrl",{value:(f,n)=>p(f,n,0)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"61TVa":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{template:{$video:m},i18n:M,notice:T}=h;(0,S.def)(h,"playbackRate",{get:()=>m.playbackRate,set(p){if(p){if(p===m.playbackRate)return;const f=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];(0,S.errorHandle)(f.includes(p),`'playbackRate' only accept ${f.toString()} as parameters`),m.playbackRate=p,T.show=`${M.get("Rate")}: ${p===1?M.get("Normal"):`${p}x`}`,h.emit("playbackRate",p)}else h.playbackRate=1,h.emit("playbackRate")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8BV9k":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{template:{$video:m,$player:M},i18n:T,notice:p}=h;(0,S.def)(h,"aspectRatio",{get:()=>M.dataset.aspectRatio||"default",set(f){f||(f="default");const n=["default","4:3","16:9"];if((0,S.errorHandle)(n.includes(f),`'aspectRatio' only accept ${n.toString()} as parameters`),f==="default")(0,S.setStyle)(m,"width",null),(0,S.setStyle)(m,"height",null),(0,S.setStyle)(m,"padding",null),delete M.dataset.aspectRatio;else{const d=f.split(":").map(Number),{videoWidth:o,videoHeight:v}=m,{clientWidth:c,clientHeight:u}=M,r=o/v,t=d[0]/d[1];if(r>t){const i=t*v/o;(0,S.setStyle)(m,"width",100*i+"%"),(0,S.setStyle)(m,"height","100%"),(0,S.setStyle)(m,"padding",`0 ${(c-c*i)/2}px`)}else{const i=o/t/v;(0,S.setStyle)(m,"width","100%"),(0,S.setStyle)(m,"height",100*i+"%"),(0,S.setStyle)(m,"padding",(u-u*i)/2+"px 0")}M.dataset.aspectRatio=f}p.show=`${T.get("Aspect Ratio")}: ${f==="default"?T.get("Default"):f}`,h.emit("aspectRatio",f)}}),(0,S.def)(h,"aspectRatioReset",{set(f){if(f){const{aspectRatio:n}=h;h.aspectRatio=n}}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bop8O:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{option:m,notice:M,template:{$video:T}}=h,p=document.createElement("canvas");(0,S.def)(h,"getDataURL",{value:()=>new Promise((f,n)=>{try{p.width=T.videoWidth,p.height=T.videoHeight,p.getContext("2d").drawImage(T,0,0),f(p.toDataURL("image/png"))}catch(d){M.show=d,n(d)}})}),(0,S.def)(h,"getBlobUrl",{value:()=>new Promise((f,n)=>{try{p.width=T.videoWidth,p.height=T.videoHeight,p.getContext("2d").drawImage(T,0,0),p.toBlob(d=>{f(URL.createObjectURL(d))})}catch(d){M.show=d,n(d)}})}),(0,S.def)(h,"screenshot",{value:async()=>{const f=await h.getDataURL();return(0,S.download)(f,`${m.title||"artplayer"}_${(0,S.secondToTime)(T.currentTime)}.png`),h.emit("screenshot",f),f}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i63VK:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../libs/screenfull"),m=S.interopDefault(h),M=O("../utils");x.default=function(T){const{i18n:p,notice:f,template:{$video:n,$player:d}}=T,o=(0,m.default)();T.once("video:loadedmetadata",()=>{var v;o.isEnabled?(v=T,o.on("change",()=>v.emit("fullscreen",o.isFullscreen)),(0,M.def)(v,"fullscreen",{get:()=>o.isFullscreen,async set(c){c?(v.normalSize="fullscreen",v.aspectRatioReset=!0,v.autoSize=!1,await o.request(d),(0,M.addClass)(d,"art-fullscreen"),v.emit("resize"),v.emit("fullscreen",!0),f.show=""):(v.aspectRatioReset=!0,v.autoSize=v.option.autoSize,await o.exit(),(0,M.removeClass)(d,"art-fullscreen"),v.emit("resize"),v.emit("fullscreen"),f.show="")}})):document.fullscreenEnabled||n.webkitSupportsFullscreen?(c=>{(0,M.def)(c,"fullscreen",{get:()=>n.webkitDisplayingFullscreen,set(u){u?(c.normalSize="fullscreen",n.webkitEnterFullscreen(),c.emit("fullscreen",!0),f.show=""):(n.webkitExitFullscreen(),c.emit("fullscreen"),f.show="")}})})(T):(0,M.def)(T,"fullscreen",{get:()=>!1,set(){f.show=p.get("Fullscreen Not Supported")}}),(0,M.def)(T,"fullscreen",(0,M.get)(T,"fullscreen"))})}},{"../libs/screenfull":"aPwar","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPwar:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(){const S=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],h=(()=>{const T=S[0],p={};for(const f of S)if(f[1]in document){for(const[n,d]of f.entries())p[T[n]]=d;return p}return!1})(),m={change:h.fullscreenchange,error:h.fullscreenerror};let M={request:(T=document.documentElement,p)=>new Promise((f,n)=>{const d=()=>{M.off("change",d),f()};M.on("change",d);const o=T[h.requestFullscreen](p);o instanceof Promise&&o.then(d).catch(n)}),exit:()=>new Promise((T,p)=>{if(!M.isFullscreen)return void T();const f=()=>{M.off("change",f),T()};M.on("change",f);const n=document[h.exitFullscreen]();n instanceof Promise&&n.then(f).catch(p)}),toggle:(T,p)=>M.isFullscreen?M.exit():M.request(T,p),onchange(T){M.on("change",T)},onerror(T){M.on("error",T)},on(T,p){const f=m[T];f&&document.addEventListener(f,p,!1)},off(T,p){const f=m[T];f&&document.removeEventListener(f,p,!1)},raw:h};return Object.defineProperties(M,{isFullscreen:{get:()=>Boolean(document[h.fullscreenElement])},element:{enumerable:!0,get:()=>document[h.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[h.fullscreenEnabled])}}),h||(M={isEnabled:!1}),M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bEKHA:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{notice:m,template:{$player:M}}=h;(0,S.def)(h,"fullscreenWeb",{get:()=>(0,S.hasClass)(M,"art-fullscreen-web"),set(T){T?(h.normalSize="fullscreenWeb",(0,S.addClass)(M,"art-fullscreen-web"),h.aspectRatioReset=!0,h.autoSize=!1,h.emit("resize"),h.emit("fullscreenWeb",!0),m.show=""):((0,S.removeClass)(M,"art-fullscreen-web"),h.aspectRatioReset=!0,h.autoSize=h.option.autoSize,h.emit("resize"),h.emit("fullscreenWeb"),m.show="")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ibIuh:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,notice:M,template:{$video:T}}=h;document.pictureInPictureEnabled?function(p){const{template:{$video:f},events:{proxy:n},notice:d}=p;f.disablePictureInPicture=!1,(0,S.def)(p,"pip",{get:()=>document.pictureInPictureElement,set(o){o?(p.normalSize="pip",f.requestPictureInPicture().catch(v=>{throw d.show=v,v})):document.exitPictureInPicture().catch(v=>{throw d.show=v,v})}}),n(f,"enterpictureinpicture",()=>{p.emit("pip",!0)}),n(f,"leavepictureinpicture",()=>{p.emit("pip")})}(h):T.webkitSupportsPresentationMode?function(p){const{$video:f}=p.template;f.webkitSetPresentationMode("inline"),(0,S.def)(p,"pip",{get:()=>f.webkitPresentationMode==="picture-in-picture",set(n){n?(p.normalSize="pip",f.webkitSetPresentationMode("picture-in-picture"),p.emit("pip",!0)):(f.webkitSetPresentationMode("inline"),p.emit("pip"))}})}(h):(0,S.def)(h,"pip",{get:()=>!1,set(){M.show=m.get("PIP Not Supported")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kwpxq:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{$video:m}=h.template;(0,S.def)(h,"loaded",{get:()=>h.loadedTime/m.duration}),(0,S.def)(h,"loadedTime",{get:()=>m.buffered.length?m.buffered.end(m.buffered.length-1):0})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e4Iws:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){(0,S.def)(h,"played",{get:()=>h.currentTime/h.duration})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fueZP:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{$video:m}=h.template;(0,S.def)(h,"playing",{get:()=>m.currentTime>0&&!m.paused&&!m.ended&&m.readyState>2})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],l6TMg:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{$container:m,$player:M,$video:T}=h.template;(0,S.def)(h,"autoSize",{get:()=>(0,S.hasClass)(m,"art-auto-size"),set(p){if(p){const{videoWidth:f,videoHeight:n}=T,{width:d,height:o}=m.getBoundingClientRect(),v=f/n,c=d/o;if((0,S.addClass)(m,"art-auto-size"),c>v){const u=o*v/d*100;(0,S.setStyle)(M,"width",`${u}%`),(0,S.setStyle)(M,"height","100%")}else{const u=d/v/o*100;(0,S.setStyle)(M,"width","100%"),(0,S.setStyle)(M,"height",`${u}%`)}h.emit("autoSize",{width:h.width,height:h.height})}else(0,S.removeClass)(m,"art-auto-size"),(0,S.setStyle)(M,"width",null),(0,S.setStyle)(M,"height",null),h.emit("autoSize")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"6URTt":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){(0,S.def)(h,"rect",{get:()=>h.template.$player.getBoundingClientRect()});const m=["bottom","height","left","right","top","width"];for(let M=0;M<m.length;M++){const T=m[M];(0,S.def)(h,T,{get:()=>h.rect[T]})}(0,S.def)(h,"x",{get:()=>h.left+window.pageXOffset}),(0,S.def)(h,"y",{get:()=>h.top+window.pageYOffset})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joth7:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{template:{$player:m},i18n:M,notice:T}=h;(0,S.def)(h,"flip",{get:()=>m.dataset.flip||"normal",set(p){p||(p="normal");const f=["normal","horizontal","vertical"];(0,S.errorHandle)(f.includes(p),`'flip' only accept ${f.toString()} as parameters`),p==="normal"?delete m.dataset.flip:m.dataset.flip=p;const n=p.replace(p[0],p[0].toUpperCase());T.show=`${M.get("Video Flip")}: ${M.get(n)}`,h.emit("flip",p)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],durkk:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,option:M,storage:T,events:{proxy:p},template:{$player:f,$miniClose:n,$miniTitle:d,$miniHeader:o}}=h;let v=!1,c=0,u=0,r=0,t=0;p(o,"mousedown",i=>{v=!0,c=i.pageX,u=i.pageY,r=h.left,t=h.top}),p(document,"mousemove",i=>{if(v){(0,S.addClass)(f,"art-is-dragging");const e=t+i.pageY-u,s=r+i.pageX-c;(0,S.setStyle)(f,"top",`${e}px`),(0,S.setStyle)(f,"left",`${s}px`),T.set("top",e),T.set("left",s)}}),p(document,"mouseup",()=>{v=!1,(0,S.removeClass)(f,"art-is-dragging")}),p(n,"click",()=>{h.mini=!1,v=!1,(0,S.removeClass)(f,"art-is-dragging")}),(0,S.append)(d,M.title||m.get("Mini Player")),(0,S.def)(h,"mini",{get:()=>(0,S.hasClass)(f,"art-mini"),set(i){if(i){h.normalSize="mini",h.autoSize=!1,(0,S.addClass)(f,"art-mini");const e=T.get("top"),s=T.get("left");if(e&&s)(0,S.setStyle)(f,"top",`${e}px`),(0,S.setStyle)(f,"left",`${s}px`),(0,S.isInViewport)(o)||(T.del("top"),T.del("left"),h.mini=!0);else{const l=window.innerHeight-h.height-50,a=window.innerWidth-h.width-50;T.set("top",l),T.set("left",a),(0,S.setStyle)(f,"top",`${l}px`),(0,S.setStyle)(f,"left",`${a}px`)}h.aspectRatio=!1,h.playbackRate=!1,h.notice.show="",h.emit("mini",!0)}else(0,S.removeClass)(f,"art-mini"),(0,S.setStyle)(f,"top",null),(0,S.setStyle)(f,"left",null),h.aspectRatio=!1,h.playbackRate=!1,h.autoSize=M.autoSize,h.notice.show="",h.emit("mini")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5EZwI":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){let m=[];(0,S.def)(h,"loop",{get:()=>m,set:M=>{if(Array.isArray(M)&&typeof M[0]=="number"&&typeof M[1]=="number"){const T=(0,S.clamp)(M[0],0,Math.min(M[1],h.duration)),p=(0,S.clamp)(M[1],T,h.duration);p-T>=1?(m=[T,p],h.emit("loop",m)):(m=[],h.emit("loop"))}else m=[],h.emit("loop")}}),h.on("video:timeupdate",()=>{m.length&&(h.currentTime<m[0]||h.currentTime>m[1])&&(h.seek=m[0])})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"22WMt":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{option:m,template:{$poster:M}}=h;(0,S.def)(h,"poster",{get:()=>m.poster,set(T){m.poster=T,(0,S.setStyle)(M,"backgroundImage",`url(${T})`)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8pdNr":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{option:m,template:{$container:M,$video:T}}=h,p=M.style.height;(0,S.def)(h,"autoHeight",{get:()=>(0,S.hasClass)(M,"art-auto-height"),set(f){if(f){const{clientWidth:n}=M,{videoHeight:d,videoWidth:o}=T,v=d*(n/o);(0,S.setStyle)(M,"height",v+"px"),(0,S.addClass)(M,"art-auto-height"),h.autoSize=m.autoSize,h.emit("autoHeight",v)}else(0,S.setStyle)(M,"height",p),(0,S.removeClass)(M,"art-auto-height"),h.autoSize=m.autoSize,h.emit("autoHeight")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eADqm:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{option:m,template:{$player:M}}=h;(0,S.def)(h,"theme",{get:()=>getComputedStyle(M).getPropertyValue("--theme"),set(T){m.theme=T,M.style.setProperty("--theme",T)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8T9U6":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){(0,S.def)(h,"title",{get:()=>h.option.title,set(m){h.option.title=m}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iEQHG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const m=["mini","pip","fullscreen","fullscreenWeb"];(0,S.def)(h,"normalSize",{get:()=>m.every(M=>!h[M]),set(M){m.filter(T=>T!==M).forEach(T=>{h[T]&&(h[T]=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8CMLG":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{clamp:m}=h.constructor.utils,{notice:M,template:T,i18n:p}=h;let f=0,n=[];h.on("subtitle:switch",()=>{n=[]}),(0,S.def)(h,"subtitleOffset",{get:()=>f,set(d){if(T.$track&&T.$track.track){const o=Array.from(T.$track.track.cues);f=m(d,-5,5);for(let v=0;v<o.length;v++){const c=o[v];n[v]||(n[v]={startTime:c.startTime,endTime:c.endTime}),c.startTime=m(n[v].startTime+f,0,h.duration),c.endTime=m(n[v].endTime+f,0,h.duration)}h.subtitle.update(),M.show=`${p.get("Subtitle Offset")}: ${d}s`,h.emit("subtitleOffset",d)}else h.emit("subtitleOffset",0)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aqLU7:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{option:m,storage:M,template:{$video:T,$poster:p}}=h;Object.keys(m.moreVideoAttr).forEach(n=>{h.attr(n,m.moreVideoAttr[n])}),m.muted&&(h.muted=m.muted),m.volume&&(T.volume=(0,S.clamp)(m.volume,0,1));const f=M.get("volume");typeof f=="number"&&(T.volume=(0,S.clamp)(f,0,1)),m.poster&&(0,S.setStyle)(p,"backgroundImage",`url(${m.poster})`),m.autoplay&&(T.autoplay=m.autoplay),m.playsInline&&(T.playsInline=!0,T["webkit-playsinline"]=!0),m.theme&&(h.theme=m.theme),h.url=m.url}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"59ETf":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../config"),m=S.interopDefault(h),M=O("../utils");x.default=function(T){const{i18n:p,notice:f,option:n,constructor:d,events:{proxy:o},template:{$player:v,$video:c,$poster:u}}=T;let r=0;for(let t=0;t<m.default.events.length;t++)o(c,m.default.events[t],i=>{T.emit(`video:${i.type}`,i)});T.on("video:canplay",()=>{r=0,T.loading.show=!1}),T.once("video:canplay",()=>{T.loading.show=!1,T.controls.show=!0,T.mask.show=!0,T.isReady=!0,T.emit("ready")}),T.on("video:ended",()=>{n.loop?(T.seek=0,T.play(),T.controls.show=!1,T.mask.show=!1):(T.controls.show=!0,T.mask.show=!0)}),T.on("video:error",async()=>{r<d.RECONNECT_TIME_MAX?(await(0,M.sleep)(d.RECONNECT_SLEEP_TIME),r+=1,T.url=n.url,f.show=`${p.get("Reconnect")}: ${r}`,T.emit("error",r)):(T.mask.show=!0,T.loading.show=!1,T.controls.show=!0,(0,M.addClass)(v,"art-error"),await(0,M.sleep)(d.RECONNECT_SLEEP_TIME),f.show=p.get("Video Load Failed"),T.destroy(!1))}),T.on("video:loadedmetadata",()=>{T.autoSize=n.autoSize,M.isMobile&&(T.loading.show=!1,T.controls.show=!0,T.mask.show=!0)}),T.on("video:loadstart",()=>{T.loading.show=!0,T.mask.show=!1,T.controls.show=!0}),T.on("video:pause",()=>{T.controls.show=!0,T.mask.show=!0}),T.on("video:play",()=>{T.mask.show=!1,(0,M.setStyle)(u,"display","none")}),T.on("video:playing",()=>{T.mask.show=!1}),T.on("video:seeked",()=>{T.loading.show=!1}),T.on("video:seeking",()=>{T.loading.show=!0,T.mask.show=!1}),T.on("video:timeupdate",()=>{T.mask.show=!1}),T.on("video:waiting",()=>{T.loading.show=!0,T.mask.show=!1})}},{"../config":"eksZR","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kJ9J9:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../utils"),m=O("../utils/component"),M=S.interopDefault(m),T=O("./fullscreen"),p=S.interopDefault(T),f=O("./fullscreenWeb"),n=S.interopDefault(f),d=O("./pip"),o=S.interopDefault(d),v=O("./playAndPause"),c=S.interopDefault(v),u=O("./progress"),r=S.interopDefault(u),t=O("./time"),i=S.interopDefault(t),e=O("./volume"),s=S.interopDefault(e),l=O("./setting"),a=S.interopDefault(l),g=O("./thumbnails"),A=S.interopDefault(g),D=O("./screenshot"),y=S.interopDefault(D),E=O("./quality"),_=S.interopDefault(E),L=O("./loop"),I=S.interopDefault(L);class b extends M.default{constructor(P){super(P),this.name="control";const{constructor:w,events:{proxy:F},template:{$player:k}}=P;let B=Date.now();F(k,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,(0,h.removeClass)(k,"art-hide-cursor"),(0,h.addClass)(k,"art-hover"),B=Date.now()}),P.on("video:timeupdate",()=>{!P.isInput&&P.playing&&this.show&&Date.now()-B>=w.CONTROL_HIDE_TIME&&(this.show=!1,(0,h.addClass)(k,"art-hide-cursor"),(0,h.removeClass)(k,"art-hover"))}),this.init()}init(){const{option:P}=this.art;this.add((0,r.default)({name:"progress",disable:P.isLive,position:"top",index:10})),this.add((0,A.default)({name:"thumbnails",disable:!P.thumbnails.url||P.isLive||h.isMobile,position:"top",index:20})),this.add((0,I.default)({name:"loop",disable:!1,position:"top",index:30})),this.add((0,c.default)({name:"playAndPause",disable:!1,position:"left",index:10})),this.add((0,s.default)({name:"volume",disable:!1,position:"left",index:20})),this.add((0,i.default)({name:"time",disable:P.isLive,position:"left",index:30})),this.add((0,_.default)({name:"quality",disable:P.quality.length===0,position:"right",index:10})),this.add((0,y.default)({name:"screenshot",disable:!P.screenshot||h.isMobile,position:"right",index:20})),this.add((0,a.default)({name:"setting",disable:!P.setting,position:"right",index:30})),this.add((0,o.default)({name:"pip",disable:!P.pip,position:"right",index:40})),this.add((0,n.default)({name:"fullscreenWeb",disable:!P.fullscreenWeb,position:"right",index:50})),this.add((0,p.default)({name:"fullscreen",disable:!P.fullscreen,position:"right",index:60}));for(let w=0;w<P.controls.length;w++)this.add(P.controls[w])}add(P){const w=typeof P=="function"?P(this.art):P,{$progress:F,$controlsLeft:k,$controlsRight:B}=this.art.template;switch(w.position){case"top":this.$parent=F;break;case"left":this.$parent=k;break;case"right":this.$parent=B;break;default:(0,h.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(w)}}x.default=b},{"../utils":"geSvU","../utils/component":"kPHYl","./fullscreen":"awkUw","./fullscreenWeb":"3qoPe","./pip":"lFHYL","./playAndPause":"b8vU1","./progress":"dRwzT","./time":"ltYI1","./volume":"8O7mM","./setting":"lX5UX","./thumbnails":"lUoGG","./screenshot":"jvdQ0","./quality":"k9pKK","./loop":"aE690","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kPHYl:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./dom"),m=O("option-validator"),M=S.interopDefault(m),T=O("../scheme"),p=O("./property"),f=O("./error");x.default=class{constructor(n){this.id=0,this.art=n,this.add=this.add.bind(this)}get show(){return(0,h.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(n){const{$player:d}=this.art.template,o=`art-${this.name}-show`;n?(0,h.addClass)(d,o):(0,h.removeClass)(d,o),this.art.emit(this.name,n)}set toggle(n){n&&(this.show=!this.show)}add(n){const d=typeof n=="function"?n(this.art):n;if(d.html=d.html||"",(0,M.default)(d,T.ComponentOption),!this.$parent||!this.name||d.disable)return;const o=d.name||`${this.name}${this.id}`;(0,f.errorHandle)(!(0,p.has)(this,o),`Cannot add an existing name [${o}] to the [${this.name}]`),this.id+=1;const v=document.createElement("div");(0,h.addClass)(v,`art-${this.name}`),(0,h.addClass)(v,`art-${this.name}-${o}`);const c=Array.from(this.$parent.children);v.dataset.index=d.index||this.id;const u=c.find(r=>Number(r.dataset.index)>=Number(v.dataset.index));return u?u.insertAdjacentElement("beforebegin",v):(0,h.append)(this.$parent,v),d.html&&(0,h.append)(v,d.html),d.style&&(0,h.setStyles)(v,d.style),d.tooltip&&(0,h.tooltip)(v,d.tooltip),d.click&&this.art.events.proxy(v,"click",r=>{r.preventDefault(),d.click.call(this.art,this,r)}),d.selector&&["left","right"].includes(d.position)&&this.selector(d,v),d.mounted&&d.mounted.call(this.art,v),v.childNodes.length===1&&v.childNodes[0].nodeType===3&&(0,h.addClass)(v,"art-control-onlyText"),(0,p.def)(this,o,{value:v}),v}selector(n,d){const{hover:o,proxy:v}=this.art.events;(0,h.addClass)(d,"art-control-selector");const c=document.createElement("div");(0,h.addClass)(c,"art-selector-value"),(0,h.append)(c,n.html),d.innerText="",(0,h.append)(d,c);const u=n.selector.map((i,e)=>`<div class="art-selector-item ${i.default?"art-current":""}" data-index="${e}">${i.html}</div>`).join(""),r=document.createElement("div");(0,h.addClass)(r,"art-selector-list"),(0,h.append)(r,u),(0,h.append)(d,r);const t=()=>{const i=(0,h.getStyle)(d,"width")/2-(0,h.getStyle)(r,"width")/2;r.style.left=`${i}px`};o(d,t),v(r,"click",async i=>{const e=(i.composedPath()||[]).find(a=>(0,h.hasClass)(a,"art-selector-item"));if(!e)return;(0,h.inverseClass)(e,"art-current");const s=Number(e.dataset.index),l=n.selector[s]||{};if(c.innerText=e.innerText,n.onSelect){const a=await n.onSelect.call(this.art,l,e,i);typeof a!="string"&&typeof a!="number"||(c.innerHTML=a)}t(),this.art.emit("selector",l,e)})}}},{"./dom":"ff6Hs","option-validator":"2A2W5","../scheme":"3vPoh","./property":"lMM6V","./error":"lDQPM","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],awkUw:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Fullscreen"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:f}=m,n=(0,S.append)(M,p.fullscreenOn),d=(0,S.append)(M,p.fullscreenOff);(0,S.setStyle)(d,"display","none"),T(M,"click",()=>{m.fullscreen=!m.fullscreen}),m.on("fullscreen",o=>{o?((0,S.tooltip)(M,f.get("Exit Fullscreen")),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","inline-flex")):((0,S.tooltip)(M,f.get("Fullscreen")),(0,S.setStyle)(n,"display","inline-flex"),(0,S.setStyle)(d,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3qoPe":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Web Fullscreen"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:f}=m,n=(0,S.append)(M,p.fullscreenWebOn),d=(0,S.append)(M,p.fullscreenWebOff);(0,S.setStyle)(d,"display","none"),T(M,"click",()=>{m.fullscreenWeb=!m.fullscreenWeb}),m.on("fullscreenWeb",o=>{o?((0,S.tooltip)(M,f.get("Exit Web Fullscreen")),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","inline-flex")):((0,S.tooltip)(M,f.get("Web Fullscreen")),(0,S.setStyle)(n,"display","inline-flex"),(0,S.setStyle)(d,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lFHYL:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("PIP Mode"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:f}=m;(0,S.append)(M,p.pip),T(M,"click",()=>{m.pip=!m.pip}),m.on("pip",n=>{(0,S.tooltip)(M,f.get(n?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],b8vU1:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,mounted:M=>{const{events:{proxy:T},icons:p,i18n:f}=m,n=(0,S.append)(M,p.play),d=(0,S.append)(M,p.pause);function o(){(0,S.setStyle)(n,"display","flex"),(0,S.setStyle)(d,"display","none")}function v(){(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","flex")}(0,S.tooltip)(n,f.get("Play")),(0,S.tooltip)(d,f.get("Pause")),T(n,"click",()=>{m.play()}),T(d,"click",()=>{m.pause()}),m.playing?v():o(),m.on("video:playing",()=>{v()}),m.on("video:pause",()=>{o()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],dRwzT:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"getPosFromEvent",()=>m);var h=O("../utils");function m(M,T){const{$progress:p}=M.template,{left:f}=p.getBoundingClientRect(),n=T.pageX,d=(0,h.clamp)(n-f,0,p.clientWidth),o=d/p.clientWidth*M.duration;return{second:o,time:(0,h.secondToTime)(o),width:d,percentage:(0,h.clamp)(d/p.clientWidth,0,1)}}x.default=function(M){return T=>{const{icons:p,option:f,events:{proxy:n}}=T;return{...M,html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:d=>{let o=!1;const v=(0,h.query)(".art-progress-loaded",d),c=(0,h.query)(".art-progress-played",d),u=(0,h.query)(".art-progress-highlight",d),r=(0,h.query)(".art-progress-indicator",d),t=(0,h.query)(".art-progress-tip",d);(0,h.setStyle)(c,"backgroundColor","var(--theme)");let i=T.constructor.INDICATOR_SIZE;function e(s,l){s==="loaded"&&(0,h.setStyle)(v,"width",100*l+"%"),s==="played"&&((0,h.setStyle)(c,"width",100*l+"%"),(0,h.setStyle)(r,"left",`calc(${100*l}% - ${i/2}px)`))}p.indicator?(i=T.constructor.INDICATOR_SIZE_ICON,(0,h.append)(r,p.indicator)):(0,h.setStyles)(r,{backgroundColor:"var(--theme)"}),h.isMobile&&(i=T.constructor.INDICATOR_SIZE_MOBILE,p.indicator&&(i=T.constructor.INDICATOR_SIZE_MOBILE_ICON)),(0,h.setStyles)(r,{left:`-${i/2}px`,width:`${i}px`,height:`${i}px`}),T.on("video:loadedmetadata",()=>{for(let s=0;s<f.highlight.length;s++){const l=f.highlight[s],a=(0,h.clamp)(l.time,0,T.duration)/T.duration*100;(0,h.append)(u,`<span data-text="${l.text}" data-time="${l.time}" style="left: ${a}%"></span>`)}}),e("loaded",T.loaded),T.on("setBar",(s,l)=>{e(s,l)}),T.on("video:progress",()=>{e("loaded",T.loaded)}),T.on("video:timeupdate",()=>{e("played",T.played)}),T.on("video:ended",()=>{e("played",1)}),h.isMobile||(n(d,"click",s=>{if(s.target!==r){const{second:l,percentage:a}=m(T,s);e("played",a),T.seek=l}}),n(d,"mousemove",s=>{(0,h.setStyle)(t,"display","block"),(0,h.includeFromEvent)(s,u)?function(l){const{width:a}=m(T,l),{text:g}=l.target.dataset;t.innerHTML=g;const A=t.clientWidth;a<=A/2?(0,h.setStyle)(t,"left",0):a>d.clientWidth-A/2?(0,h.setStyle)(t,"left",d.clientWidth-A+"px"):(0,h.setStyle)(t,"left",a-A/2+"px")}(s):function(l){const{width:a,time:g}=m(T,l);t.innerHTML=g;const A=t.clientWidth;a<=A/2?(0,h.setStyle)(t,"left",0):a>d.clientWidth-A/2?(0,h.setStyle)(t,"left",d.clientWidth-A+"px"):(0,h.setStyle)(t,"left",a-A/2+"px")}(s)}),n(d,"mouseout",()=>{(0,h.setStyle)(t,"display","none")}),n(r,"mousedown",()=>{o=!0}),n(document,"mousemove",s=>{if(o){const{second:l,percentage:a}=m(T,s);e("played",a),T.seek=l}}),n(document,"mouseup",()=>{o&&(o=!1)}))}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ltYI1:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,style:{cursor:"auto"},mounted:M=>{function T(){const f=`${(0,S.secondToTime)(m.currentTime)} / ${(0,S.secondToTime)(m.duration)}`;f!==M.innerText&&(M.innerText=f)}T();const p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let f=0;f<p.length;f++)m.on(p[f],T)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8O7mM":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,mounted:M=>{const{events:{proxy:T},icons:p,i18n:f}=m;let n=!1;const d=m.constructor.VOLUME_PANEL_WIDTH,o=m.constructor.VOLUME_HANDLE_WIDTH,v=(0,S.append)(M,p.volume),c=(0,S.append)(M,p.volumeClose),u=(0,S.append)(M,'<div class="art-volume-panel"></div>'),r=(0,S.append)(u,'<div class="art-volume-slider-handle"></div>');function t(e){const{left:s}=u.getBoundingClientRect();return(0,S.clamp)(e.pageX-s-o/2,0,d-o/2)/(d-o)}function i(e=.7){if(m.muted||e===0)(0,S.setStyle)(v,"display","none"),(0,S.setStyle)(c,"display","flex"),(0,S.setStyle)(r,"left","0");else{const s=(d-o)*e;(0,S.setStyle)(v,"display","flex"),(0,S.setStyle)(c,"display","none"),(0,S.setStyle)(r,"left",`${s}px`)}}(0,S.tooltip)(v,f.get("Mute")),(0,S.setStyle)(c,"display","none"),S.isMobile&&(0,S.setStyle)(u,"display","none"),i(m.volume),m.on("video:volumechange",()=>{i(m.volume)}),T(v,"click",()=>{m.muted=!0}),T(c,"click",()=>{m.muted=!1}),T(u,"click",e=>{m.muted=!1,m.volume=t(e)}),T(r,"mousedown",()=>{n=!0}),T(M,"mousemove",e=>{n&&(m.muted=!1,m.volume=t(e))}),T(document,"mouseup",()=>{n&&(n=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lX5UX:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Show Setting"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:f}=m;(0,S.append)(M,p.setting),T(M,"click",()=>{m.setting.toggle=!0}),m.on("setting",n=>{(0,S.tooltip)(M,f.get(n?"Hide Setting":"Show Setting"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lUoGG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils"),h=O("./progress");x.default=function(m){return M=>({...m,mounted:T=>{const{option:p,template:{$progress:f,$video:n},events:{proxy:d,loadImg:o}}=M;let v=null,c=!1,u=!1;d(f,"mousemove",async r=>{c||(c=!0,v=await o(p.thumbnails.url),u=!0),u&&((0,S.setStyle)(T,"display","block"),function(t){const{width:i}=(0,h.getPosFromEvent)(M,t),{url:e,number:s,column:l}=p.thumbnails,a=v.naturalWidth/l,g=a/(n.videoWidth/n.videoHeight),A=f.clientWidth/s,D=Math.floor(i/A),y=Math.ceil(D/l)-1,E=D%l||l-1;(0,S.setStyle)(T,"backgroundImage",`url(${e})`),(0,S.setStyle)(T,"height",`${g}px`),(0,S.setStyle)(T,"width",`${a}px`),(0,S.setStyle)(T,"backgroundPosition",`-${E*a}px -${y*g}px`),i<=a/2?(0,S.setStyle)(T,"left",0):i>f.clientWidth-a/2?(0,S.setStyle)(T,"left",f.clientWidth-a+"px"):(0,S.setStyle)(T,"left",i-a/2+"px")}(r))}),d(f,"mouseout",()=>{(0,S.setStyle)(T,"display","none")})}})}},{"../utils":"geSvU","./progress":"dRwzT","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jvdQ0:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,tooltip:m.i18n.get("Screenshot"),mounted:M=>{const{events:{proxy:T},icons:p}=m;(0,S.append)(M,p.screenshot),T(M,"click",()=>{m.screenshot()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k9pKK:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return h=>{const m=h.option.quality,M=m.find(T=>T.default)||m[0];return{...S,html:M?M.html:"",selector:m,onSelect(T){h.switchQuality(T.url,T.html)}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aE690:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>({...h,mounted:M=>{const T=(0,S.append)(M,'<span class="art-loop-point"></span>'),p=(0,S.append)(M,'<span class="art-loop-point"></span>');m.on("loop",f=>{f?((0,S.setStyle)(M,"display","block"),(0,S.setStyle)(T,"left",`calc(${f[0]/m.duration*100}% - ${T.clientWidth}px)`),(0,S.setStyle)(p,"left",f[1]/m.duration*100+"%")):(0,S.setStyle)(M,"display","none")})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7rh9q":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../utils"),m=O("../utils/component"),M=S.interopDefault(m),T=O("./playbackRate"),p=S.interopDefault(T),f=O("./aspectRatio"),n=S.interopDefault(f),d=O("./flip"),o=S.interopDefault(d),v=O("./info"),c=S.interopDefault(v),u=O("./version"),r=S.interopDefault(u),t=O("./close"),i=S.interopDefault(t);class e extends M.default{constructor(l){super(l),this.name="contextmenu",this.$parent=l.template.$contextmenu,h.isMobile||this.init()}init(){const{option:l,template:{$player:a,$contextmenu:g},events:{proxy:A}}=this.art;this.add((0,p.default)({disable:!l.playbackRate,name:"playbackRate",index:10})),this.add((0,n.default)({disable:!l.aspectRatio,name:"aspectRatio",index:20})),this.add((0,o.default)({disable:!l.flip,name:"flip",index:30})),this.add((0,c.default)({disable:!1,name:"info",index:40})),this.add((0,r.default)({disable:!1,name:"version",index:50})),this.add((0,i.default)({disable:!1,name:"close",index:60}));for(let D=0;D<l.contextmenu.length;D++)this.add(l.contextmenu[D]);A(a,"contextmenu",D=>{D.preventDefault(),this.show=!0;const y=D.clientX,E=D.clientY,{height:_,width:L,left:I,top:b}=a.getBoundingClientRect(),{height:R,width:P}=g.getBoundingClientRect();let w=y-I,F=E-b;y+P>I+L&&(w=L-P),E+R>b+_&&(F=_-R),(0,h.setStyles)(g,{top:`${F}px`,left:`${w}px`})}),A(a,"click",D=>{(0,h.includeFromEvent)(D,g)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}x.default=e},{"../utils":"geSvU","../utils/component":"kPHYl","./playbackRate":"9P3rd","./aspectRatio":"3OqVf","./flip":"iMg4Y","./info":"9FFXO","./version":"duhqU","./close":"k3lJQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9P3rd":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>{const{i18n:M}=m;return{...h,html:`${M.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${M.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(T,p)=>{const{value:f}=p.target.dataset;f&&(m.playbackRate=Number(f),T.show=!1)},mounted:T=>{m.on("playbackRate",p=>{const f=(0,S.queryAll)("span",T).find(n=>Number(n.dataset.value)===p);f&&(0,S.inverseClass)(f,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3OqVf":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>{const{i18n:M}=m;return{...h,html:`${M.get("Aspect Ratio")}:<span data-value="default" class="art-current">${M.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(T,p)=>{const{value:f}=p.target.dataset;f&&(m.aspectRatio=f,T.show=!1)},mounted:T=>{m.on("aspectRatio",p=>{const f=(0,S.queryAll)("span",T).find(n=>n.dataset.value===p);f&&(0,S.inverseClass)(f,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iMg4Y:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){return m=>{const{i18n:M}=m;return{...h,html:`${M.get("Video Flip")}:<span data-value="normal" class="art-current">${M.get("Normal")}</span><span data-value="horizontal">${M.get("Horizontal")}</span><span data-value="vertical">${M.get("Vertical")}</span>`,click:(T,p)=>{const{value:f}=p.target.dataset;f&&(m.flip=f,T.show=!1)},mounted:T=>{m.on("flip",p=>{const f=(0,S.queryAll)("span",T).find(n=>n.dataset.value===p);f&&(0,S.inverseClass)(f,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9FFXO":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return h=>({...S,html:h.i18n.get("Video Info"),click:m=>{h.info.show=!0,m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],duhqU:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return{...S,html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.5.2</a>'}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k3lJQ:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return h=>({...S,html:h.i18n.get("Close"),click:m=>{m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],c896w:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m);class T extends M.default{constructor(f){super(f),this.name="info",h.isMobile||this.init()}init(){const{constructor:f,events:{proxy:n},template:{$infoPanel:d,$infoClose:o,$video:v}}=this.art;n(o,"click",()=>{this.show=!1});let c=null;const u=(0,h.queryAll)("[data-video]",d)||[];this.art.on("destroy",()=>{clearTimeout(c)}),function r(){for(let t=0;t<u.length;t++){const i=u[t],e=v[i.dataset.video],s=typeof e=="number"?e.toFixed(2):e;i.innerText!==s&&(i.innerText=s)}c=setTimeout(r,f.INFO_LOOP_TIME)}()}}x.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"2hqso":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m),T=O("option-validator"),p=S.interopDefault(T),f=O("./scheme"),n=S.interopDefault(f);class d extends M.default{constructor(v){super(v),this.name="subtitle",this.init(v.option.subtitle)}get url(){return this.art.template.$track.src}set url(v){this.switch(v)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(v,c){const{$subtitle:u}=this.art.template;return typeof v=="object"?(0,h.setStyles)(u,v):(0,h.setStyle)(u,v,c)}update(){const{$subtitle:v}=this.art.template;v.innerHTML="",this.activeCue&&(v.innerHTML=this.activeCue.text.split(/\r?\n/).map(c=>`<p>${(0,h.escape)(c)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}async switch(v,c={}){const{i18n:u,notice:r,option:t}=this.art,i={...t.subtitle,...c,url:v},e=await this.init(i);return c.name&&(r.show=`${u.get("Switch Subtitle")}: ${c.name}`),e}init(v){if((0,p.default)(v,n.default.subtitle),!v.url)return;const{notice:c,events:{proxy:u},template:{$subtitle:r,$video:t,$track:i}}=this.art;if(!i){const e=document.createElement("track");e.default=!0,e.kind="metadata",t.appendChild(e),this.art.template.$track=e,u(this.textTrack,"cuechange",this.update.bind(this))}return this.style(v.style),(0,h.errorHandle)(window.fetch,"fetch not support"),fetch(v.url).then(e=>e.arrayBuffer()).then(e=>{(0,h.errorHandle)(window.TextDecoder,"TextDecoder not support");const s=new TextDecoder(v.encoding).decode(e);switch(this.art.emit("subtitleLoad",v.url),v.type||(0,h.getExt)(v.url)){case"srt":return(0,h.vttToBlob)((0,h.srtToVtt)(s));case"ass":return(0,h.vttToBlob)((0,h.assToVtt)(s));case"vtt":return(0,h.vttToBlob)(s);default:return v.url}}).then(e=>(r.innerHTML="",this.url===e||(URL.revokeObjectURL(this.url),this.art.template.$track.src=e,this.art.emit("subtitleSwitch",e)),e)).catch(e=>{throw c.show=e,e})}}x.default=d},{"./utils":"geSvU","./utils/component":"kPHYl","option-validator":"2A2W5","./scheme":"3vPoh","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j2hlX:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../utils/error"),m=O("./clickInit"),M=S.interopDefault(m),T=O("./hoverInit"),p=S.interopDefault(T),f=O("./mousemoveInit"),n=S.interopDefault(f),d=O("./resizeInit"),o=S.interopDefault(d),v=O("./gestureInit"),c=S.interopDefault(v),u=O("./viewInit"),r=S.interopDefault(u);x.default=class{constructor(t){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),t.whitelist.state&&((0,M.default)(t,this),(0,p.default)(t,this),(0,n.default)(t,this),(0,o.default)(t,this),(0,c.default)(t,this),(0,r.default)(t,this))}proxy(t,i,e,s={}){if(Array.isArray(i))return i.map(a=>this.proxy(t,a,e,s));t.addEventListener(i,e,s);const l=()=>t.removeEventListener(i,e,s);return this.destroyEvents.push(l),l}hover(t,i,e){i&&this.proxy(t,"mouseenter",i),e&&this.proxy(t,"mouseleave",e)}loadImg(t){return new Promise((i,e)=>{let s;if(t instanceof HTMLImageElement)s=t;else{if(typeof t!="string")return e(new h.ArtPlayerError("Unable to get Image"));s=new Image,s.src=t}if(s.complete)return i(s);this.proxy(s,"load",()=>i(s)),this.proxy(s,"error",()=>e(new h.ArtPlayerError(`Failed to load Image: ${s.src}`)))})}destroy(){for(let t=0;t<this.destroyEvents.length;t++)this.destroyEvents[t]()}}},{"../utils/error":"lDQPM","./clickInit":"iP4Z9","./hoverInit":"aoIIW","./mousemoveInit":"4WC5c","./resizeInit":"7fpan","./gestureInit":"ixtiG","./viewInit":"5WvmH","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iP4Z9:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h,m){const{constructor:M,template:{$player:T,$video:p}}=h;m.proxy(document,["click","contextmenu"],n=>{(0,S.includeFromEvent)(n,T)?(h.isInput=n.target.tagName==="INPUT",h.isFocus=!0,h.emit("focus")):(h.isInput=!1,h.isFocus=!1,h.emit("blur"))});let f=0;m.proxy(p,"click",()=>{const n=Date.now();n-f<=M.DB_CLICE_TIME?(h.emit("dblclick"),S.isMobile?h.isLock||h.toggle():h.fullscreen=!h.fullscreen):(h.emit("click"),S.isMobile||h.toggle()),f=n})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aoIIW:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h,m){const{$player:M}=h.template;m.hover(M,()=>{(0,S.addClass)(M,"art-hover"),h.emit("hover",!0)},()=>{(0,S.removeClass)(M,"art-hover"),h.emit("hover")})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4WC5c":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S,h){const{$player:m}=S.template;h.proxy(m,"mousemove",M=>{S.emit("mousemove",M)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7fpan":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h,m){const{option:M}=h,T=(0,S.throttle)(()=>{h.normalSize&&(h.autoSize=M.autoSize),h.aspectRatioReset=!0,h.notice.show="",h.emit("resize")},h.constructor.RESIZE_TIME);m.proxy(window,["orientationchange","resize"],()=>{T()}),screen&&screen.orientation&&screen.orientation.onchange&&m.proxy(screen.orientation,"change",()=>{T()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ixtiG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h,m){if(S.isMobile&&!h.option.isLive){const{$video:M,$bottom:T,$controls:p}=h.template;let f=!1,n=0,d=0,o=0;const v=r=>{if(r.touches.length===1&&!h.isLock){f=!0;const{clientX:t,clientY:i}=r.touches[0];n=t,d=i,o=h.currentTime}},c=r=>{if(r.touches.length===1&&f&&h.duration){const t=h.plugins.autoOrientation&&h.plugins.autoOrientation.state,{clientX:i,clientY:e}=r.touches[0],s=(0,S.clamp)((i-n)/h.width,-1,1),l=(0,S.clamp)((e-d)/h.height,-1,1),a=t?l:s,g=(0,S.clamp)(o+h.duration*a/2,0,h.duration);h.seek=g,h.emit("setBar","played",(0,S.clamp)(g/h.duration,0,1)),h.notice.show=`${(0,S.secondToTime)(g)} / ${(0,S.secondToTime)(h.duration)}`}},u=()=>{f&&(n=0,d=0,o=0,f=!1)};m.proxy(T,"touchstart",r=>{(0,S.includeFromEvent)(r,p)||v(r)}),m.proxy(T,"touchmove",c),m.proxy(M,"touchstart",v),m.proxy(M,"touchmove",c),m.proxy(document,"touchend",u)}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5WvmH":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h,m){const{option:M,constructor:T,template:{$container:p}}=h,f=(0,S.throttle)(()=>{h.emit("view",(0,S.isInViewport)(p,T.SCROLL_GAP))},T.SCROLL_TIME);m.proxy(window,"scroll",()=>{f()}),h.on("view",n=>{M.autoMini&&(h.mini=!n)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aTHWZ:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");x.default=class{constructor(h){this.art=h,this.keys={},h.option.hotkey&&!S.isMobile&&this.init()}init(){const{proxy:h}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),h(window,"keydown",m=>{if(this.art.isFocus){const M=document.activeElement.tagName.toUpperCase(),T=document.activeElement.getAttribute("contenteditable");if(M!=="INPUT"&&M!=="TEXTAREA"&&T!==""&&T!=="true"){const p=this.keys[m.keyCode];if(p){m.preventDefault();for(let f=0;f<p.length;f++)p[f].call(this.art,m);this.art.emit("hotkey",m)}}}})}add(h,m){return this.keys[h]?this.keys[h].push(m):this.keys[h]=[m],this}remove(h,m){if(this.keys[h]){const M=this.keys[h].indexOf(m);M!==-1&&this.keys[h].splice(M,1)}return this}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],f2kxw:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./utils/component"),m=S.interopDefault(h);class M extends m.default{constructor(p){super(p);const{option:f,template:{$layer:n}}=p;this.name="layer",this.$parent=n;for(let d=0;d<f.layers.length;d++)this.add(f.layers[d])}}x.default=M},{"./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bOs9w:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m);class T extends M.default{constructor(f){super(f),this.name="loading",(0,h.append)(f.template.$loading,f.icons.loading)}}x.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ic4th:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");x.default=class{constructor(h){this.art=h,this.timer=null}set show(h){const{constructor:m,template:{$player:M,$noticeInner:T}}=this.art;h?(T.innerText=h instanceof Error?h.message.trim():h,(0,S.addClass)(M,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{T.innerText="",(0,S.removeClass)(M,"art-notice-show")},m.NOTICE_TIME)):(0,S.removeClass)(M,"art-notice-show")}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iLfmB:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m);class T extends M.default{constructor(f){super(f),this.name="mask";const{template:n,icons:d,events:o}=f,v=(0,h.append)(n.$state,d.state),c=(0,h.append)(n.$state,d.error);(0,h.setStyle)(c,"display","none"),f.on("destroy",()=>{(0,h.setStyle)(v,"display","none"),(0,h.setStyle)(c,"display",null)}),o.proxy(n.$state,"click",()=>f.play())}}x.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5lAmI":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../utils"),m=O("bundle-text:./loading.svg"),M=S.interopDefault(m),T=O("bundle-text:./state.svg"),p=S.interopDefault(T),f=O("bundle-text:./check.svg"),n=S.interopDefault(f),d=O("bundle-text:./play.svg"),o=S.interopDefault(d),v=O("bundle-text:./pause.svg"),c=S.interopDefault(v),u=O("bundle-text:./volume.svg"),r=S.interopDefault(u),t=O("bundle-text:./volume-close.svg"),i=S.interopDefault(t),e=O("bundle-text:./screenshot.svg"),s=S.interopDefault(e),l=O("bundle-text:./setting.svg"),a=S.interopDefault(l),g=O("bundle-text:./arrow-left.svg"),A=S.interopDefault(g),D=O("bundle-text:./arrow-right.svg"),y=S.interopDefault(D),E=O("bundle-text:./playback-rate.svg"),_=S.interopDefault(E),L=O("bundle-text:./aspect-ratio.svg"),I=S.interopDefault(L),b=O("bundle-text:./config.svg"),R=S.interopDefault(b),P=O("bundle-text:./pip.svg"),w=S.interopDefault(P),F=O("bundle-text:./lock.svg"),k=S.interopDefault(F),B=O("bundle-text:./unlock.svg"),U=S.interopDefault(B),j=O("bundle-text:./fullscreen-off.svg"),K=S.interopDefault(j),N=O("bundle-text:./fullscreen-on.svg"),Z=S.interopDefault(N),X=O("bundle-text:./fullscreen-web-off.svg"),Y=S.interopDefault(X),ee=O("bundle-text:./fullscreen-web-on.svg"),Q=S.interopDefault(ee),G=O("bundle-text:./switch-on.svg"),q=S.interopDefault(G),te=O("bundle-text:./switch-off.svg"),ie=S.interopDefault(te),ne=O("bundle-text:./flip.svg"),le=S.interopDefault(ne),se=O("bundle-text:./error.svg"),oe=S.interopDefault(se),J=O("bundle-text:./close.svg"),ae=S.interopDefault(J);x.default=class{constructor(fe){const de={loading:M.default,state:p.default,play:o.default,pause:c.default,check:n.default,volume:r.default,volumeClose:i.default,screenshot:s.default,setting:a.default,pip:w.default,arrowLeft:A.default,arrowRight:y.default,playbackRate:_.default,aspectRatio:I.default,config:R.default,lock:k.default,flip:le.default,unlock:U.default,fullscreenOff:K.default,fullscreenOn:Z.default,fullscreenWebOff:Y.default,fullscreenWebOn:Q.default,switchOn:q.default,switchOff:ie.default,error:oe.default,close:ae.default,...fe.option.icons};Object.keys(de).forEach(ve=>{(0,h.def)(this,ve,{get:()=>{const ue=document.createElement("i");return(0,h.addClass)(ue,"art-icon"),(0,h.addClass)(ue,`art-icon-${ve}`),(0,h.append)(ue,de[ve]),ue}})})}}},{"../utils":"geSvU","bundle-text:./loading.svg":"hX0lQ","bundle-text:./state.svg":"01U3R","bundle-text:./check.svg":"9jaCP","bundle-text:./play.svg":"invok","bundle-text:./pause.svg":"68285","bundle-text:./volume.svg":"3zSKr","bundle-text:./volume-close.svg":"ft8Zf","bundle-text:./screenshot.svg":"dfLel","bundle-text:./setting.svg":"j8dnn","bundle-text:./arrow-left.svg":"fMoi9","bundle-text:./arrow-right.svg":"auIjA","bundle-text:./playback-rate.svg":"g3V1U","bundle-text:./aspect-ratio.svg":"3LQJt","bundle-text:./config.svg":"bcTkc","bundle-text:./pip.svg":"jDSoL","bundle-text:./lock.svg":"jqFLt","bundle-text:./unlock.svg":"5qYod","bundle-text:./fullscreen-off.svg":"25MvP","bundle-text:./fullscreen-on.svg":"6CCX4","bundle-text:./fullscreen-web-off.svg":"m9TwS","bundle-text:./fullscreen-web-on.svg":"iWJrW","bundle-text:./switch-on.svg":"8cFxH","bundle-text:./switch-off.svg":"6tBmw","bundle-text:./flip.svg":"6N8Hu","bundle-text:./error.svg":"bNBRZ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","bundle-text:./close.svg":"8pxPz"}],hX0lQ:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],"01U3R":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],"9jaCP":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],invok:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],68285:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],"3zSKr":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],ft8Zf:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],dfLel:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],j8dnn:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],fMoi9:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],auIjA:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],g3V1U:[function(O,C,x){C.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"3LQJt":[function(O,C,x){C.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],bcTkc:[function(O,C,x){C.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],jDSoL:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],jqFLt:[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],"5qYod":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],"25MvP":[function(O,C,x){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],"6CCX4":[function(O,C,x){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],m9TwS:[function(O,C,x){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],iWJrW:[function(O,C,x){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"8cFxH":[function(O,C,x){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],"6tBmw":[function(O,C,x){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],"6N8Hu":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],bNBRZ:[function(O,C,x){C.exports='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.082 93.082 0 0 1 34.448 33.341zM512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88zm0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2z"/></svg>'},{}],"8pxPz":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733-17.066-17.067-42.666-17.067-59.733 0L512 452.267l-268.8-268.8c-17.067-17.067-42.667-17.067-59.733 0-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733L571.733 512z"/></svg>'},{}],d5XKP:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./flip"),m=S.interopDefault(h),M=O("./aspectRatio"),T=S.interopDefault(M),p=O("./playbackRate"),f=S.interopDefault(p),n=O("./subtitleOffset"),d=S.interopDefault(n),o=O("../utils/component"),v=S.interopDefault(o),c=O("../utils");function u(i,e,s){for(let l=0;l<i.length;l++){const a=i[l];a.$parentItem=e,a.$parentList=s,a.selector&&u(a.selector,a,i)}return i}function r(i){return["string","number"].includes(typeof i)}class t extends v.default{constructor(e){super(e);const{option:s,events:{proxy:l},template:{$setting:a,$player:g}}=e;if(this.name="setting",this.$parent=a,this.option=[],this.events=[],this.cache=new Map,s.setting){s.playbackRate&&this.option.push((0,f.default)(e)),s.aspectRatio&&this.option.push((0,T.default)(e)),s.flip&&this.option.push((0,m.default)(e)),s.subtitleOffset&&this.option.push((0,d.default)(e));for(let A=0;A<s.settings.length;A++)this.option.push(s.settings[A]);this.option=u(this.option),this.init(this.option),e.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),l(g,"click",A=>{!this.show||(0,c.includeFromEvent)(A,e.controls.setting)||(0,c.includeFromEvent)(A,this.$parent)||(this.show=!1,this.init(this.option))})}}add(e){typeof e=="function"?this.option.push(e(this.art)):this.option.push(e),this.cache=new Map,this.events.forEach(s=>s()),this.events=[],this.$parent.innerHTML="",this.option=u(this.option),this.init(this.option)}creatHeader(e){const{icons:s,events:{proxy:l}}=this.art,a=document.createElement("div");(0,c.addClass)(a,"art-setting-item"),(0,c.addClass)(a,"art-setting-item-back");const g=(0,c.append)(a,'<div class="art-setting-item-left"></div>'),A=document.createElement("div");(0,c.addClass)(A,"art-setting-item-left-icon"),(0,c.append)(A,s.arrowLeft),(0,c.append)(g,A),(0,c.append)(g,e.$parentItem.html);const D=l(a,"click",()=>{this.init(e.$parentList)});return this.events.push(D),a}creatItem(e,s){const{icons:l,events:{proxy:a}}=this.art,g=document.createElement("div");(0,c.addClass)(g,"art-setting-item"),r(s.name)&&(g.dataset.name=s.name),r(s.value)&&(g.dataset.value=s.value);const A=(0,c.append)(g,'<div class="art-setting-item-left"></div>'),D=(0,c.append)(g,'<div class="art-setting-item-right"></div>'),y=document.createElement("div");switch((0,c.addClass)(y,"art-setting-item-left-icon"),e){case"switch":case"range":(0,c.append)(y,r(s.icon)||s.icon instanceof Element?s.icon:l.config);break;case"selector":s.selector&&s.selector.length?(0,c.append)(y,r(s.icon)||s.icon instanceof Element?s.icon:l.config):(0,c.append)(y,l.check)}(0,c.append)(A,y),s.$icon=y,(0,c.def)(s,"icon",{configurable:!0,get:()=>y.innerHTML,set(L){r(L)&&(y.innerHTML=L)}});const E=document.createElement("div");(0,c.addClass)(E,"art-setting-item-left-text"),(0,c.append)(E,s.html||""),(0,c.append)(A,E),s.$html=E,(0,c.def)(s,"html",{configurable:!0,get:()=>E.innerHTML,set(L){r(L)&&(E.innerHTML=L)}});const _=document.createElement("div");switch((0,c.addClass)(_,"art-setting-item-right-tooltip"),(0,c.append)(_,s.tooltip||""),(0,c.append)(D,_),s.$tooltip=_,(0,c.def)(s,"tooltip",{configurable:!0,get:()=>_.innerHTML,set(L){r(L)&&(_.innerHTML=L)}}),e){case"switch":{const L=document.createElement("div");(0,c.addClass)(L,"art-setting-item-right-icon");const I=(0,c.append)(L,l.switchOn),b=(0,c.append)(L,l.switchOff);(0,c.setStyle)(s.switch?b:I,"display","none"),(0,c.append)(D,L),s.$switch=s.switch,(0,c.def)(s,"switch",{configurable:!0,get:()=>s.$switch,set(R){s.$switch=R,R?((0,c.setStyle)(b,"display","none"),(0,c.setStyle)(I,"display",null)):((0,c.setStyle)(b,"display",null),(0,c.setStyle)(I,"display","none"))}});break}case"range":{const L=document.createElement("div");(0,c.addClass)(L,"art-setting-item-right-icon");const I=(0,c.append)(L,'<input type="range">');I.value=s.range[0]||0,I.min=s.range[1]||0,I.max=s.range[2]||10,I.step=s.range[3]||1,(0,c.addClass)(I,"art-setting-range"),(0,c.append)(D,L),s.$range=I,(0,c.def)(s,"range",{configurable:!0,get:()=>I.valueAsNumber,set(b){I.value=Number(b)}})}break;case"selector":if(s.selector&&s.selector.length){const L=document.createElement("div");(0,c.addClass)(L,"art-setting-item-right-icon"),(0,c.append)(L,l.arrowRight),(0,c.append)(D,L)}}switch(e){case"switch":if(s.onSwitch){const L=a(g,"click",async I=>{s.switch=await s.onSwitch.call(this.art,s,g,I)});this.events.push(L)}break;case"range":if(s.onRange&&s.$range){const L=a(s.$range,"change",async I=>{s.tooltip=await s.onRange.call(this.art,s,g,I)});this.events.push(L)}break;case"selector":{const L=a(g,"click",async I=>{if(s.selector&&s.selector.length)this.init(s.selector,s.width);else if((0,c.inverseClass)(g,"art-current"),s.$parentList&&this.init(s.$parentList),s.$parentItem&&s.$parentItem.onSelect){const b=await s.$parentItem.onSelect.call(this.art,s,g,I);s.$parentItem.$tooltip&&r(b)&&(s.$parentItem.$tooltip.innerHTML=b)}});this.events.push(L),s.default&&(0,c.addClass)(g,"art-current")}}return g}init(e,s){const{constructor:l}=this.art;if(this.cache.has(e)){const a=this.cache.get(e);(0,c.inverseClass)(a,"art-current"),(0,c.setStyle)(this.$parent,"width",`${a.dataset.width}px`),(0,c.setStyle)(this.$parent,"height",`${a.dataset.height}px`)}else{const a=document.createElement("div");(0,c.addClass)(a,"art-setting-panel"),a.dataset.width=s||l.SETTING_WIDTH,a.dataset.height=e.length*l.SETTING_ITEM_HEIGHT,e[0]&&e[0].$parentItem&&((0,c.append)(a,this.creatHeader(e[0])),a.dataset.height=Number(a.dataset.height)+l.SETTING_ITEM_HEIGHT);for(let g=0;g<e.length;g++){const A=e[g];(0,c.has)(A,"switch")?(0,c.append)(a,this.creatItem("switch",A)):(0,c.has)(A,"range")?(0,c.append)(a,this.creatItem("range",A)):(0,c.append)(a,this.creatItem("selector",A))}(0,c.append)(this.$parent,a),this.cache.set(e,a),(0,c.inverseClass)(a,"art-current"),(0,c.setStyle)(this.$parent,"width",`${a.dataset.width}px`),(0,c.setStyle)(this.$parent,"height",`${a.dataset.height}px`),e[0]&&e[0].$parentItem&&e[0].$parentItem.mounted&&e[0].$parentItem.mounted.call(this.art,a,e[0].$parentItem)}}}x.default=t},{"./flip":"ah3Qs","./aspectRatio":"1gs5B","./playbackRate":"j50mh","./subtitleOffset":"i17b6","../utils/component":"kPHYl","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ah3Qs:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:T}=h,p={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function f(n,d,o){d&&(d.innerText=m.get(p[o]));const v=(0,S.queryAll)(".art-setting-item",n).find(c=>c.dataset.value===o);v&&(0,S.inverseClass)(v,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Video Flip"),tooltip:m.get(p[h.flip]),icon:M.flip,selector:Object.keys(p).map(n=>({value:n,default:n===h.flip,html:m.get(p[n])})),onSelect(n){h.flip=n.value},mounted:(n,d)=>{f(n,d.$tooltip,h.flip),h.on("flip",()=>{f(n,d.$tooltip,h.flip)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1gs5B":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:T}=h;function p(n){return n==="default"?m.get("Default"):n}function f(n,d,o){d&&(d.innerText=p(o));const v=(0,S.queryAll)(".art-setting-item",n).find(c=>c.dataset.value===o);v&&(0,S.inverseClass)(v,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Aspect Ratio"),icon:M.aspectRatio,tooltip:p(h.aspectRatio),selector:["default","4:3","16:9"].map(n=>({value:n,default:n===h.aspectRatio,html:p(n)})),onSelect(n){h.aspectRatio=n.value},mounted:(n,d)=>{f(n,d.$tooltip,h.aspectRatio),h.on("aspectRatio",()=>{f(n,d.$tooltip,h.aspectRatio)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j50mh:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:T}=h;function p(n){return n===1?m.get("Normal"):n}function f(n,d,o){d&&(d.innerText=p(o));const v=(0,S.queryAll)(".art-setting-item",n).find(c=>Number(c.dataset.value)===o);v&&(0,S.inverseClass)(v,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Play Speed"),tooltip:p(h.playbackRate),icon:M.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(n=>({value:n,default:n===h.playbackRate,html:p(n)})),onSelect(n){h.playbackRate=n.value},mounted:(n,d)=>{f(n,d.$tooltip,h.playbackRate),h.on("playbackRate",()=>{f(n,d.$tooltip,h.playbackRate)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i17b6:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,icons:M,constructor:T}=h;function p(n){return n===0?m.get("Normal"):n}function f(n,d,o){d&&(d.innerText=p(o));const v=(0,S.queryAll)(".art-setting-item",n).find(c=>Number(c.dataset.value)===o);v&&(0,S.inverseClass)(v,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Subtitle Offset"),tooltip:p(h.subtitleOffset),icon:M.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(n=>({value:n,default:n===h.subtitleOffset,html:p(n)})),onSelect(n){h.subtitleOffset=n.value},mounted:(n,d)=>{f(n,d.$tooltip,h.subtitleOffset),h.on("subtitleOffset",()=>{f(n,d.$tooltip,h.subtitleOffset)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5M8nN":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(S){try{const h=JSON.parse(window.localStorage.getItem(this.name))||{};return S?h[S]:h}catch{return S?this.settings[S]:this.settings}}set(S,h){try{const m=Object.assign({},this.get(),{[S]:h});window.localStorage.setItem(this.name,JSON.stringify(m))}catch{this.settings[S]=h}}del(S){try{const h=this.get();delete h[S],window.localStorage.setItem(this.name,JSON.stringify(h))}catch{delete this.settings[S]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jWfEd:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("../utils"),m=O("./miniProgressBar"),M=S.interopDefault(m),T=O("./autoOrientation"),p=S.interopDefault(T),f=O("./autoPlayback"),n=S.interopDefault(f),d=O("./fastForward"),o=S.interopDefault(d),v=O("./lock"),c=S.interopDefault(v);x.default=class{constructor(u){this.art=u,this.id=0;const{option:r}=u;r.miniProgressBar&&!r.isLive&&this.add(M.default),r.lock&&h.isMobile&&this.add(c.default),r.autoPlayback&&this.add(n.default),r.autoOrientation&&h.isMobile&&this.add(p.default),r.fastForward&&h.isMobile&&!r.isLive&&this.add(o.default);for(let t=0;t<r.plugins.length;t++)this.add(r.plugins[t])}add(u){this.id+=1;const r=u.call(this,this.art),t=r&&r.name||u.name||`plugin${this.id}`;return(0,h.errorHandle)(!(0,h.has)(this,t),`Cannot add a plugin that already has the same name: ${t}`),(0,h.def)(this,t,{value:r}),this}}},{"../utils":"geSvU","./miniProgressBar":"7KBj0","./autoOrientation":"aPIVP","./autoPlayback":"j87OI","./fastForward":"1VTki","./lock":"7BtoE","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7KBj0":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return S.on("ready",()=>{S.layers.add({name:"miniProgressBar",mounted(h){S.on("destroy",()=>{h.style.display="none"}),S.on("video:timeupdate",()=>{h.style.width=100*S.played+"%"}),S.on("setBar",(m,M)=>{m==="played"&&(h.style.width=100*M+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPIVP:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{option:m,constructor:M,template:{$player:T,$video:p}}=h;return h.on("fullscreenWeb",f=>{if(f){const{videoWidth:n,videoHeight:d}=p,{clientWidth:o,clientHeight:v}=document.documentElement;(n>d&&o<v||n<d&&o>v)&&setTimeout(()=>{(0,S.setStyle)(T,"width",`${v}px`),(0,S.setStyle)(T,"height",`${o}px`),(0,S.setStyle)(T,"transform-origin","0 0"),(0,S.setStyle)(T,"transform",`rotate(90deg) translate(0, -${o}px)`),(0,S.addClass)(T,"art-auto-orientation"),h.emit("resize")},M.MOBILE_AUTO_ORIENTATION_TIME)}else(0,S.hasClass)(T,"art-auto-orientation")&&((0,S.setStyle)(T,"width",null),(0,S.setStyle)(T,"height",null),(0,S.setStyle)(T,"transform",null),(0,S.setStyle)(T,"transform-origin",null),(0,S.removeClass)(T,"art-auto-orientation"),h.aspectRatioReset=!0,h.autoSize=m.autoSize,h.notice.show="",h.emit("resize"))}),h.on("fullscreen",async f=>{const n=screen.orientation.type;if(f){const{videoWidth:d,videoHeight:o}=p,{clientWidth:v,clientHeight:c}=document.documentElement;if(d>o&&v<c||d<o&&v>c){const u=n.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(u),(0,S.addClass)(T,"art-auto-orientation-fullscreen")}}else(0,S.hasClass)(T,"art-auto-orientation-fullscreen")&&(await screen.orientation.lock(n),(0,S.removeClass)(T,"art-auto-orientation-fullscreen"))}),{name:"autoOrientation",get state(){return(0,S.hasClass)(T,"art-auto-orientation")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j87OI:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{i18n:m,icons:M,storage:T,constructor:p,events:{proxy:f},template:{$poster:n}}=h,d=h.layers.add({name:"autoPlayback",html:'<div class="art-autoPlayback-close"></div><div class="art-autoPlayback-last"></div><div class="art-autoPlayback-jump"></div>'}),o=(0,S.query)(".art-autoPlayback-last",d),v=(0,S.query)(".art-autoPlayback-jump",d),c=(0,S.query)(".art-autoPlayback-close",d);return h.on("video:timeupdate",()=>{const u=T.get("times")||{},r=Object.keys(u);r.length>p.AUTO_PLAYBACK_MAX&&delete u[r[0]],u[h.option.url]=h.currentTime,T.set("times",u)}),h.on("ready",()=>{const u=(T.get("times")||{})[h.option.url];u&&((0,S.append)(c,M.close),(0,S.setStyle)(d,"display","flex"),o.innerText=`${m.get("Last Seen")} ${(0,S.secondToTime)(u)}`,v.innerText=m.get("Jump Play"),f(c,"click",()=>{(0,S.setStyle)(d,"display","none")}),f(v,"click",()=>{h.seek=u,h.play(),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","none")}),h.once("video:timeupdate",()=>{setTimeout(()=>{(0,S.setStyle)(d,"display","none")},p.AUTO_PLAYBACK_TIMEOUT)}))}),{name:"autoPlayback",get times(){return T.get("times")||{}},clear:()=>T.del("times")}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1VTki":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{constructor:m,events:{proxy:M},template:{$player:T,$video:p}}=h;let f=null,n=!1;const d=()=>{clearTimeout(f),n&&(n=!1,h.playbackRate=1,(0,S.removeClass)(T,"art-fast-forward"))};return M(p,"touchstart",o=>{o.touches.length===1&&h.playing&&!h.isLock&&(f=setTimeout(()=>{n=!0,h.playbackRate=m.FAST_FORWARD_VALUE,(0,S.addClass)(T,"art-fast-forward")},m.FAST_FORWARD_TIME))}),M(document,"touchmove",d),M(document,"touchend",d),{name:"fastForward",get state(){return(0,S.hasClass)(T,"art-fast-forward")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7BtoE":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(h){const{layers:m,icons:M,template:{$player:T}}=h;return m.add({name:"lock",mounted(p){const f=(0,S.append)(p,M.lock),n=(0,S.append)(p,M.unlock);(0,S.setStyle)(f,"display","none"),h.on("lock",d=>{d?((0,S.setStyle)(f,"display","inline-flex"),(0,S.setStyle)(n,"display","none")):((0,S.setStyle)(f,"display","none"),(0,S.setStyle)(n,"display","inline-flex"))})},click(){(0,S.hasClass)(T,"art-lock")?((0,S.removeClass)(T,"art-lock"),this.isLock=!1,h.emit("lock",!1)):((0,S.addClass)(T,"art-lock"),this.isLock=!0,h.emit("lock",!0))}}),{name:"lock",get state(){return(0,S.hasClass)(T,"art-lock")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fkUkB:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var h=O("./config"),m=S.interopDefault(h),M=O("./utils");x.default=class{constructor(T){const{option:p,events:{proxy:f},template:{$video:n}}=T;for(let v=0;v<m.default.events.length;v++)f(n,m.default.events[v],c=>{T.emit(`video:${c.type}`,c)});Object.keys(p.moreVideoAttr).forEach(v=>{n[v]=p.moreVideoAttr[v]}),p.muted&&(n.muted=p.muted),p.volume&&(n.volume=(0,M.clamp)(p.volume,0,1)),p.poster&&(n.poster=p.poster),p.autoplay&&(n.autoplay=p.autoplay),p.playsInline&&(n.playsInline=!0,n["webkit-playsinline"]=!0);const d=p.type||(0,M.getExt)(p.url),o=p.customType[d];d&&o?(o(n,p.url,T),T.emit("customType",d)):(n.src=p.url,T.emit("url",n.src))}}},{"./config":"eksZR","./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}]},["6SN6P"],"6SN6P")})(Ne);var ht=Fe(Ne.exports),Ke={exports:{}};(function(Te,Ie){(function(C,x){Te.exports=x()})(self,function(){return function(){var O={"./node_modules/es6-promise/dist/es6-promise.js":function(h,m,M){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(T,p){h.exports=p()})(this,function(){function T(W){var z=typeof W;return W!==null&&(z==="object"||z==="function")}function p(W){return typeof W=="function"}var f=void 0;Array.isArray?f=Array.isArray:f=function(W){return Object.prototype.toString.call(W)==="[object Array]"};var n=f,d=0,o=void 0,v=void 0,c=function(z,V){E[d]=z,E[d+1]=V,d+=2,d===2&&(v?v(_):I())};function u(W){v=W}function r(W){c=W}var t=typeof window!="undefined"?window:void 0,i=t||{},e=i.MutationObserver||i.WebKitMutationObserver,s=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",l=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function a(){return function(){return process.nextTick(_)}}function g(){return typeof o!="undefined"?function(){o(_)}:y()}function A(){var W=0,z=new e(_),V=document.createTextNode("");return z.observe(V,{characterData:!0}),function(){V.data=W=++W%2}}function D(){var W=new MessageChannel;return W.port1.onmessage=_,function(){return W.port2.postMessage(0)}}function y(){var W=setTimeout;return function(){return W(_,1)}}var E=new Array(1e3);function _(){for(var W=0;W<d;W+=2){var z=E[W],V=E[W+1];z(V),E[W]=void 0,E[W+1]=void 0}d=0}function L(){try{var W=Function("return this")().require("vertx");return o=W.runOnLoop||W.runOnContext,g()}catch{return y()}}var I=void 0;s?I=a():e?I=A():l?I=D():t===void 0?I=L():I=y();function b(W,z){var V=this,$=new this.constructor(w);$[P]===void 0&&oe($);var H=V._state;if(H){var re=arguments[H-1];c(function(){return ie(H,$,re,V._result)})}else q(V,$,W,z);return $}function R(W){var z=this;if(W&&typeof W=="object"&&W.constructor===z)return W;var V=new z(w);return Y(V,W),V}var P=Math.random().toString(36).substring(2);function w(){}var F=void 0,k=1,B=2;function U(){return new TypeError("You cannot resolve a promise with itself")}function j(){return new TypeError("A promises callback cannot return that same promise.")}function K(W,z,V,$){try{W.call(z,V,$)}catch(H){return H}}function N(W,z,V){c(function($){var H=!1,re=K(V,z,function(ce){H||(H=!0,z!==ce?Y($,ce):Q($,ce))},function(ce){H||(H=!0,G($,ce))},"Settle: "+($._label||" unknown promise"));!H&&re&&(H=!0,G($,re))},W)}function Z(W,z){z._state===k?Q(W,z._result):z._state===B?G(W,z._result):q(z,void 0,function(V){return Y(W,V)},function(V){return G(W,V)})}function X(W,z,V){z.constructor===W.constructor&&V===b&&z.constructor.resolve===R?Z(W,z):V===void 0?Q(W,z):p(V)?N(W,z,V):Q(W,z)}function Y(W,z){if(W===z)G(W,U());else if(T(z)){var V=void 0;try{V=z.then}catch($){G(W,$);return}X(W,z,V)}else Q(W,z)}function ee(W){W._onerror&&W._onerror(W._result),te(W)}function Q(W,z){W._state===F&&(W._result=z,W._state=k,W._subscribers.length!==0&&c(te,W))}function G(W,z){W._state===F&&(W._state=B,W._result=z,c(ee,W))}function q(W,z,V,$){var H=W._subscribers,re=H.length;W._onerror=null,H[re]=z,H[re+k]=V,H[re+B]=$,re===0&&W._state&&c(te,W)}function te(W){var z=W._subscribers,V=W._state;if(z.length!==0){for(var $=void 0,H=void 0,re=W._result,ce=0;ce<z.length;ce+=3)$=z[ce],H=z[ce+V],$?ie(V,$,H,re):H(re);W._subscribers.length=0}}function ie(W,z,V,$){var H=p(V),re=void 0,ce=void 0,me=!0;if(H){try{re=V($)}catch(Ee){me=!1,ce=Ee}if(z===re){G(z,j());return}}else re=$;z._state!==F||(H&&me?Y(z,re):me===!1?G(z,ce):W===k?Q(z,re):W===B&&G(z,re))}function ne(W,z){try{z(function($){Y(W,$)},function($){G(W,$)})}catch(V){G(W,V)}}var le=0;function se(){return le++}function oe(W){W[P]=le++,W._state=void 0,W._result=void 0,W._subscribers=[]}function J(){return new Error("Array Methods must be provided an Array")}var ae=function(){function W(z,V){this._instanceConstructor=z,this.promise=new z(w),this.promise[P]||oe(this.promise),n(V)?(this.length=V.length,this._remaining=V.length,this._result=new Array(this.length),this.length===0?Q(this.promise,this._result):(this.length=this.length||0,this._enumerate(V),this._remaining===0&&Q(this.promise,this._result))):G(this.promise,J())}return W.prototype._enumerate=function(V){for(var $=0;this._state===F&&$<V.length;$++)this._eachEntry(V[$],$)},W.prototype._eachEntry=function(V,$){var H=this._instanceConstructor,re=H.resolve;if(re===R){var ce=void 0,me=void 0,Ee=!1;try{ce=V.then}catch(xe){Ee=!0,me=xe}if(ce===b&&V._state!==F)this._settledAt(V._state,$,V._result);else if(typeof ce!="function")this._remaining--,this._result[$]=V;else if(H===he){var Se=new H(w);Ee?G(Se,me):X(Se,V,ce),this._willSettleAt(Se,$)}else this._willSettleAt(new H(function(xe){return xe(V)}),$)}else this._willSettleAt(re(V),$)},W.prototype._settledAt=function(V,$,H){var re=this.promise;re._state===F&&(this._remaining--,V===B?G(re,H):this._result[$]=H),this._remaining===0&&Q(re,this._result)},W.prototype._willSettleAt=function(V,$){var H=this;q(V,void 0,function(re){return H._settledAt(k,$,re)},function(re){return H._settledAt(B,$,re)})},W}();function fe(W){return new ae(this,W).promise}function de(W){var z=this;return n(W)?new z(function(V,$){for(var H=W.length,re=0;re<H;re++)z.resolve(W[re]).then(V,$)}):new z(function(V,$){return $(new TypeError("You must pass an array to race."))})}function ve(W){var z=this,V=new z(w);return G(V,W),V}function ue(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function _e(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var he=function(){function W(z){this[P]=se(),this._result=this._state=void 0,this._subscribers=[],w!==z&&(typeof z!="function"&&ue(),this instanceof W?ne(this,z):_e())}return W.prototype.catch=function(V){return this.then(null,V)},W.prototype.finally=function(V){var $=this,H=$.constructor;return p(V)?$.then(function(re){return H.resolve(V()).then(function(){return re})},function(re){return H.resolve(V()).then(function(){throw re})}):$.then(V,V)},W}();he.prototype.then=b,he.all=fe,he.race=de,he.resolve=R,he.reject=ve,he._setScheduler=u,he._setAsap=r,he._asap=c;function ye(){var W=void 0;if(typeof M.g!="undefined")W=M.g;else if(typeof self!="undefined")W=self;else try{W=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var z=W.Promise;if(z){var V=null;try{V=Object.prototype.toString.call(z.resolve())}catch{}if(V==="[object Promise]"&&!z.cast)return}W.Promise=he}return he.polyfill=ye,he.Promise=he,he})},"./node_modules/events/events.js":function(h){var m=typeof Reflect=="object"?Reflect:null,M=m&&typeof m.apply=="function"?m.apply:function(y,E,_){return Function.prototype.apply.call(y,E,_)},T;m&&typeof m.ownKeys=="function"?T=m.ownKeys:Object.getOwnPropertySymbols?T=function(y){return Object.getOwnPropertyNames(y).concat(Object.getOwnPropertySymbols(y))}:T=function(y){return Object.getOwnPropertyNames(y)};function p(D){console&&console.warn&&console.warn(D)}var f=Number.isNaN||function(y){return y!==y};function n(){n.init.call(this)}h.exports=n,h.exports.once=a,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var d=10;function o(D){if(typeof D!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof D)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(D){if(typeof D!="number"||D<0||f(D))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+D+".");d=D}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||f(y))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+y+".");return this._maxListeners=y,this};function v(D){return D._maxListeners===void 0?n.defaultMaxListeners:D._maxListeners}n.prototype.getMaxListeners=function(){return v(this)},n.prototype.emit=function(y){for(var E=[],_=1;_<arguments.length;_++)E.push(arguments[_]);var L=y==="error",I=this._events;if(I!==void 0)L=L&&I.error===void 0;else if(!L)return!1;if(L){var b;if(E.length>0&&(b=E[0]),b instanceof Error)throw b;var R=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw R.context=b,R}var P=I[y];if(P===void 0)return!1;if(typeof P=="function")M(P,this,E);else for(var w=P.length,F=e(P,w),_=0;_<w;++_)M(F[_],this,E);return!0};function c(D,y,E,_){var L,I,b;if(o(E),I=D._events,I===void 0?(I=D._events=Object.create(null),D._eventsCount=0):(I.newListener!==void 0&&(D.emit("newListener",y,E.listener?E.listener:E),I=D._events),b=I[y]),b===void 0)b=I[y]=E,++D._eventsCount;else if(typeof b=="function"?b=I[y]=_?[E,b]:[b,E]:_?b.unshift(E):b.push(E),L=v(D),L>0&&b.length>L&&!b.warned){b.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(y)+" listeners added. Use emitter.setMaxListeners() to increase limit");R.name="MaxListenersExceededWarning",R.emitter=D,R.type=y,R.count=b.length,p(R)}return D}n.prototype.addListener=function(y,E){return c(this,y,E,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(y,E){return c(this,y,E,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(D,y,E){var _={fired:!1,wrapFn:void 0,target:D,type:y,listener:E},L=u.bind(_);return L.listener=E,_.wrapFn=L,L}n.prototype.once=function(y,E){return o(E),this.on(y,r(this,y,E)),this},n.prototype.prependOnceListener=function(y,E){return o(E),this.prependListener(y,r(this,y,E)),this},n.prototype.removeListener=function(y,E){var _,L,I,b,R;if(o(E),L=this._events,L===void 0)return this;if(_=L[y],_===void 0)return this;if(_===E||_.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete L[y],L.removeListener&&this.emit("removeListener",y,_.listener||E));else if(typeof _!="function"){for(I=-1,b=_.length-1;b>=0;b--)if(_[b]===E||_[b].listener===E){R=_[b].listener,I=b;break}if(I<0)return this;I===0?_.shift():s(_,I),_.length===1&&(L[y]=_[0]),L.removeListener!==void 0&&this.emit("removeListener",y,R||E)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(y){var E,_,L;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[y]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[y]),this;if(arguments.length===0){var I=Object.keys(_),b;for(L=0;L<I.length;++L)b=I[L],b!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=_[y],typeof E=="function")this.removeListener(y,E);else if(E!==void 0)for(L=E.length-1;L>=0;L--)this.removeListener(y,E[L]);return this};function t(D,y,E){var _=D._events;if(_===void 0)return[];var L=_[y];return L===void 0?[]:typeof L=="function"?E?[L.listener||L]:[L]:E?l(L):e(L,L.length)}n.prototype.listeners=function(y){return t(this,y,!0)},n.prototype.rawListeners=function(y){return t(this,y,!1)},n.listenerCount=function(D,y){return typeof D.listenerCount=="function"?D.listenerCount(y):i.call(D,y)},n.prototype.listenerCount=i;function i(D){var y=this._events;if(y!==void 0){var E=y[D];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?T(this._events):[]};function e(D,y){for(var E=new Array(y),_=0;_<y;++_)E[_]=D[_];return E}function s(D,y){for(;y+1<D.length;y++)D[y]=D[y+1];D.pop()}function l(D){for(var y=new Array(D.length),E=0;E<y.length;++E)y[E]=D[E].listener||D[E];return y}function a(D,y){return new Promise(function(E,_){function L(b){D.removeListener(y,I),_(b)}function I(){typeof D.removeListener=="function"&&D.removeListener("error",L),E([].slice.call(arguments))}A(D,y,I,{once:!0}),y!=="error"&&g(D,L,{once:!0})})}function g(D,y,E){typeof D.on=="function"&&A(D,"error",y,E)}function A(D,y,E,_){if(typeof D.on=="function")_.once?D.once(y,E):D.on(y,E);else if(typeof D.addEventListener=="function")D.addEventListener(y,function L(I){_.once&&D.removeEventListener(y,L),E(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof D)}},"./node_modules/webworkify-webpack/index.js":function(h,m,M){function T(u){var r={};function t(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return u[e].call(s.exports,s,s.exports,t),s.l=!0,s.exports}t.m=u,t.c=r,t.i=function(e){return e},t.d=function(e,s,l){t.o(e,s)||Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:l})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="/",t.oe=function(e){throw console.error(e),e};var i=t(t.s=ENTRY_MODULE);return i.default||i}var p="[\\.|\\-|\\+|\\w|/|@]+",f="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function n(u){return(u+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(u){return!isNaN(1*u)}function o(u,r,t){var i={};i[t]=[];var e=r.toString(),s=e.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return i;for(var l=s[1],a=new RegExp("(\\\\n|\\W)"+n(l)+f,"g"),g;g=a.exec(e);)g[3]!=="dll-reference"&&i[t].push(g[3]);for(a=new RegExp("\\("+n(l)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+f,"g");g=a.exec(e);)u[g[2]]||(i[t].push(g[1]),u[g[2]]=M(g[1]).m),i[g[2]]=i[g[2]]||[],i[g[2]].push(g[4]);for(var A=Object.keys(i),D=0;D<A.length;D++)for(var y=0;y<i[A[D]].length;y++)d(i[A[D]][y])&&(i[A[D]][y]=1*i[A[D]][y]);return i}function v(u){var r=Object.keys(u);return r.reduce(function(t,i){return t||u[i].length>0},!1)}function c(u,r){for(var t={main:[r]},i={main:[]},e={main:{}};v(t);)for(var s=Object.keys(t),l=0;l<s.length;l++){var a=s[l],g=t[a],A=g.pop();if(e[a]=e[a]||{},!(e[a][A]||!u[a][A])){e[a][A]=!0,i[a]=i[a]||[],i[a].push(A);for(var D=o(u,u[a][A],a),y=Object.keys(D),E=0;E<y.length;E++)t[y[E]]=t[y[E]]||[],t[y[E]]=t[y[E]].concat(D[y[E]])}}return i}h.exports=function(u,r){r=r||{};var t={main:M.m},i=r.all?{main:Object.keys(t.main)}:c(t,u),e="";Object.keys(i).filter(function(A){return A!=="main"}).forEach(function(A){for(var D=0;i[A][D];)D++;i[A].push(D),t[A][D]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",e=e+"var "+A+" = ("+T.toString().replace("ENTRY_MODULE",JSON.stringify(D))+")({"+i[A].map(function(y){return""+JSON.stringify(y)+": "+t[A][y].toString()}).join(",")+`});
`}),e=e+"new (("+T.toString().replace("ENTRY_MODULE",JSON.stringify(u))+")({"+i.main.map(function(A){return""+JSON.stringify(A)+": "+t.main[A].toString()}).join(",")+"}))(self);";var s=new window.Blob([e],{type:"text/javascript"});if(r.bare)return s;var l=window.URL||window.webkitURL||window.mozURL||window.msURL,a=l.createObjectURL(s),g=new window.Worker(a);return g.objectURL=a,g}},"./src/config.js":function(h,m,M){M.r(m),M.d(m,{defaultConfig:function(){return T},createDefaultConfig:function(){return p}});var T={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function p(){return Object.assign({},T)}},"./src/core/features.js":function(h,m,M){M.r(m);var T=M("./src/io/io-controller.js"),p=M("./src/config.js"),f=function(){function n(){}return n.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},n.supportNetworkStreamIO=function(){var d=new T.default({},(0,p.createDefaultConfig)()),o=d.loaderType;return d.destroy(),o=="fetch-stream-loader"||o=="xhr-moz-chunked-loader"},n.getNetworkLoaderTypeName=function(){var d=new T.default({},(0,p.createDefaultConfig)()),o=d.loaderType;return d.destroy(),o},n.supportNativeMediaPlayback=function(d){n.videoElement==null&&(n.videoElement=window.document.createElement("video"));var o=n.videoElement.canPlayType(d);return o==="probably"||o=="maybe"},n.getFeatureList=function(){var d={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return d.mseFlvPlayback=n.supportMSEH264Playback(),d.networkStreamIO=n.supportNetworkStreamIO(),d.networkLoaderName=n.getNetworkLoaderTypeName(),d.mseLiveFlvPlayback=d.mseFlvPlayback&&d.networkStreamIO,d.nativeMP4H264Playback=n.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),d.nativeWebmVP8Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),d.nativeWebmVP9Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp9"'),d},n}();m.default=f},"./src/core/media-info.js":function(h,m,M){M.r(m);var T=function(){function p(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return p.prototype.isComplete=function(){var f=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,n=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&f&&n},p.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},p.prototype.getNearestKeyframe=function(f){if(this.keyframesIndex==null)return null;var n=this.keyframesIndex,d=this._search(n.times,f);return{index:d,milliseconds:n.times[d],fileposition:n.filepositions[d]}},p.prototype._search=function(f,n){var d=0,o=f.length-1,v=0,c=0,u=o;for(n<f[0]&&(d=0,c=u+1);c<=u;)if(v=c+Math.floor((u-c)/2),v===o||n>=f[v]&&n<f[v+1]){d=v;break}else f[v]<n?c=v+1:u=v-1;return d},p}();m.default=T},"./src/core/media-segment-info.js":function(h,m,M){M.r(m),M.d(m,{SampleInfo:function(){return T},MediaSegmentInfo:function(){return p},IDRSampleList:function(){return f},MediaSegmentInfoList:function(){return n}});var T=function(){function d(o,v,c,u,r){this.dts=o,this.pts=v,this.duration=c,this.originalDts=u,this.isSyncPoint=r,this.fileposition=null}return d}(),p=function(){function d(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return d.prototype.appendSyncPoint=function(o){o.isSyncPoint=!0,this.syncPoints.push(o)},d}(),f=function(){function d(){this._list=[]}return d.prototype.clear=function(){this._list=[]},d.prototype.appendArray=function(o){var v=this._list;o.length!==0&&(v.length>0&&o[0].originalDts<v[v.length-1].originalDts&&this.clear(),Array.prototype.push.apply(v,o))},d.prototype.getLastSyncPointBeforeDts=function(o){if(this._list.length==0)return null;var v=this._list,c=0,u=v.length-1,r=0,t=0,i=u;for(o<v[0].dts&&(c=0,t=i+1);t<=i;)if(r=t+Math.floor((i-t)/2),r===u||o>=v[r].dts&&o<v[r+1].dts){c=r;break}else v[r].dts<o?t=r+1:i=r-1;return this._list[c]},d}(),n=function(){function d(o){this._type=o,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(d.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),d.prototype.isEmpty=function(){return this._list.length===0},d.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},d.prototype._searchNearestSegmentBefore=function(o){var v=this._list;if(v.length===0)return-2;var c=v.length-1,u=0,r=0,t=c,i=0;if(o<v[0].originalBeginDts)return i=-1,i;for(;r<=t;)if(u=r+Math.floor((t-r)/2),u===c||o>v[u].lastSample.originalDts&&o<v[u+1].originalBeginDts){i=u;break}else v[u].originalBeginDts<o?r=u+1:t=u-1;return i},d.prototype._searchNearestSegmentAfter=function(o){return this._searchNearestSegmentBefore(o)+1},d.prototype.append=function(o){var v=this._list,c=o,u=this._lastAppendLocation,r=0;u!==-1&&u<v.length&&c.originalBeginDts>=v[u].lastSample.originalDts&&(u===v.length-1||u<v.length-1&&c.originalBeginDts<v[u+1].originalBeginDts)?r=u+1:v.length>0&&(r=this._searchNearestSegmentBefore(c.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,c)},d.prototype.getLastSegmentBefore=function(o){var v=this._searchNearestSegmentBefore(o);return v>=0?this._list[v]:null},d.prototype.getLastSampleBefore=function(o){var v=this.getLastSegmentBefore(o);return v!=null?v.lastSample:null},d.prototype.getLastSyncPointBefore=function(o){for(var v=this._searchNearestSegmentBefore(o),c=this._list[v].syncPoints;c.length===0&&v>0;)v--,c=this._list[v].syncPoints;return c.length>0?c[c.length-1]:null},d}()},"./src/core/mse-controller.js":function(h,m,M){M.r(m);var T=M("./node_modules/events/events.js"),p=M.n(T),f=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),d=M("./src/core/mse-events.js"),o=M("./src/core/media-segment-info.js"),v=M("./src/utils/exception.js"),c=function(){function u(r){this.TAG="MSEController",this._config=r,this._emitter=new(p()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new o.IDRSampleList}return u.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},u.prototype.on=function(r,t){this._emitter.addListener(r,t)},u.prototype.off=function(r,t){this._emitter.removeListener(r,t)},u.prototype.attachMediaElement=function(r){if(this._mediaSource)throw new v.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=r,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),r.src=this._mediaSourceObjectURL},u.prototype.detachMediaElement=function(){if(this._mediaSource){var r=this._mediaSource;for(var t in this._sourceBuffers){var i=this._pendingSegments[t];i.splice(0,i.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var e=this._sourceBuffers[t];if(e){if(r.readyState!=="closed"){try{r.removeSourceBuffer(e)}catch(s){f.default.e(this.TAG,s.message)}e.removeEventListener("error",this.e.onSourceBufferError),e.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if(r.readyState==="open")try{r.endOfStream()}catch(s){f.default.e(this.TAG,s.message)}r.removeEventListener("sourceopen",this.e.onSourceOpen),r.removeEventListener("sourceended",this.e.onSourceEnded),r.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},u.prototype.appendInitSegment=function(r,t){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(r),this._pendingSegments[r.type].push(r);return}var i=r,e=""+i.container;i.codec&&i.codec.length>0&&(e+=";codecs="+i.codec);var s=!1;if(f.default.v(this.TAG,"Received Initialization Segment, mimeType: "+e),this._lastInitSegments[i.type]=i,e!==this._mimeTypes[i.type]){if(this._mimeTypes[i.type])f.default.v(this.TAG,"Notice: "+i.type+" mimeType changed, origin: "+this._mimeTypes[i.type]+", target: "+e);else{s=!0;try{var l=this._sourceBuffers[i.type]=this._mediaSource.addSourceBuffer(e);l.addEventListener("error",this.e.onSourceBufferError),l.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(a){f.default.e(this.TAG,a.message),this._emitter.emit(d.default.ERROR,{code:a.code,msg:a.message});return}}this._mimeTypes[i.type]=e}t||this._pendingSegments[i.type].push(i),s||this._sourceBuffers[i.type]&&!this._sourceBuffers[i.type].updating&&this._doAppendSegments(),n.default.safari&&i.container==="audio/mpeg"&&i.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=i.mediaDuration/1e3,this._updateMediaSourceDuration())},u.prototype.appendMediaSegment=function(r){var t=r;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var i=this._sourceBuffers[t.type];i&&!i.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},u.prototype.seek=function(r){for(var t in this._sourceBuffers)if(!!this._sourceBuffers[t]){var i=this._sourceBuffers[t];if(this._mediaSource.readyState==="open")try{i.abort()}catch(A){f.default.e(this.TAG,A.message)}this._idrList.clear();var e=this._pendingSegments[t];if(e.splice(0,e.length),this._mediaSource.readyState!=="closed"){for(var s=0;s<i.buffered.length;s++){var l=i.buffered.start(s),a=i.buffered.end(s);this._pendingRemoveRanges[t].push({start:l,end:a})}if(i.updating||this._doRemoveRanges(),n.default.safari){var g=this._lastInitSegments[t];g&&(this._pendingSegments[t].push(g),i.updating||this._doAppendSegments())}}}},u.prototype.endOfStream=function(){var r=this._mediaSource,t=this._sourceBuffers;if(!r||r.readyState!=="open"){r&&r.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,r.endOfStream())},u.prototype.getNearestKeyframe=function(r){return this._idrList.getLastSyncPointBeforeDts(r)},u.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var r=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){var e=i.buffered;if(e.length>=1&&r-e.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},u.prototype._doCleanupSourceBuffer=function(){var r=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){for(var e=i.buffered,s=!1,l=0;l<e.length;l++){var a=e.start(l),g=e.end(l);if(a<=r&&r<g+3){if(r-a>=this._config.autoCleanupMaxBackwardDuration){s=!0;var A=r-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:a,end:A})}}else g<r&&(s=!0,this._pendingRemoveRanges[t].push({start:a,end:g}))}s&&!i.updating&&this._doRemoveRanges()}}},u.prototype._updateMediaSourceDuration=function(){var r=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(r.video&&r.video.updating||r.audio&&r.audio.updating)){var t=this._mediaSource.duration,i=this._pendingMediaDuration;i>0&&(isNaN(t)||i>t)&&(f.default.v(this.TAG,"Update MediaSource duration from "+t+" to "+i),this._mediaSource.duration=i),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},u.prototype._doRemoveRanges=function(){for(var r in this._pendingRemoveRanges)if(!(!this._sourceBuffers[r]||this._sourceBuffers[r].updating))for(var t=this._sourceBuffers[r],i=this._pendingRemoveRanges[r];i.length&&!t.updating;){var e=i.shift();t.remove(e.start,e.end)}},u.prototype._doAppendSegments=function(){var r=this._pendingSegments;for(var t in r)if(!(!this._sourceBuffers[t]||this._sourceBuffers[t].updating)&&r[t].length>0){var i=r[t].shift();if(i.timestampOffset){var e=this._sourceBuffers[t].timestampOffset,s=i.timestampOffset/1e3,l=Math.abs(e-s);l>.1&&(f.default.v(this.TAG,"Update MPEG audio timestampOffset from "+e+" to "+s),this._sourceBuffers[t].timestampOffset=s),delete i.timestampOffset}if(!i.data||i.data.byteLength===0)continue;try{this._sourceBuffers[t].appendBuffer(i.data),this._isBufferFull=!1,t==="video"&&i.hasOwnProperty("info")&&this._idrList.appendArray(i.info.syncPoints)}catch(a){this._pendingSegments[t].unshift(i),a.code===22?(this._isBufferFull||this._emitter.emit(d.default.BUFFER_FULL),this._isBufferFull=!0):(f.default.e(this.TAG,a.message),this._emitter.emit(d.default.ERROR,{code:a.code,msg:a.message}))}}},u.prototype._onSourceOpen=function(){if(f.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var r=this._pendingSourceBufferInit;r.length;){var t=r.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(d.default.SOURCE_OPEN)},u.prototype._onSourceEnded=function(){f.default.v(this.TAG,"MediaSource onSourceEnded")},u.prototype._onSourceClose=function(){f.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},u.prototype._hasPendingSegments=function(){var r=this._pendingSegments;return r.video.length>0||r.audio.length>0},u.prototype._hasPendingRemoveRanges=function(){var r=this._pendingRemoveRanges;return r.video.length>0||r.audio.length>0},u.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(d.default.UPDATE_END)},u.prototype._onSourceBufferError=function(r){f.default.e(this.TAG,"SourceBuffer Error: "+r)},u}();m.default=c},"./src/core/mse-events.js":function(h,m,M){M.r(m);var T={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};m.default=T},"./src/core/transmuxer.js":function(h,m,M){M.r(m);var T=M("./node_modules/events/events.js"),p=M.n(T),f=M("./node_modules/webworkify-webpack/index.js"),n=M.n(f),d=M("./src/utils/logger.js"),o=M("./src/utils/logging-control.js"),v=M("./src/core/transmuxing-controller.js"),c=M("./src/core/transmuxing-events.js"),u=M("./src/core/media-info.js"),r=function(){function t(i,e){if(this.TAG="Transmuxer",this._emitter=new(p()),e.enableWorker&&typeof Worker!="undefined")try{this._worker=n()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[i,e]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},o.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:o.default.getConfig()})}catch{d.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new v.default(i,e)}else this._controller=new v.default(i,e);if(this._controller){var s=this._controller;s.on(c.default.IO_ERROR,this._onIOError.bind(this)),s.on(c.default.DEMUX_ERROR,this._onDemuxError.bind(this)),s.on(c.default.INIT_SEGMENT,this._onInitSegment.bind(this)),s.on(c.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),s.on(c.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),s.on(c.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),s.on(c.default.MEDIA_INFO,this._onMediaInfo.bind(this)),s.on(c.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),s.on(c.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),s.on(c.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),s.on(c.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return t.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),o.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},t.prototype.on=function(i,e){this._emitter.addListener(i,e)},t.prototype.off=function(i,e){this._emitter.removeListener(i,e)},t.prototype.hasWorker=function(){return this._worker!=null},t.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},t.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},t.prototype.seek=function(i){this._worker?this._worker.postMessage({cmd:"seek",param:i}):this._controller.seek(i)},t.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},t.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},t.prototype._onInitSegment=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(c.default.INIT_SEGMENT,i,e)})},t.prototype._onMediaSegment=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(c.default.MEDIA_SEGMENT,i,e)})},t.prototype._onLoadingComplete=function(){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.LOADING_COMPLETE)})},t.prototype._onRecoveredEarlyEof=function(){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.RECOVERED_EARLY_EOF)})},t.prototype._onMediaInfo=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(c.default.MEDIA_INFO,i)})},t.prototype._onMetaDataArrived=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(c.default.METADATA_ARRIVED,i)})},t.prototype._onScriptDataArrived=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(c.default.SCRIPTDATA_ARRIVED,i)})},t.prototype._onStatisticsInfo=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(c.default.STATISTICS_INFO,i)})},t.prototype._onIOError=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(c.default.IO_ERROR,i,e)})},t.prototype._onDemuxError=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(c.default.DEMUX_ERROR,i,e)})},t.prototype._onRecommendSeekpoint=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(c.default.RECOMMEND_SEEKPOINT,i)})},t.prototype._onLoggingConfigChanged=function(i){this._worker&&this._worker.postMessage({cmd:"logging_config",param:i})},t.prototype._onWorkerMessage=function(i){var e=i.data,s=e.data;if(e.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(e.msg){case c.default.INIT_SEGMENT:case c.default.MEDIA_SEGMENT:this._emitter.emit(e.msg,s.type,s.data);break;case c.default.LOADING_COMPLETE:case c.default.RECOVERED_EARLY_EOF:this._emitter.emit(e.msg);break;case c.default.MEDIA_INFO:Object.setPrototypeOf(s,u.default.prototype),this._emitter.emit(e.msg,s);break;case c.default.METADATA_ARRIVED:case c.default.SCRIPTDATA_ARRIVED:case c.default.STATISTICS_INFO:this._emitter.emit(e.msg,s);break;case c.default.IO_ERROR:case c.default.DEMUX_ERROR:this._emitter.emit(e.msg,s.type,s.info);break;case c.default.RECOMMEND_SEEKPOINT:this._emitter.emit(e.msg,s);break;case"logcat_callback":d.default.emitter.emit("log",s.type,s.logcat);break}},t}();m.default=r},"./src/core/transmuxing-controller.js":function(h,m,M){M.r(m);var T=M("./node_modules/events/events.js"),p=M.n(T),f=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),d=M("./src/core/media-info.js"),o=M("./src/demux/flv-demuxer.js"),v=M("./src/remux/mp4-remuxer.js"),c=M("./src/demux/demux-errors.js"),u=M("./src/io/io-controller.js"),r=M("./src/core/transmuxing-events.js"),t=function(){function i(e,s){this.TAG="TransmuxingController",this._emitter=new(p()),this._config=s,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),typeof e.cors!="boolean"&&(e.cors=!0),typeof e.withCredentials!="boolean"&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var l=0;this._mediaDataSource.segments.forEach(function(a){a.timestampBase=l,l+=a.duration,a.cors=e.cors,a.withCredentials=e.withCredentials,s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy)}),!isNaN(l)&&this._mediaDataSource.duration!==l&&(this._mediaDataSource.duration=l),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return i.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},i.prototype.on=function(e,s){this._emitter.addListener(e,s)},i.prototype.off=function(e,s){this._emitter.removeListener(e,s)},i.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},i.prototype._loadSegment=function(e,s){this._currentSegmentIndex=e;var l=this._mediaDataSource.segments[e],a=this._ioctl=new u.default(l,this._config,e);a.onError=this._onIOException.bind(this),a.onSeeked=this._onIOSeeked.bind(this),a.onComplete=this._onIOComplete.bind(this),a.onRedirect=this._onIORedirect.bind(this),a.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),s?this._demuxer.bindDataSource(this._ioctl):a.onDataArrival=this._onInitChunkArrival.bind(this),a.open(s)},i.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},i.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},i.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},i.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},i.prototype.seek=function(e){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var s=this._searchSegmentIndexContains(e);if(s===this._currentSegmentIndex){var l=this._mediaInfo.segments[s];if(l==null)this._pendingSeekTime=e;else{var a=l.getNearestKeyframe(e);this._remuxer.seek(a.milliseconds),this._ioctl.seek(a.fileposition),this._pendingResolveSeekPoint=a.milliseconds}}else{var g=this._mediaInfo.segments[s];if(g==null)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(s);else{var a=g.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[s].timestampBase,this._loadSegment(s,a.fileposition),this._pendingResolveSeekPoint=a.milliseconds,this._reportSegmentMediaInfo(s)}}this._enableStatisticsReporter()}},i.prototype._searchSegmentIndexContains=function(e){for(var s=this._mediaDataSource.segments,l=s.length-1,a=0;a<s.length;a++)if(e<s[a].timestampBase){l=a-1;break}return l},i.prototype._onInitChunkArrival=function(e,s){var l=this,a=null,g=0;if(s>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,g=this._demuxer.parseChunks(e,s);else if((a=o.default.probe(e)).match){this._demuxer=new o.default(a,this._config),this._remuxer||(this._remuxer=new v.default(this._config));var A=this._mediaDataSource;A.duration!=null&&!isNaN(A.duration)&&(this._demuxer.overridedDuration=A.duration),typeof A.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=A.hasAudio),typeof A.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=A.hasVideo),this._demuxer.timestampBase=A.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),g=this._demuxer.parseChunks(e,s)}else a=null,f.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){l._internalAbort()}),this._emitter.emit(r.default.DEMUX_ERROR,c.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),g=0;return g},i.prototype._onMediaInfo=function(e){var s=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,d.default.prototype));var l=Object.assign({},e);Object.setPrototypeOf(l,d.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=l,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var a=s._pendingSeekTime;s._pendingSeekTime=null,s.seek(a)})},i.prototype._onMetaDataArrived=function(e){this._emitter.emit(r.default.METADATA_ARRIVED,e)},i.prototype._onScriptDataArrived=function(e){this._emitter.emit(r.default.SCRIPTDATA_ARRIVED,e)},i.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},i.prototype._onIOComplete=function(e){var s=e,l=s+1;l<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(l)):(this._remuxer.flushStashedSamples(),this._emitter.emit(r.default.LOADING_COMPLETE),this._disableStatisticsReporter())},i.prototype._onIORedirect=function(e){var s=this._ioctl.extraData;this._mediaDataSource.segments[s].redirectedURL=e},i.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(r.default.RECOVERED_EARLY_EOF)},i.prototype._onIOException=function(e,s){f.default.e(this.TAG,"IOException: type = "+e+", code = "+s.code+", msg = "+s.msg),this._emitter.emit(r.default.IO_ERROR,e,s),this._disableStatisticsReporter()},i.prototype._onDemuxException=function(e,s){f.default.e(this.TAG,"DemuxException: type = "+e+", info = "+s),this._emitter.emit(r.default.DEMUX_ERROR,e,s)},i.prototype._onRemuxerInitSegmentArrival=function(e,s){this._emitter.emit(r.default.INIT_SEGMENT,e,s)},i.prototype._onRemuxerMediaSegmentArrival=function(e,s){if(this._pendingSeekTime==null&&(this._emitter.emit(r.default.MEDIA_SEGMENT,e,s),this._pendingResolveSeekPoint!=null&&e==="video")){var l=s.info.syncPoints,a=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,n.default.safari&&l.length>0&&l[0].originalDts===a&&(a=l[0].pts),this._emitter.emit(r.default.RECOMMEND_SEEKPOINT,a)}},i.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},i.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},i.prototype._reportSegmentMediaInfo=function(e){var s=this._mediaInfo.segments[e],l=Object.assign({},s);l.duration=this._mediaInfo.duration,l.segmentCount=this._mediaInfo.segmentCount,delete l.segments,delete l.keyframesIndex,this._emitter.emit(r.default.MEDIA_INFO,l)},i.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(r.default.STATISTICS_INFO,e)},i}();m.default=t},"./src/core/transmuxing-events.js":function(h,m,M){M.r(m);var T={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};m.default=T},"./src/core/transmuxing-worker.js":function(h,m,M){M.r(m);var T=M("./src/utils/logging-control.js"),p=M("./src/utils/polyfill.js"),f=M("./src/core/transmuxing-controller.js"),n=M("./src/core/transmuxing-events.js"),d=function(o){var v=null,c=y.bind(this);p.default.install(),o.addEventListener("message",function(E){switch(E.data.cmd){case"init":v=new f.default(E.data.param[0],E.data.param[1]),v.on(n.default.IO_ERROR,g.bind(this)),v.on(n.default.DEMUX_ERROR,A.bind(this)),v.on(n.default.INIT_SEGMENT,u.bind(this)),v.on(n.default.MEDIA_SEGMENT,r.bind(this)),v.on(n.default.LOADING_COMPLETE,t.bind(this)),v.on(n.default.RECOVERED_EARLY_EOF,i.bind(this)),v.on(n.default.MEDIA_INFO,e.bind(this)),v.on(n.default.METADATA_ARRIVED,s.bind(this)),v.on(n.default.SCRIPTDATA_ARRIVED,l.bind(this)),v.on(n.default.STATISTICS_INFO,a.bind(this)),v.on(n.default.RECOMMEND_SEEKPOINT,D.bind(this));break;case"destroy":v&&(v.destroy(),v=null),o.postMessage({msg:"destroyed"});break;case"start":v.start();break;case"stop":v.stop();break;case"seek":v.seek(E.data.param);break;case"pause":v.pause();break;case"resume":v.resume();break;case"logging_config":{var _=E.data.param;T.default.applyConfig(_),_.enableCallback===!0?T.default.addLogListener(c):T.default.removeLogListener(c);break}}});function u(E,_){var L={msg:n.default.INIT_SEGMENT,data:{type:E,data:_}};o.postMessage(L,[_.data])}function r(E,_){var L={msg:n.default.MEDIA_SEGMENT,data:{type:E,data:_}};o.postMessage(L,[_.data])}function t(){var E={msg:n.default.LOADING_COMPLETE};o.postMessage(E)}function i(){var E={msg:n.default.RECOVERED_EARLY_EOF};o.postMessage(E)}function e(E){var _={msg:n.default.MEDIA_INFO,data:E};o.postMessage(_)}function s(E){var _={msg:n.default.METADATA_ARRIVED,data:E};o.postMessage(_)}function l(E){var _={msg:n.default.SCRIPTDATA_ARRIVED,data:E};o.postMessage(_)}function a(E){var _={msg:n.default.STATISTICS_INFO,data:E};o.postMessage(_)}function g(E,_){o.postMessage({msg:n.default.IO_ERROR,data:{type:E,info:_}})}function A(E,_){o.postMessage({msg:n.default.DEMUX_ERROR,data:{type:E,info:_}})}function D(E){o.postMessage({msg:n.default.RECOMMEND_SEEKPOINT,data:E})}function y(E,_){o.postMessage({msg:"logcat_callback",data:{type:E,logcat:_}})}};m.default=d},"./src/demux/amf-parser.js":function(h,m,M){M.r(m);var T=M("./src/utils/logger.js"),p=M("./src/utils/utf8-conv.js"),f=M("./src/utils/exception.js"),n=function(){var o=new ArrayBuffer(2);return new DataView(o).setInt16(0,256,!0),new Int16Array(o)[0]===256}(),d=function(){function o(){}return o.parseScriptData=function(v,c,u){var r={};try{var t=o.parseValue(v,c,u),i=o.parseValue(v,c+t.size,u-t.size);r[t.data]=i.data}catch(e){T.default.e("AMF",e.toString())}return r},o.parseObject=function(v,c,u){if(u<3)throw new f.IllegalStateException("Data not enough when parse ScriptDataObject");var r=o.parseString(v,c,u),t=o.parseValue(v,c+r.size,u-r.size),i=t.objectEnd;return{data:{name:r.data,value:t.data},size:r.size+t.size,objectEnd:i}},o.parseVariable=function(v,c,u){return o.parseObject(v,c,u)},o.parseString=function(v,c,u){if(u<2)throw new f.IllegalStateException("Data not enough when parse String");var r=new DataView(v,c,u),t=r.getUint16(0,!n),i;return t>0?i=(0,p.default)(new Uint8Array(v,c+2,t)):i="",{data:i,size:2+t}},o.parseLongString=function(v,c,u){if(u<4)throw new f.IllegalStateException("Data not enough when parse LongString");var r=new DataView(v,c,u),t=r.getUint32(0,!n),i;return t>0?i=(0,p.default)(new Uint8Array(v,c+4,t)):i="",{data:i,size:4+t}},o.parseDate=function(v,c,u){if(u<10)throw new f.IllegalStateException("Data size invalid when parse Date");var r=new DataView(v,c,u),t=r.getFloat64(0,!n),i=r.getInt16(8,!n);return t+=i*60*1e3,{data:new Date(t),size:8+2}},o.parseValue=function(v,c,u){if(u<1)throw new f.IllegalStateException("Data not enough when parse Value");var r=new DataView(v,c,u),t=1,i=r.getUint8(0),e,s=!1;try{switch(i){case 0:e=r.getFloat64(1,!n),t+=8;break;case 1:{var l=r.getUint8(1);e=!!l,t+=1;break}case 2:{var a=o.parseString(v,c+1,u-1);e=a.data,t+=a.size;break}case 3:{e={};var g=0;for((r.getUint32(u-4,!n)&16777215)===9&&(g=3);t<u-4;){var A=o.parseObject(v,c+t,u-t-g);if(A.objectEnd)break;e[A.data.name]=A.data.value,t+=A.size}if(t<=u-3){var D=r.getUint32(t-1,!n)&16777215;D===9&&(t+=3)}break}case 8:{e={},t+=4;var g=0;for((r.getUint32(u-4,!n)&16777215)===9&&(g=3);t<u-8;){var y=o.parseVariable(v,c+t,u-t-g);if(y.objectEnd)break;e[y.data.name]=y.data.value,t+=y.size}if(t<=u-3){var D=r.getUint32(t-1,!n)&16777215;D===9&&(t+=3)}break}case 9:e=void 0,t=1,s=!0;break;case 10:{e=[];var E=r.getUint32(1,!n);t+=4;for(var _=0;_<E;_++){var L=o.parseValue(v,c+t,u-t);e.push(L.data),t+=L.size}break}case 11:{var I=o.parseDate(v,c+1,u-1);e=I.data,t+=I.size;break}case 12:{var b=o.parseString(v,c+1,u-1);e=b.data,t+=b.size;break}default:t=u,T.default.w("AMF","Unsupported AMF value type "+i)}}catch(R){T.default.e("AMF",R.toString())}return{data:e,size:t,objectEnd:s}},o}();m.default=d},"./src/demux/demux-errors.js":function(h,m,M){M.r(m);var T={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};m.default=T},"./src/demux/exp-golomb.js":function(h,m,M){M.r(m);var T=M("./src/utils/exception.js"),p=function(){function f(n){this.TAG="ExpGolomb",this._buffer=n,this._buffer_index=0,this._total_bytes=n.byteLength,this._total_bits=n.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return f.prototype.destroy=function(){this._buffer=null},f.prototype._fillCurrentWord=function(){var n=this._total_bytes-this._buffer_index;if(n<=0)throw new T.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var d=Math.min(4,n),o=new Uint8Array(4);o.set(this._buffer.subarray(this._buffer_index,this._buffer_index+d)),this._current_word=new DataView(o.buffer).getUint32(0,!1),this._buffer_index+=d,this._current_word_bits_left=d*8},f.prototype.readBits=function(n){if(n>32)throw new T.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(n<=this._current_word_bits_left){var d=this._current_word>>>32-n;return this._current_word<<=n,this._current_word_bits_left-=n,d}var o=this._current_word_bits_left?this._current_word:0;o=o>>>32-this._current_word_bits_left;var v=n-this._current_word_bits_left;this._fillCurrentWord();var c=Math.min(v,this._current_word_bits_left),u=this._current_word>>>32-c;return this._current_word<<=c,this._current_word_bits_left-=c,o=o<<c|u,o},f.prototype.readBool=function(){return this.readBits(1)===1},f.prototype.readByte=function(){return this.readBits(8)},f.prototype._skipLeadingZero=function(){var n;for(n=0;n<this._current_word_bits_left;n++)if((this._current_word&2147483648>>>n)!==0)return this._current_word<<=n,this._current_word_bits_left-=n,n;return this._fillCurrentWord(),n+this._skipLeadingZero()},f.prototype.readUEG=function(){var n=this._skipLeadingZero();return this.readBits(n+1)-1},f.prototype.readSEG=function(){var n=this.readUEG();return n&1?n+1>>>1:-1*(n>>>1)},f}();m.default=p},"./src/demux/flv-demuxer.js":function(h,m,M){M.r(m);var T=M("./src/utils/logger.js"),p=M("./src/demux/amf-parser.js"),f=M("./src/demux/sps-parser.js"),n=M("./src/demux/demux-errors.js"),d=M("./src/core/media-info.js"),o=M("./src/utils/exception.js");function v(u,r){return u[r]<<24|u[r+1]<<16|u[r+2]<<8|u[r+3]}var c=function(){function u(r,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=r.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=r.hasAudioTrack,this._hasVideo=r.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new d.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var i=new ArrayBuffer(2);return new DataView(i).setInt16(0,256,!0),new Int16Array(i)[0]===256}()}return u.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},u.probe=function(r){var t=new Uint8Array(r),i={match:!1};if(t[0]!==70||t[1]!==76||t[2]!==86||t[3]!==1)return i;var e=(t[4]&4)>>>2!==0,s=(t[4]&1)!==0,l=v(t,5);return l<9?i:{match:!0,consumed:l,dataOffset:l,hasAudioTrack:e,hasVideoTrack:s}},u.prototype.bindDataSource=function(r){return r.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(u.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(r){this._onTrackMetadata=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(r){this._onMediaInfo=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(r){this._onMetaDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(r){this._onScriptDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onError",{get:function(){return this._onError},set:function(r){this._onError=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(r){this._onDataAvailable=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(r){this._timestampBase=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"overridedDuration",{get:function(){return this._duration},set:function(r){this._durationOverrided=!0,this._duration=r,this._mediaInfo.duration=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"overridedHasAudio",{set:function(r){this._hasAudioFlagOverrided=!0,this._hasAudio=r,this._mediaInfo.hasAudio=r},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"overridedHasVideo",{set:function(r){this._hasVideoFlagOverrided=!0,this._hasVideo=r,this._mediaInfo.hasVideo=r},enumerable:!1,configurable:!0}),u.prototype.resetMediaInfo=function(){this._mediaInfo=new d.default},u.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},u.prototype.parseChunks=function(r,t){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new o.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=0,e=this._littleEndian;if(t===0)if(r.byteLength>13){var s=u.probe(r);i=s.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,t+i!==this._dataOffset&&T.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var l=new DataView(r,i),a=l.getUint32(0,!e);a!==0&&T.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),i+=4}for(;i<r.byteLength;){this._dispatch=!0;var l=new DataView(r,i);if(i+11+4>r.byteLength)break;var g=l.getUint8(0),A=l.getUint32(0,!e)&16777215;if(i+11+A+4>r.byteLength)break;if(g!==8&&g!==9&&g!==18){T.default.w(this.TAG,"Unsupported tag type "+g+", skipped"),i+=11+A+4;continue}var D=l.getUint8(4),y=l.getUint8(5),E=l.getUint8(6),_=l.getUint8(7),L=E|y<<8|D<<16|_<<24,I=l.getUint32(7,!e)&16777215;I!==0&&T.default.w(this.TAG,"Meet tag which has StreamID != 0!");var b=i+11;switch(g){case 8:this._parseAudioData(r,b,A,L);break;case 9:this._parseVideoData(r,b,A,L,t+i);break;case 18:this._parseScriptData(r,b,A);break}var R=l.getUint32(11+A,!e);R!==11+A&&T.default.w(this.TAG,"Invalid PrevTagSize "+R),i+=11+A+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),i},u.prototype._parseScriptData=function(r,t,i){var e=p.default.parseScriptData(r,t,i);if(e.hasOwnProperty("onMetaData")){if(e.onMetaData==null||typeof e.onMetaData!="object"){T.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&T.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=e;var s=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},s)),typeof s.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=s.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof s.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=s.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof s.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=s.audiodatarate),typeof s.videodatarate=="number"&&(this._mediaInfo.videoDataRate=s.videodatarate),typeof s.width=="number"&&(this._mediaInfo.width=s.width),typeof s.height=="number"&&(this._mediaInfo.height=s.height),typeof s.duration=="number"){if(!this._durationOverrided){var l=Math.floor(s.duration*this._timescale);this._duration=l,this._mediaInfo.duration=l}}else this._mediaInfo.duration=0;if(typeof s.framerate=="number"){var a=Math.floor(s.framerate*1e3);if(a>0){var g=a/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=g,this._referenceFrameRate.fps_num=a,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=g}}if(typeof s.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var A=s.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(A),s.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=s,T.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(e).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},e))},u.prototype._parseKeyframesIndex=function(r){for(var t=[],i=[],e=1;e<r.times.length;e++){var s=this._timestampBase+Math.floor(r.times[e]*1e3);t.push(s),i.push(r.filepositions[e])}return{times:t,filepositions:i}},u.prototype._parseAudioData=function(r,t,i,e){if(i<=1){T.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var s=new DataView(r,t,i),l=s.getUint8(0),a=l>>>4;if(a!==2&&a!==10){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+a);return}var g=0,A=(l&12)>>>2;if(A>=0&&A<=4)g=this._flvSoundRateTable[A];else{this._onError(n.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+A);return}var D=l&1,y=this._audioMetadata,E=this._audioTrack;if(y||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),y=this._audioMetadata={},y.type="audio",y.id=E.id,y.timescale=this._timescale,y.duration=this._duration,y.audioSampleRate=g,y.channelCount=D===0?1:2),a===10){var _=this._parseAACAudioData(r,t+1,i-1);if(_==null)return;if(_.packetType===0){y.config&&T.default.w(this.TAG,"Found another AudioSpecificConfig!");var L=_.data;y.audioSampleRate=L.samplingRate,y.channelCount=L.channelCount,y.codec=L.codec,y.originalCodec=L.originalCodec,y.config=L.config,y.refSampleDuration=1024/y.audioSampleRate*y.timescale,T.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",y);var I=this._mediaInfo;I.audioCodec=y.originalCodec,I.audioSampleRate=y.audioSampleRate,I.audioChannelCount=y.channelCount,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}else if(_.packetType===1){var b=this._timestampBase+e,R={unit:_.data,length:_.data.byteLength,dts:b,pts:b};E.samples.push(R),E.length+=_.data.length}else T.default.e(this.TAG,"Flv: Unsupported AAC data type "+_.packetType)}else if(a===2){if(!y.codec){var L=this._parseMP3AudioData(r,t+1,i-1,!0);if(L==null)return;y.audioSampleRate=L.samplingRate,y.channelCount=L.channelCount,y.codec=L.codec,y.originalCodec=L.originalCodec,y.refSampleDuration=1152/y.audioSampleRate*y.timescale,T.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",y);var I=this._mediaInfo;I.audioCodec=y.codec,I.audioSampleRate=y.audioSampleRate,I.audioChannelCount=y.channelCount,I.audioDataRate=L.bitRate,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}var P=this._parseMP3AudioData(r,t+1,i-1,!1);if(P==null)return;var b=this._timestampBase+e,w={unit:P,length:P.byteLength,dts:b,pts:b};E.samples.push(w),E.length+=P.length}}},u.prototype._parseAACAudioData=function(r,t,i){if(i<=1){T.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var e={},s=new Uint8Array(r,t,i);return e.packetType=s[0],s[0]===0?e.data=this._parseAACAudioSpecificConfig(r,t+1,i-1):e.data=s.subarray(1),e},u.prototype._parseAACAudioSpecificConfig=function(r,t,i){var e=new Uint8Array(r,t,i),s=null,l=0,a=0,g=0,A=null;if(l=a=e[0]>>>3,g=(e[0]&7)<<1|e[1]>>>7,g<0||g>=this._mpegSamplingRates.length){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var D=this._mpegSamplingRates[g],y=(e[1]&120)>>>3;if(y<0||y>=8){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}l===5&&(A=(e[1]&7)<<1|e[2]>>>7,(e[2]&124)>>>2);var E=self.navigator.userAgent.toLowerCase();return E.indexOf("firefox")!==-1?g>=6?(l=5,s=new Array(4),A=g-3):(l=2,s=new Array(2),A=g):E.indexOf("android")!==-1?(l=2,s=new Array(2),A=g):(l=5,A=g,s=new Array(4),g>=6?A=g-3:y===1&&(l=2,s=new Array(2),A=g)),s[0]=l<<3,s[0]|=(g&15)>>>1,s[1]=(g&15)<<7,s[1]|=(y&15)<<3,l===5&&(s[1]|=(A&15)>>>1,s[2]=(A&1)<<7,s[2]|=2<<2,s[3]=0),{config:s,samplingRate:D,channelCount:y,codec:"mp4a.40."+l,originalCodec:"mp4a.40."+a}},u.prototype._parseMP3AudioData=function(r,t,i,e){if(i<4){T.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var s=new Uint8Array(r,t,i),l=null;if(e){if(s[0]!==255)return;var a=s[1]>>>3&3,g=(s[1]&6)>>1,A=(s[2]&240)>>>4,D=(s[2]&12)>>>2,y=s[3]>>>6&3,E=y!==3?2:1,_=0,L=0,I="mp3";switch(a){case 0:_=this._mpegAudioV25SampleRateTable[D];break;case 2:_=this._mpegAudioV20SampleRateTable[D];break;case 3:_=this._mpegAudioV10SampleRateTable[D];break}switch(g){case 1:A<this._mpegAudioL3BitRateTable.length&&(L=this._mpegAudioL3BitRateTable[A]);break;case 2:A<this._mpegAudioL2BitRateTable.length&&(L=this._mpegAudioL2BitRateTable[A]);break;case 3:A<this._mpegAudioL1BitRateTable.length&&(L=this._mpegAudioL1BitRateTable[A]);break}l={bitRate:L,samplingRate:_,channelCount:E,codec:I,originalCodec:I}}else l=s;return l},u.prototype._parseVideoData=function(r,t,i,e,s){if(i<=1){T.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var l=new Uint8Array(r,t,i)[0],a=(l&240)>>>4,g=l&15;if(g!==7){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+g);return}this._parseAVCVideoPacket(r,t+1,i-1,e,s,a)}},u.prototype._parseAVCVideoPacket=function(r,t,i,e,s,l){if(i<4){T.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var a=this._littleEndian,g=new DataView(r,t,i),A=g.getUint8(0),D=g.getUint32(0,!a)&16777215,y=D<<8>>8;if(A===0)this._parseAVCDecoderConfigurationRecord(r,t+4,i-4);else if(A===1)this._parseAVCVideoData(r,t+4,i-4,e,s,l,y);else if(A!==2){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid video packet type "+A);return}},u.prototype._parseAVCDecoderConfigurationRecord=function(r,t,i){if(i<7){T.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var e=this._videoMetadata,s=this._videoTrack,l=this._littleEndian,a=new DataView(r,t,i);e?typeof e.avcc!="undefined"&&T.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),e=this._videoMetadata={},e.type="video",e.id=s.id,e.timescale=this._timescale,e.duration=this._duration);var g=a.getUint8(0),A=a.getUint8(1);if(a.getUint8(2),a.getUint8(3),g!==1||A===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(a.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(n.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var D=a.getUint8(5)&31;if(D===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else D>1&&T.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+D);for(var y=6,E=0;E<D;E++){var _=a.getUint16(y,!l);if(y+=2,_!==0){var L=new Uint8Array(r,t+y,_);y+=_;var I=f.default.parseSPS(L);if(E===0){e.codecWidth=I.codec_size.width,e.codecHeight=I.codec_size.height,e.presentWidth=I.present_size.width,e.presentHeight=I.present_size.height,e.profile=I.profile_string,e.level=I.level_string,e.bitDepth=I.bit_depth,e.chromaFormat=I.chroma_format,e.sarRatio=I.sar_ratio,e.frameRate=I.frame_rate,(I.frame_rate.fixed===!1||I.frame_rate.fps_num===0||I.frame_rate.fps_den===0)&&(e.frameRate=this._referenceFrameRate);var b=e.frameRate.fps_den,R=e.frameRate.fps_num;e.refSampleDuration=e.timescale*(b/R);for(var P=L.subarray(1,4),w="avc1.",F=0;F<3;F++){var k=P[F].toString(16);k.length<2&&(k="0"+k),w+=k}e.codec=w;var B=this._mediaInfo;B.width=e.codecWidth,B.height=e.codecHeight,B.fps=e.frameRate.fps,B.profile=e.profile,B.level=e.level,B.refFrames=I.ref_frames,B.chromaFormat=I.chroma_format_string,B.sarNum=e.sarRatio.width,B.sarDen=e.sarRatio.height,B.videoCodec=w,B.hasAudio?B.audioCodec!=null&&(B.mimeType='video/x-flv; codecs="'+B.videoCodec+","+B.audioCodec+'"'):B.mimeType='video/x-flv; codecs="'+B.videoCodec+'"',B.isComplete()&&this._onMediaInfo(B)}}}var U=a.getUint8(y);if(U===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else U>1&&T.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+U);y++;for(var E=0;E<U;E++){var _=a.getUint16(y,!l);y+=2,_!==0&&(y+=_)}e.avcc=new Uint8Array(i),e.avcc.set(new Uint8Array(r,t,i),0),T.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",e)},u.prototype._parseAVCVideoData=function(r,t,i,e,s,l,a){for(var g=this._littleEndian,A=new DataView(r,t,i),D=[],y=0,E=0,_=this._naluLengthSize,L=this._timestampBase+e,I=l===1;E<i;){if(E+4>=i){T.default.w(this.TAG,"Malformed Nalu near timestamp "+L+", offset = "+E+", dataSize = "+i);break}var b=A.getUint32(E,!g);if(_===3&&(b>>>=8),b>i-_){T.default.w(this.TAG,"Malformed Nalus near timestamp "+L+", NaluSize > DataSize!");return}var R=A.getUint8(E+_)&31;R===5&&(I=!0);var P=new Uint8Array(r,t+E,_+b),w={type:R,data:P};D.push(w),y+=P.byteLength,E+=_+b}if(D.length){var F=this._videoTrack,k={units:D,length:y,isKeyframe:I,dts:L,cts:a,pts:L+a};I&&(k.fileposition=s),F.samples.push(k),F.length+=y}},u}();m.default=c},"./src/demux/sps-parser.js":function(h,m,M){M.r(m);var T=M("./src/demux/exp-golomb.js"),p=function(){function f(){}return f._ebsp2rbsp=function(n){for(var d=n,o=d.byteLength,v=new Uint8Array(o),c=0,u=0;u<o;u++)u>=2&&d[u]===3&&d[u-1]===0&&d[u-2]===0||(v[c]=d[u],c++);return new Uint8Array(v.buffer,0,c)},f.parseSPS=function(n){var d=f._ebsp2rbsp(n),o=new T.default(d);o.readByte();var v=o.readByte();o.readByte();var c=o.readByte();o.readUEG();var u=f.getProfileString(v),r=f.getLevelString(c),t=1,i=420,e=[0,420,422,444],s=8;if((v===100||v===110||v===122||v===244||v===44||v===83||v===86||v===118||v===128||v===138||v===144)&&(t=o.readUEG(),t===3&&o.readBits(1),t<=3&&(i=e[t]),s=o.readUEG()+8,o.readUEG(),o.readBits(1),o.readBool()))for(var l=t!==3?8:12,a=0;a<l;a++)o.readBool()&&(a<6?f._skipScalingList(o,16):f._skipScalingList(o,64));o.readUEG();var g=o.readUEG();if(g===0)o.readUEG();else if(g===1){o.readBits(1),o.readSEG(),o.readSEG();for(var A=o.readUEG(),a=0;a<A;a++)o.readSEG()}var D=o.readUEG();o.readBits(1);var y=o.readUEG(),E=o.readUEG(),_=o.readBits(1);_===0&&o.readBits(1),o.readBits(1);var L=0,I=0,b=0,R=0,P=o.readBool();P&&(L=o.readUEG(),I=o.readUEG(),b=o.readUEG(),R=o.readUEG());var w=1,F=1,k=0,B=!0,U=0,j=0,K=o.readBool();if(K){if(o.readBool()){var N=o.readByte(),Z=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],X=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];N>0&&N<16?(w=Z[N-1],F=X[N-1]):N===255&&(w=o.readByte()<<8|o.readByte(),F=o.readByte()<<8|o.readByte())}if(o.readBool()&&o.readBool(),o.readBool()&&(o.readBits(4),o.readBool()&&o.readBits(24)),o.readBool()&&(o.readUEG(),o.readUEG()),o.readBool()){var Y=o.readBits(32),ee=o.readBits(32);B=o.readBool(),U=ee,j=Y*2,k=U/j}}var Q=1;(w!==1||F!==1)&&(Q=w/F);var G=0,q=0;if(t===0)G=1,q=2-_;else{var te=t===3?1:2,ie=t===1?2:1;G=te,q=ie*(2-_)}var ne=(y+1)*16,le=(2-_)*((E+1)*16);ne-=(L+I)*G,le-=(b+R)*q;var se=Math.ceil(ne*Q);return o.destroy(),o=null,{profile_string:u,level_string:r,bit_depth:s,ref_frames:D,chroma_format:i,chroma_format_string:f.getChromaFormatString(i),frame_rate:{fixed:B,fps:k,fps_den:j,fps_num:U},sar_ratio:{width:w,height:F},codec_size:{width:ne,height:le},present_size:{width:se,height:le}}},f._skipScalingList=function(n,d){for(var o=8,v=8,c=0,u=0;u<d;u++)v!==0&&(c=n.readSEG(),v=(o+c+256)%256),o=v===0?o:v},f.getProfileString=function(n){switch(n){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},f.getLevelString=function(n){return(n/10).toFixed(1)},f.getChromaFormatString=function(n){switch(n){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},f}();m.default=p},"./src/flv.js":function(h,m,M){M.r(m);var T=M("./src/utils/polyfill.js"),p=M("./src/core/features.js"),f=M("./src/io/loader.js"),n=M("./src/player/flv-player.js"),d=M("./src/player/native-player.js"),o=M("./src/player/player-events.js"),v=M("./src/player/player-errors.js"),c=M("./src/utils/logging-control.js"),u=M("./src/utils/exception.js");T.default.install();function r(s,l){var a=s;if(a==null||typeof a!="object")throw new u.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!a.hasOwnProperty("type"))throw new u.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(a.type){case"flv":return new n.default(a,l);default:return new d.default(a,l)}}function t(){return p.default.supportMSEH264Playback()}function i(){return p.default.getFeatureList()}var e={};e.createPlayer=r,e.isSupported=t,e.getFeatureList=i,e.BaseLoader=f.BaseLoader,e.LoaderStatus=f.LoaderStatus,e.LoaderErrors=f.LoaderErrors,e.Events=o.default,e.ErrorTypes=v.ErrorTypes,e.ErrorDetails=v.ErrorDetails,e.FlvPlayer=n.default,e.NativePlayer=d.default,e.LoggingControl=c.default,Object.defineProperty(e,"version",{enumerable:!0,get:function(){return"1.6.2"}}),m.default=e},"./src/index.js":function(h,m,M){h.exports=M("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(h,m,M){M.r(m);var T=M("./src/utils/browser.js"),p=M("./src/io/loader.js"),f=M("./src/utils/exception.js"),n=function(){var o=function(v,c){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,r){u.__proto__=r}||function(u,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(u[t]=r[t])},o(v,c)};return function(v,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");o(v,c);function u(){this.constructor=v}v.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),d=function(o){n(v,o);function v(c,u){var r=o.call(this,"fetch-stream-loader")||this;return r.TAG="FetchStreamLoader",r._seekHandler=c,r._config=u,r._needStash=!0,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return v.isSupported=function(){try{var c=T.default.msedge&&T.default.version.minor>=15048,u=T.default.msedge?c:!0;return self.fetch&&self.ReadableStream&&u}catch{return!1}},v.prototype.destroy=function(){this.isWorking()&&this.abort(),o.prototype.destroy.call(this)},v.prototype.open=function(c,u){var r=this;this._dataSource=c,this._range=u;var t=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(t=c.redirectedURL);var i=this._seekHandler.getConfig(t,u),e=new self.Headers;if(typeof i.headers=="object"){var s=i.headers;for(var l in s)s.hasOwnProperty(l)&&e.append(l,s[l])}var a={method:"GET",headers:e,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var l in this._config.headers)e.append(l,this._config.headers[l]);c.cors===!1&&(a.mode="same-origin"),c.withCredentials&&(a.credentials="include"),c.referrerPolicy&&(a.referrerPolicy=c.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,a.signal=this._abortController.signal),this._status=p.LoaderStatus.kConnecting,self.fetch(i.url,a).then(function(g){if(r._requestAbort){r._status=p.LoaderStatus.kIdle,g.body.cancel();return}if(g.ok&&g.status>=200&&g.status<=299){if(g.url!==i.url&&r._onURLRedirect){var A=r._seekHandler.removeURLParameters(g.url);r._onURLRedirect(A)}var D=g.headers.get("Content-Length");return D!=null&&(r._contentLength=parseInt(D),r._contentLength!==0&&r._onContentLengthKnown&&r._onContentLengthKnown(r._contentLength)),r._pump.call(r,g.body.getReader())}else if(r._status=p.LoaderStatus.kError,r._onError)r._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:g.status,msg:g.statusText});else throw new f.RuntimeException("FetchStreamLoader: Http code invalid, "+g.status+" "+g.statusText)}).catch(function(g){if(!(r._abortController&&r._abortController.signal.aborted))if(r._status=p.LoaderStatus.kError,r._onError)r._onError(p.LoaderErrors.EXCEPTION,{code:-1,msg:g.message});else throw g})},v.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==p.LoaderStatus.kBuffering||!T.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},v.prototype._pump=function(c){var u=this;return c.read().then(function(r){if(r.done)if(u._contentLength!==null&&u._receivedLength<u._contentLength){u._status=p.LoaderStatus.kError;var t=p.LoaderErrors.EARLY_EOF,i={code:-1,msg:"Fetch stream meet Early-EOF"};if(u._onError)u._onError(t,i);else throw new f.RuntimeException(i.msg)}else u._status=p.LoaderStatus.kComplete,u._onComplete&&u._onComplete(u._range.from,u._range.from+u._receivedLength-1);else{if(u._abortController&&u._abortController.signal.aborted){u._status=p.LoaderStatus.kComplete;return}else if(u._requestAbort===!0)return u._status=p.LoaderStatus.kComplete,c.cancel();u._status=p.LoaderStatus.kBuffering;var e=r.value.buffer,s=u._range.from+u._receivedLength;u._receivedLength+=e.byteLength,u._onDataArrival&&u._onDataArrival(e,s,u._receivedLength),u._pump(c)}}).catch(function(r){if(u._abortController&&u._abortController.signal.aborted){u._status=p.LoaderStatus.kComplete;return}if(!(r.code===11&&T.default.msedge)){u._status=p.LoaderStatus.kError;var t=0,i=null;if((r.code===19||r.message==="network error")&&(u._contentLength===null||u._contentLength!==null&&u._receivedLength<u._contentLength)?(t=p.LoaderErrors.EARLY_EOF,i={code:r.code,msg:"Fetch stream meet Early-EOF"}):(t=p.LoaderErrors.EXCEPTION,i={code:r.code,msg:r.message}),u._onError)u._onError(t,i);else throw new f.RuntimeException(i.msg)}})},v}(p.BaseLoader);m.default=d},"./src/io/io-controller.js":function(h,m,M){M.r(m);var T=M("./src/utils/logger.js"),p=M("./src/io/speed-sampler.js"),f=M("./src/io/loader.js"),n=M("./src/io/fetch-stream-loader.js"),d=M("./src/io/xhr-moz-chunked-loader.js"),o=M("./src/io/xhr-range-loader.js"),v=M("./src/io/websocket-loader.js"),c=M("./src/io/range-seek-handler.js"),u=M("./src/io/param-seek-handler.js"),r=M("./src/utils/exception.js"),t=function(){function i(e,s,l){this.TAG="IOController",this._config=s,this._extraData=l,this._stashInitialSize=1024*384,s.stashInitialSize!=null&&s.stashInitialSize>0&&(this._stashInitialSize=s.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,s.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new p.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return i.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},i.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},i.prototype.isPaused=function(){return this._paused},Object.defineProperty(i.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentSpeed",{get:function(){return this._loaderClass===o.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),i.prototype._selectSeekHandler=function(){var e=this._config;if(e.seekType==="range")this._seekHandler=new c.default(this._config.rangeLoadZeroStart);else if(e.seekType==="param"){var s=e.seekParamStart||"bstart",l=e.seekParamEnd||"bend";this._seekHandler=new u.default(s,l)}else if(e.seekType==="custom"){if(typeof e.customSeekHandler!="function")throw new r.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}else throw new r.InvalidArgumentException("Invalid seekType in config: "+e.seekType)},i.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=v.default;else if(n.default.isSupported())this._loaderClass=n.default;else if(d.default.isSupported())this._loaderClass=d.default;else if(o.default.isSupported())this._loaderClass=o.default;else throw new r.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},i.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},i.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},i.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},i.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},i.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},i.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},i.prototype._internalSeek=function(e,s){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(s),this._loader.destroy(),this._loader=null;var l={from:e,to:-1};this._currentRange={from:l.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,l),this._onSeeked&&this._onSeeked()},i.prototype.updateUrl=function(e){if(!e||typeof e!="string"||e.length===0)throw new r.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=e},i.prototype._expandBuffer=function(e){for(var s=this._stashSize;s+1024*1024*1<e;)s*=2;if(s+=1024*1024*1,s!==this._bufferSize){var l=new ArrayBuffer(s);if(this._stashUsed>0){var a=new Uint8Array(this._stashBuffer,0,this._stashUsed),g=new Uint8Array(l,0,s);g.set(a,0)}this._stashBuffer=l,this._bufferSize=s}},i.prototype._normalizeSpeed=function(e){var s=this._speedNormalizeList,l=s.length-1,a=0,g=0,A=l;if(e<s[0])return s[0];for(;g<=A;){if(a=g+Math.floor((A-g)/2),a===l||e>=s[a]&&e<s[a+1])return s[a];s[a]<e?g=a+1:A=a-1}},i.prototype._adjustStashSize=function(e){var s=0;this._config.isLive||e<512?s=e:e>=512&&e<=1024?s=Math.floor(e*1.5):s=e*2,s>8192&&(s=8192);var l=s*1024+1024*1024*1;this._bufferSize<l&&this._expandBuffer(l),this._stashSize=s*1024},i.prototype._dispatchChunks=function(e,s){return this._currentRange.to=s+e.byteLength-1,this._onDataArrival(e,s)},i.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},i.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},i.prototype._onLoaderChunkArrival=function(e,s,l){if(!this._onDataArrival)throw new r.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var a=this._speedSampler.lastSecondKBps;if(a!==0){var g=this._normalizeSpeed(a);this._speedNormalized!==g&&(this._speedNormalized=g,this._adjustStashSize(g))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=s),this._stashUsed+e.byteLength<=this._stashSize){var y=new Uint8Array(this._stashBuffer,0,this._stashSize);y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var _=this._stashBuffer.slice(0,this._stashUsed),A=this._dispatchChunks(_,this._stashByteStart);if(A<_.byteLength){if(A>0){var E=new Uint8Array(_,A);y.set(E,0),this._stashUsed=E.byteLength,this._stashByteStart+=A}}else this._stashUsed=0,this._stashByteStart+=A;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var A=this._dispatchChunks(e,s);if(A<e.byteLength){var D=e.byteLength-A;D>this._bufferSize&&(this._expandBuffer(D),y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),y.set(new Uint8Array(e,A),0),this._stashUsed+=D,this._stashByteStart=s+A}}}else if(this._stashUsed===0){var A=this._dispatchChunks(e,s);if(A<e.byteLength){var D=e.byteLength-A;D>this._bufferSize&&this._expandBuffer(D);var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);y.set(new Uint8Array(e,A),0),this._stashUsed+=D,this._stashByteStart=s+A}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;var A=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(A<this._stashUsed&&A>0){var E=new Uint8Array(this._stashBuffer,A);y.set(E,0)}this._stashUsed-=A,this._stashByteStart+=A}}},i.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var s=this._stashBuffer.slice(0,this._stashUsed),l=this._dispatchChunks(s,this._stashByteStart),a=s.byteLength-l;if(l<s.byteLength)if(e)T.default.w(this.TAG,a+" bytes unconsumed data remain when flush buffer, dropped");else{if(l>0){var g=new Uint8Array(this._stashBuffer,0,this._bufferSize),A=new Uint8Array(s,l);g.set(A,0),this._stashUsed=A.byteLength,this._stashByteStart+=l}return 0}return this._stashUsed=0,this._stashByteStart=0,a}return 0},i.prototype._onLoaderComplete=function(e,s){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},i.prototype._onLoaderError=function(e,s){switch(T.default.e(this.TAG,"Loader error, code = "+s.code+", msg = "+s.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=f.LoaderErrors.UNRECOVERABLE_EARLY_EOF),e){case f.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var l=this._currentRange.to+1;l<this._totalLength&&(T.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(l,!1));return}e=f.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case f.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case f.LoaderErrors.CONNECTING_TIMEOUT:case f.LoaderErrors.HTTP_STATUS_CODE_INVALID:case f.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(e,s);else throw new r.RuntimeException("IOException: "+s.msg)},i}();m.default=t},"./src/io/loader.js":function(h,m,M){M.r(m),M.d(m,{LoaderStatus:function(){return p},LoaderErrors:function(){return f},BaseLoader:function(){return n}});var T=M("./src/utils/exception.js"),p={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},f={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},n=function(){function d(o){this._type=o||"undefined",this._status=p.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return d.prototype.destroy=function(){this._status=p.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},d.prototype.isWorking=function(){return this._status===p.kConnecting||this._status===p.kBuffering},Object.defineProperty(d.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(o){this._onContentLengthKnown=o},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(o){this._onURLRedirect=o},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(o){this._onDataArrival=o},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onError",{get:function(){return this._onError},set:function(o){this._onError=o},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onComplete",{get:function(){return this._onComplete},set:function(o){this._onComplete=o},enumerable:!1,configurable:!0}),d.prototype.open=function(o,v){throw new T.NotImplementedException("Unimplemented abstract function!")},d.prototype.abort=function(){throw new T.NotImplementedException("Unimplemented abstract function!")},d}()},"./src/io/param-seek-handler.js":function(h,m,M){M.r(m);var T=function(){function p(f,n){this._startName=f,this._endName=n}return p.prototype.getConfig=function(f,n){var d=f;if(n.from!==0||n.to!==-1){var o=!0;d.indexOf("?")===-1&&(d+="?",o=!1),o&&(d+="&"),d+=this._startName+"="+n.from.toString(),n.to!==-1&&(d+="&"+this._endName+"="+n.to.toString())}return{url:d,headers:{}}},p.prototype.removeURLParameters=function(f){var n=f.split("?")[0],d=void 0,o=f.indexOf("?");o!==-1&&(d=f.substring(o+1));var v="";if(d!=null&&d.length>0)for(var c=d.split("&"),u=0;u<c.length;u++){var r=c[u].split("="),t=u>0;r[0]!==this._startName&&r[0]!==this._endName&&(t&&(v+="&"),v+=c[u])}return v.length===0?n:n+"?"+v},p}();m.default=T},"./src/io/range-seek-handler.js":function(h,m,M){M.r(m);var T=function(){function p(f){this._zeroStart=f||!1}return p.prototype.getConfig=function(f,n){var d={};if(n.from!==0||n.to!==-1){var o=void 0;n.to!==-1?o="bytes="+n.from.toString()+"-"+n.to.toString():o="bytes="+n.from.toString()+"-",d.Range=o}else this._zeroStart&&(d.Range="bytes=0-");return{url:f,headers:d}},p.prototype.removeURLParameters=function(f){return f},p}();m.default=T},"./src/io/speed-sampler.js":function(h,m,M){M.r(m);var T=function(){function p(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return p.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},p.prototype.addBytes=function(f){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=f,this._totalBytes+=f):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=f,this._totalBytes+=f):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=f,this._totalBytes+=f,this._lastCheckpoint=this._now())},Object.defineProperty(p.prototype,"currentKBps",{get:function(){this.addBytes(0);var f=(this._now()-this._lastCheckpoint)/1e3;return f==0&&(f=1),this._intervalBytes/f/1024},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"averageKBps",{get:function(){var f=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/f/1024},enumerable:!1,configurable:!0}),p}();m.default=T},"./src/io/websocket-loader.js":function(h,m,M){M.r(m);var T=M("./src/io/loader.js"),p=M("./src/utils/exception.js"),f=function(){var d=function(o,v){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,u){c.__proto__=u}||function(c,u){for(var r in u)Object.prototype.hasOwnProperty.call(u,r)&&(c[r]=u[r])},d(o,v)};return function(o,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");d(o,v);function c(){this.constructor=o}o.prototype=v===null?Object.create(v):(c.prototype=v.prototype,new c)}}(),n=function(d){f(o,d);function o(){var v=d.call(this,"websocket-loader")||this;return v.TAG="WebSocketLoader",v._needStash=!0,v._ws=null,v._requestAbort=!1,v._receivedLength=0,v}return o.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch{return!1}},o.prototype.destroy=function(){this._ws&&this.abort(),d.prototype.destroy.call(this)},o.prototype.open=function(v){try{var c=this._ws=new self.WebSocket(v.url);c.binaryType="arraybuffer",c.onopen=this._onWebSocketOpen.bind(this),c.onclose=this._onWebSocketClose.bind(this),c.onmessage=this._onWebSocketMessage.bind(this),c.onerror=this._onWebSocketError.bind(this),this._status=T.LoaderStatus.kConnecting}catch(r){this._status=T.LoaderStatus.kError;var u={code:r.code,msg:r.message};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,u);else throw new p.RuntimeException(u.msg)}},o.prototype.abort=function(){var v=this._ws;v&&(v.readyState===0||v.readyState===1)&&(this._requestAbort=!0,v.close()),this._ws=null,this._status=T.LoaderStatus.kComplete},o.prototype._onWebSocketOpen=function(v){this._status=T.LoaderStatus.kBuffering},o.prototype._onWebSocketClose=function(v){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=T.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},o.prototype._onWebSocketMessage=function(v){var c=this;if(v.data instanceof ArrayBuffer)this._dispatchArrayBuffer(v.data);else if(v.data instanceof Blob){var u=new FileReader;u.onload=function(){c._dispatchArrayBuffer(u.result)},u.readAsArrayBuffer(v.data)}else{this._status=T.LoaderStatus.kError;var r={code:-1,msg:"Unsupported WebSocket message type: "+v.data.constructor.name};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,r);else throw new p.RuntimeException(r.msg)}},o.prototype._dispatchArrayBuffer=function(v){var c=v,u=this._receivedLength;this._receivedLength+=c.byteLength,this._onDataArrival&&this._onDataArrival(c,u,this._receivedLength)},o.prototype._onWebSocketError=function(v){this._status=T.LoaderStatus.kError;var c={code:v.code,msg:v.message};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,c);else throw new p.RuntimeException(c.msg)},o}(T.BaseLoader);m.default=n},"./src/io/xhr-moz-chunked-loader.js":function(h,m,M){M.r(m);var T=M("./src/utils/logger.js"),p=M("./src/io/loader.js"),f=M("./src/utils/exception.js"),n=function(){var o=function(v,c){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,r){u.__proto__=r}||function(u,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(u[t]=r[t])},o(v,c)};return function(v,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");o(v,c);function u(){this.constructor=v}v.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),d=function(o){n(v,o);function v(c,u){var r=o.call(this,"xhr-moz-chunked-loader")||this;return r.TAG="MozChunkedLoader",r._seekHandler=c,r._config=u,r._needStash=!0,r._xhr=null,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return v.isSupported=function(){try{var c=new XMLHttpRequest;return c.open("GET","https://example.com",!0),c.responseType="moz-chunked-arraybuffer",c.responseType==="moz-chunked-arraybuffer"}catch(u){return T.default.w("MozChunkedLoader",u.message),!1}},v.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),o.prototype.destroy.call(this)},v.prototype.open=function(c,u){this._dataSource=c,this._range=u;var r=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(r=c.redirectedURL);var t=this._seekHandler.getConfig(r,u);this._requestURL=t.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",t.url,!0),i.responseType="moz-chunked-arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onloadend=this._onLoadEnd.bind(this),i.onerror=this._onXhrError.bind(this),c.withCredentials&&(i.withCredentials=!0),typeof t.headers=="object"){var e=t.headers;for(var s in e)e.hasOwnProperty(s)&&i.setRequestHeader(s,e[s])}if(typeof this._config.headers=="object"){var e=this._config.headers;for(var s in e)e.hasOwnProperty(s)&&i.setRequestHeader(s,e[s])}this._status=p.LoaderStatus.kConnecting,i.send()},v.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=p.LoaderStatus.kComplete},v.prototype._onReadyStateChange=function(c){var u=c.target;if(u.readyState===2){if(u.responseURL!=null&&u.responseURL!==this._requestURL&&this._onURLRedirect){var r=this._seekHandler.removeURLParameters(u.responseURL);this._onURLRedirect(r)}if(u.status!==0&&(u.status<200||u.status>299))if(this._status=p.LoaderStatus.kError,this._onError)this._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:u.status,msg:u.statusText});else throw new f.RuntimeException("MozChunkedLoader: Http code invalid, "+u.status+" "+u.statusText);else this._status=p.LoaderStatus.kBuffering}},v.prototype._onProgress=function(c){if(this._status!==p.LoaderStatus.kError){this._contentLength===null&&c.total!==null&&c.total!==0&&(this._contentLength=c.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var u=c.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=u.byteLength,this._onDataArrival&&this._onDataArrival(u,r,this._receivedLength)}},v.prototype._onLoadEnd=function(c){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===p.LoaderStatus.kError)return;this._status=p.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},v.prototype._onXhrError=function(c){this._status=p.LoaderStatus.kError;var u=0,r=null;if(this._contentLength&&c.loaded<this._contentLength?(u=p.LoaderErrors.EARLY_EOF,r={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(u=p.LoaderErrors.EXCEPTION,r={code:-1,msg:c.constructor.name+" "+c.type}),this._onError)this._onError(u,r);else throw new f.RuntimeException(r.msg)},v}(p.BaseLoader);m.default=d},"./src/io/xhr-range-loader.js":function(h,m,M){M.r(m);var T=M("./src/utils/logger.js"),p=M("./src/io/speed-sampler.js"),f=M("./src/io/loader.js"),n=M("./src/utils/exception.js"),d=function(){var v=function(c,u){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])},v(c,u)};return function(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");v(c,u);function r(){this.constructor=c}c.prototype=u===null?Object.create(u):(r.prototype=u.prototype,new r)}}(),o=function(v){d(c,v);function c(u,r){var t=v.call(this,"xhr-range-loader")||this;return t.TAG="RangeLoader",t._seekHandler=u,t._config=r,t._needStash=!1,t._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],t._currentChunkSizeKB=384,t._currentSpeedNormalized=0,t._zeroSpeedChunkCount=0,t._xhr=null,t._speedSampler=new p.default,t._requestAbort=!1,t._waitForTotalLength=!1,t._totalLengthReceived=!1,t._currentRequestURL=null,t._currentRedirectedURL=null,t._currentRequestRange=null,t._totalLength=null,t._contentLength=null,t._receivedLength=0,t._lastTimeLoaded=0,t}return c.isSupported=function(){try{var u=new XMLHttpRequest;return u.open("GET","https://example.com",!0),u.responseType="arraybuffer",u.responseType==="arraybuffer"}catch(r){return T.default.w("RangeLoader",r.message),!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),v.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),c.prototype.open=function(u,r){this._dataSource=u,this._range=r,this._status=f.LoaderStatus.kConnecting;var t=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(t=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!t?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},c.prototype._openSubRange=function(){var u=this._currentChunkSizeKB*1024,r=this._range.from+this._receivedLength,t=r+u;this._contentLength!=null&&t-this._range.from>=this._contentLength&&(t=this._range.from+this._contentLength-1),this._currentRequestRange={from:r,to:t},this._internalOpen(this._dataSource,this._currentRequestRange)},c.prototype._internalOpen=function(u,r){this._lastTimeLoaded=0;var t=u.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?t=this._currentRedirectedURL:u.redirectedURL!=null&&(t=u.redirectedURL));var i=this._seekHandler.getConfig(t,r);this._currentRequestURL=i.url;var e=this._xhr=new XMLHttpRequest;if(e.open("GET",i.url,!0),e.responseType="arraybuffer",e.onreadystatechange=this._onReadyStateChange.bind(this),e.onprogress=this._onProgress.bind(this),e.onload=this._onLoad.bind(this),e.onerror=this._onXhrError.bind(this),u.withCredentials&&(e.withCredentials=!0),typeof i.headers=="object"){var s=i.headers;for(var l in s)s.hasOwnProperty(l)&&e.setRequestHeader(l,s[l])}if(typeof this._config.headers=="object"){var s=this._config.headers;for(var l in s)s.hasOwnProperty(l)&&e.setRequestHeader(l,s[l])}e.send()},c.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=f.LoaderStatus.kComplete},c.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},c.prototype._onReadyStateChange=function(u){var r=u.target;if(r.readyState===2){if(r.responseURL!=null){var t=this._seekHandler.removeURLParameters(r.responseURL);r.responseURL!==this._currentRequestURL&&t!==this._currentRedirectedURL&&(this._currentRedirectedURL=t,this._onURLRedirect&&this._onURLRedirect(t))}if(r.status>=200&&r.status<=299){if(this._waitForTotalLength)return;this._status=f.LoaderStatus.kBuffering}else if(this._status=f.LoaderStatus.kError,this._onError)this._onError(f.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText});else throw new n.RuntimeException("RangeLoader: Http code invalid, "+r.status+" "+r.statusText)}},c.prototype._onProgress=function(u){if(this._status!==f.LoaderStatus.kError){if(this._contentLength===null){var r=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,r=!0;var t=u.total;this._internalAbort(),t!=null&t!==0&&(this._totalLength=t)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,r){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var i=u.loaded-this._lastTimeLoaded;this._lastTimeLoaded=u.loaded,this._speedSampler.addBytes(i)}},c.prototype._normalizeSpeed=function(u){var r=this._chunkSizeKBList,t=r.length-1,i=0,e=0,s=t;if(u<r[0])return r[0];for(;e<=s;){if(i=e+Math.floor((s-e)/2),i===t||u>=r[i]&&u<r[i+1])return r[i];r[i]<u?e=i+1:s=i-1}},c.prototype._onLoad=function(u){if(this._status!==f.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var r=this._speedSampler.lastSecondKBps;if(r===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(r=this._speedSampler.currentKBps)),r!==0){var t=this._normalizeSpeed(r);this._currentSpeedNormalized!==t&&(this._currentSpeedNormalized=t,this._currentChunkSizeKB=t)}var i=u.target.response,e=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength;var s=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():s=!0,this._onDataArrival&&this._onDataArrival(i,e,this._receivedLength),s&&(this._status=f.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},c.prototype._onXhrError=function(u){this._status=f.LoaderStatus.kError;var r=0,t=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(r=f.LoaderErrors.EARLY_EOF,t={code:-1,msg:"RangeLoader meet Early-Eof"}):(r=f.LoaderErrors.EXCEPTION,t={code:-1,msg:u.constructor.name+" "+u.type}),this._onError)this._onError(r,t);else throw new n.RuntimeException(t.msg)},c}(f.BaseLoader);m.default=o},"./src/player/flv-player.js":function(h,m,M){M.r(m);var T=M("./node_modules/events/events.js"),p=M.n(T),f=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),d=M("./src/player/player-events.js"),o=M("./src/core/transmuxer.js"),v=M("./src/core/transmuxing-events.js"),c=M("./src/core/mse-controller.js"),u=M("./src/core/mse-events.js"),r=M("./src/player/player-errors.js"),t=M("./src/config.js"),i=M("./src/utils/exception.js"),e=function(){function s(l,a){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(p()),this._config=(0,t.createDefaultConfig)(),typeof a=="object"&&Object.assign(this._config,a),l.type.toLowerCase()!=="flv")throw new i.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");l.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=l,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var g=n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661);this._alwaysSeekKeyframe=!!(g||n.default.msedge||n.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return s.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},s.prototype.on=function(l,a){var g=this;l===d.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){g._emitter.emit(d.default.MEDIA_INFO,g.mediaInfo)}):l===d.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){g._emitter.emit(d.default.STATISTICS_INFO,g.statisticsInfo)}),this._emitter.addListener(l,a)},s.prototype.off=function(l,a){this._emitter.removeListener(l,a)},s.prototype.attachMediaElement=function(l){var a=this;if(this._mediaElement=l,l.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),l.addEventListener("seeking",this.e.onvSeeking),l.addEventListener("canplay",this.e.onvCanPlay),l.addEventListener("stalled",this.e.onvStalled),l.addEventListener("progress",this.e.onvProgress),this._msectl=new c.default(this._config),this._msectl.on(u.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(u.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(u.default.SOURCE_OPEN,function(){a._mseSourceOpened=!0,a._hasPendingLoad&&(a._hasPendingLoad=!1,a.load())}),this._msectl.on(u.default.ERROR,function(g){a._emitter.emit(d.default.ERROR,r.ErrorTypes.MEDIA_ERROR,r.ErrorDetails.MEDIA_MSE_ERROR,g)}),this._msectl.attachMediaElement(l),this._pendingSeekTime!=null)try{l.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},s.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},s.prototype.load=function(){var l=this;if(!this._mediaElement)throw new i.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new i.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new o.default(this._mediaDataSource,this._config),this._transmuxer.on(v.default.INIT_SEGMENT,function(a,g){l._msectl.appendInitSegment(g)}),this._transmuxer.on(v.default.MEDIA_SEGMENT,function(a,g){if(l._msectl.appendMediaSegment(g),l._config.lazyLoad&&!l._config.isLive){var A=l._mediaElement.currentTime;g.info.endDts>=(A+l._config.lazyLoadMaxDuration)*1e3&&l._progressChecker==null&&(f.default.v(l.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),l._suspendTransmuxer())}}),this._transmuxer.on(v.default.LOADING_COMPLETE,function(){l._msectl.endOfStream(),l._emitter.emit(d.default.LOADING_COMPLETE)}),this._transmuxer.on(v.default.RECOVERED_EARLY_EOF,function(){l._emitter.emit(d.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(v.default.IO_ERROR,function(a,g){l._emitter.emit(d.default.ERROR,r.ErrorTypes.NETWORK_ERROR,a,g)}),this._transmuxer.on(v.default.DEMUX_ERROR,function(a,g){l._emitter.emit(d.default.ERROR,r.ErrorTypes.MEDIA_ERROR,a,{code:-1,msg:g})}),this._transmuxer.on(v.default.MEDIA_INFO,function(a){l._mediaInfo=a,l._emitter.emit(d.default.MEDIA_INFO,Object.assign({},a))}),this._transmuxer.on(v.default.METADATA_ARRIVED,function(a){l._emitter.emit(d.default.METADATA_ARRIVED,a)}),this._transmuxer.on(v.default.SCRIPTDATA_ARRIVED,function(a){l._emitter.emit(d.default.SCRIPTDATA_ARRIVED,a)}),this._transmuxer.on(v.default.STATISTICS_INFO,function(a){l._statisticsInfo=l._fillStatisticsInfo(a),l._emitter.emit(d.default.STATISTICS_INFO,Object.assign({},l._statisticsInfo))}),this._transmuxer.on(v.default.RECOMMEND_SEEKPOINT,function(a){l._mediaElement&&!l._config.accurateSeek&&(l._requestSetTime=!0,l._mediaElement.currentTime=a/1e3)}),this._transmuxer.open()}},s.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},s.prototype.play=function(){return this._mediaElement.play()},s.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(s.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(l){this._mediaElement.volume=l},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(l){this._mediaElement.muted=l},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(l){this._mediaElement?this._internalSeek(l):this._pendingSeekTime=l},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),s.prototype._fillStatisticsInfo=function(l){if(l.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return l;var a=!0,g=0,A=0;if(this._mediaElement.getVideoPlaybackQuality){var D=this._mediaElement.getVideoPlaybackQuality();g=D.totalVideoFrames,A=D.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(g=this._mediaElement.webkitDecodedFrameCount,A=this._mediaElement.webkitDroppedFrameCount):a=!1;return a&&(l.decodedFrames=g,l.droppedFrames=A),l},s.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var l=this._mediaElement.buffered,a=this._mediaElement.currentTime,g=0,A=0;A<l.length;A++){var D=l.start(A),y=l.end(A);if(D<=a&&a<y){g=y;break}}g>=a+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(f.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},s.prototype._onmseBufferFull=function(){f.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},s.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},s.prototype._checkProgressAndResume=function(){for(var l=this._mediaElement.currentTime,a=this._mediaElement.buffered,g=!1,A=0;A<a.length;A++){var D=a.start(A),y=a.end(A);if(l>=D&&l<y){l>=y-this._config.lazyLoadRecoverDuration&&(g=!0);break}}g&&(window.clearInterval(this._progressChecker),this._progressChecker=null,g&&(f.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},s.prototype._isTimepointBuffered=function(l){for(var a=this._mediaElement.buffered,g=0;g<a.length;g++){var A=a.start(g),D=a.end(g);if(l>=A&&l<D)return!0}return!1},s.prototype._internalSeek=function(l){var a=this._isTimepointBuffered(l),g=!1,A=0;if(l<1&&this._mediaElement.buffered.length>0){var D=this._mediaElement.buffered.start(0);(D<1&&l<D||n.default.safari)&&(g=!0,A=n.default.safari?.1:D)}if(g)this._requestSetTime=!0,this._mediaElement.currentTime=A;else if(a){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=l;else{var y=this._msectl.getNearestKeyframe(Math.floor(l*1e3));this._requestSetTime=!0,y!=null?this._mediaElement.currentTime=y.dts/1e3:this._mediaElement.currentTime=l}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(l),this._transmuxer.seek(Math.floor(l*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=l)},s.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var l=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(l)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(l),this._transmuxer.seek(Math.floor(l*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=l))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},s.prototype._checkAndResumeStuckPlayback=function(l){var a=this._mediaElement;if(l||!this._receivedCanPlay||a.readyState<2){var g=a.buffered;g.length>0&&a.currentTime<g.start(0)&&(f.default.w(this.TAG,"Playback seems stuck at "+a.currentTime+", seek to "+g.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=g.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},s.prototype._onvLoadedMetadata=function(l){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},s.prototype._onvSeeking=function(l){var a=this._mediaElement.currentTime,g=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(a<1&&g.length>0){var A=g.start(0);if(A<1&&a<A||n.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=n.default.safari?.1:A;return}}if(this._isTimepointBuffered(a)){if(this._alwaysSeekKeyframe){var D=this._msectl.getNearestKeyframe(Math.floor(a*1e3));D!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=D.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:a,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},s.prototype._onvCanPlay=function(l){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},s.prototype._onvStalled=function(l){this._checkAndResumeStuckPlayback(!0)},s.prototype._onvProgress=function(l){this._checkAndResumeStuckPlayback()},s}();m.default=e},"./src/player/native-player.js":function(h,m,M){M.r(m);var T=M("./node_modules/events/events.js"),p=M.n(T),f=M("./src/player/player-events.js"),n=M("./src/config.js"),d=M("./src/utils/exception.js"),o=function(){function v(c,u){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(p()),this._config=(0,n.createDefaultConfig)(),typeof u=="object"&&Object.assign(this._config,u),c.type.toLowerCase()==="flv")throw new d.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(c.hasOwnProperty("segments"))throw new d.InvalidArgumentException("NativePlayer("+c.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=c,this._mediaElement=null}return v.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(c,u){var r=this;c===f.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(f.default.MEDIA_INFO,r.mediaInfo)}):c===f.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(f.default.STATISTICS_INFO,r.statisticsInfo)}),this._emitter.addListener(c,u)},v.prototype.off=function(c,u){this._emitter.removeListener(c,u)},v.prototype.attachMediaElement=function(c){if(this._mediaElement=c,c.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{c.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},v.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},v.prototype.load=function(){if(!this._mediaElement)throw new d.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},v.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},v.prototype.play=function(){return this._mediaElement.play()},v.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(v.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(c){this._mediaElement.volume=c},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(c){this._mediaElement.muted=c},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(c){this._mediaElement?this._mediaElement.currentTime=c:this._pendingSeekTime=c},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"mediaInfo",{get:function(){var c=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",u={mimeType:c+this._mediaDataSource.type};return this._mediaElement&&(u.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(u.width=this._mediaElement.videoWidth,u.height=this._mediaElement.videoHeight)),u},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"statisticsInfo",{get:function(){var c={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return c;var u=!0,r=0,t=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();r=i.totalVideoFrames,t=i.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(r=this._mediaElement.webkitDecodedFrameCount,t=this._mediaElement.webkitDroppedFrameCount):u=!1;return u&&(c.decodedFrames=r,c.droppedFrames=t),c},enumerable:!1,configurable:!0}),v.prototype._onvLoadedMetadata=function(c){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(f.default.MEDIA_INFO,this.mediaInfo)},v.prototype._reportStatisticsInfo=function(){this._emitter.emit(f.default.STATISTICS_INFO,this.statisticsInfo)},v}();m.default=o},"./src/player/player-errors.js":function(h,m,M){M.r(m),M.d(m,{ErrorTypes:function(){return f},ErrorDetails:function(){return n}});var T=M("./src/io/loader.js"),p=M("./src/demux/demux-errors.js"),f={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},n={NETWORK_EXCEPTION:T.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:T.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:T.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:T.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:p.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:p.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:p.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(h,m,M){M.r(m);var T={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};m.default=T},"./src/remux/aac-silent.js":function(h,m,M){M.r(m);var T=function(){function p(){}return p.getSilentFrame=function(f,n){if(f==="mp4a.40.2"){if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},p}();m.default=T},"./src/remux/mp4-generator.js":function(h,m,M){M.r(m);var T=function(){function p(){}return p.init=function(){p.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var f in p.types)p.types.hasOwnProperty(f)&&(p.types[f]=[f.charCodeAt(0),f.charCodeAt(1),f.charCodeAt(2),f.charCodeAt(3)]);var n=p.constants={};n.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),n.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),n.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSC=n.STCO=n.STTS,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},p.box=function(f){for(var n=8,d=null,o=Array.prototype.slice.call(arguments,1),v=o.length,c=0;c<v;c++)n+=o[c].byteLength;d=new Uint8Array(n),d[0]=n>>>24&255,d[1]=n>>>16&255,d[2]=n>>>8&255,d[3]=n&255,d.set(f,4);for(var u=8,c=0;c<v;c++)d.set(o[c],u),u+=o[c].byteLength;return d},p.generateInitSegment=function(f){var n=p.box(p.types.ftyp,p.constants.FTYP),d=p.moov(f),o=new Uint8Array(n.byteLength+d.byteLength);return o.set(n,0),o.set(d,n.byteLength),o},p.moov=function(f){var n=p.mvhd(f.timescale,f.duration),d=p.trak(f),o=p.mvex(f);return p.box(p.types.moov,n,d,o)},p.mvhd=function(f,n){return p.box(p.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},p.trak=function(f){return p.box(p.types.trak,p.tkhd(f),p.mdia(f))},p.tkhd=function(f){var n=f.id,d=f.duration,o=f.presentWidth,v=f.presentHeight;return p.box(p.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>>8&255,o&255,0,0,v>>>8&255,v&255,0,0]))},p.mdia=function(f){return p.box(p.types.mdia,p.mdhd(f),p.hdlr(f),p.minf(f))},p.mdhd=function(f){var n=f.timescale,d=f.duration;return p.box(p.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,85,196,0,0]))},p.hdlr=function(f){var n=null;return f.type==="audio"?n=p.constants.HDLR_AUDIO:n=p.constants.HDLR_VIDEO,p.box(p.types.hdlr,n)},p.minf=function(f){var n=null;return f.type==="audio"?n=p.box(p.types.smhd,p.constants.SMHD):n=p.box(p.types.vmhd,p.constants.VMHD),p.box(p.types.minf,n,p.dinf(),p.stbl(f))},p.dinf=function(){var f=p.box(p.types.dinf,p.box(p.types.dref,p.constants.DREF));return f},p.stbl=function(f){var n=p.box(p.types.stbl,p.stsd(f),p.box(p.types.stts,p.constants.STTS),p.box(p.types.stsc,p.constants.STSC),p.box(p.types.stsz,p.constants.STSZ),p.box(p.types.stco,p.constants.STCO));return n},p.stsd=function(f){return f.type==="audio"?f.codec==="mp3"?p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp3(f)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp4a(f)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.avc1(f))},p.mp3=function(f){var n=f.channelCount,d=f.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,d>>>8&255,d&255,0,0]);return p.box(p.types[".mp3"],o)},p.mp4a=function(f){var n=f.channelCount,d=f.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,d>>>8&255,d&255,0,0]);return p.box(p.types.mp4a,o,p.esds(f))},p.esds=function(f){var n=f.config||[],d=n.length,o=new Uint8Array([0,0,0,0,3,23+d,0,1,0,4,15+d,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([d]).concat(n).concat([6,1,2]));return p.box(p.types.esds,o)},p.avc1=function(f){var n=f.avcc,d=f.codecWidth,o=f.codecHeight,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>>8&255,d&255,o>>>8&255,o&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return p.box(p.types.avc1,v,p.box(p.types.avcC,n))},p.mvex=function(f){return p.box(p.types.mvex,p.trex(f))},p.trex=function(f){var n=f.id,d=new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return p.box(p.types.trex,d)},p.moof=function(f,n){return p.box(p.types.moof,p.mfhd(f.sequenceNumber),p.traf(f,n))},p.mfhd=function(f){var n=new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255]);return p.box(p.types.mfhd,n)},p.traf=function(f,n){var d=f.id,o=p.box(p.types.tfhd,new Uint8Array([0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255])),v=p.box(p.types.tfdt,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255])),c=p.sdtp(f),u=p.trun(f,c.byteLength+16+16+8+16+8+8);return p.box(p.types.traf,o,v,u,c)},p.sdtp=function(f){for(var n=f.samples||[],d=n.length,o=new Uint8Array(4+d),v=0;v<d;v++){var c=n[v].flags;o[v+4]=c.isLeading<<6|c.dependsOn<<4|c.isDependedOn<<2|c.hasRedundancy}return p.box(p.types.sdtp,o)},p.trun=function(f,n){var d=f.samples||[],o=d.length,v=12+16*o,c=new Uint8Array(v);n+=8+v,c.set([0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,o&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0);for(var u=0;u<o;u++){var r=d[u].duration,t=d[u].size,i=d[u].flags,e=d[u].cts;c.set([r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.isNonSync,0,0,e>>>24&255,e>>>16&255,e>>>8&255,e&255],12+16*u)}return p.box(p.types.trun,c)},p.mdat=function(f){return p.box(p.types.mdat,f)},p}();T.init(),m.default=T},"./src/remux/mp4-remuxer.js":function(h,m,M){M.r(m);var T=M("./src/utils/logger.js"),p=M("./src/remux/mp4-generator.js"),f=M("./src/remux/aac-silent.js"),n=M("./src/utils/browser.js"),d=M("./src/core/media-segment-info.js"),o=M("./src/utils/exception.js"),v=function(){function c(u){this.TAG="MP4Remuxer",this._config=u,this._isLive=u.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new d.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new d.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661)),this._fillSilentAfterSeek=n.default.msedge||n.default.msie,this._mp3UseMpegAudio=!n.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return c.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},c.prototype.bindDataSource=function(u){return u.onDataAvailable=this.remux.bind(this),u.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(c.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(u){this._onInitSegment=u},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(u){this._onMediaSegment=u},enumerable:!1,configurable:!0}),c.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},c.prototype.seek=function(u){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},c.prototype.remux=function(u,r){if(!this._onMediaSegment)throw new o.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(u,r),this._remuxVideo(r),this._remuxAudio(u)},c.prototype._onTrackMetadataReceived=function(u,r){var t=null,i="mp4",e=r.codec;if(u==="audio")this._audioMeta=r,r.codec==="mp3"&&this._mp3UseMpegAudio?(i="mpeg",e="",t=new Uint8Array):t=p.default.generateInitSegment(r);else if(u==="video")this._videoMeta=r,t=p.default.generateInitSegment(r);else return;if(!this._onInitSegment)throw new o.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(u,{type:u,data:t.buffer,codec:e,container:u+"/"+i,mediaDuration:r.duration})},c.prototype._calculateDtsBase=function(u,r){this._dtsBaseInited||(u.samples&&u.samples.length&&(this._audioDtsBase=u.samples[0].dts),r.samples&&r.samples.length&&(this._videoDtsBase=r.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},c.prototype.flushStashedSamples=function(){var u=this._videoStashedLastSample,r=this._audioStashedLastSample,t={type:"video",id:1,sequenceNumber:0,samples:[],length:0};u!=null&&(t.samples.push(u),t.length=u.length);var i={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};r!=null&&(i.samples.push(r),i.length=r.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(t,!0),this._remuxAudio(i,!0)},c.prototype._remuxAudio=function(u,r){if(this._audioMeta!=null){var t=u,i=t.samples,e=void 0,s=-1,l=-1,a=this._audioMeta.refSampleDuration,g=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,A=this._dtsBaseInited&&this._audioNextDts===void 0,D=!1;if(!(!i||i.length===0)&&!(i.length===1&&!r)){var y=0,E=null,_=0;g?(y=0,_=t.length):(y=8,_=8+t.length);var L=null;if(i.length>1&&(L=i.pop(),_-=L.length),this._audioStashedLastSample!=null){var I=this._audioStashedLastSample;this._audioStashedLastSample=null,i.unshift(I),_+=I.length}L!=null&&(this._audioStashedLastSample=L);var b=i[0].dts-this._dtsBase;if(this._audioNextDts)e=b-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())e=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(D=!0);else{var R=this._audioSegmentInfoList.getLastSampleBefore(b);if(R!=null){var P=b-(R.originalDts+R.duration);P<=3&&(P=0);var w=R.dts+R.duration+P;e=b-w}else e=0}if(D){var F=b-e,k=this._videoSegmentInfoList.getLastSegmentBefore(b);if(k!=null&&k.beginDts<F){var B=f.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(B){var U=k.beginDts,j=F-k.beginDts;T.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+U+", duration: "+j),i.unshift({unit:B,dts:U,pts:U}),_+=B.byteLength}}else D=!1}for(var K=[],N=0;N<i.length;N++){var I=i[N],Z=I.unit,X=I.dts-this._dtsBase,U=X,Y=!1,ee=null,Q=0;if(!(X<-.001)){if(this._audioMeta.codec!=="mp3"){var G=X,q=3;if(this._audioNextDts&&(G=this._audioNextDts),e=X-G,e<=-q*a){T.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+X+" ms ,curRefDts: "+G+" ms)  due to dtsCorrection: "+e+" ms overlap.");continue}else if(e>=q*a&&this._fillAudioTimestampGap&&!n.default.safari){Y=!0;var te=Math.floor(e/a);T.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+X+" ms, curRefDts: "+G+" ms, ")+("dtsCorrection: "+Math.round(e)+" ms, generate: "+te+" frames")),U=Math.floor(G),Q=Math.floor(G+a)-U;var B=f.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);B==null&&(T.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),B=Z),ee=[];for(var ie=0;ie<te;ie++){G=G+a;var ne=Math.floor(G),le=Math.floor(G+a)-ne,se={dts:ne,pts:ne,cts:0,unit:B,size:B.byteLength,duration:le,originalDts:X,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};ee.push(se),_+=se.size}this._audioNextDts=G+a}else U=Math.floor(G),Q=Math.floor(G+a)-U,this._audioNextDts=G+a}else{if(U=X-e,N!==i.length-1){var oe=i[N+1].dts-this._dtsBase-e;Q=oe-U}else if(L!=null){var oe=L.dts-this._dtsBase-e;Q=oe-U}else K.length>=1?Q=K[K.length-1].duration:Q=Math.floor(a);this._audioNextDts=U+Q}s===-1&&(s=U),K.push({dts:U,pts:U,cts:0,unit:I.unit,size:I.unit.byteLength,duration:Q,originalDts:X,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Y&&K.push.apply(K,ee)}}if(K.length===0){t.samples=[],t.length=0;return}g?E=new Uint8Array(_):(E=new Uint8Array(_),E[0]=_>>>24&255,E[1]=_>>>16&255,E[2]=_>>>8&255,E[3]=_&255,E.set(p.default.types.mdat,4));for(var N=0;N<K.length;N++){var Z=K[N].unit;E.set(Z,y),y+=Z.byteLength}var J=K[K.length-1];l=J.dts+J.duration;var ae=new d.MediaSegmentInfo;ae.beginDts=s,ae.endDts=l,ae.beginPts=s,ae.endPts=l,ae.originalBeginDts=K[0].originalDts,ae.originalEndDts=J.originalDts+J.duration,ae.firstSample=new d.SampleInfo(K[0].dts,K[0].pts,K[0].duration,K[0].originalDts,!1),ae.lastSample=new d.SampleInfo(J.dts,J.pts,J.duration,J.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(ae),t.samples=K,t.sequenceNumber++;var fe=null;g?fe=new Uint8Array:fe=p.default.moof(t,s),t.samples=[],t.length=0;var de={type:"audio",data:this._mergeBoxes(fe,E).buffer,sampleCount:K.length,info:ae};g&&A&&(de.timestampOffset=s),this._onMediaSegment("audio",de)}}},c.prototype._remuxVideo=function(u,r){if(this._videoMeta!=null){var t=u,i=t.samples,e=void 0,s=-1,l=-1,a=-1,g=-1;if(!(!i||i.length===0)&&!(i.length===1&&!r)){var A=8,D=null,y=8+u.length,E=null;if(i.length>1&&(E=i.pop(),y-=E.length),this._videoStashedLastSample!=null){var _=this._videoStashedLastSample;this._videoStashedLastSample=null,i.unshift(_),y+=_.length}E!=null&&(this._videoStashedLastSample=E);var L=i[0].dts-this._dtsBase;if(this._videoNextDts)e=L-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())e=0;else{var I=this._videoSegmentInfoList.getLastSampleBefore(L);if(I!=null){var b=L-(I.originalDts+I.duration);b<=3&&(b=0);var R=I.dts+I.duration+b;e=L-R}else e=0}for(var P=new d.MediaSegmentInfo,w=[],F=0;F<i.length;F++){var _=i[F],k=_.dts-this._dtsBase,B=_.isKeyframe,U=k-e,j=_.cts,K=U+j;s===-1&&(s=U,a=K);var N=0;if(F!==i.length-1){var Z=i[F+1].dts-this._dtsBase-e;N=Z-U}else if(E!=null){var Z=E.dts-this._dtsBase-e;N=Z-U}else w.length>=1?N=w[w.length-1].duration:N=Math.floor(this._videoMeta.refSampleDuration);if(B){var X=new d.SampleInfo(U,K,N,_.dts,!0);X.fileposition=_.fileposition,P.appendSyncPoint(X)}w.push({dts:U,pts:K,cts:j,units:_.units,size:_.length,isKeyframe:B,duration:N,originalDts:k,flags:{isLeading:0,dependsOn:B?2:1,isDependedOn:B?1:0,hasRedundancy:0,isNonSync:B?0:1}})}D=new Uint8Array(y),D[0]=y>>>24&255,D[1]=y>>>16&255,D[2]=y>>>8&255,D[3]=y&255,D.set(p.default.types.mdat,4);for(var F=0;F<w.length;F++)for(var Y=w[F].units;Y.length;){var ee=Y.shift(),Q=ee.data;D.set(Q,A),A+=Q.byteLength}var G=w[w.length-1];if(l=G.dts+G.duration,g=G.pts+G.duration,this._videoNextDts=l,P.beginDts=s,P.endDts=l,P.beginPts=a,P.endPts=g,P.originalBeginDts=w[0].originalDts,P.originalEndDts=G.originalDts+G.duration,P.firstSample=new d.SampleInfo(w[0].dts,w[0].pts,w[0].duration,w[0].originalDts,w[0].isKeyframe),P.lastSample=new d.SampleInfo(G.dts,G.pts,G.duration,G.originalDts,G.isKeyframe),this._isLive||this._videoSegmentInfoList.append(P),t.samples=w,t.sequenceNumber++,this._forceFirstIDR){var q=w[0].flags;q.dependsOn=2,q.isNonSync=0}var te=p.default.moof(t,s);t.samples=[],t.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(te,D).buffer,sampleCount:w.length,info:P})}}},c.prototype._mergeBoxes=function(u,r){var t=new Uint8Array(u.byteLength+r.byteLength);return t.set(u,0),t.set(r,u.byteLength),t},c}();m.default=v},"./src/utils/browser.js":function(h,m,M){M.r(m);var T={};function p(){var f=self.navigator.userAgent.toLowerCase(),n=/(edge)\/([\w.]+)/.exec(f)||/(opr)[\/]([\w.]+)/.exec(f)||/(chrome)[ \/]([\w.]+)/.exec(f)||/(iemobile)[\/]([\w.]+)/.exec(f)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(f)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(f)||/(webkit)[ \/]([\w.]+)/.exec(f)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(f)||/(msie) ([\w.]+)/.exec(f)||f.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(f)||f.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(f)||[],d=/(ipad)/.exec(f)||/(ipod)/.exec(f)||/(windows phone)/.exec(f)||/(iphone)/.exec(f)||/(kindle)/.exec(f)||/(android)/.exec(f)||/(windows)/.exec(f)||/(mac)/.exec(f)||/(linux)/.exec(f)||/(cros)/.exec(f)||[],o={browser:n[5]||n[3]||n[1]||"",version:n[2]||n[4]||"0",majorVersion:n[4]||n[2]||"0",platform:d[0]||""},v={};if(o.browser){v[o.browser]=!0;var c=o.majorVersion.split(".");v.version={major:parseInt(o.majorVersion,10),string:o.version},c.length>1&&(v.version.minor=parseInt(c[1],10)),c.length>2&&(v.version.build=parseInt(c[2],10))}if(o.platform&&(v[o.platform]=!0),(v.chrome||v.opr||v.safari)&&(v.webkit=!0),v.rv||v.iemobile){v.rv&&delete v.rv;var u="msie";o.browser=u,v[u]=!0}if(v.edge){delete v.edge;var r="msedge";o.browser=r,v[r]=!0}if(v.opr){var t="opera";o.browser=t,v[t]=!0}if(v.safari&&v.android){var i="android";o.browser=i,v[i]=!0}v.name=o.browser,v.platform=o.platform;for(var e in T)T.hasOwnProperty(e)&&delete T[e];Object.assign(T,v)}p(),m.default=T},"./src/utils/exception.js":function(h,m,M){M.r(m),M.d(m,{RuntimeException:function(){return p},IllegalStateException:function(){return f},InvalidArgumentException:function(){return n},NotImplementedException:function(){return d}});var T=function(){var o=function(v,c){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,r){u.__proto__=r}||function(u,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(u[t]=r[t])},o(v,c)};return function(v,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");o(v,c);function u(){this.constructor=v}v.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),p=function(){function o(v){this._message=v}return Object.defineProperty(o.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),o.prototype.toString=function(){return this.name+": "+this.message},o}(),f=function(o){T(v,o);function v(c){return o.call(this,c)||this}return Object.defineProperty(v.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),v}(p),n=function(o){T(v,o);function v(c){return o.call(this,c)||this}return Object.defineProperty(v.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),v}(p),d=function(o){T(v,o);function v(c){return o.call(this,c)||this}return Object.defineProperty(v.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),v}(p)},"./src/utils/logger.js":function(h,m,M){M.r(m);var T=M("./node_modules/events/events.js"),p=M.n(T),f=function(){function n(){}return n.e=function(d,o){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var v="["+d+"] > "+o;n.ENABLE_CALLBACK&&n.emitter.emit("log","error",v),n.ENABLE_ERROR&&(console.error?console.error(v):console.warn?console.warn(v):console.log(v))},n.i=function(d,o){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var v="["+d+"] > "+o;n.ENABLE_CALLBACK&&n.emitter.emit("log","info",v),n.ENABLE_INFO&&(console.info?console.info(v):console.log(v))},n.w=function(d,o){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var v="["+d+"] > "+o;n.ENABLE_CALLBACK&&n.emitter.emit("log","warn",v),n.ENABLE_WARN&&(console.warn?console.warn(v):console.log(v))},n.d=function(d,o){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var v="["+d+"] > "+o;n.ENABLE_CALLBACK&&n.emitter.emit("log","debug",v),n.ENABLE_DEBUG&&(console.debug?console.debug(v):console.log(v))},n.v=function(d,o){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var v="["+d+"] > "+o;n.ENABLE_CALLBACK&&n.emitter.emit("log","verbose",v),n.ENABLE_VERBOSE&&console.log(v)},n}();f.GLOBAL_TAG="flv.js",f.FORCE_GLOBAL_TAG=!1,f.ENABLE_ERROR=!0,f.ENABLE_INFO=!0,f.ENABLE_WARN=!0,f.ENABLE_DEBUG=!0,f.ENABLE_VERBOSE=!0,f.ENABLE_CALLBACK=!1,f.emitter=new(p()),m.default=f},"./src/utils/logging-control.js":function(h,m,M){M.r(m);var T=M("./node_modules/events/events.js"),p=M.n(T),f=M("./src/utils/logger.js"),n=function(){function d(){}return Object.defineProperty(d,"forceGlobalTag",{get:function(){return f.default.FORCE_GLOBAL_TAG},set:function(o){f.default.FORCE_GLOBAL_TAG=o,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"globalTag",{get:function(){return f.default.GLOBAL_TAG},set:function(o){f.default.GLOBAL_TAG=o,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableAll",{get:function(){return f.default.ENABLE_VERBOSE&&f.default.ENABLE_DEBUG&&f.default.ENABLE_INFO&&f.default.ENABLE_WARN&&f.default.ENABLE_ERROR},set:function(o){f.default.ENABLE_VERBOSE=o,f.default.ENABLE_DEBUG=o,f.default.ENABLE_INFO=o,f.default.ENABLE_WARN=o,f.default.ENABLE_ERROR=o,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableDebug",{get:function(){return f.default.ENABLE_DEBUG},set:function(o){f.default.ENABLE_DEBUG=o,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableVerbose",{get:function(){return f.default.ENABLE_VERBOSE},set:function(o){f.default.ENABLE_VERBOSE=o,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableInfo",{get:function(){return f.default.ENABLE_INFO},set:function(o){f.default.ENABLE_INFO=o,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableWarn",{get:function(){return f.default.ENABLE_WARN},set:function(o){f.default.ENABLE_WARN=o,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableError",{get:function(){return f.default.ENABLE_ERROR},set:function(o){f.default.ENABLE_ERROR=o,d._notifyChange()},enumerable:!1,configurable:!0}),d.getConfig=function(){return{globalTag:f.default.GLOBAL_TAG,forceGlobalTag:f.default.FORCE_GLOBAL_TAG,enableVerbose:f.default.ENABLE_VERBOSE,enableDebug:f.default.ENABLE_DEBUG,enableInfo:f.default.ENABLE_INFO,enableWarn:f.default.ENABLE_WARN,enableError:f.default.ENABLE_ERROR,enableCallback:f.default.ENABLE_CALLBACK}},d.applyConfig=function(o){f.default.GLOBAL_TAG=o.globalTag,f.default.FORCE_GLOBAL_TAG=o.forceGlobalTag,f.default.ENABLE_VERBOSE=o.enableVerbose,f.default.ENABLE_DEBUG=o.enableDebug,f.default.ENABLE_INFO=o.enableInfo,f.default.ENABLE_WARN=o.enableWarn,f.default.ENABLE_ERROR=o.enableError,f.default.ENABLE_CALLBACK=o.enableCallback},d._notifyChange=function(){var o=d.emitter;if(o.listenerCount("change")>0){var v=d.getConfig();o.emit("change",v)}},d.registerListener=function(o){d.emitter.addListener("change",o)},d.removeListener=function(o){d.emitter.removeListener("change",o)},d.addLogListener=function(o){f.default.emitter.addListener("log",o),f.default.emitter.listenerCount("log")>0&&(f.default.ENABLE_CALLBACK=!0,d._notifyChange())},d.removeLogListener=function(o){f.default.emitter.removeListener("log",o),f.default.emitter.listenerCount("log")===0&&(f.default.ENABLE_CALLBACK=!1,d._notifyChange())},d}();n.emitter=new(p()),m.default=n},"./src/utils/polyfill.js":function(h,m,M){M.r(m);var T=function(){function p(){}return p.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(f,n){return f.__proto__=n,f},Object.assign=Object.assign||function(f){if(f==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(f),d=1;d<arguments.length;d++){var o=arguments[d];if(o!=null)for(var v in o)o.hasOwnProperty(v)&&(n[v]=o[v])}return n},typeof self.Promise!="function"&&M("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},p}();T.install(),m.default=T},"./src/utils/utf8-conv.js":function(h,m,M){M.r(m);function T(f,n,d){var o=f;if(n+d<o.length){for(;d--;)if((o[++n]&192)!==128)return!1;return!0}else return!1}function p(f){for(var n=[],d=f,o=0,v=f.length;o<v;){if(d[o]<128){n.push(String.fromCharCode(d[o])),++o;continue}else if(!(d[o]<192)){if(d[o]<224){if(T(d,o,1)){var c=(d[o]&31)<<6|d[o+1]&63;if(c>=128){n.push(String.fromCharCode(c&65535)),o+=2;continue}}}else if(d[o]<240){if(T(d,o,2)){var c=(d[o]&15)<<12|(d[o+1]&63)<<6|d[o+2]&63;if(c>=2048&&(c&63488)!==55296){n.push(String.fromCharCode(c&65535)),o+=3;continue}}}else if(d[o]<248&&T(d,o,3)){var c=(d[o]&7)<<18|(d[o+1]&63)<<12|(d[o+2]&63)<<6|d[o+3]&63;if(c>65536&&c<1114112){c-=65536,n.push(String.fromCharCode(c>>>10|55296)),n.push(String.fromCharCode(c&1023|56320)),o+=4;continue}}}n.push(String.fromCharCode(65533)),++o}return n.join("")}m.default=p}},C={};function x(h){var m=C[h];if(m!==void 0)return m.exports;var M=C[h]={exports:{}};return O[h].call(M.exports,M,M.exports,x),M.exports}x.m=O,function(){x.n=function(h){var m=h&&h.__esModule?function(){return h.default}:function(){return h};return x.d(m,{a:m}),m}}(),function(){x.d=function(h,m){for(var M in m)x.o(m,M)&&!x.o(h,M)&&Object.defineProperty(h,M,{enumerable:!0,get:m[M]})}}(),function(){x.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){x.o=function(h,m){return Object.prototype.hasOwnProperty.call(h,m)}}(),function(){x.r=function(h){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}}();var S=x("./src/index.js");return S}()})})(Ke);var vt=Fe(Ke.exports),We={exports:{}};(function(Te,Ie){typeof window!="undefined"&&function(C,x){Te.exports=x()}(we,function(){return function(O){var C={};function x(S){if(C[S])return C[S].exports;var h=C[S]={i:S,l:!1,exports:{}};return O[S].call(h.exports,h,h.exports,x),h.l=!0,h.exports}return x.m=O,x.c=C,x.d=function(S,h,m){x.o(S,h)||Object.defineProperty(S,h,{enumerable:!0,get:m})},x.r=function(S){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(S,"__esModule",{value:!0})},x.t=function(S,h){if(h&1&&(S=x(S)),h&8||h&4&&typeof S=="object"&&S&&S.__esModule)return S;var m=Object.create(null);if(x.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:S}),h&2&&typeof S!="string")for(var M in S)x.d(m,M,function(T){return S[T]}.bind(null,M));return m},x.n=function(S){var h=S&&S.__esModule?function(){return S.default}:function(){return S};return x.d(h,"a",h),h},x.o=function(S,h){return Object.prototype.hasOwnProperty.call(S,h)},x.p="/dist/",x(x.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(O,C,x){var S=Object.prototype.hasOwnProperty,h="~";function m(){}Object.create&&(m.prototype=Object.create(null),new m().__proto__||(h=!1));function M(n,d,o){this.fn=n,this.context=d,this.once=o||!1}function T(n,d,o,v,c){if(typeof o!="function")throw new TypeError("The listener must be a function");var u=new M(o,v||n,c),r=h?h+d:d;return n._events[r]?n._events[r].fn?n._events[r]=[n._events[r],u]:n._events[r].push(u):(n._events[r]=u,n._eventsCount++),n}function p(n,d){--n._eventsCount===0?n._events=new m:delete n._events[d]}function f(){this._events=new m,this._eventsCount=0}f.prototype.eventNames=function(){var d=[],o,v;if(this._eventsCount===0)return d;for(v in o=this._events)S.call(o,v)&&d.push(h?v.slice(1):v);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(o)):d},f.prototype.listeners=function(d){var o=h?h+d:d,v=this._events[o];if(!v)return[];if(v.fn)return[v.fn];for(var c=0,u=v.length,r=new Array(u);c<u;c++)r[c]=v[c].fn;return r},f.prototype.listenerCount=function(d){var o=h?h+d:d,v=this._events[o];return v?v.fn?1:v.length:0},f.prototype.emit=function(d,o,v,c,u,r){var t=h?h+d:d;if(!this._events[t])return!1;var i=this._events[t],e=arguments.length,s,l;if(i.fn){switch(i.once&&this.removeListener(d,i.fn,void 0,!0),e){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,o),!0;case 3:return i.fn.call(i.context,o,v),!0;case 4:return i.fn.call(i.context,o,v,c),!0;case 5:return i.fn.call(i.context,o,v,c,u),!0;case 6:return i.fn.call(i.context,o,v,c,u,r),!0}for(l=1,s=new Array(e-1);l<e;l++)s[l-1]=arguments[l];i.fn.apply(i.context,s)}else{var a=i.length,g;for(l=0;l<a;l++)switch(i[l].once&&this.removeListener(d,i[l].fn,void 0,!0),e){case 1:i[l].fn.call(i[l].context);break;case 2:i[l].fn.call(i[l].context,o);break;case 3:i[l].fn.call(i[l].context,o,v);break;case 4:i[l].fn.call(i[l].context,o,v,c);break;default:if(!s)for(g=1,s=new Array(e-1);g<e;g++)s[g-1]=arguments[g];i[l].fn.apply(i[l].context,s)}}return!0},f.prototype.on=function(d,o,v){return T(this,d,o,v,!1)},f.prototype.once=function(d,o,v){return T(this,d,o,v,!0)},f.prototype.removeListener=function(d,o,v,c){var u=h?h+d:d;if(!this._events[u])return this;if(!o)return p(this,u),this;var r=this._events[u];if(r.fn)r.fn===o&&(!c||r.once)&&(!v||r.context===v)&&p(this,u);else{for(var t=0,i=[],e=r.length;t<e;t++)(r[t].fn!==o||c&&!r[t].once||v&&r[t].context!==v)&&i.push(r[t]);i.length?this._events[u]=i.length===1?i[0]:i:p(this,u)}return this},f.prototype.removeAllListeners=function(d){var o;return d?(o=h?h+d:d,this._events[o]&&p(this,o)):(this._events=new m,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=h,f.EventEmitter=f,O.exports=f},"./node_modules/url-toolkit/src/url-toolkit.js":function(O,C,x){(function(S){var h=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,m=/^([^\/?#]*)([^]*)$/,M=/(?:\/|^)\.(?=\/)/g,T=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(f,n,d){if(d=d||{},f=f.trim(),n=n.trim(),!n){if(!d.alwaysNormalize)return f;var o=p.parseURL(f);if(!o)throw new Error("Error trying to parse base URL.");return o.path=p.normalizePath(o.path),p.buildURLFromParts(o)}var v=p.parseURL(n);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return d.alwaysNormalize?(v.path=p.normalizePath(v.path),p.buildURLFromParts(v)):n;var c=p.parseURL(f);if(!c)throw new Error("Error trying to parse base URL.");if(!c.netLoc&&c.path&&c.path[0]!=="/"){var u=m.exec(c.path);c.netLoc=u[1],c.path=u[2]}c.netLoc&&!c.path&&(c.path="/");var r={scheme:c.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(r.netLoc=c.netLoc,v.path[0]!=="/"))if(!v.path)r.path=c.path,v.params||(r.params=c.params,v.query||(r.query=c.query));else{var t=c.path,i=t.substring(0,t.lastIndexOf("/")+1)+v.path;r.path=p.normalizePath(i)}return r.path===null&&(r.path=d.alwaysNormalize?p.normalizePath(v.path):v.path),p.buildURLFromParts(r)},parseURL:function(f){var n=h.exec(f);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(M,"");f.length!==(f=f.replace(T,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};O.exports=p})()},"./node_modules/webworkify-webpack/index.js":function(O,C,x){function S(d){var o={};function v(u){if(o[u])return o[u].exports;var r=o[u]={i:u,l:!1,exports:{}};return d[u].call(r.exports,r,r.exports,v),r.l=!0,r.exports}v.m=d,v.c=o,v.i=function(u){return u},v.d=function(u,r,t){v.o(u,r)||Object.defineProperty(u,r,{configurable:!1,enumerable:!0,get:t})},v.r=function(u){Object.defineProperty(u,"__esModule",{value:!0})},v.n=function(u){var r=u&&u.__esModule?function(){return u.default}:function(){return u};return v.d(r,"a",r),r},v.o=function(u,r){return Object.prototype.hasOwnProperty.call(u,r)},v.p="/",v.oe=function(u){throw console.error(u),u};var c=v(v.s=ENTRY_MODULE);return c.default||c}var h="[\\.|\\-|\\+|\\w|/|@]+",m="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+h+").*?\\)";function M(d){return(d+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function T(d){return!isNaN(1*d)}function p(d,o,v){var c={};c[v]=[];var u=o.toString(),r=u.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!r)return c;for(var t=r[1],i=new RegExp("(\\\\n|\\W)"+M(t)+m,"g"),e;e=i.exec(u);)e[3]!=="dll-reference"&&c[v].push(e[3]);for(i=new RegExp("\\("+M(t)+'\\("(dll-reference\\s('+h+'))"\\)\\)'+m,"g");e=i.exec(u);)d[e[2]]||(c[v].push(e[1]),d[e[2]]=x(e[1]).m),c[e[2]]=c[e[2]]||[],c[e[2]].push(e[4]);for(var s=Object.keys(c),l=0;l<s.length;l++)for(var a=0;a<c[s[l]].length;a++)T(c[s[l]][a])&&(c[s[l]][a]=1*c[s[l]][a]);return c}function f(d){var o=Object.keys(d);return o.reduce(function(v,c){return v||d[c].length>0},!1)}function n(d,o){for(var v={main:[o]},c={main:[]},u={main:{}};f(v);)for(var r=Object.keys(v),t=0;t<r.length;t++){var i=r[t],e=v[i],s=e.pop();if(u[i]=u[i]||{},!(u[i][s]||!d[i][s])){u[i][s]=!0,c[i]=c[i]||[],c[i].push(s);for(var l=p(d,d[i][s],i),a=Object.keys(l),g=0;g<a.length;g++)v[a[g]]=v[a[g]]||[],v[a[g]]=v[a[g]].concat(l[a[g]])}}return c}O.exports=function(d,o){o=o||{};var v={main:x.m},c=o.all?{main:Object.keys(v.main)}:n(v,d),u="";Object.keys(c).filter(function(s){return s!=="main"}).forEach(function(s){for(var l=0;c[s][l];)l++;c[s].push(l),v[s][l]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+s+" = ("+S.toString().replace("ENTRY_MODULE",JSON.stringify(l))+")({"+c[s].map(function(a){return""+JSON.stringify(a)+": "+v[s][a].toString()}).join(",")+`});
`}),u=u+"new (("+S.toString().replace("ENTRY_MODULE",JSON.stringify(d))+")({"+c.main.map(function(s){return""+JSON.stringify(s)+": "+v.main[s].toString()}).join(",")+"}))(self);";var r=new window.Blob([u],{type:"text/javascript"});if(o.bare)return r;var t=window.URL||window.webkitURL||window.mozURL||window.msURL,i=t.createObjectURL(r),e=new window.Worker(i);return e.objectURL=i,e}},"./src/config.ts":function(O,C,x){x.r(C),x.d(C,"hlsDefaultConfig",function(){return g}),x.d(C,"mergeConfig",function(){return D}),x.d(C,"enableStreamingMode",function(){return y});var S=x("./src/controller/abr-controller.ts"),h=x("./src/controller/audio-stream-controller.ts"),m=x("./src/controller/audio-track-controller.ts"),M=x("./src/controller/subtitle-stream-controller.ts"),T=x("./src/controller/subtitle-track-controller.ts"),p=x("./src/controller/buffer-controller.ts"),f=x("./src/controller/timeline-controller.ts"),n=x("./src/controller/cap-level-controller.ts"),d=x("./src/controller/fps-controller.ts"),o=x("./src/controller/eme-controller.ts"),v=x("./src/controller/cmcd-controller.ts"),c=x("./src/utils/xhr-loader.ts"),u=x("./src/utils/fetch-loader.ts"),r=x("./src/utils/cues.ts"),t=x("./src/utils/mediakeys-helper.ts"),i=x("./src/utils/logger.ts");function e(){return e=Object.assign||function(E){for(var _=1;_<arguments.length;_++){var L=arguments[_];for(var I in L)Object.prototype.hasOwnProperty.call(L,I)&&(E[I]=L[I])}return E},e.apply(this,arguments)}function s(E,_){var L=Object.keys(E);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(E);_&&(I=I.filter(function(b){return Object.getOwnPropertyDescriptor(E,b).enumerable})),L.push.apply(L,I)}return L}function l(E){for(var _=1;_<arguments.length;_++){var L=arguments[_]!=null?arguments[_]:{};_%2?s(Object(L),!0).forEach(function(I){a(E,I,L[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(L)):s(Object(L)).forEach(function(I){Object.defineProperty(E,I,Object.getOwnPropertyDescriptor(L,I))})}return E}function a(E,_,L){return _ in E?Object.defineProperty(E,_,{value:L,enumerable:!0,configurable:!0,writable:!0}):E[_]=L,E}var g=l(l({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:c.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:S.default,bufferController:p.default,capLevelController:n.default,fpsController:d.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:t.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},A()),{},{subtitleStreamController:M.SubtitleStreamController,subtitleTrackController:T.default,timelineController:f.TimelineController,audioStreamController:h.default,audioTrackController:m.default,emeController:o.default,cmcdController:v.default});function A(){return{cueHandler:r.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function D(E,_){if((_.liveSyncDurationCount||_.liveMaxLatencyDurationCount)&&(_.liveSyncDuration||_.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(_.liveMaxLatencyDurationCount!==void 0&&(_.liveSyncDurationCount===void 0||_.liveMaxLatencyDurationCount<=_.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(_.liveMaxLatencyDuration!==void 0&&(_.liveSyncDuration===void 0||_.liveMaxLatencyDuration<=_.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return e({},E,_)}function y(E){var _=E.loader;if(_!==u.default&&_!==c.default)i.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),E.progressive=!1;else{var L=Object(u.fetchSupported)();L&&(E.loader=u.default,E.progressive=!0,E.enableSoftwareAES=!0,i.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),h=x("./src/utils/ewma-bandwidth-estimator.ts"),m=x("./src/events.ts"),M=x("./src/utils/buffer-helper.ts"),T=x("./src/errors.ts"),p=x("./src/types/loader.ts"),f=x("./src/utils/logger.ts");function n(v,c){for(var u=0;u<c.length;u++){var r=c[u];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(v,r.key,r)}}function d(v,c,u){return c&&n(v.prototype,c),u&&n(v,u),v}var o=function(){function v(u){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=u;var r=u.config;this.bwEstimator=new h.default(r.abrEwmaSlowVoD,r.abrEwmaFastVoD,r.abrEwmaDefaultEstimate),this.registerListeners()}var c=v.prototype;return c.registerListeners=function(){var r=this.hls;r.on(m.Events.FRAG_LOADING,this.onFragLoading,this),r.on(m.Events.FRAG_LOADED,this.onFragLoaded,this),r.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),r.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),r.on(m.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var r=this.hls;r.off(m.Events.FRAG_LOADING,this.onFragLoading,this),r.off(m.Events.FRAG_LOADED,this.onFragLoaded,this),r.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),r.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),r.off(m.Events.ERROR,this.onError,this)},c.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},c.onFragLoading=function(r,t){var i=t.frag;if(i.type===p.PlaylistLevelType.MAIN&&!this.timer){var e;this.fragCurrent=i,this.partCurrent=(e=t.part)!=null?e:null,this.timer=self.setInterval(this.onCheck,100)}},c.onLevelLoaded=function(r,t){var i=this.hls.config;t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)},c._abandonRulesCheck=function(){var r=this.fragCurrent,t=this.partCurrent,i=this.hls,e=i.autoLevelEnabled,s=i.config,l=i.media;if(!(!r||!l)){var a=t?t.stats:r.stats,g=t?t.duration:r.duration;if(a.aborted){f.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!e||l.paused||!l.playbackRate||!l.readyState)){var A=performance.now()-a.loading.start,D=Math.abs(l.playbackRate);if(!(A<=500*g/D)){var y=i.levels,E=i.minAutoLevel,_=y[r.level],L=a.total||Math.max(a.loaded,Math.round(g*_.maxBitrate/8)),I=Math.max(1,a.bwEstimate?a.bwEstimate/8:a.loaded*1e3/A),b=(L-a.loaded)/I,R=l.currentTime,P=(M.BufferHelper.bufferInfo(l,R,s.maxBufferHole).end-R)/D;if(!(P>=2*g/D||b<=P)){var w=Number.POSITIVE_INFINITY,F;for(F=r.level-1;F>E;F--){var k=y[F].maxBitrate;if(w=g*k/(8*.8*I),w<P)break}if(!(w>=b)){var B=this.bwEstimator.getEstimate();f.logger.warn("Fragment "+r.sn+(t?" part "+t.index:"")+" of level "+r.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+F+`
      Current BW estimate: `+(Object(S.isFiniteNumber)(B)?(B/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+b.toFixed(3)+` s
      Estimated load time for the next fragment: `+w.toFixed(3)+` s
      Time to underbuffer: `+P.toFixed(3)+" s"),i.nextLoadLevel=F,this.bwEstimator.sample(A,a.loaded),this.clearTimer(),r.loader&&(this.fragCurrent=this.partCurrent=null,r.loader.abort()),i.trigger(m.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:t,stats:a})}}}}}},c.onFragLoaded=function(r,t){var i=t.frag,e=t.part;if(i.type===p.PlaylistLevelType.MAIN&&Object(S.isFiniteNumber)(i.sn)){var s=e?e.stats:i.stats,l=e?e.duration:i.duration;if(this.clearTimer(),this.lastLoadedFragLevel=i.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[i.level],g=(a.loaded?a.loaded.bytes:0)+s.loaded,A=(a.loaded?a.loaded.duration:0)+l;a.loaded={bytes:g,duration:A},a.realBitrate=Math.round(8*g/A)}if(i.bitrateTest){var D={stats:s,frag:i,part:e,id:i.type};this.onFragBuffered(m.Events.FRAG_BUFFERED,D),i.bitrateTest=!1}}},c.onFragBuffered=function(r,t){var i=t.frag,e=t.part,s=e?e.stats:i.stats;if(!s.aborted&&!(i.type!==p.PlaylistLevelType.MAIN||i.sn==="initSegment")){var l=s.parsing.end-s.loading.start;this.bwEstimator.sample(l,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}},c.onError=function(r,t){switch(t.details){case T.ErrorDetails.FRAG_LOAD_ERROR:case T.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},c.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},c.getNextABRAutoLevel=function(){var r=this.fragCurrent,t=this.partCurrent,i=this.hls,e=i.maxAutoLevel,s=i.config,l=i.minAutoLevel,a=i.media,g=t?t.duration:r?r.duration:0,A=a?a.currentTime:0,D=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,y=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,E=(M.BufferHelper.bufferInfo(a,A,s.maxBufferHole).end-A)/D,_=this.findBestLevel(y,l,e,E,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(_>=0)return _;f.logger.trace((E?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var L=g?Math.min(g,s.maxStarvationDelay):s.maxStarvationDelay,I=s.abrBandWidthFactor,b=s.abrBandWidthUpFactor;if(!E){var R=this.bitrateTestDelay;if(R){var P=g?Math.min(g,s.maxLoadingDelay):s.maxLoadingDelay;L=P-R,f.logger.trace("bitrate test took "+Math.round(1e3*R)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*L)+" ms"),I=b=1}}return _=this.findBestLevel(y,l,e,E+L,I,b),Math.max(_,0)},c.findBestLevel=function(r,t,i,e,s,l){for(var a,g=this.fragCurrent,A=this.partCurrent,D=this.lastLoadedFragLevel,y=this.hls.levels,E=y[D],_=!!(E!=null&&(a=E.details)!==null&&a!==void 0&&a.live),L=E==null?void 0:E.codecSet,I=A?A.duration:g?g.duration:0,b=i;b>=t;b--){var R=y[b];if(!(!R||L&&R.codecSet!==L)){var P=R.details,w=(A?P==null?void 0:P.partTarget:P==null?void 0:P.averagetargetduration)||I,F=void 0;b<=D?F=s*r:F=l*r;var k=y[b].maxBitrate,B=k*w/F;if(f.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+b+"/"+Math.round(F)+"/"+k+"/"+w+"/"+e+"/"+B),F>k&&(!B||_&&!this.bitrateTestDelay||B<e))return b}}return-1},d(v,[{key:"nextAutoLevel",get:function(){var r=this._nextAutoLevel,t=this.bwEstimator;if(r!==-1&&(!t||!t.canEstimate()))return r;var i=this.getNextABRAutoLevel();return r!==-1&&(i=Math.min(r,i)),i},set:function(r){this._nextAutoLevel=r}}]),v}();C.default=o},"./src/controller/audio-stream-controller.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),h=x("./src/controller/base-stream-controller.ts"),m=x("./src/events.ts"),M=x("./src/utils/buffer-helper.ts"),T=x("./src/controller/fragment-tracker.ts"),p=x("./src/types/level.ts"),f=x("./src/types/loader.ts"),n=x("./src/loader/fragment.ts"),d=x("./src/demux/chunk-cache.ts"),o=x("./src/demux/transmuxer-interface.ts"),v=x("./src/types/transmuxer.ts"),c=x("./src/controller/fragment-finders.ts"),u=x("./src/utils/discontinuities.ts"),r=x("./src/errors.ts"),t=x("./src/utils/logger.ts");function i(){return i=Object.assign||function(g){for(var A=1;A<arguments.length;A++){var D=arguments[A];for(var y in D)Object.prototype.hasOwnProperty.call(D,y)&&(g[y]=D[y])}return g},i.apply(this,arguments)}function e(g,A){g.prototype=Object.create(A.prototype),g.prototype.constructor=g,s(g,A)}function s(g,A){return s=Object.setPrototypeOf||function(y,E){return y.__proto__=E,y},s(g,A)}var l=100,a=function(g){e(A,g);function A(y,E){var _;return _=g.call(this,y,E,"[audio-stream-controller]")||this,_.videoBuffer=null,_.videoTrackCC=-1,_.waitingVideoCC=-1,_.audioSwitch=!1,_.trackId=-1,_.waitingData=null,_.mainDetails=null,_.bufferFlushed=!1,_._registerListeners(),_}var D=A.prototype;return D.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},D._registerListeners=function(){var E=this.hls;E.on(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.on(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.on(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.on(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.on(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.on(m.Events.ERROR,this.onError,this),E.on(m.Events.BUFFER_RESET,this.onBufferReset,this),E.on(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.on(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.on(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var E=this.hls;E.off(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.off(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.off(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.off(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.off(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.off(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.off(m.Events.ERROR,this.onError,this),E.off(m.Events.BUFFER_RESET,this.onBufferReset,this),E.off(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.off(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.off(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onInitPtsFound=function(E,_){var L=_.frag,I=_.id,b=_.initPTS;if(I==="main"){var R=L.cc;this.initPTS[L.cc]=b,this.log("InitPTS for cc: "+R+" found from main: "+b),this.videoTrackCC=R,this.state===h.State.WAITING_INIT_PTS&&this.tick()}},D.startLoad=function(E){if(!this.levels){this.startPosition=E,this.state=h.State.STOPPED;return}var _=this.lastCurrentTime;this.stopLoad(),this.setInterval(l),this.fragLoadError=0,_>0&&E===-1?(this.log("Override startPosition with lastCurrentTime @"+_.toFixed(3)),this.state=h.State.IDLE):(this.loadedmetadata=!1,this.state=h.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=E,this.tick()},D.doTick=function(){switch(this.state){case h.State.IDLE:this.doTickIdle();break;case h.State.WAITING_TRACK:{var E,_=this.levels,L=this.trackId,I=_==null||(E=_[L])===null||E===void 0?void 0:E.details;if(I){if(this.waitForCdnTuneIn(I))break;this.state=h.State.WAITING_INIT_PTS}break}case h.State.FRAG_LOADING_WAITING_RETRY:{var b,R=performance.now(),P=this.retryDate;(!P||R>=P||(b=this.media)!==null&&b!==void 0&&b.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=h.State.IDLE);break}case h.State.WAITING_INIT_PTS:{var w=this.waitingData;if(w){var F=w.frag,k=w.part,B=w.cache,U=w.complete;if(this.initPTS[F.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=h.State.FRAG_LOADING;var j=B.flush(),K={frag:F,part:k,payload:j,networkDetails:null};this._handleFragmentLoadProgress(K),U&&g.prototype._handleFragmentLoadComplete.call(this,K)}else if(this.videoTrackCC!==this.waitingVideoCC)t.logger.log("Waiting fragment cc ("+F.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var N=this.getLoadPosition(),Z=M.BufferHelper.bufferInfo(this.mediaBuffer,N,this.config.maxBufferHole),X=Object(c.fragmentWithinToleranceTest)(Z.end,this.config.maxFragLookUpTolerance,F);X<0&&(t.logger.log("Waiting fragment cc ("+F.cc+") @ "+F.start+" cancelled because another fragment at "+Z.end+" is needed"),this.clearWaitingFragment())}}else this.state=h.State.IDLE}}this.onTickEnd()},D.clearWaitingFragment=function(){var E=this.waitingData;E&&(this.fragmentTracker.removeFragment(E.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=h.State.IDLE)},D.onTickEnd=function(){var E=this.media;if(!(!E||!E.readyState)){var _=this.mediaBuffer?this.mediaBuffer:E,L=_.buffered;!this.loadedmetadata&&L.length&&(this.loadedmetadata=!0),this.lastCurrentTime=E.currentTime}},D.doTickIdle=function(){var E,_,L=this.hls,I=this.levels,b=this.media,R=this.trackId,P=L.config;if(!(!I||!I[R])&&!(!b&&(this.startFragRequested||!P.startFragPrefetch))){var w=I[R],F=w.details;if(!F||F.live&&this.levelLastLoaded!==R||this.waitForCdnTuneIn(F)){this.state=h.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,n.ElementaryStreamTypes.AUDIO,f.PlaylistLevelType.AUDIO));var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,f.PlaylistLevelType.AUDIO);if(k!==null){var B=k.len,U=this.getMaxBufferLength(),j=this.audioSwitch;if(!(B>=U&&!j)){if(!j&&this._streamEnded(k,F)){L.trigger(m.Events.BUFFER_EOS,{type:"audio"}),this.state=h.State.ENDED;return}var K=F.fragments,N=K[0].start,Z=k.end;if(j){var X=this.getLoadPosition();Z=X,F.PTSKnown&&X<N&&(k.end>N||k.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),b.currentTime=N+.05)}var Y=this.getNextFragment(Z,F);if(!Y){this.bufferFlushed=!0;return}((E=Y.decryptdata)===null||E===void 0?void 0:E.keyFormat)==="identity"&&!((_=Y.decryptdata)!==null&&_!==void 0&&_.key)?this.loadKey(Y,F):this.loadFragment(Y,F,Z)}}}},D.getMaxBufferLength=function(){var E=g.prototype.getMaxBufferLength.call(this),_=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,f.PlaylistLevelType.MAIN);return _===null?E:Math.max(E,_.len)},D.onMediaDetaching=function(){this.videoBuffer=null,g.prototype.onMediaDetaching.call(this)},D.onAudioTracksUpdated=function(E,_){var L=_.audioTracks;this.resetTransmuxer(),this.levels=L.map(function(I){return new p.Level(I)})},D.onAudioTrackSwitching=function(E,_){var L=!!_.url;this.trackId=_.id;var I=this.fragCurrent;I!=null&&I.loader&&I.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),L?this.setInterval(l):this.resetTransmuxer(),L?(this.audioSwitch=!0,this.state=h.State.IDLE):this.state=h.State.STOPPED,this.tick()},D.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},D.onLevelLoaded=function(E,_){this.mainDetails=_.details},D.onAudioTrackLoaded=function(E,_){var L,I=this.levels,b=_.details,R=_.id;if(!I){this.warn("Audio tracks were reset while loading level "+R);return}this.log("Track "+R+" loaded ["+b.startSN+","+b.endSN+"],duration:"+b.totalduration);var P=I[R],w=0;if(b.live||(L=P.details)!==null&&L!==void 0&&L.live){var F=this.mainDetails;if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed||!F)return;!P.details&&b.hasProgramDateTime&&F.hasProgramDateTime?(Object(u.alignMediaPlaylistByPDT)(b,F),w=b.fragments[0].start):w=this.alignPlaylists(b,P.details)}P.details=b,this.levelLastLoaded=R,!this.startFragRequested&&(this.mainDetails||!b.live)&&this.setStartPosition(P.details,w),this.state===h.State.WAITING_TRACK&&!this.waitForCdnTuneIn(b)&&(this.state=h.State.IDLE),this.tick()},D._handleFragmentLoadProgress=function(E){var _,L=E.frag,I=E.part,b=E.payload,R=this.config,P=this.trackId,w=this.levels;if(!w){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+L.sn+" of level "+L.level+" will not be buffered");return}var F=w[P];console.assert(F,"Audio track is defined on fragment load progress");var k=F.details;console.assert(k,"Audio track details are defined on fragment load progress");var B=R.defaultAudioCodec||F.audioCodec||"mp4a.40.2",U=this.transmuxer;U||(U=this.transmuxer=new o.default(this.hls,f.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var j=this.initPTS[L.cc],K=(_=L.initSegment)===null||_===void 0?void 0:_.data;if(j!==void 0){var N=!1,Z=I?I.index:-1,X=Z!==-1,Y=new v.ChunkMetadata(L.level,L.sn,L.stats.chunkCount,b.byteLength,Z,X);U.push(b,K,B,"",L,I,k.totalduration,N,Y,j)}else{t.logger.log("Unknown video PTS for cc "+L.cc+", waiting for video PTS before demuxing audio frag "+L.sn+" of ["+k.startSN+" ,"+k.endSN+"],track "+P);var ee=this.waitingData=this.waitingData||{frag:L,part:I,cache:new d.default,complete:!1},Q=ee.cache;Q.push(new Uint8Array(b)),this.waitingVideoCC=this.videoTrackCC,this.state=h.State.WAITING_INIT_PTS}},D._handleFragmentLoadComplete=function(E){if(this.waitingData){this.waitingData.complete=!0;return}g.prototype._handleFragmentLoadComplete.call(this,E)},D.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},D.onBufferCreated=function(E,_){var L=_.tracks.audio;L&&(this.mediaBuffer=L.buffer),_.tracks.video&&(this.videoBuffer=_.tracks.video.buffer)},D.onFragBuffered=function(E,_){var L=_.frag,I=_.part;if(L.type===f.PlaylistLevelType.AUDIO){if(this.fragContextChanged(L)){this.warn("Fragment "+L.sn+(I?" p: "+I.index:"")+" of level "+L.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}L.sn!=="initSegment"&&(this.fragPrevious=L,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(L,I)}},D.onError=function(E,_){switch(_.details){case r.ErrorDetails.FRAG_LOAD_ERROR:case r.ErrorDetails.FRAG_LOAD_TIMEOUT:case r.ErrorDetails.KEY_LOAD_ERROR:case r.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(f.PlaylistLevelType.AUDIO,_);break;case r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==h.State.ERROR&&this.state!==h.State.STOPPED&&(this.state=_.fatal?h.State.ERROR:h.State.IDLE,this.warn(_.details+" while loading frag, switching to "+this.state+" state"));break;case r.ErrorDetails.BUFFER_FULL_ERROR:if(_.parent==="audio"&&(this.state===h.State.PARSING||this.state===h.State.PARSED)){var L=!0,I=this.getFwdBufferInfo(this.mediaBuffer,f.PlaylistLevelType.AUDIO);I&&I.len>.5&&(L=!this.reduceMaxBufferLength(I.len)),L&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},D.onBufferFlushed=function(E,_){var L=_.type;L===n.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},D._handleTransmuxComplete=function(E){var _,L="audio",I=this.hls,b=E.remuxResult,R=E.chunkMeta,P=this.getCurrentContext(R);if(!P){this.warn("The loading context changed while buffering fragment "+R.sn+" of level "+R.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(R.level);return}var w=P.frag,F=P.part,k=b.audio,B=b.text,U=b.id3,j=b.initSegment;if(!this.fragContextChanged(w)){if(this.state=h.State.PARSING,this.audioSwitch&&k&&this.completeAudioSwitch(),j!=null&&j.tracks&&(this._bufferInitSegment(j.tracks,w,R),I.trigger(m.Events.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:L,tracks:j.tracks})),k){var K=k.startPTS,N=k.endPTS,Z=k.startDTS,X=k.endDTS;F&&(F.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:K,endPTS:N,startDTS:Z,endDTS:X}),w.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,K,N,Z,X),this.bufferFragmentData(k,w,F,R)}if(U!=null&&(_=U.samples)!==null&&_!==void 0&&_.length){var Y=i({frag:w,id:L},U);I.trigger(m.Events.FRAG_PARSING_METADATA,Y)}if(B){var ee=i({frag:w,id:L},B);I.trigger(m.Events.FRAG_PARSING_USERDATA,ee)}}},D._bufferInitSegment=function(E,_,L){if(this.state===h.State.PARSING){E.video&&delete E.video;var I=E.audio;if(!!I){I.levelCodec=I.codec,I.id="audio",this.log("Init audio buffer, container:"+I.container+", codecs[parsed]=["+I.codec+"]"),this.hls.trigger(m.Events.BUFFER_CODECS,E);var b=I.initSegment;if(b!=null&&b.byteLength){var R={type:"audio",frag:_,part:null,chunkMeta:L,parent:_.type,data:b};this.hls.trigger(m.Events.BUFFER_APPENDING,R)}this.tick()}}},D.loadFragment=function(E,_,L){var I=this.fragmentTracker.getState(E);this.fragCurrent=E,(this.audioSwitch||I===T.FragmentState.NOT_LOADED||I===T.FragmentState.PARTIAL)&&(E.sn==="initSegment"?this._loadInitSegment(E):_.live&&!Object(S.isFiniteNumber)(this.initPTS[E.cc])?(this.log("Waiting for video PTS in continuity counter "+E.cc+" of live stream before loading audio fragment "+E.sn+" of level "+this.trackId),this.state=h.State.WAITING_INIT_PTS):(this.startFragRequested=!0,g.prototype.loadFragment.call(this,E,_,L)))},D.completeAudioSwitch=function(){var E=this.hls,_=this.media,L=this.trackId;_&&(this.log("Switching audio track : flushing all audio"),g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,E.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:L})},A}(h.default);C.default=a},"./src/controller/audio-track-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/controller/base-playlist-controller.ts"),M=x("./src/types/loader.ts");function T(o,v){for(var c=0;c<v.length;c++){var u=v[c];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(o,u.key,u)}}function p(o,v,c){return v&&T(o.prototype,v),c&&T(o,c),o}function f(o,v){o.prototype=Object.create(v.prototype),o.prototype.constructor=o,n(o,v)}function n(o,v){return n=Object.setPrototypeOf||function(u,r){return u.__proto__=r,u},n(o,v)}var d=function(o){f(v,o);function v(u){var r;return r=o.call(this,u,"[audio-track-controller]")||this,r.tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.trackName="",r.selectDefaultTrack=!0,r.registerListeners(),r}var c=v.prototype;return c.registerListeners=function(){var r=this.hls;r.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),r.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),r.on(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),r.on(S.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),r.on(S.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var r=this.hls;r.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),r.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),r.off(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),r.off(S.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),r.off(S.Events.ERROR,this.onError,this)},c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,o.prototype.destroy.call(this)},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},c.onManifestParsed=function(r,t){this.tracks=t.audioTracks||[]},c.onAudioTrackLoaded=function(r,t){var i=t.id,e=t.details,s=this.tracksInGroup[i];if(!s){this.warn("Invalid audio track id "+i);return}var l=s.details;s.details=t.details,this.log("audioTrack "+i+" loaded ["+e.startSN+"-"+e.endSN+"]"),i===this.trackId&&(this.retryCount=0,this.playlistLoaded(i,t,l))},c.onLevelLoading=function(r,t){this.switchLevel(t.level)},c.onLevelSwitching=function(r,t){this.switchLevel(t.level)},c.switchLevel=function(r){var t=this.hls.levels[r];if(!!(t!=null&&t.audioGroupIds)){var i=t.audioGroupIds[t.urlId];if(this.groupId!==i){this.groupId=i;var e=this.tracks.filter(function(l){return!i||l.groupId===i});this.selectDefaultTrack&&!e.some(function(l){return l.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;var s={audioTracks:e};this.log("Updating audio tracks, "+e.length+' track(s) found in "'+i+'" group-id'),this.hls.trigger(S.Events.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}}},c.onError=function(r,t){o.prototype.onError.call(this,r,t),!(t.fatal||!t.context)&&t.context.type===M.PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.retryLoadingOrFail(t)},c.setAudioTrack=function(r){var t=this.tracksInGroup;if(r<0||r>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var i=t[this.trackId];this.log("Now switching to audio-track index "+r);var e=t[r],s=e.id,l=e.groupId,a=l===void 0?"":l,g=e.name,A=e.type,D=e.url;if(this.trackId=r,this.trackName=g,this.selectDefaultTrack=!1,this.hls.trigger(S.Events.AUDIO_TRACK_SWITCHING,{id:s,groupId:a,name:g,type:A,url:D}),!(e.details&&!e.details.live)){var y=this.switchParams(e.url,i==null?void 0:i.details);this.loadPlaylist(y)}},c.selectInitialTrack=function(){var r=this.tracksInGroup;console.assert(r.length,"Initial audio track should be selected when tracks are known");var t=this.trackName,i=this.findTrackId(t)||this.findTrackId();i!==-1?this.setAudioTrack(i):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},c.findTrackId=function(r){for(var t=this.tracksInGroup,i=0;i<t.length;i++){var e=t[i];if((!this.selectDefaultTrack||e.default)&&(!r||r===e.name))return e.id}return-1},c.loadPlaylist=function(r){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var i=t.id,e=t.groupId,s=t.url;if(r)try{s=r.addDirectives(s)}catch(l){this.warn("Could not construct new URL with HLS Delivery Directives: "+l)}this.log("loading audio-track playlist for id: "+i),this.clearTimer(),this.hls.trigger(S.Events.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:e,deliveryDirectives:r||null})}},p(v,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(r){this.selectDefaultTrack=!1,this.setAudioTrack(r)}}]),v}(m.default);C.default=d},"./src/controller/base-playlist-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return p});var S=x("./src/polyfills/number.ts"),h=x("./src/types/level.ts"),m=x("./src/controller/level-helper.ts"),M=x("./src/utils/logger.ts"),T=x("./src/errors.ts"),p=function(){function f(d,o){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=M.logger.log.bind(M.logger,o+":"),this.warn=M.logger.warn.bind(M.logger,o+":"),this.hls=d}var n=f.prototype;return n.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},n.onError=function(o,v){v.fatal&&v.type===T.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},n.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},n.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},n.stopLoad=function(){this.canLoad=!1,this.clearTimer()},n.switchParams=function(o,v){var c=v==null?void 0:v.renditionReports;if(c)for(var u=0;u<c.length;u++){var r=c[u],t=""+r.URI;if(t===o.substr(-t.length)){var i=parseInt(r["LAST-MSN"]),e=parseInt(r["LAST-PART"]);if(v&&this.hls.config.lowLatencyMode){var s=Math.min(v.age-v.partTarget,v.targetduration);e!==void 0&&s>v.partTarget&&(e+=1)}if(Object(S.isFiniteNumber)(i))return new h.HlsUrlParameters(i,Object(S.isFiniteNumber)(e)?e:void 0,h.HlsSkip.No)}}},n.loadPlaylist=function(o){},n.shouldLoadTrack=function(o){return this.canLoad&&o&&!!o.url&&(!o.details||o.details.live)},n.playlistLoaded=function(o,v,c){var u=this,r=v.details,t=v.stats,i=t.loading.end?Math.max(0,self.performance.now()-t.loading.end):0;if(r.advancedDateTime=Date.now()-i,r.live||c!=null&&c.live){if(r.reloaded(c),c&&this.log("live playlist "+o+" "+(r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:"MISSED")),c&&r.fragments.length>0&&Object(m.mergeDetails)(c,r),!this.canLoad||!r.live)return;var e,s=void 0,l=void 0;if(r.canBlockReload&&r.endSN&&r.advanced){var a=this.hls.config.lowLatencyMode,g=r.lastPartSn,A=r.endSN,D=r.lastPartIndex,y=D!==-1,E=g===A,_=a?0:D;y?(s=E?A+1:g,l=E?_:D+1):s=A+1;var L=r.age,I=L+r.ageHeader,b=Math.min(I-r.partTarget,r.targetduration*1.5);if(b>0){if(c&&b>c.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+c.tuneInGoal+" to: "+b+" with playlist age: "+r.age),b=0;else{var R=Math.floor(b/r.targetduration);if(s+=R,l!==void 0){var P=Math.round(b%r.targetduration/r.partTarget);l+=P}this.log("CDN Tune-in age: "+r.ageHeader+"s last advanced "+L.toFixed(2)+"s goal: "+b+" skip sn "+R+" to part "+l)}r.tuneInGoal=b}if(e=this.getDeliveryDirectives(r,v.deliveryDirectives,s,l),a||!E){this.loadPlaylist(e);return}}else e=this.getDeliveryDirectives(r,v.deliveryDirectives,s,l);var w=Object(m.computeReloadInterval)(r,t);s!==void 0&&r.canBlockReload&&(w-=r.partTarget||1),this.log("reload live playlist "+o+" in "+Math.round(w)+" ms"),this.timer=self.setTimeout(function(){return u.loadPlaylist(e)},w)}else this.clearTimer()},n.getDeliveryDirectives=function(o,v,c,u){var r=Object(h.getSkipValue)(o,c);return v!=null&&v.skip&&o.deltaUpdateFailed&&(c=v.msn,u=v.part,r=h.HlsSkip.No),new h.HlsUrlParameters(c,u,r)},n.retryLoadingOrFail=function(o){var v=this,c=this.hls.config,u=this.retryCount<c.levelLoadingMaxRetry;if(u){var r;if(this.retryCount++,o.details.indexOf("LoadTimeOut")>-1&&(r=o.context)!==null&&r!==void 0&&r.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+o.details+'"'),this.loadPlaylist();else{var t=Math.min(Math.pow(2,this.retryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return v.loadPlaylist()},t),this.warn("retry playlist loading #"+this.retryCount+" in "+t+' ms after "'+o.details+'"')}}else this.warn('cannot recover from error "'+o.details+'"'),this.clearTimer(),o.fatal=!0;return u},f}()},"./src/controller/base-stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"State",function(){return A}),x.d(C,"default",function(){return D});var S=x("./src/polyfills/number.ts"),h=x("./src/task-loop.ts"),m=x("./src/controller/fragment-tracker.ts"),M=x("./src/utils/buffer-helper.ts"),T=x("./src/utils/logger.ts"),p=x("./src/events.ts"),f=x("./src/errors.ts"),n=x("./src/types/transmuxer.ts"),d=x("./src/utils/mp4-tools.ts"),o=x("./src/utils/discontinuities.ts"),v=x("./src/controller/fragment-finders.ts"),c=x("./src/controller/level-helper.ts"),u=x("./src/loader/fragment-loader.ts"),r=x("./src/crypt/decrypter.ts"),t=x("./src/utils/time-ranges.ts"),i=x("./src/types/loader.ts");function e(y,E){for(var _=0;_<E.length;_++){var L=E[_];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(y,L.key,L)}}function s(y,E,_){return E&&e(y.prototype,E),_&&e(y,_),y}function l(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function a(y,E){y.prototype=Object.create(E.prototype),y.prototype.constructor=y,g(y,E)}function g(y,E){return g=Object.setPrototypeOf||function(L,I){return L.__proto__=I,L},g(y,E)}var A={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},D=function(y){a(E,y);function E(L,I,b){var R;return R=y.call(this)||this,R.hls=void 0,R.fragPrevious=null,R.fragCurrent=null,R.fragmentTracker=void 0,R.transmuxer=null,R._state=A.STOPPED,R.media=void 0,R.mediaBuffer=void 0,R.config=void 0,R.bitrateTest=!1,R.lastCurrentTime=0,R.nextLoadPosition=0,R.startPosition=0,R.loadedmetadata=!1,R.fragLoadError=0,R.retryDate=0,R.levels=null,R.fragmentLoader=void 0,R.levelLastLoaded=null,R.startFragRequested=!1,R.decrypter=void 0,R.initPTS=[],R.onvseeking=null,R.onvended=null,R.logPrefix="",R.log=void 0,R.warn=void 0,R.logPrefix=b,R.log=T.logger.log.bind(T.logger,b+":"),R.warn=T.logger.warn.bind(T.logger,b+":"),R.hls=L,R.fragmentLoader=new u.default(L.config),R.fragmentTracker=I,R.config=L.config,R.decrypter=new r.default(L,L.config),L.on(p.Events.KEY_LOADED,R.onKeyLoaded,l(R)),R}var _=E.prototype;return _.doTick=function(){this.onTickEnd()},_.onTickEnd=function(){},_.startLoad=function(I){},_.stopLoad=function(){this.fragmentLoader.abort();var I=this.fragCurrent;I&&this.fragmentTracker.removeFragment(I),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=A.STOPPED},_._streamEnded=function(I,b){var R=this.fragCurrent,P=this.fragmentTracker;if(!b.live&&R&&R.sn>=b.endSN&&!I.nextStart){var w=b.partList;if(w!=null&&w.length){var F=w[w.length-1],k=M.BufferHelper.isBuffered(this.media,F.start+F.duration/2);return k}var B=P.getState(R);return B===m.FragmentState.PARTIAL||B===m.FragmentState.OK}return!1},_.onMediaAttached=function(I,b){var R=this.media=this.mediaBuffer=b.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),R.addEventListener("seeking",this.onvseeking),R.addEventListener("ended",this.onvended);var P=this.config;this.levels&&P.autoStartLoad&&this.state===A.STOPPED&&this.startLoad(P.startPosition)},_.onMediaDetaching=function(){var I=this.media;I!=null&&I.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),I&&(I.removeEventListener("seeking",this.onvseeking),I.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},_.onMediaSeeking=function(){var I=this.config,b=this.fragCurrent,R=this.media,P=this.mediaBuffer,w=this.state,F=R?R.currentTime:0,k=M.BufferHelper.bufferInfo(P||R,F,I.maxBufferHole);if(this.log("media seeking to "+(Object(S.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+w),w===A.ENDED)this.resetLoadingState();else if(b&&!k.len){var B=I.maxFragLookUpTolerance,U=b.start-B,j=b.start+b.duration+B,K=F>j;(F<U||K)&&(K&&b.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),b.loader.abort()),this.resetLoadingState())}R&&(this.lastCurrentTime=F),!this.loadedmetadata&&!k.len&&(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},_.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},_.onKeyLoaded=function(I,b){if(!(this.state!==A.KEY_LOADING||b.frag!==this.fragCurrent||!this.levels)){this.state=A.IDLE;var R=this.levels[b.frag.level].details;R&&this.loadFragment(b.frag,R,b.frag.start)}},_.onHandlerDestroying=function(){this.stopLoad(),y.prototype.onHandlerDestroying.call(this)},_.onHandlerDestroyed=function(){this.state=A.STOPPED,this.hls.off(p.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,y.prototype.onHandlerDestroyed.call(this)},_.loadKey=function(I,b){this.log("Loading key for "+I.sn+" of ["+b.startSN+"-"+b.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level),this.state=A.KEY_LOADING,this.fragCurrent=I,this.hls.trigger(p.Events.KEY_LOADING,{frag:I})},_.loadFragment=function(I,b,R){this._loadFragForPlayback(I,b,R)},_._loadFragForPlayback=function(I,b,R){var P=this,w=function(k){if(P.fragContextChanged(I)){P.warn("Fragment "+I.sn+(k.part?" p: "+k.part.index:"")+" of level "+I.level+" was dropped during download."),P.fragmentTracker.removeFragment(I);return}I.stats.chunkCount++,P._handleFragmentLoadProgress(k)};this._doFragLoad(I,b,R,w).then(function(F){if(!!F){P.fragLoadError=0;var k=P.state;if(P.fragContextChanged(I)){(k===A.FRAG_LOADING||k===A.BACKTRACKING||!P.fragCurrent&&k===A.PARSING)&&(P.fragmentTracker.removeFragment(I),P.state=A.IDLE);return}if("payload"in F&&(P.log("Loaded fragment "+I.sn+" of level "+I.level),P.hls.trigger(p.Events.FRAG_LOADED,F),P.state===A.BACKTRACKING)){P.fragmentTracker.backtrack(I,F),P.resetFragmentLoading(I);return}P._handleFragmentLoadComplete(F)}}).catch(function(F){P.warn(F),P.resetFragmentLoading(I)})},_.flushMainBuffer=function(I,b,R){if(R===void 0&&(R=null),!!(I-b)){var P={startOffset:I,endOffset:b,type:R};this.fragLoadError=0,this.hls.trigger(p.Events.BUFFER_FLUSHING,P)}},_._loadInitSegment=function(I){var b=this;this._doFragLoad(I).then(function(R){if(!R||b.fragContextChanged(I)||!b.levels)throw new Error("init load aborted");return R}).then(function(R){var P=b.hls,w=R.payload,F=I.decryptdata;if(w&&w.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var k=self.performance.now();return b.decrypter.webCryptoDecrypt(new Uint8Array(w),F.key.buffer,F.iv.buffer).then(function(B){var U=self.performance.now();return P.trigger(p.Events.FRAG_DECRYPTED,{frag:I,payload:B,stats:{tstart:k,tdecrypt:U}}),R.payload=B,R})}return R}).then(function(R){var P=b.fragCurrent,w=b.hls,F=b.levels;if(!F)throw new Error("init load aborted, missing levels");var k=F[I.level].details;console.assert(k,"Level details are defined when init segment is loaded");var B=I.stats;b.state=A.IDLE,b.fragLoadError=0,I.data=new Uint8Array(R.payload),B.parsing.start=B.buffering.start=self.performance.now(),B.parsing.end=B.buffering.end=self.performance.now(),R.frag===P&&w.trigger(p.Events.FRAG_BUFFERED,{stats:B,frag:P,part:null,id:I.type}),b.tick()}).catch(function(R){b.warn(R),b.resetFragmentLoading(I)})},_.fragContextChanged=function(I){var b=this.fragCurrent;return!I||!b||I.level!==b.level||I.sn!==b.sn||I.urlId!==b.urlId},_.fragBufferedComplete=function(I,b){var R=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+I.type+" sn: "+I.sn+(b?" part: "+b.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level+" "+t.default.toString(M.BufferHelper.getBuffered(R))),this.state=A.IDLE,this.tick()},_._handleFragmentLoadComplete=function(I){var b=this.transmuxer;if(!!b){var R=I.frag,P=I.part,w=I.partsLoaded,F=!w||w.length===0||w.some(function(B){return!B}),k=new n.ChunkMetadata(R.level,R.sn,R.stats.chunkCount+1,0,P?P.index:-1,!F);b.flush(k)}},_._handleFragmentLoadProgress=function(I){},_._doFragLoad=function(I,b,R,P){var w=this;if(R===void 0&&(R=null),!this.levels)throw new Error("frag load aborted, missing levels");if(R=Math.max(I.start,R||0),this.config.lowLatencyMode&&b){var F=b.partList;if(F&&P){R>I.end&&b.fragmentHint&&(I=b.fragmentHint);var k=this.getNextPart(F,I,R);if(k>-1){var B=F[k];return this.log("Loading part sn: "+I.sn+" p: "+B.index+" cc: "+I.cc+" of playlist ["+b.startSN+"-"+b.endSN+"] parts [0-"+k+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),this.nextLoadPosition=B.start+B.duration,this.state=A.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:I,part:F[k],targetBufferTime:R}),this.doFragPartsLoad(I,F,k,P).catch(function(U){return w.handleFragLoadError(U)})}else if(!I.url||this.loadedEndOfParts(F,R))return Promise.resolve(null)}}return this.log("Loading fragment "+I.sn+" cc: "+I.cc+" "+(b?"of ["+b.startSN+"-"+b.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),Object(S.isFiniteNumber)(I.sn)&&!this.bitrateTest&&(this.nextLoadPosition=I.start+I.duration),this.state=A.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:I,targetBufferTime:R}),this.fragmentLoader.load(I,P).catch(function(U){return w.handleFragLoadError(U)})},_.doFragPartsLoad=function(I,b,R,P){var w=this;return new Promise(function(F,k){var B=[],U=function j(K){var N=b[K];w.fragmentLoader.loadPart(I,N,P).then(function(Z){B[N.index]=Z;var X=Z.part;w.hls.trigger(p.Events.FRAG_LOADED,Z);var Y=b[K+1];if(Y&&Y.fragment===I)j(K+1);else return F({frag:I,part:X,partsLoaded:B})}).catch(k)};U(R)})},_.handleFragLoadError=function(I){var b=I.data;return b&&b.details===f.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(b.frag,b.part):this.hls.trigger(p.Events.ERROR,b),null},_._handleTransmuxerFlush=function(I){var b=this.getCurrentContext(I);if(!b||this.state!==A.PARSING){this.fragCurrent||(this.state=A.IDLE);return}var R=b.frag,P=b.part,w=b.level,F=self.performance.now();R.stats.parsing.end=F,P&&(P.stats.parsing.end=F),this.updateLevelTiming(R,P,w,I.partial)},_.getCurrentContext=function(I){var b=this.levels,R=I.level,P=I.sn,w=I.part;if(!b||!b[R])return this.warn("Levels object was unset while buffering fragment "+P+" of level "+R+". The current chunk will not be buffered."),null;var F=b[R],k=w>-1?Object(c.getPartWith)(F,P,w):null,B=k?k.fragment:Object(c.getFragmentWithSN)(F,P,this.fragCurrent);return B?{frag:B,part:k,level:F}:null},_.bufferFragmentData=function(I,b,R,P){if(!(!I||this.state!==A.PARSING)){var w=I.data1,F=I.data2,k=w;if(w&&F&&(k=Object(d.appendUint8Array)(w,F)),!(!k||!k.length)){var B={type:I.type,frag:b,part:R,chunkMeta:P,parent:b.type,data:k};this.hls.trigger(p.Events.BUFFER_APPENDING,B),I.dropped&&I.independent&&!R&&this.flushBufferGap(b)}}},_.flushBufferGap=function(I){var b=this.media;if(!!b){if(!M.BufferHelper.isBuffered(b,b.currentTime)){this.flushMainBuffer(0,I.start);return}var R=b.currentTime,P=M.BufferHelper.bufferInfo(b,R,0),w=I.duration,F=Math.min(this.config.maxFragLookUpTolerance*2,w*.25),k=Math.max(Math.min(I.start-F,P.end-F),R+F);I.start-k>F&&this.flushMainBuffer(k,I.start)}},_.getFwdBufferInfo=function(I,b){var R=this.config,P=this.getLoadPosition();if(!Object(S.isFiniteNumber)(P))return null;var w=M.BufferHelper.bufferInfo(I,P,R.maxBufferHole);if(w.len===0&&w.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(P,b);if(F&&w.nextStart<F.end)return M.BufferHelper.bufferInfo(I,P,Math.max(w.nextStart,R.maxBufferHole))}return w},_.getMaxBufferLength=function(I){var b=this.config,R;return I?R=Math.max(8*b.maxBufferSize/I,b.maxBufferLength):R=b.maxBufferLength,Math.min(R,b.maxMaxBufferLength)},_.reduceMaxBufferLength=function(I){var b=this.config,R=I||b.maxBufferLength;return b.maxMaxBufferLength>=R?(b.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+b.maxMaxBufferLength+"s"),!0):!1},_.getNextFragment=function(I,b){var R,P,w=b.fragments,F=w.length;if(!F)return null;var k=this.config,B=w[0].start,U;if(b.live){var j=k.initialLiveManifestSize;if(F<j)return this.warn("Not enough fragments to start playback (have: "+F+", need: "+j+")"),null;!b.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(U=this.getInitialLiveFragment(b,w),this.startPosition=U?this.hls.liveSyncPosition||U.start:I)}else I<=B&&(U=w[0]);if(!U){var K=k.lowLatencyMode?b.partEnd:b.fragmentEnd;U=this.getFragmentAtPosition(I,K,b)}return(R=U)!==null&&R!==void 0&&R.initSegment&&!((P=U)!==null&&P!==void 0&&P.initSegment.data)&&!this.bitrateTest&&(U=U.initSegment),U},_.getNextPart=function(I,b,R){for(var P=-1,w=!1,F=!0,k=0,B=I.length;k<B;k++){var U=I[k];if(F=F&&!U.independent,P>-1&&R<U.start)break;var j=U.loaded;!j&&(w||U.independent||F)&&U.fragment===b&&(P=k),w=j}return P},_.loadedEndOfParts=function(I,b){var R=I[I.length-1];return R&&b>R.start&&R.loaded},_.getInitialLiveFragment=function(I,b){var R=this.fragPrevious,P=null;if(R){if(I.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+R.programDateTime),P=Object(v.findFragmentByPDT)(b,R.endProgramDateTime,this.config.maxFragLookUpTolerance)),!P){var w=R.sn+1;if(w>=I.startSN&&w<=I.endSN){var F=b[w-I.startSN];R.cc===F.cc&&(P=F,this.log("Live playlist, switching playlist, load frag with next SN: "+P.sn))}P||(P=Object(v.findFragWithCC)(b,R.cc),P&&this.log("Live playlist, switching playlist, load frag with same CC: "+P.sn))}}else{var k=this.hls.liveSyncPosition;k!==null&&(P=this.getFragmentAtPosition(k,this.bitrateTest?I.fragmentEnd:I.edge,I))}return P},_.getFragmentAtPosition=function(I,b,R){var P=this.config,w=this.fragPrevious,F=R.fragments,k=R.endSN,B=R.fragmentHint,U=P.maxFragLookUpTolerance,j=!!(P.lowLatencyMode&&R.partList&&B);j&&B&&!this.bitrateTest&&(F=F.concat(B),k=B.sn);var K;if(I<b){var N=I>b-U?0:U;K=Object(v.findFragmentByPTS)(w,F,I,N)}else K=F[F.length-1];if(K){var Z=K.sn-R.startSN,X=w&&K.level===w.level,Y=F[Z+1],ee=this.fragmentTracker.getState(K);if(ee===m.FragmentState.BACKTRACKED){K=null;for(var Q=Z;F[Q]&&this.fragmentTracker.getState(F[Q])===m.FragmentState.BACKTRACKED;)w?K=F[Q--]:K=F[--Q];K||(K=Y)}else w&&K.sn===w.sn&&!j&&X&&(K.sn<k&&this.fragmentTracker.getState(Y)!==m.FragmentState.OK?(this.log("SN "+K.sn+" just loaded, load next one: "+Y.sn),K=Y):K=null)}return K},_.synchronizeToLiveEdge=function(I){var b=this.config,R=this.media;if(!!R){var P=this.hls.liveSyncPosition,w=R.currentTime,F=I.fragments[0].start,k=I.edge,B=w>=F-b.maxFragLookUpTolerance&&w<=k;if(P!==null&&R.duration>P&&(w<P||!B)){var U=b.liveMaxLatencyDuration!==void 0?b.liveMaxLatencyDuration:b.liveMaxLatencyDurationCount*I.targetduration;(!B&&R.readyState<4||w<k-U)&&(this.loadedmetadata||(this.nextLoadPosition=P),R.readyState&&(this.warn("Playback: "+w.toFixed(3)+" is located too far from the end of live sliding playlist: "+k+", reset currentTime to : "+P.toFixed(3)),R.currentTime=P))}}},_.alignPlaylists=function(I,b){var R=this.levels,P=this.levelLastLoaded,w=this.fragPrevious,F=P!==null?R[P]:null,k=I.fragments.length;if(!k)return this.warn("No fragments in live playlist"),0;var B=I.fragments[0].start,U=!b,j=I.alignedSliding&&Object(S.isFiniteNumber)(B);if(U||!j&&!B){Object(o.alignStream)(w,F,I);var K=I.fragments[0].start;return this.log("Live playlist sliding: "+K.toFixed(2)+" start-sn: "+(b?b.startSN:"na")+"->"+I.startSN+" prev-sn: "+(w?w.sn:"na")+" fragments: "+k),K}return B},_.waitForCdnTuneIn=function(I){var b=3;return I.live&&I.canBlockReload&&I.tuneInGoal>Math.max(I.partHoldBack,I.partTarget*b)},_.setStartPosition=function(I,b){var R=this.startPosition;if(R<b&&(R=-1),R===-1||this.lastCurrentTime===-1){var P=I.startTimeOffset;Object(S.isFiniteNumber)(P)?(R=b+P,P<0&&(R+=I.totalduration),R=Math.min(Math.max(b,R),b+I.totalduration),this.log("Start time offset "+P+" found in playlist, adjust startPosition to "+R),this.startPosition=R):I.live?R=this.hls.liveSyncPosition||b:this.startPosition=R=0,this.lastCurrentTime=R}this.nextLoadPosition=R},_.getLoadPosition=function(){var I=this.media,b=0;return this.loadedmetadata&&I?b=I.currentTime:this.nextLoadPosition&&(b=this.nextLoadPosition),b},_.handleFragLoadAborted=function(I,b){this.transmuxer&&I.sn!=="initSegment"&&I.stats.aborted&&(this.warn("Fragment "+I.sn+(b?" part"+b.index:"")+" of level "+I.level+" was aborted"),this.resetFragmentLoading(I))},_.resetFragmentLoading=function(I){(!this.fragCurrent||!this.fragContextChanged(I))&&(this.state=A.IDLE)},_.onFragmentOrKeyLoadError=function(I,b){if(!b.fatal){var R=b.frag;if(!(!R||R.type!==I)){var P=this.fragCurrent;console.assert(P&&R.sn===P.sn&&R.level===P.level&&R.urlId===P.urlId,"Frag load error must match current frag to retry");var w=this.config;if(this.fragLoadError+1<=w.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(R.level))return;var F=Math.min(Math.pow(2,this.fragLoadError)*w.fragLoadingRetryDelay,w.fragLoadingMaxRetryTimeout);this.warn("Fragment "+R.sn+" of "+I+" "+R.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=A.FRAG_LOADING_WAITING_RETRY}else b.levelRetry?(I===i.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=A.IDLE):(T.logger.error(b.details+" reaches max retry, redispatch as fatal ..."),b.fatal=!0,this.hls.stopLoad(),this.state=A.ERROR)}}},_.afterBufferFlushed=function(I,b,R){if(!!I){var P=M.BufferHelper.getBuffered(I);this.fragmentTracker.detectEvictedFragments(b,P,R),this.state===A.ENDED&&this.resetLoadingState()}},_.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=A.IDLE},_.resetLiveStartWhenNotLoaded=function(I){if(!this.loadedmetadata){this.startFragRequested=!1;var b=this.levels?this.levels[I].details:null;if(b!=null&&b.live)return this.startPosition=-1,this.setStartPosition(b,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},_.updateLevelTiming=function(I,b,R,P){var w=this,F=R.details;console.assert(!!F,"level.details must be defined");var k=Object.keys(I.elementaryStreams).reduce(function(B,U){var j=I.elementaryStreams[U];if(j){var K=j.endPTS-j.startPTS;if(K<=0)return w.warn("Could not parse fragment "+I.sn+" "+U+" duration reliably ("+K+") resetting transmuxer to fallback to playlist timing"),w.resetTransmuxer(),B||!1;var N=P?0:Object(c.updateFragPTSDTS)(F,I,j.startPTS,j.endPTS,j.startDTS,j.endDTS);return w.hls.trigger(p.Events.LEVEL_PTS_UPDATED,{details:F,level:R,drift:N,type:U,frag:I,start:j.startPTS,end:j.endPTS}),!0}return B},!1);k?(this.state=A.PARSED,this.hls.trigger(p.Events.FRAG_PARSED,{frag:I,part:b})):this.resetLoadingState()},_.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},s(E,[{key:"state",get:function(){return this._state},set:function(I){var b=this._state;b!==I&&(this._state=I,this.log(b+"->"+I))}}]),E}(h.default)},"./src/controller/buffer-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return v});var S=x("./src/polyfills/number.ts"),h=x("./src/events.ts"),m=x("./src/utils/logger.ts"),M=x("./src/errors.ts"),T=x("./src/utils/buffer-helper.ts"),p=x("./src/utils/mediasource-helper.ts"),f=x("./src/loader/fragment.ts"),n=x("./src/controller/buffer-operation-queue.ts"),d=Object(p.getMediaSource)(),o=/([ha]vc.)(?:\.[^.,]+)+/,v=function(){function c(r){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var i=t.hls,e=t.media,s=t.mediaSource;m.logger.log("[buffer-controller]: Media source opened"),e&&(t.updateMediaElementDuration(),i.trigger(h.Events.MEDIA_ATTACHED,{media:e})),s&&s.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){m.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){m.logger.log("[buffer-controller]: Media source ended")},this.hls=r,this._initSourceBuffer(),this.registerListeners()}var u=c.prototype;return u.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},u.destroy=function(){this.unregisterListeners(),this.details=null},u.registerListeners=function(){var t=this.hls;t.on(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(h.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(h.Events.BUFFER_RESET,this.onBufferReset,this),t.on(h.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(h.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(h.Events.BUFFER_EOS,this.onBufferEos,this),t.on(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(h.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(h.Events.FRAG_PARSED,this.onFragParsed,this),t.on(h.Events.FRAG_CHANGED,this.onFragChanged,this)},u.unregisterListeners=function(){var t=this.hls;t.off(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(h.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(h.Events.BUFFER_RESET,this.onBufferReset,this),t.off(h.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(h.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(h.Events.BUFFER_EOS,this.onBufferEos,this),t.off(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(h.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(h.Events.FRAG_PARSED,this.onFragParsed,this),t.off(h.Events.FRAG_CHANGED,this.onFragChanged,this)},u._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new n.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},u.onManifestParsed=function(t,i){var e=2;(i.audio&&!i.video||!i.altAudio)&&(e=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e,this.details=null,m.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},u.onMediaAttaching=function(t,i){var e=this.media=i.media;if(e&&d){var s=this.mediaSource=new d;s.addEventListener("sourceopen",this._onMediaSourceOpen),s.addEventListener("sourceended",this._onMediaSourceEnded),s.addEventListener("sourceclose",this._onMediaSourceClose),e.src=self.URL.createObjectURL(s),this._objectUrl=e.src}},u.onMediaDetaching=function(){var t=this.media,i=this.mediaSource,e=this._objectUrl;if(i){if(m.logger.log("[buffer-controller]: media source detaching"),i.readyState==="open")try{i.endOfStream()}catch(s){m.logger.warn("[buffer-controller]: onMediaDetaching: "+s.message+" while calling endOfStream")}this.onBufferReset(),i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(e&&self.URL.revokeObjectURL(e),t.src===e?(t.removeAttribute("src"),t.load()):m.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(h.Events.MEDIA_DETACHED,void 0)},u.onBufferReset=function(){var t=this;this.getSourceBufferTypes().forEach(function(i){var e=t.sourceBuffer[i];try{e&&(t.removeBufferListeners(i),t.mediaSource&&t.mediaSource.removeSourceBuffer(e),t.sourceBuffer[i]=void 0)}catch(s){m.logger.warn("[buffer-controller]: Failed to reset the "+i+" buffer",s)}}),this._initSourceBuffer()},u.onBufferCodecs=function(t,i){var e=this,s=this.getSourceBufferTypes().length;Object.keys(i).forEach(function(l){if(s){var a=e.tracks[l];if(a&&typeof a.buffer.changeType=="function"){var g=i[l],A=g.codec,D=g.levelCodec,y=g.container,E=(a.levelCodec||a.codec).replace(o,"$1"),_=(D||A).replace(o,"$1");if(E!==_){var L=y+";codecs="+(D||A);e.appendChangeType(l,L)}}}else e.pendingTracks[l]=i[l]}),!s&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},u.appendChangeType=function(t,i){var e=this,s=this.operationQueue,l={execute:function(){var g=e.sourceBuffer[t];g&&(m.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+i),g.changeType(i)),s.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(g){m.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",g)}};s.append(l,t)},u.onBufferAppending=function(t,i){var e=this,s=this.hls,l=this.operationQueue,a=this.tracks,g=i.data,A=i.type,D=i.frag,y=i.part,E=i.chunkMeta,_=E.buffering[A],L=self.performance.now();_.start=L;var I=D.stats.buffering,b=y?y.stats.buffering:null;I.start===0&&(I.start=L),b&&b.start===0&&(b.start=L);var R=a.audio,P=A==="audio"&&E.id===1&&(R==null?void 0:R.container)==="audio/mpeg",w={execute:function(){if(_.executeStart=self.performance.now(),P){var k=e.sourceBuffer[A];if(k){var B=D.start-k.timestampOffset;Math.abs(B)>=.1&&(m.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+D.start+" (delta: "+B+") sn: "+D.sn+")"),k.timestampOffset=D.start)}}e.appendExecutor(g,A)},onStart:function(){},onComplete:function(){var k=self.performance.now();_.executeEnd=_.end=k,I.first===0&&(I.first=k),b&&b.first===0&&(b.first=k);var B=e.sourceBuffer,U={};for(var j in B)U[j]=T.BufferHelper.getBuffered(B[j]);e.appendError=0,e.hls.trigger(h.Events.BUFFER_APPENDED,{type:A,frag:D,part:y,chunkMeta:E,parent:D.type,timeRanges:U})},onError:function(k){m.logger.error("[buffer-controller]: Error encountered while trying to append to the "+A+" SourceBuffer",k);var B={type:M.ErrorTypes.MEDIA_ERROR,parent:D.type,details:M.ErrorDetails.BUFFER_APPEND_ERROR,err:k,fatal:!1};k.code===DOMException.QUOTA_EXCEEDED_ERR?B.details=M.ErrorDetails.BUFFER_FULL_ERROR:(e.appendError++,B.details=M.ErrorDetails.BUFFER_APPEND_ERROR,e.appendError>s.config.appendErrorMaxRetry&&(m.logger.error("[buffer-controller]: Failed "+s.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),B.fatal=!0)),s.trigger(h.Events.ERROR,B)}};l.append(w,A)},u.onBufferFlushing=function(t,i){var e=this,s=this.operationQueue,l=function(g){return{execute:e.removeExecutor.bind(e,g,i.startOffset,i.endOffset),onStart:function(){},onComplete:function(){e.hls.trigger(h.Events.BUFFER_FLUSHED,{type:g})},onError:function(D){m.logger.warn("[buffer-controller]: Failed to remove from "+g+" SourceBuffer",D)}}};i.type?s.append(l(i.type),i.type):this.getSourceBufferTypes().forEach(function(a){s.append(l(a),a)})},u.onFragParsed=function(t,i){var e=this,s=i.frag,l=i.part,a=[],g=l?l.elementaryStreams:s.elementaryStreams;g[f.ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(g[f.ElementaryStreamTypes.AUDIO]&&a.push("audio"),g[f.ElementaryStreamTypes.VIDEO]&&a.push("video"));var A=function(){var y=self.performance.now();s.stats.buffering.end=y,l&&(l.stats.buffering.end=y);var E=l?l.stats:s.stats;e.hls.trigger(h.Events.FRAG_BUFFERED,{frag:s,part:l,stats:E,id:s.type})};a.length===0&&m.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+s.type+" level: "+s.level+" sn: "+s.sn),this.blockBuffers(A,a)},u.onFragChanged=function(t,i){this.flushBackBuffer()},u.onBufferEos=function(t,i){var e=this,s=this.getSourceBufferTypes().reduce(function(l,a){var g=e.sourceBuffer[a];return(!i.type||i.type===a)&&g&&!g.ended&&(g.ended=!0,m.logger.log("[buffer-controller]: "+a+" sourceBuffer now EOS")),l&&!!(!g||g.ended)},!0);s&&this.blockBuffers(function(){var l=e.mediaSource;!l||l.readyState!=="open"||l.endOfStream()})},u.onLevelUpdated=function(t,i){var e=i.details;!e.fragments.length||(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},u.flushBackBuffer=function(){var t=this.hls,i=this.details,e=this.media,s=this.sourceBuffer;if(!(!e||i===null)){var l=this.getSourceBufferTypes();if(!!l.length){var a=i.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if(!(!Object(S.isFiniteNumber)(a)||a<0)){var g=e.currentTime,A=i.levelTargetDuration,D=Math.max(a,A),y=Math.floor(g/A)*A-D;l.forEach(function(E){var _=s[E];if(_){var L=T.BufferHelper.getBuffered(_);L.length>0&&y>L.start(0)&&(t.trigger(h.Events.BACK_BUFFER_REACHED,{bufferEnd:y}),i.live&&t.trigger(h.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:y}),t.trigger(h.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:y,type:E}))}})}}}},u.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var t=this.details,i=this.hls,e=this.media,s=this.mediaSource,l=t.fragments[0].start+t.totalduration,a=e.duration,g=Object(S.isFiniteNumber)(s.duration)?s.duration:0;t.live&&i.config.liveDurationInfinity?(m.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),s.duration=1/0,this.updateSeekableRange(t)):(l>g&&l>a||!Object(S.isFiniteNumber)(a))&&(m.logger.log("[buffer-controller]: Updating Media Source duration to "+l.toFixed(3)),s.duration=l)}},u.updateSeekableRange=function(t){var i=this.mediaSource,e=t.fragments,s=e.length;if(s&&t.live&&i!==null&&i!==void 0&&i.setLiveSeekableRange){var l=Math.max(0,e[0].start),a=Math.max(l,l+t.totalduration);i.setLiveSeekableRange(l,a)}},u.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,i=this.operationQueue,e=this.pendingTracks,s=Object.keys(e).length;if(s&&!t||s===2){this.createSourceBuffers(e),this.pendingTracks={};var l=this.getSourceBufferTypes();if(l.length===0){this.hls.trigger(h.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}l.forEach(function(a){i.executeNext(a)})}},u.createSourceBuffers=function(t){var i=this.sourceBuffer,e=this.mediaSource;if(!e)throw Error("createSourceBuffers called when mediaSource was null");var s=0;for(var l in t)if(!i[l]){var a=t[l];if(!a)throw Error("source buffer exists for track "+l+", however track does not");var g=a.levelCodec||a.codec,A=a.container+";codecs="+g;m.logger.log("[buffer-controller]: creating sourceBuffer("+A+")");try{var D=i[l]=e.addSourceBuffer(A),y=l;this.addBufferListener(y,"updatestart",this._onSBUpdateStart),this.addBufferListener(y,"updateend",this._onSBUpdateEnd),this.addBufferListener(y,"error",this._onSBUpdateError),this.tracks[l]={buffer:D,codec:g,container:a.container,levelCodec:a.levelCodec,id:a.id},s++}catch(E){m.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+E.message),this.hls.trigger(h.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:E,mimeType:A})}}s&&this.hls.trigger(h.Events.BUFFER_CREATED,{tracks:this.tracks})},u._onSBUpdateStart=function(t){var i=this.operationQueue,e=i.current(t);e.onStart()},u._onSBUpdateEnd=function(t){var i=this.operationQueue,e=i.current(t);e.onComplete(),i.shiftAndExecuteNext(t)},u._onSBUpdateError=function(t,i){m.logger.error("[buffer-controller]: "+t+" SourceBuffer error",i),this.hls.trigger(h.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var e=this.operationQueue.current(t);e&&e.onError(i)},u.removeExecutor=function(t,i,e){var s=this.media,l=this.mediaSource,a=this.operationQueue,g=this.sourceBuffer,A=g[t];if(!s||!l||!A){m.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),a.shiftAndExecuteNext(t);return}var D=Object(S.isFiniteNumber)(s.duration)?s.duration:1/0,y=Object(S.isFiniteNumber)(l.duration)?l.duration:1/0,E=Math.max(0,i),_=Math.min(e,D,y);_>E?(m.logger.log("[buffer-controller]: Removing ["+E+","+_+"] from the "+t+" SourceBuffer"),console.assert(!A.updating,t+" sourceBuffer must not be updating"),A.remove(E,_)):a.shiftAndExecuteNext(t)},u.appendExecutor=function(t,i){var e=this.operationQueue,s=this.sourceBuffer,l=s[i];if(!l){m.logger.warn("[buffer-controller]: Attempting to append to the "+i+" SourceBuffer, but it does not exist"),e.shiftAndExecuteNext(i);return}l.ended=!1,console.assert(!l.updating,i+" sourceBuffer must not be updating"),l.appendBuffer(t)},u.blockBuffers=function(t,i){var e=this;if(i===void 0&&(i=this.getSourceBufferTypes()),!i.length){m.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(t);return}var s=this.operationQueue,l=i.map(function(a){return s.appendBlocker(a)});Promise.all(l).then(function(){t(),i.forEach(function(a){var g=e.sourceBuffer[a];(!g||!g.updating)&&s.shiftAndExecuteNext(a)})})},u.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},u.addBufferListener=function(t,i,e){var s=this.sourceBuffer[t];if(!!s){var l=e.bind(this,t);this.listeners[t].push({event:i,listener:l}),s.addEventListener(i,l)}},u.removeBufferListeners=function(t){var i=this.sourceBuffer[t];!i||this.listeners[t].forEach(function(e){i.removeEventListener(e.event,e.listener)})},c}()},"./src/controller/buffer-operation-queue.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return h});var S=x("./src/utils/logger.ts"),h=function(){function m(T){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=T}var M=m.prototype;return M.append=function(p,f){var n=this.queues[f];n.push(p),n.length===1&&this.buffers[f]&&this.executeNext(f)},M.insertAbort=function(p,f){var n=this.queues[f];n.unshift(p),this.executeNext(f)},M.appendBlocker=function(p){var f,n=new Promise(function(o){f=o}),d={execute:f,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(d,p),n},M.executeNext=function(p){var f=this.buffers,n=this.queues,d=f[p],o=n[p];if(o.length){var v=o[0];try{v.execute()}catch(c){S.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),v.onError(c),(!d||!d.updating)&&(o.shift(),this.executeNext(p))}}},M.shiftAndExecuteNext=function(p){this.queues[p].shift(),this.executeNext(p)},M.current=function(p){return this.queues[p][0]},m}()},"./src/controller/cap-level-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts");function h(T,p){for(var f=0;f<p.length;f++){var n=p[f];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(T,n.key,n)}}function m(T,p,f){return p&&h(T.prototype,p),f&&h(T,f),T}var M=function(){function T(f){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=f,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var p=T.prototype;return p.setStreamController=function(n){this.streamController=n},p.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},p.registerListeners=function(){var n=this.hls;n.on(S.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.unregisterListener=function(){var n=this.hls;n.off(S.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.onFpsDropLevelCapping=function(n,d){T.isLevelAllowed(d.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(d.droppedLevel)},p.onMediaAttaching=function(n,d){this.media=d.media instanceof HTMLVideoElement?d.media:null},p.onManifestParsed=function(n,d){var o=this.hls;this.restrictedLevels=[],this.firstLevel=d.firstLevel,o.config.capLevelToPlayerSize&&d.video&&this.startCapping()},p.onBufferCodecs=function(n,d){var o=this.hls;o.config.capLevelToPlayerSize&&d.video&&this.startCapping()},p.onMediaDetaching=function(){this.stopCapping()},p.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var n=this.hls.levels;if(n.length){var d=this.hls;d.autoLevelCapping=this.getMaxLevel(n.length-1),d.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=d.autoLevelCapping}}},p.getMaxLevel=function(n){var d=this,o=this.hls.levels;if(!o.length)return-1;var v=o.filter(function(c,u){return T.isLevelAllowed(u,d.restrictedLevels)&&u<=n});return this.clientRect=null,T.getMaxLevelByMediaSize(v,this.mediaWidth,this.mediaHeight)},p.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},p.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},p.getDimensions=function(){if(this.clientRect)return this.clientRect;var n=this.media,d={width:0,height:0};if(n){var o=n.getBoundingClientRect();d.width=o.width,d.height=o.height,!d.width&&!d.height&&(d.width=o.right-o.left||n.width||0,d.height=o.bottom-o.top||n.height||0)}return this.clientRect=d,d},T.isLevelAllowed=function(n,d){return d===void 0&&(d=[]),d.indexOf(n)===-1},T.getMaxLevelByMediaSize=function(n,d,o){if(!n||!n.length)return-1;for(var v=function(i,e){return e?i.width!==e.width||i.height!==e.height:!0},c=n.length-1,u=0;u<n.length;u+=1){var r=n[u];if((r.width>=d||r.height>=o)&&v(r,n[u+1])){c=u;break}}return c},m(T,[{key:"mediaWidth",get:function(){return this.getDimensions().width*T.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*T.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var n=1;try{n=self.devicePixelRatio}catch{}return n}}]),T}();C.default=M},"./src/controller/cmcd-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return v});var S=x("./src/events.ts"),h=x("./src/types/cmcd.ts"),m=x("./src/utils/buffer-helper.ts"),M=x("./src/utils/logger.ts");function T(c,u){for(var r=0;r<u.length;r++){var t=u[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(c,t.key,t)}}function p(c,u,r){return u&&T(c.prototype,u),r&&T(c,r),c}function f(c,u){var r=typeof Symbol!="undefined"&&c[Symbol.iterator]||c["@@iterator"];if(r)return(r=r.call(c)).next.bind(r);if(Array.isArray(c)||(r=n(c))||u&&c&&typeof c.length=="number"){r&&(c=r);var t=0;return function(){return t>=c.length?{done:!0}:{done:!1,value:c[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(c,u){if(!!c){if(typeof c=="string")return d(c,u);var r=Object.prototype.toString.call(c).slice(8,-1);if(r==="Object"&&c.constructor&&(r=c.constructor.name),r==="Map"||r==="Set")return Array.from(c);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(c,u)}}function d(c,u){(u==null||u>c.length)&&(u=c.length);for(var r=0,t=new Array(u);r<u;r++)t[r]=c[r];return t}function o(){return o=Object.assign||function(c){for(var u=1;u<arguments.length;u++){var r=arguments[u];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(c[t]=r[t])}return c},o.apply(this,arguments)}var v=function(){function c(r){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1},this.applyPlaylistData=function(s){try{t.apply(s,{ot:h.CMCDObjectType.MANIFEST,su:!t.initialized})}catch(l){M.logger.warn("Could not generate manifest CMCD data.",l)}},this.applyFragmentData=function(s){try{var l=s.frag,a=t.hls.levels[l.level],g=t.getObjectType(l),A={d:l.duration*1e3,ot:g};(g===h.CMCDObjectType.VIDEO||g===h.CMCDObjectType.AUDIO||g==h.CMCDObjectType.MUXED)&&(A.br=a.bitrate/1e3,A.tb=t.getTopBandwidth(g)/1e3,A.bl=t.getBufferLength(g)),t.apply(s,A)}catch(D){M.logger.warn("Could not generate segment CMCD data.",D)}},this.hls=r;var i=this.config=r.config,e=i.cmcd;e!=null&&(i.pLoader=this.createPlaylistLoader(),i.fLoader=this.createFragmentLoader(),this.sid=e.sessionId||c.uuid(),this.cid=e.contentId,this.useHeaders=e.useHeaders===!0,this.registerListeners())}var u=c.prototype;return u.registerListeners=function(){var t=this.hls;t.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.on(S.Events.BUFFER_CREATED,this.onBufferCreated,this)},u.unregisterListeners=function(){var t=this.hls;t.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.off(S.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},u.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},u.onMediaAttached=function(t,i){this.media=i.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},u.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},u.onBufferCreated=function(t,i){var e,s;this.audioBuffer=(e=i.tracks.audio)===null||e===void 0?void 0:e.buffer,this.videoBuffer=(s=i.tracks.video)===null||s===void 0?void 0:s.buffer},u.createData=function(){var t;return{v:h.CMCDVersion,sf:h.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)===null||t===void 0?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},u.apply=function(t,i){i===void 0&&(i={}),o(i,this.createData());var e=i.ot===h.CMCDObjectType.INIT||i.ot===h.CMCDObjectType.VIDEO||i.ot===h.CMCDObjectType.MUXED;if(this.starved&&e&&(i.bs=!0,i.su=!0,this.starved=!1),i.su==null&&(i.su=this.buffering),this.useHeaders){var s=c.toHeaders(i);if(!Object.keys(s).length)return;t.headers||(t.headers={}),o(t.headers,s)}else{var l=c.toQuery(i);if(!l)return;t.url=c.appendQueryToUri(t.url,l)}},u.getObjectType=function(t){var i=t.type;if(i==="subtitle")return h.CMCDObjectType.TIMED_TEXT;if(t.sn==="initSegment")return h.CMCDObjectType.INIT;if(i==="audio")return h.CMCDObjectType.AUDIO;if(i==="main")return this.hls.audioTracks.length?h.CMCDObjectType.VIDEO:h.CMCDObjectType.MUXED},u.getTopBandwidth=function(t){var i=0,e,s=this.hls;if(t===h.CMCDObjectType.AUDIO)e=s.audioTracks;else{var l=s.maxAutoLevel,a=l>-1?l+1:s.levels.length;e=s.levels.slice(0,a)}for(var g=f(e),A;!(A=g()).done;){var D=A.value;D.bitrate>i&&(i=D.bitrate)}return i>0?i:NaN},u.getBufferLength=function(t){var i=this.hls.media,e=t===h.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!e||!i)return NaN;var s=m.BufferHelper.bufferInfo(e,i.currentTime,this.config.maxBufferHole);return s.len*1e3},u.createPlaylistLoader=function(){var t=this.config.pLoader,i=this.applyPlaylistData,e=t||this.config.loader;return function(){function s(a){this.loader=void 0,this.loader=new e(a)}var l=s.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(g,A,D){i(g),this.loader.load(g,A,D)},p(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},u.createFragmentLoader=function(){var t=this.config.fLoader,i=this.applyFragmentData,e=t||this.config.loader;return function(){function s(a){this.loader=void 0,this.loader=new e(a)}var l=s.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(g,A,D){i(g),this.loader.load(g,A,D)},p(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},c.uuid=function(){var t=URL.createObjectURL(new Blob),i=t.toString();return URL.revokeObjectURL(t),i.substr(i.lastIndexOf("/")+1)},c.serialize=function(t){for(var i=[],e=function(P){return!Number.isNaN(P)&&P!=null&&P!==""&&P!==!1},s=function(P){return Math.round(P)},l=function(P){return s(P/100)*100},a=function(P){return encodeURIComponent(P)},g={br:s,d:s,bl:l,dl:l,mtp:l,nor:a,rtp:l,tb:s},A=Object.keys(t||{}).sort(),D=f(A),y;!(y=D()).done;){var E=y.value,_=t[E];if(!!e(_)&&!(E==="v"&&_===1)&&!(E=="pr"&&_===1)){var L=g[E];L&&(_=L(_));var I=typeof _,b=void 0;E==="ot"||E==="sf"||E==="st"?b=E+"="+_:I==="boolean"?b=E:I==="number"?b=E+"="+_:b=E+"="+JSON.stringify(_),i.push(b)}}return i.join(",")},c.toHeaders=function(t){for(var i=Object.keys(t),e={},s=["Object","Request","Session","Status"],l=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},g=0,A=i;g<A.length;g++){var D=A[g],y=a[D]!=null?a[D]:1;l[y][D]=t[D]}for(var E=0;E<l.length;E++){var _=c.serialize(l[E]);_&&(e["CMCD-"+s[E]]=_)}return e},c.toQuery=function(t){return"CMCD="+encodeURIComponent(c.serialize(t))},c.appendQueryToUri=function(t,i){if(!i)return t;var e=t.includes("?")?"&":"?";return""+t+e+i},c}()},"./src/controller/eme-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/utils/logger.ts"),M=x("./src/utils/mediakeys-helper.ts");function T(v,c){for(var u=0;u<c.length;u++){var r=c[u];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(v,r.key,r)}}function p(v,c,u){return c&&T(v.prototype,c),u&&T(v,u),v}var f=3,n=function(c,u,r){var t={audioCapabilities:[],videoCapabilities:[]};return c.forEach(function(i){t.audioCapabilities.push({contentType:'audio/mp4; codecs="'+i+'"',robustness:r.audioRobustness||""})}),u.forEach(function(i){t.videoCapabilities.push({contentType:'video/mp4; codecs="'+i+'"',robustness:r.videoRobustness||""})}),[t]},d=function(c,u,r,t){switch(c){case M.KeySystems.WIDEVINE:return n(u,r,t);default:throw new Error("Unknown key-system: "+c)}},o=function(){function v(u){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=u,this._config=u.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var c=v.prototype;return c.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},c._registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this)},c._unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this)},c.getLicenseServerUrl=function(r){switch(r){case M.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+r+'"')},c._attemptKeySystemAccess=function(r,t,i){var e=this,s=d(r,t,i,this._drmSystemOptions);m.logger.log("Requesting encrypted media key-system access");var l=this.requestMediaKeySystemAccess(r,s);this.mediaKeysPromise=l.then(function(a){return e._onMediaKeySystemAccessObtained(r,a)}),l.catch(function(a){m.logger.error('Failed to obtain key-system "'+r+'" access:',a)})},c._onMediaKeySystemAccessObtained=function(r,t){var i=this;m.logger.log('Access for key-system "'+r+'" obtained');var e={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:r};this._mediaKeysList.push(e);var s=Promise.resolve().then(function(){return t.createMediaKeys()}).then(function(l){return e.mediaKeys=l,m.logger.log('Media-keys created for key-system "'+r+'"'),i._onMediaKeysCreated(),l});return s.catch(function(l){m.logger.error("Failed to create media-keys:",l)}),s},c._onMediaKeysCreated=function(){var r=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),r._onNewMediaKeySession(t.mediaKeysSession))})},c._onNewMediaKeySession=function(r){var t=this;m.logger.log("New key-system session "+r.sessionId),r.addEventListener("message",function(i){t._onKeySessionMessage(r,i.message)},!1)},c._onKeySessionMessage=function(r,t){m.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(i){m.logger.log("Received license data (length: "+(i&&i.byteLength)+"), updating key-session"),r.update(i)})},c.onMediaEncrypted=function(r){var t=this;if(m.logger.log('Media is encrypted using "'+r.initDataType+'" init data type'),!this.mediaKeysPromise){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var i=function(s){!t._media||(t._attemptSetMediaKeys(s),t._generateRequestWithPreferredKeySession(r.initDataType,r.initData))};this.mediaKeysPromise.then(i).catch(i)},c._attemptSetMediaKeys=function(r){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}m.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},c._generateRequestWithPreferredKeySession=function(r,t){var i=this,e=this._mediaKeysList[0];if(!e){m.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(e.mediaKeysSessionInitialized){m.logger.warn("Key-Session already initialized but requested again");return}var s=e.mediaKeysSession;if(!s){m.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!t){m.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}m.logger.log('Generating key-session request for "'+r+'" init data type'),e.mediaKeysSessionInitialized=!0,s.generateRequest(r,t).then(function(){m.logger.debug("Key-session generation succeeded")}).catch(function(l){m.logger.error("Error generating key-session request:",l),i.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},c._createLicenseXhr=function(r,t,i){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,e,r,t,i);var s=this._licenseXhrSetup;if(s)try{s.call(this.hls,e,r),s=void 0}catch(l){m.logger.error(l)}try{e.readyState||e.open("POST",r,!0),s&&s.call(this.hls,e,r)}catch(l){throw new Error("issue setting up KeySystem license XHR "+l)}return e},c._onLicenseRequestReadyStageChange=function(r,t,i,e){switch(r.readyState){case 4:if(r.status===200){this._requestLicenseFailureCount=0,m.logger.log("License request succeeded");var s=r.response,l=this._licenseResponseCallback;if(l)try{s=l.call(this.hls,r,t)}catch(g){m.logger.error(g)}e(s)}else{if(m.logger.error("License Request XHR failed ("+t+"). Status: "+r.status+" ("+r.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f){this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var a=f-this._requestLicenseFailureCount+1;m.logger.warn("Retrying license request, "+a+" attempts left"),this._requestLicense(i,e)}break}},c._generateLicenseRequestChallenge=function(r,t){switch(r.mediaKeySystemDomain){case M.KeySystems.WIDEVINE:return t}throw new Error("unsupported key-system: "+r.mediaKeySystemDomain)},c._requestLicense=function(r,t){m.logger.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i){m.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var e=this.getLicenseServerUrl(i.mediaKeySystemDomain),s=this._createLicenseXhr(e,r,t);m.logger.log("Sending license request to URL: "+e);var l=this._generateLicenseRequestChallenge(i,r);s.send(l)}catch(a){m.logger.error("Failure requesting DRM license: "+a),this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.KEY_SYSTEM_ERROR,details:h.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},c.onMediaAttached=function(r,t){if(!!this._emeEnabled){var i=t.media;this._media=i,i.addEventListener("encrypted",this._onMediaEncrypted)}},c.onMediaDetached=function(){var r=this._media,t=this._mediaKeysList;!r||(r.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(i){if(i.mediaKeysSession)return i.mediaKeysSession.close().catch(function(){})})).then(function(){return r.setMediaKeys(null)}).catch(function(){}))},c.onManifestParsed=function(r,t){if(!!this._emeEnabled){var i=t.levels.map(function(s){return s.audioCodec}).filter(function(s){return!!s}),e=t.levels.map(function(s){return s.videoCodec}).filter(function(s){return!!s});this._attemptKeySystemAccess(M.KeySystems.WIDEVINE,i,e)}},p(v,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),v}();C.default=o},"./src/controller/fps-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),h=x("./src/utils/logger.ts"),m=function(){function M(p){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=p,this.registerListeners()}var T=M.prototype;return T.setStreamController=function(f){this.streamController=f},T.registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},T.unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching)},T.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},T.onMediaAttaching=function(f,n){var d=this.hls.config;if(d.capLevelOnFPSDrop){var o=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=o,o&&typeof o.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),d.fpsDroppedMonitoringPeriod)}},T.checkFPS=function(f,n,d){var o=performance.now();if(n){if(this.lastTime){var v=o-this.lastTime,c=d-this.lastDroppedFrames,u=n-this.lastDecodedFrames,r=1e3*c/v,t=this.hls;if(t.trigger(S.Events.FPS_DROP,{currentDropped:c,currentDecoded:u,totalDroppedFrames:d}),r>0&&c>t.config.fpsDroppedMonitoringThreshold*u){var i=t.currentLevel;h.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+i),i>0&&(t.autoLevelCapping===-1||t.autoLevelCapping>=i)&&(i=i-1,t.trigger(S.Events.FPS_DROP_LEVEL_CAPPING,{level:i,droppedLevel:t.currentLevel}),t.autoLevelCapping=i,this.streamController.nextLevelSwitch())}}this.lastTime=o,this.lastDroppedFrames=d,this.lastDecodedFrames=n}},T.checkFPSInterval=function(){var f=this.media;if(f)if(this.isVideoPlaybackQualityAvailable){var n=f.getVideoPlaybackQuality();this.checkFPS(f,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(f,f.webkitDecodedFrameCount,f.webkitDroppedFrameCount)},M}();C.default=m},"./src/controller/fragment-finders.ts":function(O,C,x){x.r(C),x.d(C,"findFragmentByPDT",function(){return m}),x.d(C,"findFragmentByPTS",function(){return M}),x.d(C,"fragmentWithinToleranceTest",function(){return T}),x.d(C,"pdtWithinToleranceTest",function(){return p}),x.d(C,"findFragWithCC",function(){return f});var S=x("./src/polyfills/number.ts"),h=x("./src/utils/binary-search.ts");function m(n,d,o){if(d===null||!Array.isArray(n)||!n.length||!Object(S.isFiniteNumber)(d))return null;var v=n[0].programDateTime;if(d<(v||0))return null;var c=n[n.length-1].endProgramDateTime;if(d>=(c||0))return null;o=o||0;for(var u=0;u<n.length;++u){var r=n[u];if(p(d,o,r))return r}return null}function M(n,d,o,v){o===void 0&&(o=0),v===void 0&&(v=0);var c=null;if(n?c=d[n.sn-d[0].sn+1]||null:o===0&&d[0].start===0&&(c=d[0]),c&&T(o,v,c)===0)return c;var u=h.default.search(d,T.bind(null,o,v));return u||c}function T(n,d,o){n===void 0&&(n=0),d===void 0&&(d=0);var v=Math.min(d,o.duration+(o.deltaPTS?o.deltaPTS:0));return o.start+o.duration-v<=n?1:o.start-v>n&&o.start?-1:0}function p(n,d,o){var v=Math.min(d,o.duration+(o.deltaPTS?o.deltaPTS:0))*1e3,c=o.endProgramDateTime||0;return c-v>n}function f(n,d){return h.default.search(n,function(o){return o.cc<d?1:o.cc>d?-1:0})}},"./src/controller/fragment-tracker.ts":function(O,C,x){x.r(C),x.d(C,"FragmentState",function(){return m}),x.d(C,"FragmentTracker",function(){return M});var S=x("./src/events.ts"),h=x("./src/types/loader.ts"),m;(function(f){f.NOT_LOADED="NOT_LOADED",f.BACKTRACKED="BACKTRACKED",f.APPENDING="APPENDING",f.PARTIAL="PARTIAL",f.OK="OK"})(m||(m={}));var M=function(){function f(d){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=d,this._registerListeners()}var n=f.prototype;return n._registerListeners=function(){var o=this.hls;o.on(S.Events.BUFFER_APPENDED,this.onBufferAppended,this),o.on(S.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.on(S.Events.FRAG_LOADED,this.onFragLoaded,this)},n._unregisterListeners=function(){var o=this.hls;o.off(S.Events.BUFFER_APPENDED,this.onBufferAppended,this),o.off(S.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.off(S.Events.FRAG_LOADED,this.onFragLoaded,this)},n.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},n.getAppendedFrag=function(o,v){if(v===h.PlaylistLevelType.MAIN){var c=this.activeFragment,u=this.activeParts;if(!c)return null;if(u)for(var r=u.length;r--;){var t=u[r],i=t?t.end:c.appendedPTS;if(t.start<=o&&i!==void 0&&o<=i)return r>9&&(this.activeParts=u.slice(r-9)),t}else if(c.start<=o&&c.appendedPTS!==void 0&&o<=c.appendedPTS)return c}return this.getBufferedFrag(o,v)},n.getBufferedFrag=function(o,v){for(var c=this.fragments,u=Object.keys(c),r=u.length;r--;){var t=c[u[r]];if((t==null?void 0:t.body.type)===v&&t.buffered){var i=t.body;if(i.start<=o&&o<=i.end)return i}}return null},n.detectEvictedFragments=function(o,v,c){var u=this;Object.keys(this.fragments).forEach(function(r){var t=u.fragments[r];if(!!t){if(!t.buffered){t.body.type===c&&u.removeFragment(t.body);return}var i=t.range[o];!i||i.time.some(function(e){var s=!u.isTimeBuffered(e.startPTS,e.endPTS,v);return s&&u.removeFragment(t.body),s})}})},n.detectPartialFragments=function(o){var v=this,c=this.timeRanges,u=o.frag,r=o.part;if(!(!c||u.sn==="initSegment")){var t=p(u),i=this.fragments[t];!i||(Object.keys(c).forEach(function(e){var s=u.elementaryStreams[e];if(!!s){var l=c[e],a=r!==null||s.partial===!0;i.range[e]=v.getBufferedTimes(u,r,a,l)}}),i.backtrack=i.loaded=null,Object.keys(i.range).length?i.buffered=!0:this.removeFragment(i.body))}},n.fragBuffered=function(o){var v=p(o),c=this.fragments[v];c&&(c.backtrack=c.loaded=null,c.buffered=!0)},n.getBufferedTimes=function(o,v,c,u){for(var r={time:[],partial:c},t=v?v.start:o.start,i=v?v.end:o.end,e=o.minEndPTS||i,s=o.maxStartPTS||t,l=0;l<u.length;l++){var a=u.start(l)-this.bufferPadding,g=u.end(l)+this.bufferPadding;if(s>=a&&e<=g){r.time.push({startPTS:Math.max(t,u.start(l)),endPTS:Math.min(i,u.end(l))});break}else if(t<g&&i>a)r.partial=!0,r.time.push({startPTS:Math.max(t,u.start(l)),endPTS:Math.min(i,u.end(l))});else if(i<=a)break}return r},n.getPartialFragment=function(o){var v=null,c,u,r,t=0,i=this.bufferPadding,e=this.fragments;return Object.keys(e).forEach(function(s){var l=e[s];!l||T(l)&&(u=l.body.start-i,r=l.body.end+i,o>=u&&o<=r&&(c=Math.min(o-u,r-o),t<=c&&(v=l.body,t=c)))}),v},n.getState=function(o){var v=p(o),c=this.fragments[v];return c?c.buffered?T(c)?m.PARTIAL:m.OK:c.backtrack?m.BACKTRACKED:m.APPENDING:m.NOT_LOADED},n.backtrack=function(o,v){var c=p(o),u=this.fragments[c];if(!u||u.backtrack)return null;var r=u.backtrack=v||u.loaded;return u.loaded=null,r},n.getBacktrackData=function(o){var v=p(o),c=this.fragments[v];if(c){var u,r=c.backtrack;if(r!=null&&(u=r.payload)!==null&&u!==void 0&&u.byteLength)return r;this.removeFragment(o)}return null},n.isTimeBuffered=function(o,v,c){for(var u,r,t=0;t<c.length;t++){if(u=c.start(t)-this.bufferPadding,r=c.end(t)+this.bufferPadding,o>=u&&v<=r)return!0;if(v<=u)return!1}return!1},n.onFragLoaded=function(o,v){var c=v.frag,u=v.part;if(!(c.sn==="initSegment"||c.bitrateTest||u)){var r=p(c);this.fragments[r]={body:c,loaded:v,backtrack:null,buffered:!1,range:Object.create(null)}}},n.onBufferAppended=function(o,v){var c=this,u=v.frag,r=v.part,t=v.timeRanges;if(u.type===h.PlaylistLevelType.MAIN)if(this.activeFragment=u,r){var i=this.activeParts;i||(this.activeParts=i=[]),i.push(r)}else this.activeParts=null;this.timeRanges=t,Object.keys(t).forEach(function(e){var s=t[e];if(c.detectEvictedFragments(e,s),!r)for(var l=0;l<s.length;l++)u.appendedPTS=Math.max(s.end(l),u.appendedPTS||0)})},n.onFragBuffered=function(o,v){this.detectPartialFragments(v)},n.hasFragment=function(o){var v=p(o);return!!this.fragments[v]},n.removeFragmentsInRange=function(o,v,c){var u=this;Object.keys(this.fragments).forEach(function(r){var t=u.fragments[r];if(!!t&&t.buffered){var i=t.body;i.type===c&&i.start<v&&i.end>o&&u.removeFragment(i)}})},n.removeFragment=function(o){var v=p(o);o.stats.loaded=0,o.clearElementaryStreamInfo(),delete this.fragments[v]},n.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},f}();function T(f){var n,d;return f.buffered&&(((n=f.range.video)===null||n===void 0?void 0:n.partial)||((d=f.range.audio)===null||d===void 0?void 0:d.partial))}function p(f){return f.type+"_"+f.level+"_"+f.urlId+"_"+f.sn}},"./src/controller/gap-controller.ts":function(O,C,x){x.r(C),x.d(C,"STALL_MINIMUM_DURATION_MS",function(){return T}),x.d(C,"MAX_START_GAP_JUMP",function(){return p}),x.d(C,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return f}),x.d(C,"SKIP_BUFFER_RANGE_START",function(){return n}),x.d(C,"default",function(){return d});var S=x("./src/utils/buffer-helper.ts"),h=x("./src/errors.ts"),m=x("./src/events.ts"),M=x("./src/utils/logger.ts"),T=250,p=2,f=.1,n=.05,d=function(){function o(c,u,r,t){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=c,this.media=u,this.fragmentTracker=r,this.hls=t}var v=o.prototype;return v.destroy=function(){this.hls=this.fragmentTracker=this.media=null},v.poll=function(u){var r=this.config,t=this.media,i=this.stalled,e=t.currentTime,s=t.seeking,l=this.seeking&&!s,a=!this.seeking&&s;if(this.seeking=s,e!==u){if(this.moved=!0,i!==null){if(this.stallReported){var g=self.performance.now()-i;M.logger.warn("playback not stuck anymore @"+e+", after "+Math.round(g)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((a||l)&&(this.stalled=null),!(t.paused||t.ended||t.playbackRate===0||!S.BufferHelper.getBuffered(t).length)){var A=S.BufferHelper.bufferInfo(t,e,0),D=A.len>0,y=A.nextStart||0;if(!(!D&&!y)){if(s){var E=A.len>p,_=!y||y-e>p&&!this.fragmentTracker.getPartialFragment(e);if(E||_)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var L,I=Math.max(y,A.start||0)-e,b=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,R=b==null||(L=b.details)===null||L===void 0?void 0:L.live,P=R?b.details.targetduration*2:p;if(I>0&&I<=P){this._trySkipBufferHole(null);return}}var w=self.performance.now();if(i===null){this.stalled=w;return}var F=w-i;!s&&F>=T&&this._reportStall(A.len);var k=S.BufferHelper.bufferInfo(t,e,r.maxBufferHole);this._tryFixBufferStall(k,F)}}},v._tryFixBufferStall=function(u,r){var t=this.config,i=this.fragmentTracker,e=this.media,s=e.currentTime,l=i.getPartialFragment(s);if(l){var a=this._trySkipBufferHole(l);if(a)return}u.len>t.maxBufferHole&&r>t.highBufferWatchdogPeriod*1e3&&(M.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},v._reportStall=function(u){var r=this.hls,t=this.media,i=this.stallReported;i||(this.stallReported=!0,M.logger.warn("Playback stalling at @"+t.currentTime+" due to low buffer (buffer="+u+")"),r.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:u}))},v._trySkipBufferHole=function(u){for(var r=this.config,t=this.hls,i=this.media,e=i.currentTime,s=0,l=S.BufferHelper.getBuffered(i),a=0;a<l.length;a++){var g=l.start(a);if(e+r.maxBufferHole>=s&&e<g){var A=Math.max(g+n,i.currentTime+f);return M.logger.warn("skipping hole, adjusting currentTime from "+e+" to "+A),this.moved=!0,this.stalled=null,i.currentTime=A,u&&t.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+e+" to "+A,frag:u}),A}s=l.end(a)}return 0},v._tryNudgeBuffer=function(){var u=this.config,r=this.hls,t=this.media,i=t.currentTime,e=(this.nudgeRetry||0)+1;if(this.nudgeRetry=e,e<u.nudgeMaxRetry){var s=i+e*u.nudgeOffset;M.logger.warn("Nudging 'currentTime' from "+i+" to "+s),t.currentTime=s,r.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else M.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+u.nudgeMaxRetry+" nudges"),r.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},o}()},"./src/controller/id3-track-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),h=x("./src/utils/texttrack-utils.ts"),m=x("./src/demux/id3.ts"),M=.25,T=function(){function p(n){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=n,this._registerListeners()}var f=p.prototype;return f.destroy=function(){this._unregisterListeners()},f._registerListeners=function(){var d=this.hls;d.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.on(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),d.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f._unregisterListeners=function(){var d=this.hls;d.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),d.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f.onMediaAttached=function(d,o){this.media=o.media},f.onMediaDetaching=function(){!this.id3Track||(Object(h.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},f.getID3Track=function(d){if(!!this.media){for(var o=0;o<d.length;o++){var v=d[o];if(v.kind==="metadata"&&v.label==="id3")return Object(h.sendAddTrackEvent)(v,this.media),v}return this.media.addTextTrack("metadata","id3")}},f.onFragParsingMetadata=function(d,o){if(!!this.media){var v=o.frag,c=o.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var u=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,r=0;r<c.length;r++){var t=m.getID3Frames(c[r].data);if(t){var i=c[r].pts,e=r<c.length-1?c[r+1].pts:v.end,s=e-i;s<=0&&(e=i+M);for(var l=0;l<t.length;l++){var a=t[l];if(!m.isTimeStampFrame(a)){var g=new u(i,e,"");g.value=a,this.id3Track.addCue(g)}}}}}},f.onBufferFlushing=function(d,o){var v=o.startOffset,c=o.endOffset,u=o.type;if(!u||u==="audio"){var r=this.id3Track;r&&Object(h.removeCuesInRange)(r,v,c)}},p}();C.default=T},"./src/controller/latency-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return p});var S=x("./src/errors.ts"),h=x("./src/events.ts"),m=x("./src/utils/logger.ts");function M(f,n){for(var d=0;d<n.length;d++){var o=n[d];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(f,o.key,o)}}function T(f,n,d){return n&&M(f.prototype,n),d&&M(f,d),f}var p=function(){function f(d){var o=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return o.timeupdate()},this.hls=d,this.config=d.config,this.registerListeners()}var n=f.prototype;return n.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},n.registerListeners=function(){this.hls.on(h.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(h.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(h.Events.ERROR,this.onError,this)},n.unregisterListeners=function(){this.hls.off(h.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(h.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(h.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(h.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(h.Events.ERROR,this.onError)},n.onMediaAttached=function(o,v){this.media=v.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},n.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},n.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},n.onLevelUpdated=function(o,v){var c=v.details;this.levelDetails=c,c.advanced&&this.timeupdate(),!c.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},n.onError=function(o,v){v.details===S.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,m.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},n.timeupdate=function(){var o=this.media,v=this.levelDetails;if(!(!o||!v)){this.currentTime=o.currentTime;var c=this.computeLatency();if(c!==null){this._latency=c;var u=this.config,r=u.lowLatencyMode,t=u.maxLiveSyncPlaybackRate;if(!(!r||t===1)){var i=this.targetLatency;if(i!==null){var e=c-i,s=Math.min(this.maxLatency,i+v.targetduration),l=e<s;if(v.live&&l&&e>.05&&this.forwardBufferLength>1){var a=Math.min(2,Math.max(1,t)),g=Math.round(2/(1+Math.exp(-.75*e-this.edgeStalled))*20)/20;o.playbackRate=Math.min(a,Math.max(1,g))}else o.playbackRate!==1&&o.playbackRate!==0&&(o.playbackRate=1)}}}}},n.estimateLiveEdge=function(){var o=this.levelDetails;return o===null?null:o.edge+o.age},n.computeLatency=function(){var o=this.estimateLiveEdge();return o===null?null:o-this.currentTime},T(f,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var o=this.config,v=this.levelDetails;return o.liveMaxLatencyDuration!==void 0?o.liveMaxLatencyDuration:v?o.liveMaxLatencyDurationCount*v.targetduration:0}},{key:"targetLatency",get:function(){var o=this.levelDetails;if(o===null)return null;var v=o.holdBack,c=o.partHoldBack,u=o.targetduration,r=this.config,t=r.liveSyncDuration,i=r.liveSyncDurationCount,e=r.lowLatencyMode,s=this.hls.userConfig,l=e&&c||v;(s.liveSyncDuration||s.liveSyncDurationCount||l===0)&&(l=t!==void 0?t:i*u);var a=u,g=1;return l+Math.min(this.stallCount*g,a)}},{key:"liveSyncPosition",get:function(){var o=this.estimateLiveEdge(),v=this.targetLatency,c=this.levelDetails;if(o===null||v===null||c===null)return null;var u=c.edge,r=o-v-this.edgeStalled,t=u-c.totalduration,i=u-(this.config.lowLatencyMode&&c.partTarget||c.targetduration);return Math.min(Math.max(t,r),i)}},{key:"drift",get:function(){var o=this.levelDetails;return o===null?1:o.drift}},{key:"edgeStalled",get:function(){var o=this.levelDetails;if(o===null)return 0;var v=(this.config.lowLatencyMode&&o.partTarget||o.targetduration)*3;return Math.max(o.age-v,0)}},{key:"forwardBufferLength",get:function(){var o=this.media,v=this.levelDetails;if(!o||!v)return 0;var c=o.buffered.length;return c?o.buffered.end(c-1):v.edge-this.currentTime}}]),f}()},"./src/controller/level-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return r});var S=x("./src/types/level.ts"),h=x("./src/events.ts"),m=x("./src/errors.ts"),M=x("./src/utils/codecs.ts"),T=x("./src/controller/level-helper.ts"),p=x("./src/controller/base-playlist-controller.ts"),f=x("./src/types/loader.ts");function n(){return n=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},n.apply(this,arguments)}function d(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function o(t,i,e){return i&&d(t.prototype,i),e&&d(t,e),t}function v(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,c(t,i)}function c(t,i){return c=Object.setPrototypeOf||function(s,l){return s.__proto__=l,s},c(t,i)}var u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r=function(t){v(i,t);function i(s){var l;return l=t.call(this,s,"[level-controller]")||this,l._levels=[],l._firstLevel=-1,l._startLevel=void 0,l.currentLevelIndex=-1,l.manualLevelIndex=-1,l.onParsedComplete=void 0,l._registerListeners(),l}var e=i.prototype;return e._registerListeners=function(){var l=this.hls;l.on(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.on(h.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.on(h.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.on(h.Events.FRAG_LOADED,this.onFragLoaded,this),l.on(h.Events.ERROR,this.onError,this)},e._unregisterListeners=function(){var l=this.hls;l.off(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.off(h.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.off(h.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.off(h.Events.FRAG_LOADED,this.onFragLoaded,this),l.off(h.Events.ERROR,this.onError,this)},e.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,t.prototype.destroy.call(this)},e.startLoad=function(){var l=this._levels;l.forEach(function(a){a.loadError=0}),t.prototype.startLoad.call(this)},e.onManifestLoaded=function(l,a){var g=[],A=[],D=[],y,E={},_,L=!1,I=!1,b=!1;if(a.levels.forEach(function(F){var k=F.attrs;L=L||!!(F.width&&F.height),I=I||!!F.videoCodec,b=b||!!F.audioCodec,u&&F.audioCodec&&F.audioCodec.indexOf("mp4a.40.34")!==-1&&(F.audioCodec=void 0);var B=F.bitrate+"-"+F.attrs.RESOLUTION+"-"+F.attrs.CODECS;_=E[B],_?_.url.push(F.url):(_=new S.Level(F),E[B]=_,g.push(_)),k&&(k.AUDIO&&Object(T.addGroupId)(_,"audio",k.AUDIO),k.SUBTITLES&&Object(T.addGroupId)(_,"text",k.SUBTITLES))}),(L||I)&&b&&(g=g.filter(function(F){var k=F.videoCodec,B=F.width,U=F.height;return!!k||!!(B&&U)})),g=g.filter(function(F){var k=F.audioCodec,B=F.videoCodec;return(!k||Object(M.isCodecSupportedInMp4)(k,"audio"))&&(!B||Object(M.isCodecSupportedInMp4)(B,"video"))}),a.audioTracks&&(A=a.audioTracks.filter(function(F){return!F.audioCodec||Object(M.isCodecSupportedInMp4)(F.audioCodec,"audio")}),Object(T.assignTrackIdsByGroup)(A)),a.subtitles&&(D=a.subtitles,Object(T.assignTrackIdsByGroup)(D)),g.length>0){y=g[0].bitrate,g.sort(function(F,k){return F.bitrate-k.bitrate}),this._levels=g;for(var R=0;R<g.length;R++)if(g[R].bitrate===y){this._firstLevel=R,this.log("manifest loaded, "+g.length+" level(s) found, first bitrate: "+y);break}var P=b&&!I,w={levels:g,audioTracks:A,subtitleTracks:D,firstLevel:this._firstLevel,stats:a.stats,audio:b,video:I,altAudio:!P&&A.some(function(F){return!!F.url})};this.hls.trigger(h.Events.MANIFEST_PARSED,w),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(h.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:a.url,reason:"no level with compatible codecs found in manifest"})},e.onError=function(l,a){if(t.prototype.onError.call(this,l,a),!a.fatal){var g=a.context,A=this._levels[this.currentLevelIndex];if(g&&(g.type===f.PlaylistContextType.AUDIO_TRACK&&A.audioGroupIds&&g.groupId===A.audioGroupIds[A.urlId]||g.type===f.PlaylistContextType.SUBTITLE_TRACK&&A.textGroupIds&&g.groupId===A.textGroupIds[A.urlId])){this.redundantFailover(this.currentLevelIndex);return}var D=!1,y=!0,E;switch(a.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:if(a.frag){var _=this._levels[a.frag.level];_?(_.fragmentError++,_.fragmentError>this.hls.config.fragLoadingMaxRetry&&(E=a.frag.level)):E=a.frag.level}break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:g&&(g.deliveryDirectives&&(y=!1),E=g.level),D=!0;break;case m.ErrorDetails.REMUX_ALLOC_ERROR:E=a.level,D=!0;break}E!==void 0&&this.recoverLevel(a,E,D,y)}},e.recoverLevel=function(l,a,g,A){var D=l.details,y=this._levels[a];if(y.loadError++,g){var E=this.retryLoadingOrFail(l);if(E)l.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(A){var _=y.url.length;if(_>1&&y.loadError<_)l.levelRetry=!0,this.redundantFailover(a);else if(this.manualLevelIndex===-1){var L=a===0?this._levels.length-1:a-1;this.currentLevelIndex!==L&&this._levels[L].loadError===0&&(this.warn(D+": switch to "+L),l.levelRetry=!0,this.hls.nextAutoLevel=L)}}},e.redundantFailover=function(l){var a=this._levels[l],g=a.url.length;if(g>1){var A=(a.urlId+1)%g;this.warn("Switching to redundant URL-id "+A),this._levels.forEach(function(D){D.urlId=A}),this.level=l}},e.onFragLoaded=function(l,a){var g=a.frag;if(g!==void 0&&g.type===f.PlaylistLevelType.MAIN){var A=this._levels[g.level];A!==void 0&&(A.fragmentError=0,A.loadError=0)}},e.onLevelLoaded=function(l,a){var g,A=a.level,D=a.details,y=this._levels[A];if(!y){var E;this.warn("Invalid level index "+A),(E=a.deliveryDirectives)!==null&&E!==void 0&&E.skip&&(D.deltaUpdateFailed=!0);return}A===this.currentLevelIndex?(y.fragmentError===0&&(y.loadError=0,this.retryCount=0),this.playlistLoaded(A,a,y.details)):(g=a.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(D.deltaUpdateFailed=!0)},e.onAudioTrackSwitched=function(l,a){var g=this.hls.levels[this.currentLevelIndex];if(!!g&&g.audioGroupIds){for(var A=-1,D=this.hls.audioTracks[a.id].groupId,y=0;y<g.audioGroupIds.length;y++)if(g.audioGroupIds[y]===D){A=y;break}A!==g.urlId&&(g.urlId=A,this.startLoad())}},e.loadPlaylist=function(l){var a=this.currentLevelIndex,g=this._levels[a];if(this.canLoad&&g&&g.url.length>0){var A=g.urlId,D=g.url[A];if(l)try{D=l.addDirectives(D)}catch(y){this.warn("Could not construct new URL with HLS Delivery Directives: "+y)}this.log("Attempt loading level index "+a+(l?" at sn "+l.msn+" part "+l.part:"")+" with URL-id "+A+" "+D),this.clearTimer(),this.hls.trigger(h.Events.LEVEL_LOADING,{url:D,level:a,id:A,deliveryDirectives:l||null})}},e.removeLevel=function(l,a){var g=function(y,E){return E!==a},A=this._levels.filter(function(D,y){return y!==l?!0:D.url.length>1&&a!==void 0?(D.url=D.url.filter(g),D.audioGroupIds&&(D.audioGroupIds=D.audioGroupIds.filter(g)),D.textGroupIds&&(D.textGroupIds=D.textGroupIds.filter(g)),D.urlId=0,!0):!1}).map(function(D,y){var E=D.details;return E!=null&&E.fragments&&E.fragments.forEach(function(_){_.level=y}),D});this._levels=A,this.hls.trigger(h.Events.LEVELS_UPDATED,{levels:A})},o(i,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(l){var a,g=this._levels;if(g.length!==0&&!(this.currentLevelIndex===l&&(a=g[l])!==null&&a!==void 0&&a.details)){if(l<0||l>=g.length){var A=l<0;if(this.hls.trigger(h.Events.ERROR,{type:m.ErrorTypes.OTHER_ERROR,details:m.ErrorDetails.LEVEL_SWITCH_ERROR,level:l,fatal:A,reason:"invalid level idx"}),A)return;l=Math.min(l,g.length-1)}this.clearTimer();var D=this.currentLevelIndex,y=g[D],E=g[l];this.log("switching to level "+l+" from "+D),this.currentLevelIndex=l;var _=n({},E,{level:l,maxBitrate:E.maxBitrate,uri:E.uri,urlId:E.urlId});delete _._urlId,this.hls.trigger(h.Events.LEVEL_SWITCHING,_);var L=E.details;if(!L||L.live){var I=this.switchParams(E.uri,y==null?void 0:y.details);this.loadPlaylist(I)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(l){this.manualLevelIndex=l,this._startLevel===void 0&&(this._startLevel=l),l!==-1&&(this.level=l)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(l){this._firstLevel=l}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var l=this.hls.config.startLevel;return l!==void 0?l:this._firstLevel}else return this._startLevel},set:function(l){this._startLevel=l}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(l){this.level=l,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=l)}}]),i}(p.default)},"./src/controller/level-helper.ts":function(O,C,x){x.r(C),x.d(C,"addGroupId",function(){return m}),x.d(C,"assignTrackIdsByGroup",function(){return M}),x.d(C,"updatePTS",function(){return T}),x.d(C,"updateFragPTSDTS",function(){return f}),x.d(C,"mergeDetails",function(){return n}),x.d(C,"mapPartIntersection",function(){return d}),x.d(C,"mapFragmentIntersection",function(){return o}),x.d(C,"adjustSliding",function(){return v}),x.d(C,"addSliding",function(){return c}),x.d(C,"computeReloadInterval",function(){return u}),x.d(C,"getFragmentWithSN",function(){return r}),x.d(C,"getPartWith",function(){return t});var S=x("./src/polyfills/number.ts"),h=x("./src/utils/logger.ts");function m(i,e,s){switch(e){case"audio":i.audioGroupIds||(i.audioGroupIds=[]),i.audioGroupIds.push(s);break;case"text":i.textGroupIds||(i.textGroupIds=[]),i.textGroupIds.push(s);break}}function M(i){var e={};i.forEach(function(s){var l=s.groupId||"";s.id=e[l]=e[l]||0,e[l]++})}function T(i,e,s){var l=i[e],a=i[s];p(l,a)}function p(i,e){var s=e.startPTS;if(Object(S.isFiniteNumber)(s)){var l=0,a;e.sn>i.sn?(l=s-i.start,a=i):(l=i.start-s,a=e),a.duration!==l&&(a.duration=l)}else if(e.sn>i.sn){var g=i.cc===e.cc;g&&i.minEndPTS?e.start=i.start+(i.minEndPTS-i.start):e.start=i.start+i.duration}else e.start=Math.max(i.start-e.duration,0)}function f(i,e,s,l,a,g){var A=l-s;A<=0&&(h.logger.warn("Fragment should have a positive duration",e),l=s+e.duration,g=a+e.duration);var D=s,y=l,E=e.startPTS,_=e.endPTS;if(Object(S.isFiniteNumber)(E)){var L=Math.abs(E-s);Object(S.isFiniteNumber)(e.deltaPTS)?e.deltaPTS=Math.max(L,e.deltaPTS):e.deltaPTS=L,D=Math.max(s,E),s=Math.min(s,E),a=Math.min(a,e.startDTS),y=Math.min(l,_),l=Math.max(l,_),g=Math.max(g,e.endDTS)}e.duration=l-s;var I=s-e.start;e.appendedPTS=l,e.start=e.startPTS=s,e.maxStartPTS=D,e.startDTS=a,e.endPTS=l,e.minEndPTS=y,e.endDTS=g;var b=e.sn;if(!i||b<i.startSN||b>i.endSN)return 0;var R,P=b-i.startSN,w=i.fragments;for(w[P]=e,R=P;R>0;R--)p(w[R],w[R-1]);for(R=P;R<w.length-1;R++)p(w[R],w[R+1]);return i.fragmentHint&&p(w[w.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,I}function n(i,e){for(var s=null,l=i.fragments,a=l.length-1;a>=0;a--){var g=l[a].initSegment;if(g){s=g;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;var A=0,D;if(o(i,e,function(R,P){R.relurl&&(A=R.cc-P.cc),Object(S.isFiniteNumber)(R.startPTS)&&Object(S.isFiniteNumber)(R.endPTS)&&(P.start=P.startPTS=R.startPTS,P.startDTS=R.startDTS,P.appendedPTS=R.appendedPTS,P.maxStartPTS=R.maxStartPTS,P.endPTS=R.endPTS,P.endDTS=R.endDTS,P.minEndPTS=R.minEndPTS,P.duration=R.endPTS-R.startPTS,P.duration&&(D=P),e.PTSKnown=e.alignedSliding=!0),P.elementaryStreams=R.elementaryStreams,P.loader=R.loader,P.stats=R.stats,P.urlId=R.urlId,R.initSegment&&(P.initSegment=R.initSegment,s=R.initSegment)}),s){var y=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;y.forEach(function(R){var P;(!R.initSegment||R.initSegment.relurl===((P=s)===null||P===void 0?void 0:P.relurl))&&(R.initSegment=s)})}if(e.skippedSegments&&(e.deltaUpdateFailed=e.fragments.some(function(R){return!R}),e.deltaUpdateFailed)){h.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var E=e.skippedSegments;E--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}var _=e.fragments;if(A){h.logger.warn("discontinuity sliding from playlist, take drift into account");for(var L=0;L<_.length;L++)_[L].cc+=A}e.skippedSegments&&(e.startCC=e.fragments[0].cc),d(i.partList,e.partList,function(R,P){P.elementaryStreams=R.elementaryStreams,P.stats=R.stats}),D?f(e,D,D.startPTS,D.endPTS,D.startDTS,D.endDTS):v(i,e),_.length&&(e.totalduration=e.edge-_[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;var I=e.advancedDateTime;if(e.advanced&&I){var b=e.edge;e.driftStart||(e.driftStartTime=I,e.driftStart=b),e.driftEndTime=I,e.driftEnd=b}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}function d(i,e,s){if(i&&e)for(var l=0,a=0,g=i.length;a<=g;a++){var A=i[a],D=e[a+l];A&&D&&A.index===D.index&&A.fragment.sn===D.fragment.sn?s(A,D):l--}}function o(i,e,s){for(var l=e.skippedSegments,a=Math.max(i.startSN,e.startSN)-e.startSN,g=(i.fragmentHint?1:0)+(l?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,A=e.startSN-i.startSN,D=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,y=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments,E=a;E<=g;E++){var _=y[A+E],L=D[E];l&&!L&&E<l&&(L=e.fragments[E]=_),_&&L&&s(_,L)}}function v(i,e){var s=e.startSN+e.skippedSegments-i.startSN,l=i.fragments;s<0||s>=l.length||c(e,l[s].start)}function c(i,e){if(e){for(var s=i.fragments,l=i.skippedSegments;l<s.length;l++)s[l].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function u(i,e){var s=1e3*i.levelTargetDuration,l=s/2,a=i.age,g=a>0&&a<s*3,A=e.loading.end-e.loading.start,D,y=i.availabilityDelay;if(i.updated===!1)if(g){var E=333*i.misses;D=Math.max(Math.min(l,A*2),E),i.availabilityDelay=(i.availabilityDelay||0)+D}else D=l;else g?(y=Math.min(y||s/2,a),i.availabilityDelay=y,D=y+s-a):D=s-A;return Math.round(D)}function r(i,e,s){if(!i||!i.details)return null;var l=i.details,a=l.fragments[e-l.startSN];return a||(a=l.fragmentHint,a&&a.sn===e)?a:e<l.startSN&&s&&s.sn===e?s:null}function t(i,e,s){if(!i||!i.details)return null;var l=i.details.partList;if(l)for(var a=l.length;a--;){var g=l[a];if(g.index===s&&g.fragment.sn===e)return g}return null}},"./src/controller/stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return l});var S=x("./src/polyfills/number.ts"),h=x("./src/controller/base-stream-controller.ts"),m=x("./src/is-supported.ts"),M=x("./src/events.ts"),T=x("./src/utils/buffer-helper.ts"),p=x("./src/controller/fragment-tracker.ts"),f=x("./src/types/loader.ts"),n=x("./src/loader/fragment.ts"),d=x("./src/demux/transmuxer-interface.ts"),o=x("./src/types/transmuxer.ts"),v=x("./src/controller/gap-controller.ts"),c=x("./src/errors.ts"),u=x("./src/utils/logger.ts");function r(a,g){for(var A=0;A<g.length;A++){var D=g[A];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(a,D.key,D)}}function t(a,g,A){return g&&r(a.prototype,g),A&&r(a,A),a}function i(a,g){a.prototype=Object.create(g.prototype),a.prototype.constructor=a,e(a,g)}function e(a,g){return e=Object.setPrototypeOf||function(D,y){return D.__proto__=y,D},e(a,g)}var s=100,l=function(a){i(g,a);function g(D,y){var E;return E=a.call(this,D,y,"[stream-controller]")||this,E.audioCodecSwap=!1,E.gapController=null,E.level=-1,E._forceStartLoad=!1,E.altAudio=!1,E.audioOnly=!1,E.fragPlaying=null,E.onvplaying=null,E.onvseeked=null,E.fragLastKbps=0,E.stalled=!1,E.couldBacktrack=!1,E.audioCodecSwitch=!1,E.videoBuffer=null,E._registerListeners(),E}var A=g.prototype;return A._registerListeners=function(){var y=this.hls;y.on(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),y.on(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.on(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.on(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.on(M.Events.LEVEL_LOADING,this.onLevelLoading,this),y.on(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.on(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),y.on(M.Events.ERROR,this.onError,this),y.on(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),y.on(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),y.on(M.Events.BUFFER_CREATED,this.onBufferCreated,this),y.on(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),y.on(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),y.on(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A._unregisterListeners=function(){var y=this.hls;y.off(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),y.off(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.off(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.off(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.off(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.off(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),y.off(M.Events.ERROR,this.onError,this),y.off(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),y.off(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),y.off(M.Events.BUFFER_CREATED,this.onBufferCreated,this),y.off(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),y.off(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),y.off(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},A.startLoad=function(y){if(this.levels){var E=this.lastCurrentTime,_=this.hls;if(this.stopLoad(),this.setInterval(s),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var L=_.startLevel;L===-1&&(_.config.testBandwidth?(L=0,this.bitrateTest=!0):L=_.nextAutoLevel),this.level=_.nextLoadLevel=L,this.loadedmetadata=!1}E>0&&y===-1&&(this.log("Override startPosition with lastCurrentTime @"+E.toFixed(3)),y=E),this.state=h.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=y,this.tick()}else this._forceStartLoad=!0,this.state=h.State.STOPPED},A.stopLoad=function(){this._forceStartLoad=!1,a.prototype.stopLoad.call(this)},A.doTick=function(){switch(this.state){case h.State.IDLE:this.doTickIdle();break;case h.State.WAITING_LEVEL:{var y,E=this.levels,_=this.level,L=E==null||(y=E[_])===null||y===void 0?void 0:y.details;if(L&&(!L.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(L))break;this.state=h.State.IDLE;break}break}case h.State.FRAG_LOADING_WAITING_RETRY:{var I,b=self.performance.now(),R=this.retryDate;(!R||b>=R||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=h.State.IDLE)}break}this.onTickEnd()},A.onTickEnd=function(){a.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},A.doTickIdle=function(){var y,E,_=this.hls,L=this.levelLastLoaded,I=this.levels,b=this.media,R=_.config,P=_.nextLoadLevel;if(!(L===null||!b&&(this.startFragRequested||!R.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!I||!I[P])){var w=I[P];this.level=_.nextLoadLevel=P;var F=w.details;if(!F||this.state===h.State.WAITING_LEVEL||F.live&&this.levelLastLoaded!==P){this.state=h.State.WAITING_LEVEL;return}var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:b,f.PlaylistLevelType.MAIN);if(k!==null){var B=k.len,U=this.getMaxBufferLength(w.maxBitrate);if(!(B>=U)){if(this._streamEnded(k,F)){var j={};this.altAudio&&(j.type="video"),this.hls.trigger(M.Events.BUFFER_EOS,j),this.state=h.State.ENDED;return}var K=k.end,N=this.getNextFragment(K,F);if(this.couldBacktrack&&!this.fragPrevious&&N&&N.sn!=="initSegment"){var Z=N.sn-F.startSN;Z>1&&(N=F.fragments[Z-1],this.fragmentTracker.removeFragment(N))}if(N&&this.fragmentTracker.getState(N)===p.FragmentState.OK&&this.nextLoadPosition>K){var X=this.audioOnly&&!this.altAudio?n.ElementaryStreamTypes.AUDIO:n.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(b,X,f.PlaylistLevelType.MAIN),N=this.getNextFragment(this.nextLoadPosition,F)}!N||(N.initSegment&&!N.initSegment.data&&!this.bitrateTest&&(N=N.initSegment),((y=N.decryptdata)===null||y===void 0?void 0:y.keyFormat)==="identity"&&!((E=N.decryptdata)!==null&&E!==void 0&&E.key)?this.loadKey(N,F):this.loadFragment(N,F,K))}}}},A.loadFragment=function(y,E,_){var L,I=this.fragmentTracker.getState(y);if(this.fragCurrent=y,I===p.FragmentState.BACKTRACKED){var b=this.fragmentTracker.getBacktrackData(y);if(b){this._handleFragmentLoadProgress(b),this._handleFragmentLoadComplete(b);return}else I=p.FragmentState.NOT_LOADED}I===p.FragmentState.NOT_LOADED||I===p.FragmentState.PARTIAL?y.sn==="initSegment"?this._loadInitSegment(y):this.bitrateTest?(y.bitrateTest=!0,this.log("Fragment "+y.sn+" of level "+y.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(y)):(this.startFragRequested=!0,a.prototype.loadFragment.call(this,y,E,_)):I===p.FragmentState.APPENDING?this.reduceMaxBufferLength(y.duration)&&this.fragmentTracker.removeFragment(y):((L=this.media)===null||L===void 0?void 0:L.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},A.getAppendedFrag=function(y){var E=this.fragmentTracker.getAppendedFrag(y,f.PlaylistLevelType.MAIN);return E&&"fragment"in E?E.fragment:E},A.getBufferedFrag=function(y){return this.fragmentTracker.getBufferedFrag(y,f.PlaylistLevelType.MAIN)},A.followingBufferedFrag=function(y){return y?this.getBufferedFrag(y.end+.5):null},A.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},A.nextLevelSwitch=function(){var y=this.levels,E=this.media;if(E!=null&&E.readyState){var _,L=this.getAppendedFrag(E.currentTime);if(L&&L.start>1&&this.flushMainBuffer(0,L.start-1),!E.paused&&y){var I=this.hls.nextLoadLevel,b=y[I],R=this.fragLastKbps;R&&this.fragCurrent?_=this.fragCurrent.duration*b.maxBitrate/(1e3*R)+1:_=0}else _=0;var P=this.getBufferedFrag(E.currentTime+_);if(P){var w=this.followingBufferedFrag(P);if(w){this.abortCurrentFrag();var F=w.maxStartPTS?w.maxStartPTS:w.start,k=w.duration,B=Math.max(P.end,F+Math.min(Math.max(k-this.config.maxFragLookUpTolerance,k*.5),k*.75));this.flushMainBuffer(B,Number.POSITIVE_INFINITY)}}}},A.abortCurrentFrag=function(){var y=this.fragCurrent;this.fragCurrent=null,y!=null&&y.loader&&y.loader.abort(),this.state===h.State.KEY_LOADING&&(this.state=h.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},A.flushMainBuffer=function(y,E){a.prototype.flushMainBuffer.call(this,y,E,this.altAudio?"video":null)},A.onMediaAttached=function(y,E){a.prototype.onMediaAttached.call(this,y,E);var _=E.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),_.addEventListener("playing",this.onvplaying),_.addEventListener("seeked",this.onvseeked),this.gapController=new v.default(this.config,_,this.fragmentTracker,this.hls)},A.onMediaDetaching=function(){var y=this.media;y&&(y.removeEventListener("playing",this.onvplaying),y.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),a.prototype.onMediaDetaching.call(this)},A.onMediaPlaying=function(){this.tick()},A.onMediaSeeked=function(){var y=this.media,E=y?y.currentTime:null;Object(S.isFiniteNumber)(E)&&this.log("Media seeked to "+E.toFixed(3)),this.tick()},A.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},A.onManifestParsed=function(y,E){var _=!1,L=!1,I;E.levels.forEach(function(b){I=b.audioCodec,I&&(I.indexOf("mp4a.40.2")!==-1&&(_=!0),I.indexOf("mp4a.40.5")!==-1&&(L=!0))}),this.audioCodecSwitch=_&&L&&!Object(m.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=E.levels,this.startFragRequested=!1},A.onLevelLoading=function(y,E){var _=this.levels;if(!(!_||this.state!==h.State.IDLE)){var L=_[E.level];(!L.details||L.details.live&&this.levelLastLoaded!==E.level||this.waitForCdnTuneIn(L.details))&&(this.state=h.State.WAITING_LEVEL)}},A.onLevelLoaded=function(y,E){var _,L=this.levels,I=E.level,b=E.details,R=b.totalduration;if(!L){this.warn("Levels were reset while loading level "+I);return}this.log("Level "+I+" loaded ["+b.startSN+","+b.endSN+"], cc ["+b.startCC+", "+b.endCC+"] duration:"+R);var P=this.fragCurrent;P&&(this.state===h.State.FRAG_LOADING||this.state===h.State.FRAG_LOADING_WAITING_RETRY)&&P.level!==E.level&&P.loader&&(this.state=h.State.IDLE,P.loader.abort());var w=L[I],F=0;if(b.live||(_=w.details)!==null&&_!==void 0&&_.live){if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed)return;F=this.alignPlaylists(b,w.details)}if(w.details=b,this.levelLastLoaded=I,this.hls.trigger(M.Events.LEVEL_UPDATED,{details:b,level:I}),this.state===h.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(b))return;this.state=h.State.IDLE}this.startFragRequested?b.live&&this.synchronizeToLiveEdge(b):this.setStartPosition(b,F),this.tick()},A._handleFragmentLoadProgress=function(y){var E,_=y.frag,L=y.part,I=y.payload,b=this.levels;if(!b){this.warn("Levels were reset while fragment load was in progress. Fragment "+_.sn+" of level "+_.level+" will not be buffered");return}var R=b[_.level],P=R.details;if(!P){this.warn("Dropping fragment "+_.sn+" of level "+_.level+" after level details were reset");return}var w=R.videoCodec,F=P.PTSKnown||!P.live,k=(E=_.initSegment)===null||E===void 0?void 0:E.data,B=this._getAudioCodec(R),U=this.transmuxer=this.transmuxer||new d.default(this.hls,f.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),j=L?L.index:-1,K=j!==-1,N=new o.ChunkMetadata(_.level,_.sn,_.stats.chunkCount,I.byteLength,j,K),Z=this.initPTS[_.cc];U.push(I,k,B,w,_,L,P.totalduration,F,N,Z)},A.onAudioTrackSwitching=function(y,E){var _=this.altAudio,L=!!E.url,I=E.id;if(!L){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var b=this.fragCurrent;b!=null&&b.loader&&(this.log("Switching to main audio track, cancel main fragment load"),b.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var R=this.hls;_&&R.trigger(M.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),R.trigger(M.Events.AUDIO_TRACK_SWITCHED,{id:I})}},A.onAudioTrackSwitched=function(y,E){var _=E.id,L=!!this.hls.audioTracks[_].url;if(L){var I=this.videoBuffer;I&&this.mediaBuffer!==I&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=I)}this.altAudio=L,this.tick()},A.onBufferCreated=function(y,E){var _=E.tracks,L,I,b=!1;for(var R in _){var P=_[R];if(P.id==="main"){if(I=R,L=P,R==="video"){var w=_[R];w&&(this.videoBuffer=w.buffer)}}else b=!0}b&&L?(this.log("Alternate track found, use "+I+".buffered to schedule main fragment loading"),this.mediaBuffer=L.buffer):this.mediaBuffer=this.media},A.onFragBuffered=function(y,E){var _=E.frag,L=E.part;if(!(_&&_.type!==f.PlaylistLevelType.MAIN)){if(this.fragContextChanged(_)){this.warn("Fragment "+_.sn+(L?" p: "+L.index:"")+" of level "+_.level+" finished buffering, but was aborted. state: "+this.state),this.state===h.State.PARSED&&(this.state=h.State.IDLE);return}var I=L?L.stats:_.stats;this.fragLastKbps=Math.round(8*I.total/(I.buffering.end-I.loading.first)),_.sn!=="initSegment"&&(this.fragPrevious=_),this.fragBufferedComplete(_,L)}},A.onError=function(y,E){switch(E.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(f.PlaylistLevelType.MAIN,E);break;case c.ErrorDetails.LEVEL_LOAD_ERROR:case c.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==h.State.ERROR&&(E.fatal?(this.warn(""+E.details),this.state=h.State.ERROR):!E.levelRetry&&this.state===h.State.WAITING_LEVEL&&(this.state=h.State.IDLE));break;case c.ErrorDetails.BUFFER_FULL_ERROR:if(E.parent==="main"&&(this.state===h.State.PARSING||this.state===h.State.PARSED)){var _=!0,L=this.getFwdBufferInfo(this.media,f.PlaylistLevelType.MAIN);L&&L.len>.5&&(_=!this.reduceMaxBufferLength(L.len)),_&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},A.checkBuffer=function(){var y=this.media,E=this.gapController;if(!(!y||!E||!y.readyState)){var _=T.BufferHelper.getBuffered(y);!this.loadedmetadata&&_.length?(this.loadedmetadata=!0,this.seekToStartPos()):E.poll(this.lastCurrentTime),this.lastCurrentTime=y.currentTime}},A.onFragLoadEmergencyAborted=function(){this.state=h.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},A.onBufferFlushed=function(y,E){var _=E.type;if(_!==n.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var L=(_===n.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(L,_,f.PlaylistLevelType.MAIN)}},A.onLevelsUpdated=function(y,E){this.levels=E.levels},A.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},A.seekToStartPos=function(){var y=this.media,E=y.currentTime,_=this.startPosition;if(_>=0&&E<_){if(y.seeking){u.logger.log("could not seek to "+_+", already seeking at "+E);return}var L=T.BufferHelper.getBuffered(y),I=L.length?L.start(0):0,b=I-_;b>0&&(b<this.config.maxBufferHole||b<this.config.maxFragLookUpTolerance)&&(u.logger.log("adjusting start position by "+b+" to match buffer start"),_+=b,this.startPosition=_),this.log("seek to target start position "+_+" from current time "+E),y.currentTime=_}},A._getAudioCodec=function(y){var E=this.config.defaultAudioCodec||y.audioCodec;return this.audioCodecSwap&&E&&(this.log("Swapping audio codec"),E.indexOf("mp4a.40.5")!==-1?E="mp4a.40.2":E="mp4a.40.5"),E},A._loadBitrateTestFrag=function(y){var E=this;this._doFragLoad(y).then(function(_){var L=E.hls;if(!(!_||L.nextLoadLevel||E.fragContextChanged(y))){E.fragLoadError=0,E.state=h.State.IDLE,E.startFragRequested=!1,E.bitrateTest=!1;var I=y.stats;I.parsing.start=I.parsing.end=I.buffering.start=I.buffering.end=self.performance.now(),L.trigger(M.Events.FRAG_LOADED,_)}})},A._handleTransmuxComplete=function(y){var E,_="main",L=this.hls,I=y.remuxResult,b=y.chunkMeta,R=this.getCurrentContext(b);if(!R){this.warn("The loading context changed while buffering fragment "+b.sn+" of level "+b.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(b.level);return}var P=R.frag,w=R.part,F=R.level,k=I.video,B=I.text,U=I.id3,j=I.initSegment,K=this.altAudio?void 0:I.audio;if(!this.fragContextChanged(P)){if(this.state=h.State.PARSING,j){j.tracks&&(this._bufferInitSegment(F,j.tracks,P,b),L.trigger(M.Events.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:_,tracks:j.tracks}));var N=j.initPTS,Z=j.timescale;Object(S.isFiniteNumber)(N)&&(this.initPTS[P.cc]=N,L.trigger(M.Events.INIT_PTS_FOUND,{frag:P,id:_,initPTS:N,timescale:Z}))}if(k&&I.independent!==!1){if(F.details){var X=k.startPTS,Y=k.endPTS,ee=k.startDTS,Q=k.endDTS;if(w)w.elementaryStreams[k.type]={startPTS:X,endPTS:Y,startDTS:ee,endDTS:Q};else if(k.firstKeyFrame&&k.independent&&(this.couldBacktrack=!0),k.dropped&&k.independent){var G=this.getLoadPosition()+this.config.maxBufferHole;if(G<X){this.backtrack(P);return}P.setElementaryStreamInfo(k.type,P.start,Y,P.start,Q,!0)}P.setElementaryStreamInfo(k.type,X,Y,ee,Q),this.bufferFragmentData(k,P,w,b)}}else if(I.independent===!1){this.backtrack(P);return}if(K){var q=K.startPTS,te=K.endPTS,ie=K.startDTS,ne=K.endDTS;w&&(w.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:q,endPTS:te,startDTS:ie,endDTS:ne}),P.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,q,te,ie,ne),this.bufferFragmentData(K,P,w,b)}if(U!=null&&(E=U.samples)!==null&&E!==void 0&&E.length){var le={frag:P,id:_,samples:U.samples};L.trigger(M.Events.FRAG_PARSING_METADATA,le)}if(B){var se={frag:P,id:_,samples:B.samples};L.trigger(M.Events.FRAG_PARSING_USERDATA,se)}}},A._bufferInitSegment=function(y,E,_,L){var I=this;if(this.state===h.State.PARSING){this.audioOnly=!!E.audio&&!E.video,this.altAudio&&!this.audioOnly&&delete E.audio;var b=E.audio,R=E.video,P=E.audiovideo;if(b){var w=y.audioCodec,F=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(w&&(w.indexOf("mp4a.40.5")!==-1?w="mp4a.40.2":w="mp4a.40.5"),b.metadata.channelCount!==1&&F.indexOf("firefox")===-1&&(w="mp4a.40.5")),F.indexOf("android")!==-1&&b.container!=="audio/mpeg"&&(w="mp4a.40.2",this.log("Android: force audio codec to "+w)),y.audioCodec&&y.audioCodec!==w&&this.log('Swapping manifest audio codec "'+y.audioCodec+'" for "'+w+'"'),b.levelCodec=w,b.id="main",this.log("Init audio buffer, container:"+b.container+", codecs[selected/level/parsed]=["+(w||"")+"/"+(y.audioCodec||"")+"/"+b.codec+"]")}R&&(R.levelCodec=y.videoCodec,R.id="main",this.log("Init video buffer, container:"+R.container+", codecs[level/parsed]=["+(y.videoCodec||"")+"/"+R.codec+"]")),P&&this.log("Init audiovideo buffer, container:"+P.container+", codecs[level/parsed]=["+(y.attrs.CODECS||"")+"/"+P.codec+"]"),this.hls.trigger(M.Events.BUFFER_CODECS,E),Object.keys(E).forEach(function(k){var B=E[k],U=B.initSegment;U!=null&&U.byteLength&&I.hls.trigger(M.Events.BUFFER_APPENDING,{type:k,data:U,frag:_,part:null,chunkMeta:L,parent:_.type})}),this.tick()}},A.backtrack=function(y){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(y);var E=this.fragmentTracker.backtrack(y);this.fragPrevious=null,this.nextLoadPosition=y.start,E?this.resetFragmentLoading(y):this.state=h.State.BACKTRACKING},A.checkFragmentChanged=function(){var y=this.media,E=null;if(y&&y.readyState>1&&y.seeking===!1){var _=y.currentTime;if(T.BufferHelper.isBuffered(y,_)?E=this.getAppendedFrag(_):T.BufferHelper.isBuffered(y,_+.1)&&(E=this.getAppendedFrag(_+.1)),E){var L=this.fragPlaying,I=E.level;(!L||E.sn!==L.sn||L.level!==I||E.urlId!==L.urlId)&&(this.hls.trigger(M.Events.FRAG_CHANGED,{frag:E}),(!L||L.level!==I)&&this.hls.trigger(M.Events.LEVEL_SWITCHED,{level:I}),this.fragPlaying=E)}}},t(g,[{key:"nextLevel",get:function(){var y=this.nextBufferedFrag;return y?y.level:-1}},{key:"currentLevel",get:function(){var y=this.media;if(y){var E=this.getAppendedFrag(y.currentTime);if(E)return E.level}return-1}},{key:"nextBufferedFrag",get:function(){var y=this.media;if(y){var E=this.getAppendedFrag(y.currentTime);return this.followingBufferedFrag(E)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),g}(h.default)},"./src/controller/subtitle-stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"SubtitleStreamController",function(){return t});var S=x("./src/events.ts"),h=x("./src/utils/buffer-helper.ts"),m=x("./src/controller/fragment-finders.ts"),M=x("./src/utils/discontinuities.ts"),T=x("./src/controller/level-helper.ts"),p=x("./src/controller/fragment-tracker.ts"),f=x("./src/controller/base-stream-controller.ts"),n=x("./src/types/loader.ts"),d=x("./src/types/level.ts");function o(i,e){for(var s=0;s<e.length;s++){var l=e[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(i,l.key,l)}}function v(i,e,s){return e&&o(i.prototype,e),s&&o(i,s),i}function c(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,u(i,e)}function u(i,e){return u=Object.setPrototypeOf||function(l,a){return l.__proto__=a,l},u(i,e)}var r=500,t=function(i){c(e,i);function e(l,a){var g;return g=i.call(this,l,a,"[subtitle-stream-controller]")||this,g.levels=[],g.currentTrackId=-1,g.tracksBuffered=[],g.mainDetails=null,g._registerListeners(),g}var s=e.prototype;return s.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function(){var a=this.hls;a.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.on(S.Events.ERROR,this.onError,this),a.on(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.on(S.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.on(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.on(S.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s._unregisterListeners=function(){var a=this.hls;a.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.off(S.Events.ERROR,this.onError,this),a.off(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.off(S.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.off(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.off(S.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s.startLoad=function(){this.stopLoad(),this.state=f.State.IDLE,this.setInterval(r),this.tick()},s.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},s.onLevelLoaded=function(a,g){this.mainDetails=g.details},s.onSubtitleFragProcessed=function(a,g){var A=g.frag,D=g.success;if(this.fragPrevious=A,this.state=f.State.IDLE,!!D){var y=this.tracksBuffered[this.currentTrackId];if(!!y){for(var E,_=A.start,L=0;L<y.length;L++)if(_>=y[L].start&&_<=y[L].end){E=y[L];break}var I=A.start+A.duration;E?E.end=I:(E={start:_,end:I},y.push(E)),this.fragmentTracker.fragBuffered(A)}}},s.onBufferFlushing=function(a,g){var A=g.startOffset,D=g.endOffset;if(A===0&&D!==Number.POSITIVE_INFINITY){var y=this.currentTrackId,E=this.levels;if(!E.length||!E[y]||!E[y].details)return;var _=E[y].details,L=_.targetduration,I=D-L;if(I<=0)return;g.endOffsetSubtitles=Math.max(0,I),this.tracksBuffered.forEach(function(b){for(var R=0;R<b.length;){if(b[R].end<=I){b.shift();continue}else if(b[R].start<I)b[R].start=I;else break;R++}}),this.fragmentTracker.removeFragmentsInRange(A,I,n.PlaylistLevelType.SUBTITLE)}},s.onError=function(a,g){var A,D=g.frag;!D||D.type!==n.PlaylistLevelType.SUBTITLE||((A=this.fragCurrent)!==null&&A!==void 0&&A.loader&&this.fragCurrent.loader.abort(),this.state=f.State.IDLE)},s.onSubtitleTracksUpdated=function(a,g){var A=this,D=g.subtitleTracks;this.tracksBuffered=[],this.levels=D.map(function(y){return new d.Level(y)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(y){A.tracksBuffered[y.id]=[]}),this.mediaBuffer=null},s.onSubtitleTrackSwitch=function(a,g){if(this.currentTrackId=g.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var A=this.levels[this.currentTrackId];A!=null&&A.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,A&&this.setInterval(r)},s.onSubtitleTrackLoaded=function(a,g){var A,D=g.details,y=g.id,E=this.currentTrackId,_=this.levels;if(!!_.length){var L=_[E];if(!(y>=_.length||y!==E||!L)){if(this.mediaBuffer=this.mediaBufferTimeRanges,D.live||(A=L.details)!==null&&A!==void 0&&A.live){var I=this.mainDetails;if(D.deltaUpdateFailed||!I)return;var b=I.fragments[0];if(!L.details)D.hasProgramDateTime&&I.hasProgramDateTime?Object(M.alignMediaPlaylistByPDT)(D,I):b&&Object(T.addSliding)(D,b.start);else{var R=this.alignPlaylists(D,L.details);R===0&&b&&Object(T.addSliding)(D,b.start)}}if(L.details=D,this.levelLastLoaded=y,this.tick(),D.live&&!this.fragCurrent&&this.media&&this.state===f.State.IDLE){var P=Object(m.findFragmentByPTS)(null,D.fragments,this.media.currentTime,0);P||(this.warn("Subtitle playlist not aligned with playback"),L.details=void 0)}}}},s._handleFragmentLoadComplete=function(a){var g=a.frag,A=a.payload,D=g.decryptdata,y=this.hls;if(!this.fragContextChanged(g)&&A&&A.byteLength>0&&D&&D.key&&D.iv&&D.method==="AES-128"){var E=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(A),D.key.buffer,D.iv.buffer).then(function(_){var L=performance.now();y.trigger(S.Events.FRAG_DECRYPTED,{frag:g,payload:_,stats:{tstart:E,tdecrypt:L}})})}},s.doTick=function(){if(!this.media){this.state=f.State.IDLE;return}if(this.state===f.State.IDLE){var a,g=this.currentTrackId,A=this.levels;if(!A.length||!A[g]||!A[g].details)return;var D=A[g].details,y=D.targetduration,E=this.config,_=this.media,L=h.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,_.currentTime-y,E.maxBufferHole),I=L.end,b=L.len,R=this.getMaxBufferLength()+y;if(b>R)return;console.assert(D,"Subtitle track details are defined on idle subtitle stream controller tick");var P=D.fragments,w=P.length,F=D.edge,k,B=this.fragPrevious;if(I<F){var U=E.maxFragLookUpTolerance;k=Object(m.findFragmentByPTS)(B,P,I,U),!k&&B&&B.start<P[0].start&&(k=P[0])}else k=P[w-1];(a=k)!==null&&a!==void 0&&a.encrypted?this.loadKey(k,D):k&&this.fragmentTracker.getState(k)===p.FragmentState.NOT_LOADED&&this.loadFragment(k,D,I)}},s.loadFragment=function(a,g,A){this.fragCurrent=a,i.prototype.loadFragment.call(this,a,g,A)},v(e,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),e}(f.default)},"./src/controller/subtitle-track-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),h=x("./src/utils/texttrack-utils.ts"),m=x("./src/controller/base-playlist-controller.ts"),M=x("./src/types/loader.ts");function T(v,c){for(var u=0;u<c.length;u++){var r=c[u];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(v,r.key,r)}}function p(v,c,u){return c&&T(v.prototype,c),u&&T(v,u),v}function f(v,c){v.prototype=Object.create(c.prototype),v.prototype.constructor=v,n(v,c)}function n(v,c){return n=Object.setPrototypeOf||function(r,t){return r.__proto__=t,r},n(v,c)}var d=function(v){f(c,v);function c(r){var t;return t=v.call(this,r,"[subtitle-track-controller]")||this,t.media=null,t.tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.selectDefaultTrack=!0,t.queuedDefaultTrack=-1,t.trackChangeListener=function(){return t.onTextTracksChanged()},t.asyncPollTrackChange=function(){return t.pollTrackChange(0)},t.useTextTrackPolling=!1,t.subtitlePollingInterval=-1,t.subtitleDisplay=!0,t.registerListeners(),t}var u=c.prototype;return u.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,v.prototype.destroy.call(this)},u.registerListeners=function(){var t=this.hls;t.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(S.Events.ERROR,this.onError,this)},u.unregisterListeners=function(){var t=this.hls;t.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(S.Events.ERROR,this.onError,this)},u.onMediaAttached=function(t,i){this.media=i.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},u.pollTrackChange=function(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)},u.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var t=o(this.media.textTracks);t.forEach(function(i){Object(h.clearCurrentCues)(i)}),this.subtitleTrack=-1,this.media=null}},u.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},u.onManifestParsed=function(t,i){this.tracks=i.subtitleTracks},u.onSubtitleTrackLoaded=function(t,i){var e=i.id,s=i.details,l=this.trackId,a=this.tracksInGroup[l];if(!a){this.warn("Invalid subtitle track id "+e);return}var g=a.details;a.details=i.details,this.log("subtitle track "+e+" loaded ["+s.startSN+"-"+s.endSN+"]"),e===this.trackId&&(this.retryCount=0,this.playlistLoaded(e,i,g))},u.onLevelLoading=function(t,i){this.switchLevel(i.level)},u.onLevelSwitching=function(t,i){this.switchLevel(i.level)},u.switchLevel=function(t){var i=this.hls.levels[t];if(!!(i!=null&&i.textGroupIds)){var e=i.textGroupIds[i.urlId];if(this.groupId!==e){var s=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,l=this.tracks.filter(function(A){return!e||A.groupId===e});this.tracksInGroup=l;var a=this.findTrackId(s==null?void 0:s.name)||this.findTrackId();this.groupId=e;var g={subtitleTracks:l};this.log("Updating subtitle tracks, "+l.length+' track(s) found in "'+e+'" group-id'),this.hls.trigger(S.Events.SUBTITLE_TRACKS_UPDATED,g),a!==-1&&this.setSubtitleTrack(a,s)}}},u.findTrackId=function(t){for(var i=this.tracksInGroup,e=0;e<i.length;e++){var s=i[e];if((!this.selectDefaultTrack||s.default)&&(!t||t===s.name))return s.id}return-1},u.onError=function(t,i){v.prototype.onError.call(this,t,i),!(i.fatal||!i.context)&&i.context.type===M.PlaylistContextType.SUBTITLE_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&this.retryLoadingOrFail(i)},u.loadPlaylist=function(t){var i=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(i)){var e=i.id,s=i.groupId,l=i.url;if(t)try{l=t.addDirectives(l)}catch(a){this.warn("Could not construct new URL with HLS Delivery Directives: "+a)}this.log("Loading subtitle playlist for id "+e),this.hls.trigger(S.Events.SUBTITLE_TRACK_LOADING,{url:l,id:e,groupId:s,deliveryDirectives:t||null})}},u.toggleTrackModes=function(t){var i=this,e=this.media,s=this.subtitleDisplay,l=this.trackId;if(!!e){var a=o(e.textTracks),g=a.filter(function(y){return y.groupId===i.groupId});if(t===-1)[].slice.call(a).forEach(function(y){y.mode="disabled"});else{var A=g[l];A&&(A.mode="disabled")}var D=g[t];D&&(D.mode=s?"showing":"hidden")}},u.setSubtitleTrack=function(t,i){var e,s=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(this.trackId!==t&&this.toggleTrackModes(t),!(this.trackId===t&&(t===-1||(e=s[t])!==null&&e!==void 0&&e.details)||t<-1||t>=s.length)){this.clearTimer();var l=s[t];if(this.log("Switching to subtitle track "+t),this.trackId=t,l){var a=l.id,g=l.groupId,A=g===void 0?"":g,D=l.name,y=l.type,E=l.url;this.hls.trigger(S.Events.SUBTITLE_TRACK_SWITCH,{id:a,groupId:A,name:D,type:y,url:E});var _=this.switchParams(l.url,i==null?void 0:i.details);this.loadPlaylist(_)}else this.hls.trigger(S.Events.SUBTITLE_TRACK_SWITCH,{id:t})}},u.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var t=-1,i=o(this.media.textTracks),e=0;e<i.length;e++)if(i[e].mode==="hidden")t=e;else if(i[e].mode==="showing"){t=e;break}this.subtitleTrack!==t&&(this.subtitleTrack=t)}},p(c,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1;var i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,i)}}]),c}(m.default);function o(v){for(var c=[],u=0;u<v.length;u++){var r=v[u];r.kind==="subtitles"&&r.label&&c.push(v[u])}return c}C.default=d},"./src/controller/timeline-controller.ts":function(O,C,x){x.r(C),x.d(C,"TimelineController",function(){return o});var S=x("./src/polyfills/number.ts"),h=x("./src/events.ts"),m=x("./src/utils/cea-608-parser.ts"),M=x("./src/utils/output-filter.ts"),T=x("./src/utils/webvtt-parser.ts"),p=x("./src/utils/texttrack-utils.ts"),f=x("./src/utils/imsc1-ttml-parser.ts"),n=x("./src/types/loader.ts"),d=x("./src/utils/logger.ts"),o=function(){function r(i){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=u(),this.captionsProperties=void 0,this.hls=i,this.config=i.config,this.Cues=i.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var e=new M.default(this,"textTrack1"),s=new M.default(this,"textTrack2"),l=new M.default(this,"textTrack3"),a=new M.default(this,"textTrack4");this.cea608Parser1=new m.default(1,e,s),this.cea608Parser2=new m.default(3,l,a)}i.on(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(h.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(h.Events.FRAG_LOADING,this.onFragLoading,this),i.on(h.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(h.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.on(h.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.on(h.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(h.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.on(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=r.prototype;return t.destroy=function(){var e=this.hls;e.off(h.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(h.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(h.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(h.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(h.Events.FRAG_LOADING,this.onFragLoading,this),e.off(h.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(h.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(h.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(h.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(h.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(h.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,s,l,a,g){for(var A=!1,D=g.length;D--;){var y=g[D],E=c(y[0],y[1],s,l);if(E>=0&&(y[0]=Math.min(y[0],s),y[1]=Math.max(y[1],l),A=!0,E/(l-s)>.5))return}if(A||g.push([s,l]),this.config.renderTextTracksNatively){var _=this.captionsTracks[e];this.Cues.newCue(_,s,l,a)}else{var L=this.Cues.newCue(null,s,l,a);this.hls.trigger(h.Events.CUES_PARSED,{type:"captions",cues:L,track:e})}},t.onInitPtsFound=function(e,s){var l=this,a=s.frag,g=s.id,A=s.initPTS,D=s.timescale,y=this.unparsedVttFrags;g==="main"&&(this.initPTS[a.cc]=A,this.timescale[a.cc]=D),y.length&&(this.unparsedVttFrags=[],y.forEach(function(E){l.onFragLoaded(h.Events.FRAG_LOADED,E)}))},t.getExistingTrack=function(e){var s=this.media;if(s)for(var l=0;l<s.textTracks.length;l++){var a=s.textTracks[l];if(a[e])return a}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var s=this.captionsProperties,l=this.captionsTracks,a=this.media,g=s[e],A=g.label,D=g.languageCode,y=this.getExistingTrack(e);if(y)l[e]=y,Object(p.clearCurrentCues)(l[e]),Object(p.sendAddTrackEvent)(l[e],a);else{var E=this.createTextTrack("captions",A,D);E&&(E[e]=!0,l[e]=E)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var s=this.captionsProperties[e];if(!!s){var l=s.label,a={_id:e,label:l,kind:"captions",default:s.media?!!s.media.default:!1,closedCaptions:s.media};this.nonNativeCaptionsTracks[e]=a,this.hls.trigger(h.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[a]})}}},t.createTextTrack=function(e,s,l){var a=this.media;if(!!a)return a.addTextTrack(e,s,l)},t.onMediaAttaching=function(e,s){this.media=s.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(s){Object(p.clearCurrentCues)(e[s]),delete e[s]}),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=u(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(!!e){var s=e.textTracks;if(s)for(var l=0;l<s.length;l++)Object(p.clearCurrentCues)(s[l])}},t.onSubtitleTracksUpdated=function(e,s){var l=this;this.textTracks=[];var a=s.subtitleTracks||[],g=a.some(function(E){return E.textCodec===f.IMSC1_CODEC});if(this.config.enableWebVTT||g&&this.config.enableIMSC1){var A=this.tracks&&a&&this.tracks.length===a.length;if(this.tracks=a||[],this.config.renderTextTracksNatively){var D=this.media?this.media.textTracks:[];this.tracks.forEach(function(E,_){var L;if(_<D.length){for(var I=null,b=0;b<D.length;b++)if(v(D[b],E)){I=D[b];break}I&&(L=I)}L?Object(p.clearCurrentCues)(L):(L=l.createTextTrack("subtitles",E.name,E.lang),L&&(L.mode="disabled")),L&&(L.groupId=E.groupId,l.textTracks.push(L))})}else if(!A&&this.tracks&&this.tracks.length){var y=this.tracks.map(function(E){return{label:E.name,kind:E.type.toLowerCase(),default:E.default,subtitleTrack:E}});this.hls.trigger(h.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:y})}}},t.onManifestLoaded=function(e,s){var l=this;this.config.enableCEA708Captions&&s.captions&&s.captions.forEach(function(a){var g=/(?:CC|SERVICE)([1-4])/.exec(a.instreamId);if(!!g){var A="textTrack"+g[1],D=l.captionsProperties[A];!D||(D.label=a.name,a.lang&&(D.languageCode=a.lang),D.media=a)}})},t.onFragLoading=function(e,s){var l=this.cea608Parser1,a=this.cea608Parser2,g=this.lastSn,A=this.lastPartIndex;if(!(!this.enabled||!(l&&a))&&s.frag.type===n.PlaylistLevelType.MAIN){var D,y,E=s.frag.sn,_=(D=s==null||(y=s.part)===null||y===void 0?void 0:y.index)!=null?D:-1;E===g+1||E===g&&_===A+1||(l.reset(),a.reset()),this.lastSn=E,this.lastPartIndex=_}},t.onFragLoaded=function(e,s){var l=s.frag,a=s.payload,g=this.initPTS,A=this.unparsedVttFrags;if(l.type===n.PlaylistLevelType.SUBTITLE)if(a.byteLength){if(!Object(S.isFiniteNumber)(g[l.cc])){A.push(s),g.length&&this.hls.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Missing initial subtitle PTS")});return}var D=l.decryptdata,y="stats"in s;if(D==null||D.key==null||D.method!=="AES-128"||y){var E=this.tracks[l.level],_=this.vttCCs;_[l.cc]||(_[l.cc]={start:l.start,prevCC:this.prevCC,new:!0},this.prevCC=l.cc),E&&E.textCodec===f.IMSC1_CODEC?this._parseIMSC1(l,a):this._parseVTTs(l,a,_)}}else this.hls.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,s){var l=this,a=this.hls;Object(f.parseIMSC1)(s,this.initPTS[e.cc],this.timescale[e.cc],function(g){l._appendCues(g,e.level),a.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(g){d.logger.log("Failed to parse IMSC1: "+g),a.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:g})})},t._parseVTTs=function(e,s,l){var a=this,g=this.hls;Object(T.parseWebVTT)(s,this.initPTS[e.cc],this.timescale[e.cc],l,e.cc,e.start,function(A){a._appendCues(A,e.level),g.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(A){a._fallbackToIMSC1(e,s),d.logger.log("Failed to parse VTT cue: "+A),g.trigger(h.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:A})})},t._fallbackToIMSC1=function(e,s){var l=this,a=this.tracks[e.level];a.textCodec||Object(f.parseIMSC1)(s,this.initPTS[e.cc],this.timescale[e.cc],function(){a.textCodec=f.IMSC1_CODEC,l._parseIMSC1(e,s)},function(){a.textCodec="wvtt"})},t._appendCues=function(e,s){var l=this.hls;if(this.config.renderTextTracksNatively){var a=this.textTracks[s];if(a.mode==="disabled")return;e.forEach(function(D){return Object(p.addCueToTrack)(a,D)})}else{var g=this.tracks[s],A=g.default?"default":"subtitles"+s;l.trigger(h.Events.CUES_PARSED,{type:"subtitles",cues:e,track:A})}},t.onFragDecrypted=function(e,s){var l=s.frag;if(l.type===n.PlaylistLevelType.SUBTITLE){if(!Object(S.isFiniteNumber)(this.initPTS[l.cc])){this.unparsedVttFrags.push(s);return}this.onFragLoaded(h.Events.FRAG_LOADED,s)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,s){var l=this.cea608Parser1,a=this.cea608Parser2;if(!(!this.enabled||!(l&&a)))for(var g=0;g<s.samples.length;g++){var A=s.samples[g].bytes;if(A){var D=this.extractCea608Data(A);l.addData(s.samples[g].pts,D[0]),a.addData(s.samples[g].pts,D[1])}}},t.onBufferFlushing=function(e,s){var l=s.startOffset,a=s.endOffset,g=s.endOffsetSubtitles,A=s.type,D=this.media;if(!(!D||D.currentTime<a)){if(!A||A==="video"){var y=this.captionsTracks;Object.keys(y).forEach(function(_){return Object(p.removeCuesInRange)(y[_],l,a)})}if(this.config.renderTextTracksNatively&&l===0&&g!==void 0){var E=this.textTracks;Object.keys(E).forEach(function(_){return Object(p.removeCuesInRange)(E[_],l,g)})}}},t.extractCea608Data=function(e){for(var s=e[0]&31,l=2,a=[[],[]],g=0;g<s;g++){var A=e[l++],D=127&e[l++],y=127&e[l++],E=(4&A)!==0,_=3&A;D===0&&y===0||E&&(_===0||_===1)&&(a[_].push(D),a[_].push(y))}return a},r}();function v(r,t){return r&&r.label===t.name&&!(r.textTrack1||r.textTrack2)}function c(r,t,i,e){return Math.min(t,e)-Math.max(r,i)}function u(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function h(M,T){this.subtle=void 0,this.aesIV=void 0,this.subtle=M,this.aesIV=T}var m=h.prototype;return m.decrypt=function(T,p){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},p,T)},h}()},"./src/crypt/aes-decryptor.ts":function(O,C,x){x.r(C),x.d(C,"removePadding",function(){return h}),x.d(C,"default",function(){return m});var S=x("./src/utils/typed-array.ts");function h(M){var T=M.byteLength,p=T&&new DataView(M.buffer).getUint8(T-1);return p?Object(S.sliceUint8)(M,0,T-p):M}var m=function(){function M(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var T=M.prototype;return T.uint8ArrayToUint32Array_=function(f){for(var n=new DataView(f),d=new Uint32Array(4),o=0;o<4;o++)d[o]=n.getUint32(o*4);return d},T.initTable=function(){var f=this.sBox,n=this.invSBox,d=this.subMix,o=d[0],v=d[1],c=d[2],u=d[3],r=this.invSubMix,t=r[0],i=r[1],e=r[2],s=r[3],l=new Uint32Array(256),a=0,g=0,A=0;for(A=0;A<256;A++)A<128?l[A]=A<<1:l[A]=A<<1^283;for(A=0;A<256;A++){var D=g^g<<1^g<<2^g<<3^g<<4;D=D>>>8^D&255^99,f[a]=D,n[D]=a;var y=l[a],E=l[y],_=l[E],L=l[D]*257^D*16843008;o[a]=L<<24|L>>>8,v[a]=L<<16|L>>>16,c[a]=L<<8|L>>>24,u[a]=L,L=_*16843009^E*65537^y*257^a*16843008,t[D]=L<<24|L>>>8,i[D]=L<<16|L>>>16,e[D]=L<<8|L>>>24,s[D]=L,a?(a=y^l[l[l[_^y]]],g^=l[l[g]]):a=g=1}},T.expandKey=function(f){for(var n=this.uint8ArrayToUint32Array_(f),d=!0,o=0;o<n.length&&d;)d=n[o]===this.key[o],o++;if(!d){this.key=n;var v=this.keySize=n.length;if(v!==4&&v!==6&&v!==8)throw new Error("Invalid aes key size="+v);var c=this.ksRows=(v+6+1)*4,u,r,t=this.keySchedule=new Uint32Array(c),i=this.invKeySchedule=new Uint32Array(c),e=this.sBox,s=this.rcon,l=this.invSubMix,a=l[0],g=l[1],A=l[2],D=l[3],y,E;for(u=0;u<c;u++){if(u<v){y=t[u]=n[u];continue}E=y,u%v===0?(E=E<<8|E>>>24,E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255],E^=s[u/v|0]<<24):v>6&&u%v===4&&(E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255]),t[u]=y=(t[u-v]^E)>>>0}for(r=0;r<c;r++)u=c-r,r&3?E=t[u]:E=t[u-4],r<4||u<=4?i[r]=E:i[r]=a[e[E>>>24]]^g[e[E>>>16&255]]^A[e[E>>>8&255]]^D[e[E&255]],i[r]=i[r]>>>0}},T.networkToHostOrderSwap=function(f){return f<<24|(f&65280)<<8|(f&16711680)>>8|f>>>24},T.decrypt=function(f,n,d){for(var o=this.keySize+6,v=this.invKeySchedule,c=this.invSBox,u=this.invSubMix,r=u[0],t=u[1],i=u[2],e=u[3],s=this.uint8ArrayToUint32Array_(d),l=s[0],a=s[1],g=s[2],A=s[3],D=new Int32Array(f),y=new Int32Array(D.length),E,_,L,I,b,R,P,w,F,k,B,U,j,K,N=this.networkToHostOrderSwap;n<D.length;){for(F=N(D[n]),k=N(D[n+1]),B=N(D[n+2]),U=N(D[n+3]),b=F^v[0],R=U^v[1],P=B^v[2],w=k^v[3],j=4,K=1;K<o;K++)E=r[b>>>24]^t[R>>16&255]^i[P>>8&255]^e[w&255]^v[j],_=r[R>>>24]^t[P>>16&255]^i[w>>8&255]^e[b&255]^v[j+1],L=r[P>>>24]^t[w>>16&255]^i[b>>8&255]^e[R&255]^v[j+2],I=r[w>>>24]^t[b>>16&255]^i[R>>8&255]^e[P&255]^v[j+3],b=E,R=_,P=L,w=I,j=j+4;E=c[b>>>24]<<24^c[R>>16&255]<<16^c[P>>8&255]<<8^c[w&255]^v[j],_=c[R>>>24]<<24^c[P>>16&255]<<16^c[w>>8&255]<<8^c[b&255]^v[j+1],L=c[P>>>24]<<24^c[w>>16&255]<<16^c[b>>8&255]<<8^c[R&255]^v[j+2],I=c[w>>>24]<<24^c[b>>16&255]<<16^c[R>>8&255]<<8^c[P&255]^v[j+3],y[n]=N(E^l),y[n+1]=N(I^a),y[n+2]=N(L^g),y[n+3]=N(_^A),l=F,a=k,g=B,A=U,n=n+4}return y.buffer},M}()},"./src/crypt/decrypter.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return n});var S=x("./src/crypt/aes-crypto.ts"),h=x("./src/crypt/fast-aes-key.ts"),m=x("./src/crypt/aes-decryptor.ts"),M=x("./src/utils/logger.ts"),T=x("./src/utils/mp4-tools.ts"),p=x("./src/utils/typed-array.ts"),f=16,n=function(){function d(v,c,u){var r=u===void 0?{}:u,t=r.removePKCS7Padding,i=t===void 0?!0:t;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=v,this.config=c,this.removePKCS7Padding=i,i)try{var e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var o=d.prototype;return o.destroy=function(){this.observer=null},o.isSync=function(){return this.config.enableSoftwareAES},o.flush=function(){var c=this.currentResult;if(!c){this.reset();return}var u=new Uint8Array(c);return this.reset(),this.removePKCS7Padding?Object(m.removePadding)(u):u},o.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},o.decrypt=function(c,u,r,t){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(c),u,r);var i=this.flush();i&&t(i.buffer)}else this.webCryptoDecrypt(new Uint8Array(c),u,r).then(t)},o.softwareDecrypt=function(c,u,r){var t=this.currentIV,i=this.currentResult,e=this.remainderData;this.logOnce("JS AES decrypt"),e&&(c=Object(T.appendUint8Array)(e,c),this.remainderData=null);var s=this.getValidChunk(c);if(!s.length)return null;t&&(r=t);var l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new m.default),l.expandKey(u);var a=i;return this.currentResult=l.decrypt(s.buffer,0,r),this.currentIV=Object(p.sliceUint8)(s,-16).buffer,a||null},o.webCryptoDecrypt=function(c,u,r){var t=this,i=this.subtle;return(this.key!==u||!this.fastAesKey)&&(this.key=u,this.fastAesKey=new h.default(i,u)),this.fastAesKey.expandKey().then(function(e){if(!i)return Promise.reject(new Error("web crypto not initialized"));var s=new S.default(i,r);return s.decrypt(c.buffer,e)}).catch(function(e){return t.onWebCryptoError(e,c,u,r)})},o.onWebCryptoError=function(c,u,r,t){return M.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",c),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(u,r,t)},o.getValidChunk=function(c){var u=c,r=c.length-c.length%f;return r!==c.length&&(u=Object(p.sliceUint8)(c,0,r),this.remainderData=Object(p.sliceUint8)(c,r)),u},o.logOnce=function(c){!this.logEnabled||(M.logger.log("[decrypter.ts]: "+c),this.logEnabled=!1)},d}()},"./src/crypt/fast-aes-key.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function h(M,T){this.subtle=void 0,this.key=void 0,this.subtle=M,this.key=T}var m=h.prototype;return m.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},h}()},"./src/demux/aacdemuxer.ts":function(O,C,x){x.r(C);var S=x("./src/demux/base-audio-demuxer.ts"),h=x("./src/demux/adts.ts"),m=x("./src/utils/logger.ts"),M=x("./src/demux/id3.ts");function T(n,d){n.prototype=Object.create(d.prototype),n.prototype.constructor=n,p(n,d)}function p(n,d){return p=Object.setPrototypeOf||function(v,c){return v.__proto__=c,v},p(n,d)}var f=function(n){T(d,n);function d(v,c){var u;return u=n.call(this)||this,u.observer=void 0,u.config=void 0,u.observer=v,u.config=c,u}var o=d.prototype;return o.resetInitSegment=function(c,u,r){n.prototype.resetInitSegment.call(this,c,u,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:c,duration:r,inputTimeScale:9e4,dropped:0}},d.probe=function(c){if(!c)return!1;for(var u=M.getID3Data(c,0)||[],r=u.length,t=c.length;r<t;r++)if(h.probe(c,r))return m.logger.log("ADTS sync word found !"),!0;return!1},o.canParse=function(c,u){return h.canParse(c,u)},o.appendFrame=function(c,u,r){h.initTrackConfig(c,this.observer,u,r,c.manifestCodec);var t=h.appendFrame(c,u,r,this.initPTS,this.frameIndex);if(t&&t.missing===0)return t},d}(S.default);f.minProbeByteLength=9,C.default=f},"./src/demux/adts.ts":function(O,C,x){x.r(C),x.d(C,"getAudioConfig",function(){return M}),x.d(C,"isHeaderPattern",function(){return T}),x.d(C,"getHeaderLength",function(){return p}),x.d(C,"getFullFrameLength",function(){return f}),x.d(C,"canGetFrameLength",function(){return n}),x.d(C,"isHeader",function(){return d}),x.d(C,"canParse",function(){return o}),x.d(C,"probe",function(){return v}),x.d(C,"initTrackConfig",function(){return c}),x.d(C,"getFrameDuration",function(){return u}),x.d(C,"parseFrameHeader",function(){return r}),x.d(C,"appendFrame",function(){return t});var S=x("./src/utils/logger.ts"),h=x("./src/errors.ts"),m=x("./src/events.ts");function M(i,e,s,l){var a,g,A,D,y=navigator.userAgent.toLowerCase(),E=l,_=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((e[s+2]&192)>>>6)+1;var L=(e[s+2]&60)>>>2;if(L>_.length-1){i.trigger(m.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+L});return}return A=(e[s+2]&1)<<2,A|=(e[s+3]&192)>>>6,S.logger.log("manifest codec:"+l+", ADTS type:"+a+", samplingIndex:"+L),/firefox/i.test(y)?L>=6?(a=5,D=new Array(4),g=L-3):(a=2,D=new Array(2),g=L):y.indexOf("android")!==-1?(a=2,D=new Array(2),g=L):(a=5,D=new Array(4),l&&(l.indexOf("mp4a.40.29")!==-1||l.indexOf("mp4a.40.5")!==-1)||!l&&L>=6?g=L-3:((l&&l.indexOf("mp4a.40.2")!==-1&&(L>=6&&A===1||/vivaldi/i.test(y))||!l&&A===1)&&(a=2,D=new Array(2)),g=L)),D[0]=a<<3,D[0]|=(L&14)>>1,D[1]|=(L&1)<<7,D[1]|=A<<3,a===5&&(D[1]|=(g&14)>>1,D[2]=(g&1)<<7,D[2]|=2<<2,D[3]=0),{config:D,samplerate:_[L],channelCount:A,codec:"mp4a.40."+a,manifestCodec:E}}function T(i,e){return i[e]===255&&(i[e+1]&246)===240}function p(i,e){return i[e+1]&1?7:9}function f(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function n(i,e){return e+5<i.length}function d(i,e){return e+1<i.length&&T(i,e)}function o(i,e){return n(i,e)&&T(i,e)&&f(i,e)<=i.length-e}function v(i,e){if(d(i,e)){var s=p(i,e);if(e+s>=i.length)return!1;var l=f(i,e);if(l<=s)return!1;var a=e+l;return a===i.length||d(i,a)}return!1}function c(i,e,s,l,a){if(!i.samplerate){var g=M(e,s,l,a);if(!g)return;i.config=g.config,i.samplerate=g.samplerate,i.channelCount=g.channelCount,i.codec=g.codec,i.manifestCodec=g.manifestCodec,S.logger.log("parsed codec:"+i.codec+", rate:"+g.samplerate+", channels:"+g.channelCount)}}function u(i){return 1024*9e4/i}function r(i,e,s,l,a){var g=p(i,e),A=f(i,e);if(A-=g,A>0){var D=s+l*a;return{headerLength:g,frameLength:A,stamp:D}}}function t(i,e,s,l,a){var g=u(i.samplerate),A=r(e,s,l,a,g);if(A){var D=A.frameLength,y=A.headerLength,E=A.stamp,_=y+D,L=Math.max(0,s+_-e.length),I;L?(I=new Uint8Array(_-y),I.set(e.subarray(s+y,e.length),0)):I=e.subarray(s+y,s+_);var b={unit:I,pts:E};return L||i.samples.push(b),{sample:b,length:_,missing:L}}}},"./src/demux/base-audio-demuxer.ts":function(O,C,x){x.r(C),x.d(C,"initPTSFn",function(){return f});var S=x("./src/polyfills/number.ts"),h=x("./src/demux/id3.ts"),m=x("./src/demux/dummy-demuxed-track.ts"),M=x("./src/utils/mp4-tools.ts"),T=x("./src/utils/typed-array.ts"),p=function(){function n(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var d=n.prototype;return d.resetInitSegment=function(v,c,u){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},d.resetTimeStamp=function(){},d.resetContiguity=function(){},d.canParse=function(v,c){return!1},d.appendFrame=function(v,c,u){},d.demux=function(v,c){this.cachedData&&(v=Object(M.appendUint8Array)(this.cachedData,v),this.cachedData=null);var u=h.getID3Data(v,0),r=u?u.length:0,t,i,e=this._audioTrack,s=this._id3Track,l=u?h.getTimeStamp(u):void 0,a=v.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=f(l,c)),u&&u.length>0&&s.samples.push({pts:this.initPTS,dts:this.initPTS,data:u}),i=this.initPTS;r<a;){if(this.canParse(v,r)){var g=this.appendFrame(e,v,r);g?(this.frameIndex++,i=g.sample.pts,r+=g.length,t=r):r=a}else h.canParse(v,r)?(u=h.getID3Data(v,r),s.samples.push({pts:i,dts:i,data:u}),r+=u.length,t=r):r++;if(r===a&&t!==a){var A=Object(T.sliceUint8)(v,t);this.cachedData?this.cachedData=Object(M.appendUint8Array)(this.cachedData,A):this.cachedData=A}}return{audioTrack:e,avcTrack:Object(m.dummyTrack)(),id3Track:s,textTrack:Object(m.dummyTrack)()}},d.demuxSampleAes=function(v,c,u){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},d.flush=function(v){var c=this.cachedData;return c&&(this.cachedData=null,this.demux(c,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(m.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(m.dummyTrack)()}},d.destroy=function(){},n}(),f=function(d,o){return Object(S.isFiniteNumber)(d)?d*90:o*9e4};C.default=p},"./src/demux/chunk-cache.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function m(){this.chunks=[],this.dataLength=0}var M=m.prototype;return M.push=function(p){this.chunks.push(p),this.dataLength+=p.length},M.flush=function(){var p=this.chunks,f=this.dataLength,n;if(p.length)p.length===1?n=p[0]:n=h(p,f);else return new Uint8Array(0);return this.reset(),n},M.reset=function(){this.chunks.length=0,this.dataLength=0},m}();function h(m,M){for(var T=new Uint8Array(M),p=0,f=0;f<m.length;f++){var n=m[f];T.set(n,p),p+=n.length}return T}},"./src/demux/dummy-demuxed-track.ts":function(O,C,x){x.r(C),x.d(C,"dummyTrack",function(){return S});function S(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(O,C,x){x.r(C);var S=x("./src/utils/logger.ts"),h=function(){function m(T){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=T,this.bytesAvailable=T.byteLength,this.word=0,this.bitsAvailable=0}var M=m.prototype;return M.loadWord=function(){var p=this.data,f=this.bytesAvailable,n=p.byteLength-f,d=new Uint8Array(4),o=Math.min(4,f);if(o===0)throw new Error("no bytes available");d.set(p.subarray(n,n+o)),this.word=new DataView(d.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o},M.skipBits=function(p){var f;this.bitsAvailable>p?(this.word<<=p,this.bitsAvailable-=p):(p-=this.bitsAvailable,f=p>>3,p-=f>>3,this.bytesAvailable-=f,this.loadWord(),this.word<<=p,this.bitsAvailable-=p)},M.readBits=function(p){var f=Math.min(this.bitsAvailable,p),n=this.word>>>32-f;return p>32&&S.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=f,this.bitsAvailable>0?this.word<<=f:this.bytesAvailable>0&&this.loadWord(),f=p-f,f>0&&this.bitsAvailable?n<<f|this.readBits(f):n},M.skipLZ=function(){var p;for(p=0;p<this.bitsAvailable;++p)if((this.word&2147483648>>>p)!==0)return this.word<<=p,this.bitsAvailable-=p,p;return this.loadWord(),p+this.skipLZ()},M.skipUEG=function(){this.skipBits(1+this.skipLZ())},M.skipEG=function(){this.skipBits(1+this.skipLZ())},M.readUEG=function(){var p=this.skipLZ();return this.readBits(p+1)-1},M.readEG=function(){var p=this.readUEG();return 1&p?1+p>>>1:-1*(p>>>1)},M.readBoolean=function(){return this.readBits(1)===1},M.readUByte=function(){return this.readBits(8)},M.readUShort=function(){return this.readBits(16)},M.readUInt=function(){return this.readBits(32)},M.skipScalingList=function(p){for(var f=8,n=8,d,o=0;o<p;o++)n!==0&&(d=this.readEG(),n=(f+d+256)%256),f=n===0?f:n},M.readSPS=function(){var p=0,f=0,n=0,d=0,o,v,c,u=this.readUByte.bind(this),r=this.readBits.bind(this),t=this.readUEG.bind(this),i=this.readBoolean.bind(this),e=this.skipBits.bind(this),s=this.skipEG.bind(this),l=this.skipUEG.bind(this),a=this.skipScalingList.bind(this);u();var g=u();if(r(5),e(3),u(),l(),g===100||g===110||g===122||g===244||g===44||g===83||g===86||g===118||g===128){var A=t();if(A===3&&e(1),l(),l(),e(1),i())for(v=A!==3?8:12,c=0;c<v;c++)i()&&(c<6?a(16):a(64))}l();var D=t();if(D===0)t();else if(D===1)for(e(1),s(),s(),o=t(),c=0;c<o;c++)s();l(),e(1);var y=t(),E=t(),_=r(1);_===0&&e(1),e(1),i()&&(p=t(),f=t(),n=t(),d=t());var L=[1,1];if(i()&&i()){var I=u();switch(I){case 1:L=[1,1];break;case 2:L=[12,11];break;case 3:L=[10,11];break;case 4:L=[16,11];break;case 5:L=[40,33];break;case 6:L=[24,11];break;case 7:L=[20,11];break;case 8:L=[32,11];break;case 9:L=[80,33];break;case 10:L=[18,11];break;case 11:L=[15,11];break;case 12:L=[64,33];break;case 13:L=[160,99];break;case 14:L=[4,3];break;case 15:L=[3,2];break;case 16:L=[2,1];break;case 255:{L=[u()<<8|u(),u()<<8|u()];break}}}return{width:Math.ceil((y+1)*16-p*2-f*2),height:(2-_)*(E+1)*16-(_?2:4)*(n+d),pixelRatio:L}},M.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},m}();C.default=h},"./src/demux/id3.ts":function(O,C,x){x.r(C),x.d(C,"isHeader",function(){return S}),x.d(C,"isFooter",function(){return h}),x.d(C,"getID3Data",function(){return m}),x.d(C,"canParse",function(){return T}),x.d(C,"getTimeStamp",function(){return p}),x.d(C,"isTimeStampFrame",function(){return f}),x.d(C,"getID3Frames",function(){return d}),x.d(C,"decodeFrame",function(){return o}),x.d(C,"utf8ArrayToStr",function(){return t}),x.d(C,"testables",function(){return i});var S=function(a,g){return g+10<=a.length&&a[g]===73&&a[g+1]===68&&a[g+2]===51&&a[g+3]<255&&a[g+4]<255&&a[g+6]<128&&a[g+7]<128&&a[g+8]<128&&a[g+9]<128},h=function(a,g){return g+10<=a.length&&a[g]===51&&a[g+1]===68&&a[g+2]===73&&a[g+3]<255&&a[g+4]<255&&a[g+6]<128&&a[g+7]<128&&a[g+8]<128&&a[g+9]<128},m=function(a,g){for(var A=g,D=0;S(a,g);){D+=10;var y=M(a,g+6);D+=y,h(a,g+10)&&(D+=10),g+=D}if(D>0)return a.subarray(A,A+D)},M=function(a,g){var A=0;return A=(a[g]&127)<<21,A|=(a[g+1]&127)<<14,A|=(a[g+2]&127)<<7,A|=a[g+3]&127,A},T=function(a,g){return S(a,g)&&M(a,g+6)+10<=a.length-g},p=function(a){for(var g=d(a),A=0;A<g.length;A++){var D=g[A];if(f(D))return r(D)}},f=function(a){return a&&a.key==="PRIV"&&a.info==="com.apple.streaming.transportStreamTimestamp"},n=function(a){var g=String.fromCharCode(a[0],a[1],a[2],a[3]),A=M(a,4),D=10;return{type:g,size:A,data:a.subarray(D,D+A)}},d=function(a){for(var g=0,A=[];S(a,g);){var D=M(a,g+6);g+=10;for(var y=g+D;g+8<y;){var E=n(a.subarray(g)),_=o(E);_&&A.push(_),g+=E.size+10}h(a,g)&&(g+=10)}return A},o=function(a){return a.type==="PRIV"?v(a):a.type[0]==="W"?u(a):c(a)},v=function(a){if(!(a.size<2)){var g=t(a.data,!0),A=new Uint8Array(a.data.subarray(g.length+1));return{key:a.type,info:g,data:A.buffer}}},c=function(a){if(!(a.size<2)){if(a.type==="TXXX"){var g=1,A=t(a.data.subarray(g),!0);g+=A.length+1;var D=t(a.data.subarray(g));return{key:a.type,info:A,data:D}}var y=t(a.data.subarray(1));return{key:a.type,data:y}}},u=function(a){if(a.type==="WXXX"){if(a.size<2)return;var g=1,A=t(a.data.subarray(g),!0);g+=A.length+1;var D=t(a.data.subarray(g));return{key:a.type,info:A,data:D}}var y=t(a.data);return{key:a.type,data:y}},r=function(a){if(a.data.byteLength===8){var g=new Uint8Array(a.data),A=g[3]&1,D=(g[4]<<23)+(g[5]<<15)+(g[6]<<7)+g[7];return D/=45,A&&(D+=4772185884e-2),Math.round(D)}},t=function(a,g){g===void 0&&(g=!1);var A=s();if(A){var D=A.decode(a);if(g){var y=D.indexOf("\0");return y!==-1?D.substring(0,y):D}return D.replace(/\0/g,"")}for(var E=a.length,_,L,I,b="",R=0;R<E;){if(_=a[R++],_===0&&g)return b;if(_===0||_===3)continue;switch(_>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(_);break;case 12:case 13:L=a[R++],b+=String.fromCharCode((_&31)<<6|L&63);break;case 14:L=a[R++],I=a[R++],b+=String.fromCharCode((_&15)<<12|(L&63)<<6|(I&63)<<0);break}}return b},i={decodeTextFrame:c},e;function s(){return!e&&typeof self.TextDecoder!="undefined"&&(e=new self.TextDecoder("utf-8")),e}},"./src/demux/mp3demuxer.ts":function(O,C,x){x.r(C);var S=x("./src/demux/base-audio-demuxer.ts"),h=x("./src/demux/id3.ts"),m=x("./src/utils/logger.ts"),M=x("./src/demux/mpegaudio.ts");function T(n,d){n.prototype=Object.create(d.prototype),n.prototype.constructor=n,p(n,d)}function p(n,d){return p=Object.setPrototypeOf||function(v,c){return v.__proto__=c,v},p(n,d)}var f=function(n){T(d,n);function d(){return n.apply(this,arguments)||this}var o=d.prototype;return o.resetInitSegment=function(c,u,r){n.prototype.resetInitSegment.call(this,c,u,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:c,duration:r,inputTimeScale:9e4,dropped:0}},d.probe=function(c){if(!c)return!1;for(var u=h.getID3Data(c,0)||[],r=u.length,t=c.length;r<t;r++)if(M.probe(c,r))return m.logger.log("MPEG Audio sync word found !"),!0;return!1},o.canParse=function(c,u){return M.canParse(c,u)},o.appendFrame=function(c,u,r){if(this.initPTS!==null)return M.appendFrame(c,u,r,this.initPTS,this.frameIndex)},d}(S.default);f.minProbeByteLength=4,C.default=f},"./src/demux/mp4demuxer.ts":function(O,C,x){x.r(C);var S=x("./src/utils/mp4-tools.ts"),h=x("./src/demux/dummy-demuxed-track.ts"),m=function(){function M(p,f){this.remainderData=null,this.config=void 0,this.config=f}var T=M.prototype;return T.resetTimeStamp=function(){},T.resetInitSegment=function(){},T.resetContiguity=function(){},M.probe=function(f){return Object(S.findBox)({data:f,start:0,end:Math.min(f.length,16384)},["moof"]).length>0},T.demux=function(f){var n=f,d=Object(h.dummyTrack)();if(this.config.progressive){this.remainderData&&(n=Object(S.appendUint8Array)(this.remainderData,f));var o=Object(S.segmentValidRange)(n);this.remainderData=o.remainder,d.samples=o.valid||new Uint8Array}else d.samples=n;return{audioTrack:Object(h.dummyTrack)(),avcTrack:d,id3Track:Object(h.dummyTrack)(),textTrack:Object(h.dummyTrack)()}},T.flush=function(){var f=Object(h.dummyTrack)();return f.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(h.dummyTrack)(),avcTrack:f,id3Track:Object(h.dummyTrack)(),textTrack:Object(h.dummyTrack)()}},T.demuxSampleAes=function(f,n,d){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},T.destroy=function(){},M}();m.minProbeByteLength=1024,C.default=m},"./src/demux/mpegaudio.ts":function(O,C,x){x.r(C),x.d(C,"appendFrame",function(){return p}),x.d(C,"parseHeader",function(){return f}),x.d(C,"isHeaderPattern",function(){return n}),x.d(C,"isHeader",function(){return d}),x.d(C,"canParse",function(){return o}),x.d(C,"probe",function(){return v});var S=null,h=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],m=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],T=[0,1,1,4];function p(c,u,r,t,i){if(!(r+24>u.length)){var e=f(u,r);if(e&&r+e.frameLength<=u.length){var s=e.samplesPerFrame*9e4/e.sampleRate,l=t+i*s,a={unit:u.subarray(r,r+e.frameLength),pts:l,dts:l};return c.config=[],c.channelCount=e.channelCount,c.samplerate=e.sampleRate,c.samples.push(a),{sample:a,length:e.frameLength,missing:0}}}}function f(c,u){var r=c[u+1]>>3&3,t=c[u+1]>>1&3,i=c[u+2]>>4&15,e=c[u+2]>>2&3;if(r!==1&&i!==0&&i!==15&&e!==3){var s=c[u+2]>>1&1,l=c[u+3]>>6,a=r===3?3-t:t===3?3:4,g=h[a*14+i-1]*1e3,A=r===3?0:r===2?1:2,D=m[A*3+e],y=l===3?1:2,E=M[r][t],_=T[t],L=E*8*_,I=Math.floor(E*g/D+s)*_;if(S===null){var b=navigator.userAgent||"",R=b.match(/Chrome\/(\d+)/i);S=R?parseInt(R[1]):0}var P=!!S&&S<=87;return P&&t===2&&g>=224e3&&l===0&&(c[u+3]=c[u+3]|128),{sampleRate:D,channelCount:y,frameLength:I,samplesPerFrame:L}}}function n(c,u){return c[u]===255&&(c[u+1]&224)===224&&(c[u+1]&6)!==0}function d(c,u){return u+1<c.length&&n(c,u)}function o(c,u){var r=4;return n(c,u)&&r<=c.length-u}function v(c,u){if(u+1<c.length&&n(c,u)){var r=4,t=f(c,u),i=r;t!=null&&t.frameLength&&(i=t.frameLength);var e=u+i;return e===c.length||d(c,e)}return!1}},"./src/demux/sample-aes.ts":function(O,C,x){x.r(C);var S=x("./src/crypt/decrypter.ts"),h=x("./src/demux/tsdemuxer.ts"),m=function(){function M(p,f,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new S.default(p,f,{removePKCS7Padding:!1})}var T=M.prototype;return T.decryptBuffer=function(f,n){this.decrypter.decrypt(f,this.keyData.key.buffer,this.keyData.iv.buffer,n)},T.decryptAacSample=function(f,n,d,o){var v=f[n].unit,c=v.subarray(16,v.length-v.length%16),u=c.buffer.slice(c.byteOffset,c.byteOffset+c.length),r=this;this.decryptBuffer(u,function(t){var i=new Uint8Array(t);v.set(i,16),o||r.decryptAacSamples(f,n+1,d)})},T.decryptAacSamples=function(f,n,d){for(;;n++){if(n>=f.length){d();return}if(!(f[n].unit.length<32)){var o=this.decrypter.isSync();if(this.decryptAacSample(f,n,d,o),!o)return}}},T.getAvcEncryptedData=function(f){for(var n=Math.floor((f.length-48)/160)*16+16,d=new Int8Array(n),o=0,v=32;v<f.length-16;v+=160,o+=16)d.set(f.subarray(v,v+16),o);return d},T.getAvcDecryptedUnit=function(f,n){for(var d=new Uint8Array(n),o=0,v=32;v<f.length-16;v+=160,o+=16)f.set(d.subarray(o,o+16),v);return f},T.decryptAvcSample=function(f,n,d,o,v,c){var u=Object(h.discardEPB)(v.data),r=this.getAvcEncryptedData(u),t=this;this.decryptBuffer(r.buffer,function(i){v.data=t.getAvcDecryptedUnit(u,i),c||t.decryptAvcSamples(f,n,d+1,o)})},T.decryptAvcSamples=function(f,n,d,o){if(f instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,d=0){if(n>=f.length){o();return}for(var v=f[n].units;!(d>=v.length);d++){var c=v[d];if(!(c.data.length<=48||c.type!==1&&c.type!==5)){var u=this.decrypter.isSync();if(this.decryptAvcSample(f,n,d,o,c,u),!u)return}}}},M}();C.default=m},"./src/demux/transmuxer-interface.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return d});var S=x("./node_modules/webworkify-webpack/index.js"),h=x("./src/events.ts"),m=x("./src/demux/transmuxer.ts"),M=x("./src/utils/logger.ts"),T=x("./src/errors.ts"),p=x("./src/utils/mediasource-helper.ts"),f=x("./node_modules/eventemitter3/index.js"),n=Object(p.getMediaSource)()||{isTypeSupported:function(){return!1}},d=function(){function o(c,u,r,t){var i=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=c,this.id=u,this.onTransmuxComplete=r,this.onFlush=t;var e=c.config,s=function(D,y){y=y||{},y.frag=i.frag,y.id=i.id,c.trigger(D,y)};this.observer=new f.EventEmitter,this.observer.on(h.Events.FRAG_DECRYPTED,s),this.observer.on(h.Events.ERROR,s);var l={mp4:n.isTypeSupported("video/mp4"),mpeg:n.isTypeSupported("audio/mpeg"),mp3:n.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(e.enableWorker&&typeof Worker!="undefined"){M.logger.log("demuxing in webworker");var g;try{g=this.worker=S("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),g.addEventListener("message",this.onwmsg),g.onerror=function(A){c.trigger(h.Events.ERROR,{type:T.ErrorTypes.OTHER_ERROR,details:T.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(A.message+"  ("+A.filename+":"+A.lineno+")")})},g.postMessage({cmd:"init",typeSupported:l,vendor:a,id:u,config:JSON.stringify(e)})}catch(A){M.logger.warn("Error in worker:",A),M.logger.error("Error while initializing DemuxerWorker, fallback to inline"),g&&self.URL.revokeObjectURL(g.objectURL),this.transmuxer=new m.default(this.observer,l,e,a,u),this.worker=null}}else this.transmuxer=new m.default(this.observer,l,e,a,u)}var v=o.prototype;return v.destroy=function(){var u=this.worker;if(u)u.removeEventListener("message",this.onwmsg),u.terminate(),this.worker=null;else{var r=this.transmuxer;r&&(r.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.observer=null},v.push=function(u,r,t,i,e,s,l,a,g,A){var D,y,E=this;g.transmuxing.start=self.performance.now();var _=this.transmuxer,L=this.worker,I=s?s.start:e.start,b=e.decryptdata,R=this.frag,P=!(R&&e.cc===R.cc),w=!(R&&g.level===R.level),F=R?g.sn-R.sn:-1,k=this.part?g.part-this.part.index:1,B=!w&&(F===1||F===0&&k===1),U=self.performance.now();(w||F||e.stats.parsing.start===0)&&(e.stats.parsing.start=U),s&&(k||!B)&&(s.stats.parsing.start=U);var j=!(R&&((D=e.initSegment)===null||D===void 0?void 0:D.url)===((y=R.initSegment)===null||y===void 0?void 0:y.url)),K=new m.TransmuxState(P,B,a,w,I,j);if(!B||P||j){M.logger.log("[transmuxer-interface, "+e.type+"]: Starting new transmux session for sn: "+g.sn+" p: "+g.part+" level: "+g.level+" id: "+g.id+`
        discontinuity: `+P+`
        trackSwitch: `+w+`
        contiguous: `+B+`
        accurateTimeOffset: `+a+`
        timeOffset: `+I+`
        initSegmentChange: `+j);var N=new m.TransmuxConfig(t,i,r,l,A);this.configureTransmuxer(N)}if(this.frag=e,this.part=s,L)L.postMessage({cmd:"demux",data:u,decryptdata:b,chunkMeta:g,state:K},u instanceof ArrayBuffer?[u]:[]);else if(_){var Z=_.push(u,b,g,K);Object(m.isPromise)(Z)?Z.then(function(X){E.handleTransmuxComplete(X)}):this.handleTransmuxComplete(Z)}},v.flush=function(u){var r=this;u.transmuxing.start=self.performance.now();var t=this.transmuxer,i=this.worker;if(i)i.postMessage({cmd:"flush",chunkMeta:u});else if(t){var e=t.flush(u);Object(m.isPromise)(e)?e.then(function(s){r.handleFlushResult(s,u)}):this.handleFlushResult(e,u)}},v.handleFlushResult=function(u,r){var t=this;u.forEach(function(i){t.handleTransmuxComplete(i)}),this.onFlush(r)},v.onWorkerMessage=function(u){var r=u.data,t=this.hls;switch(r.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(r.data);break}case"flush":{this.onFlush(r.data);break}default:{r.data=r.data||{},r.data.frag=this.frag,r.data.id=this.id,t.trigger(r.event,r.data);break}}},v.configureTransmuxer=function(u){var r=this.worker,t=this.transmuxer;r?r.postMessage({cmd:"configure",config:u}):t&&t.configure(u)},v.handleTransmuxComplete=function(u){u.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(u)},o}()},"./src/demux/transmuxer-worker.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return T});var S=x("./src/demux/transmuxer.ts"),h=x("./src/events.ts"),m=x("./src/utils/logger.ts"),M=x("./node_modules/eventemitter3/index.js");function T(o){var v=new M.EventEmitter,c=function(r,t){o.postMessage({event:r,data:t})};v.on(h.Events.FRAG_DECRYPTED,c),v.on(h.Events.ERROR,c),o.addEventListener("message",function(u){var r=u.data;switch(r.cmd){case"init":{var t=JSON.parse(r.config);o.transmuxer=new S.default(v,r.typeSupported,t,r.vendor,r.id),Object(m.enableLogs)(t.debug),c("init",null);break}case"configure":{o.transmuxer.configure(r.config);break}case"demux":{var i=o.transmuxer.push(r.data,r.decryptdata,r.chunkMeta,r.state);Object(S.isPromise)(i)?i.then(function(l){p(o,l)}):p(o,i);break}case"flush":{var e=r.chunkMeta,s=o.transmuxer.flush(e);Object(S.isPromise)(s)?s.then(function(l){n(o,l,e)}):n(o,s,e);break}}})}function p(o,v){if(!d(v.remuxResult)){var c=[],u=v.remuxResult,r=u.audio,t=u.video;r&&f(c,r),t&&f(c,t),o.postMessage({event:"transmuxComplete",data:v},c)}}function f(o,v){v.data1&&o.push(v.data1.buffer),v.data2&&o.push(v.data2.buffer)}function n(o,v,c){v.forEach(function(u){p(o,u)}),o.postMessage({event:"flush",data:c})}function d(o){return!o.audio&&!o.video&&!o.text&&!o.id3&&!o.initSegment}},"./src/demux/transmuxer.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return i}),x.d(C,"isPromise",function(){return l}),x.d(C,"TransmuxConfig",function(){return a}),x.d(C,"TransmuxState",function(){return g});var S=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/crypt/decrypter.ts"),M=x("./src/demux/aacdemuxer.ts"),T=x("./src/demux/mp4demuxer.ts"),p=x("./src/demux/tsdemuxer.ts"),f=x("./src/demux/mp3demuxer.ts"),n=x("./src/remux/mp4-remuxer.ts"),d=x("./src/remux/passthrough-remuxer.ts"),o=x("./src/demux/chunk-cache.ts"),v=x("./src/utils/mp4-tools.ts"),c=x("./src/utils/logger.ts"),u;try{u=self.performance.now.bind(self.performance)}catch{c.logger.debug("Unable to use Performance API on this environment"),u=self.Date.now}var r=[{demux:p.default,remux:n.default},{demux:T.default,remux:d.default},{demux:M.default,remux:n.default},{demux:f.default,remux:n.default}],t=1024;r.forEach(function(A){var D=A.demux;t=Math.max(t,D.minProbeByteLength)});var i=function(){function A(y,E,_,L,I){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new o.default,this.observer=y,this.typeSupported=E,this.config=_,this.vendor=L,this.id=I}var D=A.prototype;return D.configure=function(E){this.transmuxConfig=E,this.decrypter&&this.decrypter.reset()},D.push=function(E,_,L,I){var b=this,R=L.transmuxing;R.executeStart=u();var P=new Uint8Array(E),w=this.cache,F=this.config,k=this.currentTransmuxState,B=this.transmuxConfig;I&&(this.currentTransmuxState=I);var U=e(P,_);if(U&&U.method==="AES-128"){var j=this.getDecrypter();if(F.enableSoftwareAES){var K=j.softwareDecrypt(P,U.key.buffer,U.iv.buffer);if(!K)return R.executeEnd=u(),s(L);P=new Uint8Array(K)}else return this.decryptionPromise=j.webCryptoDecrypt(P,U.key.buffer,U.iv.buffer).then(function(ae){var fe=b.push(ae,null,L);return b.decryptionPromise=null,fe}),this.decryptionPromise}var N=I||k,Z=N.contiguous,X=N.discontinuity,Y=N.trackSwitch,ee=N.accurateTimeOffset,Q=N.timeOffset,G=N.initSegmentChange,q=B.audioCodec,te=B.videoCodec,ie=B.defaultInitPts,ne=B.duration,le=B.initSegmentData;if((X||Y||G)&&this.resetInitSegment(le,q,te,ne),(X||G)&&this.resetInitialTimestamp(ie),Z||this.resetContiguity(),this.needsProbing(P,X,Y)){if(w.dataLength){var se=w.flush();P=Object(v.appendUint8Array)(se,P)}this.configureTransmuxer(P,B)}var oe=this.transmux(P,U,Q,ee,L),J=this.currentTransmuxState;return J.contiguous=!0,J.discontinuity=!1,J.trackSwitch=!1,R.executeEnd=u(),oe},D.flush=function(E){var _=this,L=E.transmuxing;L.executeStart=u();var I=this.decrypter,b=this.cache,R=this.currentTransmuxState,P=this.decryptionPromise;if(P)return P.then(function(){return _.flush(E)});var w=[],F=R.timeOffset;if(I){var k=I.flush();k&&w.push(this.push(k,null,E))}var B=b.dataLength;b.reset();var U=this.demuxer,j=this.remuxer;if(!U||!j)return B>=t&&this.observer.emit(S.Events.ERROR,S.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),L.executeEnd=u(),[s(E)];var K=U.flush(F);return l(K)?K.then(function(N){return _.flushRemux(w,N,E),w}):(this.flushRemux(w,K,E),w)},D.flushRemux=function(E,_,L){var I=_.audioTrack,b=_.avcTrack,R=_.id3Track,P=_.textTrack,w=this.currentTransmuxState,F=w.accurateTimeOffset,k=w.timeOffset;c.logger.log("[transmuxer.ts]: Flushed fragment "+L.sn+(L.part>-1?" p: "+L.part:"")+" of level "+L.level);var B=this.remuxer.remux(I,b,R,P,k,F,!0,this.id);E.push({remuxResult:B,chunkMeta:L}),L.transmuxing.executeEnd=u()},D.resetInitialTimestamp=function(E){var _=this.demuxer,L=this.remuxer;!_||!L||(_.resetTimeStamp(E),L.resetTimeStamp(E))},D.resetContiguity=function(){var E=this.demuxer,_=this.remuxer;!E||!_||(E.resetContiguity(),_.resetNextTimestamp())},D.resetInitSegment=function(E,_,L,I){var b=this.demuxer,R=this.remuxer;!b||!R||(b.resetInitSegment(_,L,I),R.resetInitSegment(E,_,L))},D.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},D.transmux=function(E,_,L,I,b){var R;return _&&_.method==="SAMPLE-AES"?R=this.transmuxSampleAes(E,_,L,I,b):R=this.transmuxUnencrypted(E,L,I,b),R},D.transmuxUnencrypted=function(E,_,L,I){var b=this.demuxer.demux(E,_,!1,!this.config.progressive),R=b.audioTrack,P=b.avcTrack,w=b.id3Track,F=b.textTrack,k=this.remuxer.remux(R,P,w,F,_,L,!1,this.id);return{remuxResult:k,chunkMeta:I}},D.transmuxSampleAes=function(E,_,L,I,b){var R=this;return this.demuxer.demuxSampleAes(E,_,L).then(function(P){var w=R.remuxer.remux(P.audioTrack,P.avcTrack,P.id3Track,P.textTrack,L,I,!1,R.id);return{remuxResult:w,chunkMeta:b}})},D.configureTransmuxer=function(E,_){for(var L=this.config,I=this.observer,b=this.typeSupported,R=this.vendor,P=_.audioCodec,w=_.defaultInitPts,F=_.duration,k=_.initSegmentData,B=_.videoCodec,U,j=0,K=r.length;j<K;j++)if(r[j].demux.probe(E)){U=r[j];break}U||(c.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),U={demux:T.default,remux:d.default});var N=this.demuxer,Z=this.remuxer,X=U.remux,Y=U.demux;(!Z||!(Z instanceof X))&&(this.remuxer=new X(I,L,b,R)),(!N||!(N instanceof Y))&&(this.demuxer=new Y(I,L,b),this.probe=Y.probe),this.resetInitSegment(k,P,B,F),this.resetInitialTimestamp(w)},D.needsProbing=function(E,_,L){return!this.demuxer||!this.remuxer||_||L},D.getDecrypter=function(){var E=this.decrypter;return E||(E=this.decrypter=new m.default(this.observer,this.config)),E},A}();function e(A,D){var y=null;return A.byteLength>0&&D!=null&&D.key!=null&&D.iv!==null&&D.method!=null&&(y=D),y}var s=function(D){return{remuxResult:{},chunkMeta:D}};function l(A){return"then"in A&&A.then instanceof Function}var a=function(D,y,E,_,L){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=D,this.videoCodec=y,this.initSegmentData=E,this.duration=_,this.defaultInitPts=L},g=function(D,y,E,_,L,I){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=D,this.contiguous=y,this.accurateTimeOffset=E,this.trackSwitch=_,this.timeOffset=L,this.initSegmentChange=I}},"./src/demux/tsdemuxer.ts":function(O,C,x){x.r(C),x.d(C,"discardEPB",function(){return s});var S=x("./src/demux/adts.ts"),h=x("./src/demux/mpegaudio.ts"),m=x("./src/demux/exp-golomb.ts"),M=x("./src/demux/id3.ts"),T=x("./src/demux/sample-aes.ts"),p=x("./src/events.ts"),f=x("./src/utils/mp4-tools.ts"),n=x("./src/utils/logger.ts"),d=x("./src/errors.ts"),o={video:1,audio:2,id3:3,text:4},v=function(){function l(g,A,D){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=g,this.config=A,this.typeSupported=D}l.probe=function(A){var D=l.syncOffset(A);return D<0?!1:(D&&n.logger.warn("MPEG2-TS detected but first sync word found @ offset "+D+", junk ahead ?"),!0)},l.syncOffset=function(A){for(var D=Math.min(1e3,A.length-564),y=0;y<D;){if(A[y]===71&&A[y+188]===71&&A[y+2*188]===71)return y;y++}return-1},l.createTrack=function(A,D){return{container:A==="video"||A==="audio"?"video/mp2t":void 0,type:A,id:o[A],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:A==="audio"?D:void 0}};var a=l.prototype;return a.resetInitSegment=function(A,D,y){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=l.createTrack("video",y),this._audioTrack=l.createTrack("audio",y),this._id3Track=l.createTrack("id3",y),this._txtTrack=l.createTrack("text",y),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=A,this.videoCodec=D,this._duration=y},a.resetTimeStamp=function(){},a.resetContiguity=function(){var A=this._audioTrack,D=this._avcTrack,y=this._id3Track;A&&(A.pesData=null),D&&(D.pesData=null),y&&(y.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},a.demux=function(A,D,y,E){y===void 0&&(y=!1),E===void 0&&(E=!1),y||(this.sampleAes=null);var _,L=this._avcTrack,I=this._audioTrack,b=this._id3Track,R=L.pid,P=L.pesData,w=I.pid,F=b.pid,k=I.pesData,B=b.pesData,U=!1,j=this.pmtParsed,K=this._pmtId,N=A.length;if(this.remainderData&&(A=Object(f.appendUint8Array)(this.remainderData,A),N=A.length,this.remainderData=null),N<188&&!E)return this.remainderData=A,{audioTrack:I,avcTrack:L,id3Track:b,textTrack:this._txtTrack};var Z=Math.max(0,l.syncOffset(A));N-=(N+Z)%188,N<A.byteLength&&!E&&(this.remainderData=new Uint8Array(A.buffer,N,A.buffer.byteLength-N));for(var X=0,Y=Z;Y<N;Y+=188)if(A[Y]===71){var ee=!!(A[Y+1]&64),Q=((A[Y+1]&31)<<8)+A[Y+2],G=(A[Y+3]&48)>>4,q=void 0;if(G>1){if(q=Y+5+A[Y+4],q===Y+188)continue}else q=Y+4;switch(Q){case R:ee&&(P&&(_=t(P))&&this.parseAVCPES(_,!1),P={data:[],size:0}),P&&(P.data.push(A.subarray(q,Y+188)),P.size+=Y+188-q);break;case w:ee&&(k&&(_=t(k))&&(I.isAAC?this.parseAACPES(_):this.parseMPEGPES(_)),k={data:[],size:0}),k&&(k.data.push(A.subarray(q,Y+188)),k.size+=Y+188-q);break;case F:ee&&(B&&(_=t(B))&&this.parseID3PES(_),B={data:[],size:0}),B&&(B.data.push(A.subarray(q,Y+188)),B.size+=Y+188-q);break;case 0:ee&&(q+=A[q]+1),K=this._pmtId=u(A,q);break;case K:{ee&&(q+=A[q]+1);var te=r(A,q,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,y);R=te.avc,R>0&&(L.pid=R),w=te.audio,w>0&&(I.pid=w,I.isAAC=te.isAAC),F=te.id3,F>0&&(b.pid=F),U&&!j&&(n.logger.log("reparse from beginning"),U=!1,Y=Z-188),j=this.pmtParsed=!0;break}case 17:case 8191:break;default:U=!0;break}}else X++;X>0&&this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+X+" TS packet/s that do not start with 0x47"}),L.pesData=P,I.pesData=k,b.pesData=B;var ie={audioTrack:I,avcTrack:L,id3Track:b,textTrack:this._txtTrack};return E&&this.extractRemainingSamples(ie),ie},a.flush=function(){var A=this.remainderData;this.remainderData=null;var D;return A?D=this.demux(A,-1,!1,!0):D={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},a.extractRemainingSamples=function(A){var D=A.audioTrack,y=A.avcTrack,E=A.id3Track,_=y.pesData,L=D.pesData,I=E.pesData,b;_&&(b=t(_))?(this.parseAVCPES(b,!0),y.pesData=null):y.pesData=_,L&&(b=t(L))?(D.isAAC?this.parseAACPES(b):this.parseMPEGPES(b),D.pesData=null):(L!=null&&L.size&&n.logger.log("last AAC PES packet truncated,might overlap between fragments"),D.pesData=L),I&&(b=t(I))?(this.parseID3PES(b),E.pesData=null):E.pesData=I},a.demuxSampleAes=function(A,D,y){var E=this.demux(A,y,!0,!this.config.progressive),_=this.sampleAes=new T.default(this.observer,this.config,D);return this.decrypt(E,_)},a.decrypt=function(A,D){return new Promise(function(y){var E=A.audioTrack,_=A.avcTrack;E.samples&&E.isAAC?D.decryptAacSamples(E.samples,0,function(){_.samples?D.decryptAvcSamples(_.samples,0,0,function(){y(A)}):y(A)}):_.samples&&D.decryptAvcSamples(_.samples,0,0,function(){y(A)})})},a.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},a.parseAVCPES=function(A,D){var y=this,E=this._avcTrack,_=this.parseAVCNALu(A.data),L=this.avcSample,I,b=!1;A.data=null,L&&_.length&&!E.audFound&&(i(L,E),L=this.avcSample=c(!1,A.pts,A.dts,"")),_.forEach(function(R){switch(R.type){case 1:{I=!0,L||(L=y.avcSample=c(!0,A.pts,A.dts,"")),L.frame=!0;var P=R.data;if(b&&P.length>4){var w=new m.default(P).readSliceType();(w===2||w===4||w===7||w===9)&&(L.key=!0)}break}case 5:I=!0,L||(L=y.avcSample=c(!0,A.pts,A.dts,"")),L.key=!0,L.frame=!0;break;case 6:{I=!0;var F=new m.default(s(R.data));F.readUByte();for(var k=0,B=0,U=!1,j=0;!U&&F.bytesAvailable>1;){k=0;do j=F.readUByte(),k+=j;while(j===255);B=0;do j=F.readUByte(),B+=j;while(j===255);if(k===4&&F.bytesAvailable!==0){U=!0;var K=F.readUByte();if(K===181){var N=F.readUShort();if(N===49){var Z=F.readUInt();if(Z===1195456820){var X=F.readUByte();if(X===3){for(var Y=F.readUByte(),ee=F.readUByte(),Q=31&Y,G=[Y,ee],q=0;q<Q;q++)G.push(F.readUByte()),G.push(F.readUByte()),G.push(F.readUByte());e(y._txtTrack.samples,{type:3,pts:A.pts,bytes:G})}}}}}else if(k===5&&F.bytesAvailable!==0){if(U=!0,B>16){for(var te=[],ie=0;ie<16;ie++)te.push(F.readUByte().toString(16)),(ie===3||ie===5||ie===7||ie===9)&&te.push("-");for(var ne=B-16,le=new Uint8Array(ne),se=0;se<ne;se++)le[se]=F.readUByte();e(y._txtTrack.samples,{pts:A.pts,payloadType:k,uuid:te.join(""),userData:Object(M.utf8ArrayToStr)(le),userDataBytes:le})}}else if(B<F.bytesAvailable)for(var oe=0;oe<B;oe++)F.readUByte()}break}case 7:if(I=!0,b=!0,!E.sps){var J=new m.default(R.data),ae=J.readSPS();E.width=ae.width,E.height=ae.height,E.pixelRatio=ae.pixelRatio,E.sps=[R.data],E.duration=y._duration;for(var fe=R.data.subarray(1,4),de="avc1.",ve=0;ve<3;ve++){var ue=fe[ve].toString(16);ue.length<2&&(ue="0"+ue),de+=ue}E.codec=de}break;case 8:I=!0,E.pps||(E.pps=[R.data]);break;case 9:I=!1,E.audFound=!0,L&&i(L,E),L=y.avcSample=c(!1,A.pts,A.dts,"");break;case 12:I=!1;break;default:I=!1,L&&(L.debug+="unknown NAL "+R.type+" ");break}if(L&&I){var _e=L.units;_e.push(R)}}),D&&L&&(i(L,E),this.avcSample=null)},a.getLastNalUnit=function(){var A,D=this.avcSample,y;if(!D||D.units.length===0){var E=this._avcTrack.samples;D=E[E.length-1]}if((A=D)!==null&&A!==void 0&&A.units){var _=D.units;y=_[_.length-1]}return y},a.parseAVCNALu=function(A){var D=A.byteLength,y=this._avcTrack,E=y.naluState||0,_=E,L=[],I=0,b,R,P,w=-1,F=0;for(E===-1&&(w=0,F=A[0]&31,E=0,I=1);I<D;){if(b=A[I++],!E){E=b?0:1;continue}if(E===1){E=b?0:2;continue}if(!b)E=3;else if(b===1){if(w>=0){var k={data:A.subarray(w,I-E-1),type:F};L.push(k)}else{var B=this.getLastNalUnit();if(B&&(_&&I<=4-_&&B.state&&(B.data=B.data.subarray(0,B.data.byteLength-_)),R=I-E-1,R>0)){var U=new Uint8Array(B.data.byteLength+R);U.set(B.data,0),U.set(A.subarray(0,R),B.data.byteLength),B.data=U,B.state=0}}I<D?(P=A[I]&31,w=I,F=P,E=0):E=-1}else E=0}if(w>=0&&E>=0){var j={data:A.subarray(w,D),type:F,state:E};L.push(j)}if(L.length===0){var K=this.getLastNalUnit();if(K){var N=new Uint8Array(K.data.byteLength+A.byteLength);N.set(K.data,0),N.set(A,K.data.byteLength),K.data=N}}return y.naluState=E,L},a.parseAACPES=function(A){var D=0,y=this._audioTrack,E=this.aacOverFlow,_=A.data;if(E){this.aacOverFlow=null;var L=E.sample.unit.byteLength,I=Math.min(E.missing,L),b=L-I;E.sample.unit.set(_.subarray(0,I),b),y.samples.push(E.sample),D=E.missing}var R,P;for(R=D,P=_.length;R<P-1&&!S.isHeader(_,R);R++);if(R!==D){var w,F;if(R<P-1?(w="AAC PES did not start with ADTS header,offset:"+R,F=!1):(w="no ADTS header found in AAC PES",F=!0),n.logger.warn("parsing error:"+w),this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:F,reason:w}),F)return}S.initTrackConfig(y,this.observer,_,R,this.audioCodec);var k;if(A.pts!==void 0)k=A.pts;else if(E){var B=S.getFrameDuration(y.samplerate);k=E.sample.pts+B}else{n.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var U=0;R<P;)if(S.isHeader(_,R)){if(R+5<P){var j=S.appendFrame(y,_,R,k,U);if(j)if(j.missing)this.aacOverFlow=j;else{R+=j.length,U++;continue}}break}else R++},a.parseMPEGPES=function(A){var D=A.data,y=D.length,E=0,_=0,L=A.pts;if(L===void 0){n.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;_<y;)if(h.isHeader(D,_)){var I=h.appendFrame(this._audioTrack,D,_,L,E);if(I)_+=I.length,E++;else break}else _++},a.parseID3PES=function(A){if(A.pts===void 0){n.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(A)},l}();v.minProbeByteLength=188;function c(l,a,g,A){return{key:l,frame:!1,pts:a,dts:g,units:[],debug:A,length:0}}function u(l,a){return(l[a+10]&31)<<8|l[a+11]}function r(l,a,g,A){var D={audio:-1,avc:-1,id3:-1,isAAC:!0},y=(l[a+1]&15)<<8|l[a+2],E=a+3+y-4,_=(l[a+10]&15)<<8|l[a+11];for(a+=12+_;a<E;){var L=(l[a+1]&31)<<8|l[a+2];switch(l[a]){case 207:if(!A){n.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:D.audio===-1&&(D.audio=L);break;case 21:D.id3===-1&&(D.id3=L);break;case 219:if(!A){n.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:D.avc===-1&&(D.avc=L);break;case 3:case 4:g?D.audio===-1&&(D.audio=L,D.isAAC=!1):n.logger.log("MPEG audio found, not supported in this browser");break;case 36:n.logger.warn("Unsupported HEVC stream type found");break}a+=((l[a+3]&15)<<8|l[a+4])+5}return D}function t(l){var a=0,g,A,D,y,E,_=l.data;if(!l||l.size===0)return null;for(;_[0].length<19&&_.length>1;){var L=new Uint8Array(_[0].length+_[1].length);L.set(_[0]),L.set(_[1],_[0].length),_[0]=L,_.splice(1,1)}g=_[0];var I=(g[0]<<16)+(g[1]<<8)+g[2];if(I===1){if(A=(g[4]<<8)+g[5],A&&A>l.size-6)return null;var b=g[7];b&192&&(y=(g[9]&14)*536870912+(g[10]&255)*4194304+(g[11]&254)*16384+(g[12]&255)*128+(g[13]&254)/2,b&64?(E=(g[14]&14)*536870912+(g[15]&255)*4194304+(g[16]&254)*16384+(g[17]&255)*128+(g[18]&254)/2,y-E>60*9e4&&(n.logger.warn(Math.round((y-E)/9e4)+"s delta between PTS and DTS, align them"),y=E)):E=y),D=g[8];var R=D+9;if(l.size<=R)return null;l.size-=R;for(var P=new Uint8Array(l.size),w=0,F=_.length;w<F;w++){g=_[w];var k=g.byteLength;if(R)if(R>k){R-=k;continue}else g=g.subarray(R),k-=R,R=0;P.set(g,a),a+=k}return A&&(A-=D+3),{data:P,pts:y,dts:E,len:A}}return null}function i(l,a){if(l.units.length&&l.frame){if(l.pts===void 0){var g=a.samples,A=g.length;if(A){var D=g[A-1];l.pts=D.pts,l.dts=D.dts}else{a.dropped++;return}}a.samples.push(l)}l.debug.length&&n.logger.log(l.pts+"/"+l.dts+":"+l.debug)}function e(l,a){var g=l.length;if(g>0){if(a.pts>=l[g-1].pts)l.push(a);else for(var A=g-1;A>=0;A--)if(a.pts<l[A].pts){l.splice(A,0,a);break}}else l.push(a)}function s(l){for(var a=l.byteLength,g=[],A=1;A<a-2;)l[A]===0&&l[A+1]===0&&l[A+2]===3?(g.push(A+2),A+=2):A++;if(g.length===0)return l;var D=a-g.length,y=new Uint8Array(D),E=0;for(A=0;A<D;E++,A++)E===g[0]&&(E++,g.shift()),y[A]=l[E];return y}C.default=v},"./src/errors.ts":function(O,C,x){x.r(C),x.d(C,"ErrorTypes",function(){return S}),x.d(C,"ErrorDetails",function(){return h});var S;(function(m){m.NETWORK_ERROR="networkError",m.MEDIA_ERROR="mediaError",m.KEY_SYSTEM_ERROR="keySystemError",m.MUX_ERROR="muxError",m.OTHER_ERROR="otherError"})(S||(S={}));var h;(function(m){m.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",m.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",m.KEY_SYSTEM_NO_SESSION="keySystemNoSession",m.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",m.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",m.MANIFEST_LOAD_ERROR="manifestLoadError",m.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",m.MANIFEST_PARSING_ERROR="manifestParsingError",m.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",m.LEVEL_EMPTY_ERROR="levelEmptyError",m.LEVEL_LOAD_ERROR="levelLoadError",m.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",m.LEVEL_SWITCH_ERROR="levelSwitchError",m.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",m.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",m.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",m.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",m.FRAG_LOAD_ERROR="fragLoadError",m.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",m.FRAG_DECRYPT_ERROR="fragDecryptError",m.FRAG_PARSING_ERROR="fragParsingError",m.REMUX_ALLOC_ERROR="remuxAllocError",m.KEY_LOAD_ERROR="keyLoadError",m.KEY_LOAD_TIMEOUT="keyLoadTimeOut",m.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",m.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",m.BUFFER_APPEND_ERROR="bufferAppendError",m.BUFFER_APPENDING_ERROR="bufferAppendingError",m.BUFFER_STALLED_ERROR="bufferStalledError",m.BUFFER_FULL_ERROR="bufferFullError",m.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",m.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",m.INTERNAL_EXCEPTION="internalException",m.INTERNAL_ABORTED="aborted",m.UNKNOWN="unknown"})(h||(h={}))},"./src/events.ts":function(O,C,x){x.r(C),x.d(C,"Events",function(){return S});var S;(function(h){h.MEDIA_ATTACHING="hlsMediaAttaching",h.MEDIA_ATTACHED="hlsMediaAttached",h.MEDIA_DETACHING="hlsMediaDetaching",h.MEDIA_DETACHED="hlsMediaDetached",h.BUFFER_RESET="hlsBufferReset",h.BUFFER_CODECS="hlsBufferCodecs",h.BUFFER_CREATED="hlsBufferCreated",h.BUFFER_APPENDING="hlsBufferAppending",h.BUFFER_APPENDED="hlsBufferAppended",h.BUFFER_EOS="hlsBufferEos",h.BUFFER_FLUSHING="hlsBufferFlushing",h.BUFFER_FLUSHED="hlsBufferFlushed",h.MANIFEST_LOADING="hlsManifestLoading",h.MANIFEST_LOADED="hlsManifestLoaded",h.MANIFEST_PARSED="hlsManifestParsed",h.LEVEL_SWITCHING="hlsLevelSwitching",h.LEVEL_SWITCHED="hlsLevelSwitched",h.LEVEL_LOADING="hlsLevelLoading",h.LEVEL_LOADED="hlsLevelLoaded",h.LEVEL_UPDATED="hlsLevelUpdated",h.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",h.LEVELS_UPDATED="hlsLevelsUpdated",h.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",h.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",h.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",h.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",h.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",h.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",h.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",h.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",h.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",h.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",h.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",h.CUES_PARSED="hlsCuesParsed",h.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",h.INIT_PTS_FOUND="hlsInitPtsFound",h.FRAG_LOADING="hlsFragLoading",h.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",h.FRAG_LOADED="hlsFragLoaded",h.FRAG_DECRYPTED="hlsFragDecrypted",h.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",h.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",h.FRAG_PARSING_METADATA="hlsFragParsingMetadata",h.FRAG_PARSED="hlsFragParsed",h.FRAG_BUFFERED="hlsFragBuffered",h.FRAG_CHANGED="hlsFragChanged",h.FPS_DROP="hlsFpsDrop",h.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",h.ERROR="hlsError",h.DESTROYING="hlsDestroying",h.KEY_LOADING="hlsKeyLoading",h.KEY_LOADED="hlsKeyLoaded",h.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",h.BACK_BUFFER_REACHED="hlsBackBufferReached"})(S||(S={}))},"./src/hls.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return e});var S=x("./node_modules/url-toolkit/src/url-toolkit.js"),h=x("./src/loader/playlist-loader.ts"),m=x("./src/loader/key-loader.ts"),M=x("./src/controller/id3-track-controller.ts"),T=x("./src/controller/latency-controller.ts"),p=x("./src/controller/level-controller.ts"),f=x("./src/controller/fragment-tracker.ts"),n=x("./src/controller/stream-controller.ts"),d=x("./src/is-supported.ts"),o=x("./src/utils/logger.ts"),v=x("./src/config.ts"),c=x("./node_modules/eventemitter3/index.js"),u=x("./src/events.ts"),r=x("./src/errors.ts");function t(s,l){for(var a=0;a<l.length;a++){var g=l[a];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(s,g.key,g)}}function i(s,l,a){return l&&t(s.prototype,l),a&&t(s,a),s}var e=function(){s.isSupported=function(){return Object(d.isSupported)()};function s(a){a===void 0&&(a={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new c.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var g=this.config=Object(v.mergeConfig)(s.DefaultConfig,a);this.userConfig=a,Object(o.enableLogs)(g.debug),this._autoLevelCapping=-1,g.progressive&&Object(v.enableStreamingMode)(g);var A=g.abrController,D=g.bufferController,y=g.capLevelController,E=g.fpsController,_=this.abrController=new A(this),L=this.bufferController=new D(this),I=this.capLevelController=new y(this),b=new E(this),R=new h.default(this),P=new m.default(this),w=new M.default(this),F=this.levelController=new p.default(this),k=new f.FragmentTracker(this),B=this.streamController=new n.default(this,k);I.setStreamController(B),b.setStreamController(B);var U=[F,B];this.networkControllers=U;var j=[R,P,_,L,I,b,w,k];this.audioTrackController=this.createController(g.audioTrackController,null,U),this.createController(g.audioStreamController,k,U),this.subtitleTrackController=this.createController(g.subtitleTrackController,null,U),this.createController(g.subtitleStreamController,k,U),this.createController(g.timelineController,null,j),this.emeController=this.createController(g.emeController,null,j),this.cmcdController=this.createController(g.cmcdController,null,j),this.latencyController=this.createController(T.default,null,j),this.coreComponents=j}var l=s.prototype;return l.createController=function(g,A,D){if(g){var y=A?new g(this,A):new g(this);return D&&D.push(y),y}return null},l.on=function(g,A,D){D===void 0&&(D=this),this._emitter.on(g,A,D)},l.once=function(g,A,D){D===void 0&&(D=this),this._emitter.once(g,A,D)},l.removeAllListeners=function(g){this._emitter.removeAllListeners(g)},l.off=function(g,A,D,y){D===void 0&&(D=this),this._emitter.off(g,A,D,y)},l.listeners=function(g){return this._emitter.listeners(g)},l.emit=function(g,A,D){return this._emitter.emit(g,A,D)},l.trigger=function(g,A){if(this.config.debug)return this.emit(g,g,A);try{return this.emit(g,g,A)}catch(D){o.logger.error("An internal error happened while handling event "+g+'. Error message: "'+D.message+'". Here is a stacktrace:',D),this.trigger(u.Events.ERROR,{type:r.ErrorTypes.OTHER_ERROR,details:r.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:g,error:D})}return!1},l.listenerCount=function(g){return this._emitter.listenerCount(g)},l.destroy=function(){o.logger.log("destroy"),this.trigger(u.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(g){return g.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(g){return g.destroy()}),this.coreComponents.length=0},l.attachMedia=function(g){o.logger.log("attachMedia"),this._media=g,this.trigger(u.Events.MEDIA_ATTACHING,{media:g})},l.detachMedia=function(){o.logger.log("detachMedia"),this.trigger(u.Events.MEDIA_DETACHING,void 0),this._media=null},l.loadSource=function(g){this.stopLoad();var A=this.media,D=this.url,y=this.url=S.buildAbsoluteURL(self.location.href,g,{alwaysNormalize:!0});o.logger.log("loadSource:"+y),A&&D&&D!==y&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(A)),this.trigger(u.Events.MANIFEST_LOADING,{url:g})},l.startLoad=function(g){g===void 0&&(g=-1),o.logger.log("startLoad("+g+")"),this.networkControllers.forEach(function(A){A.startLoad(g)})},l.stopLoad=function(){o.logger.log("stopLoad"),this.networkControllers.forEach(function(g){g.stopLoad()})},l.swapAudioCodec=function(){o.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},l.recoverMediaError=function(){o.logger.log("recoverMediaError");var g=this._media;this.detachMedia(),g&&this.attachMedia(g)},l.removeLevel=function(g,A){A===void 0&&(A=0),this.levelController.removeLevel(g,A)},i(s,[{key:"levels",get:function(){var g=this.levelController.levels;return g||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(g){o.logger.log("set currentLevel:"+g),this.loadLevel=g,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(g){o.logger.log("set nextLevel:"+g),this.levelController.manualLevel=g,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(g){o.logger.log("set loadLevel:"+g),this.levelController.manualLevel=g}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(g){this.levelController.nextLoadLevel=g}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(g){o.logger.log("set firstLevel:"+g),this.levelController.firstLevel=g}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(g){o.logger.log("set startLevel:"+g),g!==-1&&(g=Math.max(g,this.minAutoLevel)),this.levelController.startLevel=g}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(g){var A=!!g;A!==this.config.capLevelToPlayerSize&&(A?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=A)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(g){this._autoLevelCapping!==g&&(o.logger.log("set autoLevelCapping:"+g),this._autoLevelCapping=g)}},{key:"bandwidthEstimate",get:function(){var g=this.abrController.bwEstimator;return g?g.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var g=this.levels,A=this.config.minAutoBitrate;if(!g)return 0;for(var D=g.length,y=0;y<D;y++)if(g[y].maxBitrate>A)return y;return 0}},{key:"maxAutoLevel",get:function(){var g=this.levels,A=this.autoLevelCapping,D;return A===-1&&g&&g.length?D=g.length-1:D=A,D}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(g){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,g)}},{key:"audioTracks",get:function(){var g=this.audioTrackController;return g?g.audioTracks:[]}},{key:"audioTrack",get:function(){var g=this.audioTrackController;return g?g.audioTrack:-1},set:function(g){var A=this.audioTrackController;A&&(A.audioTrack=g)}},{key:"subtitleTracks",get:function(){var g=this.subtitleTrackController;return g?g.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var g=this.subtitleTrackController;return g?g.subtitleTrack:-1},set:function(g){var A=this.subtitleTrackController;A&&(A.subtitleTrack=g)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var g=this.subtitleTrackController;return g?g.subtitleDisplay:!1},set:function(g){var A=this.subtitleTrackController;A&&(A.subtitleDisplay=g)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(g){this.config.lowLatencyMode=g}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return u.Events}},{key:"ErrorTypes",get:function(){return r.ErrorTypes}},{key:"ErrorDetails",get:function(){return r.ErrorDetails}},{key:"DefaultConfig",get:function(){return s.defaultConfig?s.defaultConfig:v.hlsDefaultConfig},set:function(g){s.defaultConfig=g}}]),s}();e.defaultConfig=void 0},"./src/is-supported.ts":function(O,C,x){x.r(C),x.d(C,"isSupported",function(){return m}),x.d(C,"changeTypeSupported",function(){return M});var S=x("./src/utils/mediasource-helper.ts");function h(){return self.SourceBuffer||self.WebKitSourceBuffer}function m(){var T=Object(S.getMediaSource)();if(!T)return!1;var p=h(),f=T&&typeof T.isTypeSupported=="function"&&T.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!p||p.prototype&&typeof p.prototype.appendBuffer=="function"&&typeof p.prototype.remove=="function";return!!f&&!!n}function M(){var T,p=h();return typeof(p==null||(T=p.prototype)===null||T===void 0?void 0:T.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return v}),x.d(C,"LoadError",function(){return u});var S=x("./src/polyfills/number.ts"),h=x("./src/errors.ts");function m(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t)}function M(r){var t=typeof Map=="function"?new Map:void 0;return M=function(e){if(e===null||!f(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return T(e,arguments,d(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),n(s,e)},M(r)}function T(r,t,i){return p()?T=Reflect.construct:T=function(s,l,a){var g=[null];g.push.apply(g,l);var A=Function.bind.apply(s,g),D=new A;return a&&n(D,a.prototype),D},T.apply(null,arguments)}function p(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function n(r,t){return n=Object.setPrototypeOf||function(e,s){return e.__proto__=s,e},n(r,t)}function d(r){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},d(r)}var o=Math.pow(2,17),v=function(){function r(i){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=i}var t=r.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,s){var l=this,a=e.url;if(!a)return Promise.reject(new u({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,networkDetails:null},"Fragment does not have a "+(a?"part list":"url")));this.abort();var g=this.config,A=g.fLoader,D=g.loader;return new Promise(function(y,E){l.loader&&l.loader.destroy();var _=l.loader=e.loader=A?new A(g):new D(g),L=c(e),I={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:o};e.stats=_.stats,_.load(L,I,{onSuccess:function(R,P,w,F){l.resetLoader(e,_),y({frag:e,part:null,payload:R.data,networkDetails:F})},onError:function(R,P,w){l.resetLoader(e,_),E(new u({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:R,networkDetails:w}))},onAbort:function(R,P,w){l.resetLoader(e,_),E(new u({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,networkDetails:w}))},onTimeout:function(R,P,w){l.resetLoader(e,_),E(new u({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,networkDetails:w}))},onProgress:function(R,P,w,F){s&&s({frag:e,part:null,payload:w,networkDetails:F})}})})},t.loadPart=function(e,s,l){var a=this;this.abort();var g=this.config,A=g.fLoader,D=g.loader;return new Promise(function(y,E){a.loader&&a.loader.destroy();var _=a.loader=e.loader=A?new A(g):new D(g),L=c(e,s),I={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:o};s.stats=_.stats,_.load(L,I,{onSuccess:function(R,P,w,F){a.resetLoader(e,_),a.updateStatsFromPart(e,s);var k={frag:e,part:s,payload:R.data,networkDetails:F};l(k),y(k)},onError:function(R,P,w){a.resetLoader(e,_),E(new u({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:s,response:R,networkDetails:w}))},onAbort:function(R,P,w){e.stats.aborted=s.stats.aborted,a.resetLoader(e,_),E(new u({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:s,networkDetails:w}))},onTimeout:function(R,P,w){a.resetLoader(e,_),E(new u({type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:s,networkDetails:w}))}})})},t.updateStatsFromPart=function(e,s){var l=e.stats,a=s.stats,g=a.total;if(l.loaded+=a.loaded,g){var A=Math.round(e.duration/s.duration),D=Math.min(Math.round(l.loaded/g),A),y=A-D,E=y*Math.round(l.loaded/D);l.total=l.loaded+E}else l.total=Math.max(l.loaded,l.total);var _=l.loading,L=a.loading;_.start?_.first+=L.first-L.start:(_.start=L.start,_.first=L.first),_.end=L.end},t.resetLoader=function(e,s){e.loader=null,this.loader===s&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),s.destroy()},r}();function c(r,t){t===void 0&&(t=null);var i=t||r,e={frag:r,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},s=i.byteRangeStartOffset,l=i.byteRangeEndOffset;return Object(S.isFiniteNumber)(s)&&Object(S.isFiniteNumber)(l)&&(e.rangeStart=s,e.rangeEnd=l),e}var u=function(r){m(t,r);function t(i){for(var e,s=arguments.length,l=new Array(s>1?s-1:0),a=1;a<s;a++)l[a-1]=arguments[a];return e=r.call.apply(r,[this].concat(l))||this,e.data=void 0,e.data=i,e}return t}(M(Error))},"./src/loader/fragment.ts":function(O,C,x){x.r(C),x.d(C,"ElementaryStreamTypes",function(){return o}),x.d(C,"BaseSegment",function(){return v}),x.d(C,"Fragment",function(){return c}),x.d(C,"Part",function(){return u});var S=x("./src/polyfills/number.ts"),h=x("./node_modules/url-toolkit/src/url-toolkit.js"),m=x("./src/utils/logger.ts"),M=x("./src/loader/level-key.ts"),T=x("./src/loader/load-stats.ts");function p(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,f(r,t)}function f(r,t){return f=Object.setPrototypeOf||function(e,s){return e.__proto__=s,e},f(r,t)}function n(r,t){for(var i=0;i<t.length;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}function d(r,t,i){return t&&n(r.prototype,t),i&&n(r,i),r}var o;(function(r){r.AUDIO="audio",r.VIDEO="video",r.AUDIOVIDEO="audiovideo"})(o||(o={}));var v=function(){function r(i){var e;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(e={},e[o.AUDIO]=null,e[o.VIDEO]=null,e[o.AUDIOVIDEO]=null,e),this.baseurl=i}var t=r.prototype;return t.setByteRange=function(e,s){var l=e.split("@",2),a=[];l.length===1?a[0]=s?s.byteRangeEndOffset:0:a[0]=parseInt(l[1]),a[1]=parseInt(l[0])+a[0],this._byteRange=a},d(r,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(h.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),r}(),c=function(r){p(t,r);function t(e,s){var l;return l=r.call(this,s)||this,l._decryptdata=null,l.rawProgramDateTime=null,l.programDateTime=null,l.tagList=[],l.duration=0,l.sn=0,l.levelkey=void 0,l.type=void 0,l.loader=null,l.level=-1,l.cc=0,l.startPTS=void 0,l.endPTS=void 0,l.appendedPTS=void 0,l.startDTS=void 0,l.endDTS=void 0,l.start=0,l.deltaPTS=void 0,l.maxStartPTS=void 0,l.minEndPTS=void 0,l.stats=new T.LoadStats,l.urlId=0,l.data=void 0,l.bitrateTest=!1,l.title=null,l.initSegment=null,l.type=e,l}var i=t.prototype;return i.createInitializationVector=function(s){for(var l=new Uint8Array(16),a=12;a<16;a++)l[a]=s>>8*(15-a)&255;return l},i.setDecryptDataFromLevelKey=function(s,l){var a=s;return(s==null?void 0:s.method)==="AES-128"&&s.uri&&!s.iv&&(a=M.LevelKey.fromURI(s.uri),a.method=s.method,a.iv=this.createInitializationVector(l),a.keyFormat="identity"),a},i.setElementaryStreamInfo=function(s,l,a,g,A,D){D===void 0&&(D=!1);var y=this.elementaryStreams,E=y[s];if(!E){y[s]={startPTS:l,endPTS:a,startDTS:g,endDTS:A,partial:D};return}E.startPTS=Math.min(E.startPTS,l),E.endPTS=Math.max(E.endPTS,a),E.startDTS=Math.min(E.startDTS,g),E.endDTS=Math.max(E.endDTS,A)},i.clearElementaryStreamInfo=function(){var s=this.elementaryStreams;s[o.AUDIO]=null,s[o.VIDEO]=null,s[o.AUDIOVIDEO]=null},d(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var s=this.sn;typeof s!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&m.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),s=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,s)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(S.isFiniteNumber)(this.programDateTime))return null;var s=Object(S.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+s*1e3}},{key:"encrypted",get:function(){var s;return!!((s=this.decryptdata)!==null&&s!==void 0&&s.keyFormat&&this.decryptdata.uri)}}]),t}(v),u=function(r){p(t,r);function t(i,e,s,l,a){var g;g=r.call(this,s)||this,g.fragOffset=0,g.duration=0,g.gap=!1,g.independent=!1,g.relurl=void 0,g.fragment=void 0,g.index=void 0,g.stats=new T.LoadStats,g.duration=i.decimalFloatingPoint("DURATION"),g.gap=i.bool("GAP"),g.independent=i.bool("INDEPENDENT"),g.relurl=i.enumeratedString("URI"),g.fragment=e,g.index=l;var A=i.enumeratedString("BYTERANGE");return A&&g.setByteRange(A,a),a&&(g.fragOffset=a.fragOffset+a.duration),g}return d(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(v)},"./src/loader/key-loader.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return M});var S=x("./src/events.ts"),h=x("./src/errors.ts"),m=x("./src/utils/logger.ts"),M=function(){function T(f){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=f,this._registerListeners()}var p=T.prototype;return p._registerListeners=function(){this.hls.on(S.Events.KEY_LOADING,this.onKeyLoading,this)},p._unregisterListeners=function(){this.hls.off(S.Events.KEY_LOADING,this.onKeyLoading)},p.destroy=function(){this._unregisterListeners();for(var n in this.loaders){var d=this.loaders[n];d&&d.destroy()}this.loaders={}},p.onKeyLoading=function(n,d){var o=d.frag,v=o.type,c=this.loaders[v];if(!o.decryptdata){m.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var u=o.decryptdata.uri;if(u!==this.decrypturl||this.decryptkey===null){var r=this.hls.config;if(c&&(m.logger.warn("abort previous key loader for type:"+v),c.abort()),!u){m.logger.warn("key uri is falsy");return}var t=r.loader,i=o.loader=this.loaders[v]=new t(r);this.decrypturl=u,this.decryptkey=null;var e={url:u,frag:o,responseType:"arraybuffer"},s={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:r.fragLoadingRetryDelay,maxRetryDelay:r.fragLoadingMaxRetryTimeout,highWaterMark:0},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};i.load(e,s,l)}else this.decryptkey&&(o.decryptdata.key=this.decryptkey,this.hls.trigger(S.Events.KEY_LOADED,{frag:o}))},p.loadsuccess=function(n,d,o){var v=o.frag;if(!v.decryptdata){m.logger.error("after key load, decryptdata unset");return}this.decryptkey=v.decryptdata.key=new Uint8Array(n.data),v.loader=null,delete this.loaders[v.type],this.hls.trigger(S.Events.KEY_LOADED,{frag:v})},p.loaderror=function(n,d){var o=d.frag,v=o.loader;v&&v.abort(),delete this.loaders[o.type],this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:o,response:n})},p.loadtimeout=function(n,d){var o=d.frag,v=o.loader;v&&v.abort(),delete this.loaders[o.type],this.hls.trigger(S.Events.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:o})},T}()},"./src/loader/level-details.ts":function(O,C,x){x.r(C),x.d(C,"LevelDetails",function(){return T});var S=x("./src/polyfills/number.ts");function h(p,f){for(var n=0;n<f.length;n++){var d=f[n];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(p,d.key,d)}}function m(p,f,n){return f&&h(p.prototype,f),n&&h(p,n),p}var M=10,T=function(){function p(n){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=n}var f=p.prototype;return f.reloaded=function(d){if(!d){this.advanced=!0,this.updated=!0;return}var o=this.lastPartSn-d.lastPartSn,v=this.lastPartIndex-d.lastPartIndex;this.updated=this.endSN!==d.endSN||!!v||!!o,this.advanced=this.endSN>d.endSN||o>0||o===0&&v>0,this.updated||this.advanced?this.misses=Math.floor(d.misses*.6):this.misses=d.misses+1,this.availabilityDelay=d.availabilityDelay},m(p,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(S.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||M}},{key:"drift",get:function(){var d=this.driftEndTime-this.driftStartTime;if(d>0){var o=this.driftEnd-this.driftStart;return o*1e3/d}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var d;return(d=this.partList)!==null&&d!==void 0&&d.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var d;return(d=this.fragments)!==null&&d!==void 0&&d.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var d;return(d=this.partList)!==null&&d!==void 0&&d.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var d;return(d=this.partList)!==null&&d!==void 0&&d.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),p}()},"./src/loader/level-key.ts":function(O,C,x){x.r(C),x.d(C,"LevelKey",function(){return M});var S=x("./node_modules/url-toolkit/src/url-toolkit.js");function h(T,p){for(var f=0;f<p.length;f++){var n=p[f];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(T,n.key,n)}}function m(T,p,f){return p&&h(T.prototype,p),f&&h(T,f),T}var M=function(){T.fromURL=function(f,n){return new T(f,n)},T.fromURI=function(f){return new T(f)};function T(p,f){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,f?this._uri=Object(S.buildAbsoluteURL)(p,f,{alwaysNormalize:!0}):this._uri=p}return m(T,[{key:"uri",get:function(){return this._uri}}]),T}()},"./src/loader/load-stats.ts":function(O,C,x){x.r(C),x.d(C,"LoadStats",function(){return S});var S=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return t});var S=x("./src/polyfills/number.ts"),h=x("./node_modules/url-toolkit/src/url-toolkit.js"),m=x("./src/loader/fragment.ts"),M=x("./src/loader/level-details.ts"),T=x("./src/loader/level-key.ts"),p=x("./src/utils/attr-list.ts"),f=x("./src/utils/logger.ts"),n=x("./src/utils/codecs.ts"),d=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,o=/#EXT-X-MEDIA:(.*)/g,v=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),c=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),u=/\.(mp4|m4s|m4v|m4a)$/i;function r(a){var g,A;return u.test((g=(A=h.parseURL(a))===null||A===void 0?void 0:A.path)!=null?g:"")}var t=function(){function a(){}return a.findGroup=function(A,D){for(var y=0;y<A.length;y++){var E=A[y];if(E.id===D)return E}},a.convertAVC1ToAVCOTI=function(A){var D=A.split(".");if(D.length>2){var y=D.shift()+".";return y+=parseInt(D.shift()).toString(16),y+=("000"+parseInt(D.shift()).toString(16)).substr(-4),y}return A},a.resolve=function(A,D){return h.buildAbsoluteURL(D,A,{alwaysNormalize:!0})},a.parseMasterPlaylist=function(A,D){var y=[],E={},_=!1;d.lastIndex=0;for(var L;(L=d.exec(A))!=null;)if(L[1]){var I=new p.AttrList(L[1]),b={attrs:I,bitrate:I.decimalInteger("AVERAGE-BANDWIDTH")||I.decimalInteger("BANDWIDTH"),name:I.NAME,url:a.resolve(L[2],D)},R=I.decimalResolution("RESOLUTION");R&&(b.width=R.width,b.height=R.height),i((I.CODECS||"").split(/[ ,]+/).filter(function(w){return w}),b),b.videoCodec&&b.videoCodec.indexOf("avc1")!==-1&&(b.videoCodec=a.convertAVC1ToAVCOTI(b.videoCodec)),y.push(b)}else if(L[3]){var P=new p.AttrList(L[3]);P["DATA-ID"]&&(_=!0,E[P["DATA-ID"]]=P)}return{levels:y,sessionData:_?E:null}},a.parseMasterPlaylistMedia=function(A,D,y,E){E===void 0&&(E=[]);var _,L=[],I=0;for(o.lastIndex=0;(_=o.exec(A))!==null;){var b=new p.AttrList(_[1]);if(b.TYPE===y){var R={attrs:b,bitrate:0,id:I++,groupId:b["GROUP-ID"],instreamId:b["INSTREAM-ID"],name:b.NAME||b.LANGUAGE||"",type:y,default:b.bool("DEFAULT"),autoselect:b.bool("AUTOSELECT"),forced:b.bool("FORCED"),lang:b.LANGUAGE,url:b.URI?a.resolve(b.URI,D):""};if(E.length){var P=a.findGroup(E,R.groupId)||E[0];e(R,P,"audioCodec"),e(R,P,"textCodec")}L.push(R)}}return L},a.parseLevelPlaylist=function(A,D,y,E,_){var L=new M.LevelDetails(D),I=L.fragments,b=null,R=0,P=0,w=0,F=0,k=null,B=new m.Fragment(E,D),U,j,K,N=-1,Z=!1;for(v.lastIndex=0,L.m3u8=A;(U=v.exec(A))!==null;){Z&&(Z=!1,B=new m.Fragment(E,D),B.start=w,B.sn=R,B.cc=F,B.level=y,b&&(B.initSegment=b,B.rawProgramDateTime=b.rawProgramDateTime));var X=U[1];if(X){B.duration=parseFloat(X);var Y=(" "+U[2]).slice(1);B.title=Y||null,B.tagList.push(Y?["INF",X,Y]:["INF",X])}else if(U[3])Object(S.isFiniteNumber)(B.duration)&&(B.start=w,K&&(B.levelkey=K),B.sn=R,B.level=y,B.cc=F,B.urlId=_,I.push(B),B.relurl=(" "+U[3]).slice(1),l(B,k),k=B,w+=B.duration,R++,P=0,Z=!0);else if(U[4]){var ee=(" "+U[4]).slice(1);k?B.setByteRange(ee,k):B.setByteRange(ee)}else if(U[5])B.rawProgramDateTime=(" "+U[5]).slice(1),B.tagList.push(["PROGRAM-DATE-TIME",B.rawProgramDateTime]),N===-1&&(N=I.length);else{if(U=U[0].match(c),!U){f.logger.warn("No matches on slow regex match for level playlist!");continue}for(j=1;j<U.length&&typeof U[j]=="undefined";j++);var Q=(" "+U[j]).slice(1),G=(" "+U[j+1]).slice(1),q=U[j+2]?(" "+U[j+2]).slice(1):"";switch(Q){case"PLAYLIST-TYPE":L.type=G.toUpperCase();break;case"MEDIA-SEQUENCE":R=L.startSN=parseInt(G);break;case"SKIP":{var te=new p.AttrList(G),ie=te.decimalInteger("SKIPPED-SEGMENTS");if(Object(S.isFiniteNumber)(ie)){L.skippedSegments=ie;for(var ne=ie;ne--;)I.unshift(null);R+=ie}var le=te.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(L.recentlyRemovedDateranges=le.split("	"));break}case"TARGETDURATION":L.targetduration=parseFloat(G);break;case"VERSION":L.version=parseInt(G);break;case"EXTM3U":break;case"ENDLIST":L.live=!1;break;case"#":(G||q)&&B.tagList.push(q?[G,q]:[G]);break;case"DIS":F++;case"GAP":B.tagList.push([Q]);break;case"BITRATE":B.tagList.push([Q,G]);break;case"DISCONTINUITY-SEQ":F=parseInt(G);break;case"KEY":{var se,oe=new p.AttrList(G),J=oe.enumeratedString("METHOD"),ae=oe.URI,fe=oe.hexadecimalInteger("IV"),de=oe.enumeratedString("KEYFORMATVERSIONS"),ve=oe.enumeratedString("KEYID"),ue=(se=oe.enumeratedString("KEYFORMAT"))!=null?se:"identity",_e=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(_e.indexOf(ue)>-1){f.logger.warn("Keyformat "+ue+" is not supported from the manifest");continue}else if(ue!=="identity")continue;J&&(K=T.LevelKey.fromURL(D,ae),ae&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(J)>=0&&(K.method=J,K.keyFormat=ue,ve&&(K.keyID=ve),de&&(K.keyFormatVersions=de),K.iv=fe));break}case"START":{var he=new p.AttrList(G),ye=he.decimalFloatingPoint("TIME-OFFSET");Object(S.isFiniteNumber)(ye)&&(L.startTimeOffset=ye);break}case"MAP":{var W=new p.AttrList(G);B.relurl=W.URI,W.BYTERANGE&&B.setByteRange(W.BYTERANGE),B.level=y,B.sn="initSegment",K&&(B.levelkey=K),B.initSegment=null,b=B,Z=!0;break}case"SERVER-CONTROL":{var z=new p.AttrList(G);L.canBlockReload=z.bool("CAN-BLOCK-RELOAD"),L.canSkipUntil=z.optionalFloat("CAN-SKIP-UNTIL",0),L.canSkipDateRanges=L.canSkipUntil>0&&z.bool("CAN-SKIP-DATERANGES"),L.partHoldBack=z.optionalFloat("PART-HOLD-BACK",0),L.holdBack=z.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var V=new p.AttrList(G);L.partTarget=V.decimalFloatingPoint("PART-TARGET");break}case"PART":{var $=L.partList;$||($=L.partList=[]);var H=P>0?$[$.length-1]:void 0,re=P++,ce=new m.Part(new p.AttrList(G),B,D,re,H);$.push(ce),B.duration+=ce.duration;break}case"PRELOAD-HINT":{var me=new p.AttrList(G);L.preloadHint=me;break}case"RENDITION-REPORT":{var Ee=new p.AttrList(G);L.renditionReports=L.renditionReports||[],L.renditionReports.push(Ee);break}default:f.logger.warn("line parsed but not handled: "+U);break}}}k&&!k.relurl?(I.pop(),w-=k.duration,L.partList&&(L.fragmentHint=k)):L.partList&&(l(B,k),B.cc=F,L.fragmentHint=B);var Se=I.length,xe=I[0],Le=I[Se-1];if(w+=L.skippedSegments*L.targetduration,w>0&&Se&&Le){L.averagetargetduration=w/Se;var be=Le.sn;L.endSN=be!=="initSegment"?be:0,xe&&(L.startCC=xe.cc,xe.initSegment||L.fragments.every(function(Re){return Re.relurl&&r(Re.relurl)})&&(f.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),B=new m.Fragment(E,D),B.relurl=Le.relurl,B.level=y,B.sn="initSegment",xe.initSegment=B,L.needSidxRanges=!0))}else L.endSN=0,L.startCC=0;return L.fragmentHint&&(w+=L.fragmentHint.duration),L.totalduration=w,L.endCC=F,N>0&&s(I,N),L},a}();function i(a,g){["video","audio","text"].forEach(function(A){var D=a.filter(function(E){return Object(n.isCodecType)(E,A)});if(D.length){var y=D.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});g[A+"Codec"]=y.length>0?y[0]:D[0],a=a.filter(function(E){return D.indexOf(E)===-1})}}),g.unknownCodecs=a}function e(a,g,A){var D=g[A];D&&(a[A]=D)}function s(a,g){for(var A=a[g],D=g;D--;){var y=a[D];if(!y)return;y.programDateTime=A.programDateTime-y.duration*1e3,A=y}}function l(a,g){a.rawProgramDateTime?a.programDateTime=Date.parse(a.rawProgramDateTime):g!=null&&g.programDateTime&&(a.programDateTime=g.endProgramDateTime),Object(S.isFiniteNumber)(a.programDateTime)||(a.programDateTime=null,a.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),h=x("./src/events.ts"),m=x("./src/errors.ts"),M=x("./src/utils/logger.ts"),T=x("./src/utils/mp4-tools.ts"),p=x("./src/loader/m3u8-parser.ts"),f=x("./src/types/loader.ts"),n=x("./src/utils/attr-list.ts");function d(c){var u=c.type;switch(u){case f.PlaylistContextType.AUDIO_TRACK:return f.PlaylistLevelType.AUDIO;case f.PlaylistContextType.SUBTITLE_TRACK:return f.PlaylistLevelType.SUBTITLE;default:return f.PlaylistLevelType.MAIN}}function o(c,u){var r=c.url;return(r===void 0||r.indexOf("data:")===0)&&(r=u.url),r}var v=function(){function c(r){this.hls=void 0,this.loaders=Object.create(null),this.hls=r,this.registerListeners()}var u=c.prototype;return u.registerListeners=function(){var t=this.hls;t.on(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(h.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(h.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(h.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},u.unregisterListeners=function(){var t=this.hls;t.off(h.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(h.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(h.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(h.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},u.createInternalLoader=function(t){var i=this.hls.config,e=i.pLoader,s=i.loader,l=e||s,a=new l(i);return t.loader=a,this.loaders[t.type]=a,a},u.getInternalLoader=function(t){return this.loaders[t.type]},u.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},u.destroyInternalLoaders=function(){for(var t in this.loaders){var i=this.loaders[t];i&&i.destroy(),this.resetInternalLoader(t)}},u.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},u.onManifestLoading=function(t,i){var e=i.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:f.PlaylistContextType.MANIFEST,url:e,deliveryDirectives:null})},u.onLevelLoading=function(t,i){var e=i.id,s=i.level,l=i.url,a=i.deliveryDirectives;this.load({id:e,groupId:null,level:s,responseType:"text",type:f.PlaylistContextType.LEVEL,url:l,deliveryDirectives:a})},u.onAudioTrackLoading=function(t,i){var e=i.id,s=i.groupId,l=i.url,a=i.deliveryDirectives;this.load({id:e,groupId:s,level:null,responseType:"text",type:f.PlaylistContextType.AUDIO_TRACK,url:l,deliveryDirectives:a})},u.onSubtitleTrackLoading=function(t,i){var e=i.id,s=i.groupId,l=i.url,a=i.deliveryDirectives;this.load({id:e,groupId:s,level:null,responseType:"text",type:f.PlaylistContextType.SUBTITLE_TRACK,url:l,deliveryDirectives:a})},u.load=function(t){var i,e=this.hls.config,s=this.getInternalLoader(t);if(s){var l=s.context;if(l&&l.url===t.url){M.logger.trace("[playlist-loader]: playlist request ongoing");return}M.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),s.abort()}var a,g,A,D;switch(t.type){case f.PlaylistContextType.MANIFEST:a=e.manifestLoadingMaxRetry,g=e.manifestLoadingTimeOut,A=e.manifestLoadingRetryDelay,D=e.manifestLoadingMaxRetryTimeout;break;case f.PlaylistContextType.LEVEL:case f.PlaylistContextType.AUDIO_TRACK:case f.PlaylistContextType.SUBTITLE_TRACK:a=0,g=e.levelLoadingTimeOut;break;default:a=e.levelLoadingMaxRetry,g=e.levelLoadingTimeOut,A=e.levelLoadingRetryDelay,D=e.levelLoadingMaxRetryTimeout;break}if(s=this.createInternalLoader(t),(i=t.deliveryDirectives)!==null&&i!==void 0&&i.part){var y;if(t.type===f.PlaylistContextType.LEVEL&&t.level!==null?y=this.hls.levels[t.level].details:t.type===f.PlaylistContextType.AUDIO_TRACK&&t.id!==null?y=this.hls.audioTracks[t.id].details:t.type===f.PlaylistContextType.SUBTITLE_TRACK&&t.id!==null&&(y=this.hls.subtitleTracks[t.id].details),y){var E=y.partTarget,_=y.targetduration;E&&_&&(g=Math.min(Math.max(E*3,_*.8)*1e3,g))}}var L={timeout:g,maxRetry:a,retryDelay:A,maxRetryDelay:D,highWaterMark:0},I={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};s.load(t,L,I)},u.loadsuccess=function(t,i,e,s){if(s===void 0&&(s=null),e.isSidxRequest){this.handleSidxRequest(t,e),this.handlePlaylistLoaded(t,i,e,s);return}this.resetInternalLoader(e.type);var l=t.data;if(l.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(t,e,"no EXTM3U delimiter",s);return}i.parsing.start=performance.now(),l.indexOf("#EXTINF:")>0||l.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,i,e,s):this.handleMasterPlaylist(t,i,e,s)},u.loaderror=function(t,i,e){e===void 0&&(e=null),this.handleNetworkError(i,e,!1,t)},u.loadtimeout=function(t,i,e){e===void 0&&(e=null),this.handleNetworkError(i,e,!0)},u.handleMasterPlaylist=function(t,i,e,s){var l=this.hls,a=t.data,g=o(t,e),A=p.default.parseMasterPlaylist(a,g),D=A.levels,y=A.sessionData;if(!D.length){this.handleManifestParsingError(t,e,"no level found in manifest",s);return}var E=D.map(function(P){return{id:P.attrs.AUDIO,audioCodec:P.audioCodec}}),_=D.map(function(P){return{id:P.attrs.SUBTITLES,textCodec:P.textCodec}}),L=p.default.parseMasterPlaylistMedia(a,g,"AUDIO",E),I=p.default.parseMasterPlaylistMedia(a,g,"SUBTITLES",_),b=p.default.parseMasterPlaylistMedia(a,g,"CLOSED-CAPTIONS");if(L.length){var R=L.some(function(P){return!P.url});!R&&D[0].audioCodec&&!D[0].attrs.AUDIO&&(M.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),L.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new n.AttrList({}),bitrate:0,url:""}))}l.trigger(h.Events.MANIFEST_LOADED,{levels:D,audioTracks:L,subtitles:I,captions:b,url:g,stats:i,networkDetails:s,sessionData:y})},u.handleTrackOrLevelPlaylist=function(t,i,e,s){var l=this.hls,a=e.id,g=e.level,A=e.type,D=o(t,e),y=Object(S.isFiniteNumber)(a)?a:0,E=Object(S.isFiniteNumber)(g)?g:y,_=d(e),L=p.default.parseLevelPlaylist(t.data,D,E,_,y);if(!L.fragments.length){l.trigger(h.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:D,reason:"no fragments found in level",level:typeof e.level=="number"?e.level:void 0});return}if(A===f.PlaylistContextType.MANIFEST){var I={attrs:new n.AttrList({}),bitrate:0,details:L,name:"",url:D};l.trigger(h.Events.MANIFEST_LOADED,{levels:[I],audioTracks:[],url:D,stats:i,networkDetails:s,sessionData:null})}if(i.parsing.end=performance.now(),L.needSidxRanges){var b,R=(b=L.fragments[0].initSegment)===null||b===void 0?void 0:b.url;this.load({url:R,isSidxRequest:!0,type:A,level:g,levelDetails:L,id:a,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}e.levelDetails=L,this.handlePlaylistLoaded(t,i,e,s)},u.handleSidxRequest=function(t,i){var e=Object(T.parseSegmentIndex)(new Uint8Array(t.data));if(!!e){var s=e.references,l=i.levelDetails;s.forEach(function(a,g){var A=a.info,D=l.fragments[g];D.byteRange.length===0&&D.setByteRange(String(1+A.end-A.start)+"@"+String(A.start)),D.initSegment&&D.initSegment.setByteRange(String(e.moovEndOffset)+"@0")})}},u.handleManifestParsingError=function(t,i,e,s){this.hls.trigger(h.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:i.type===f.PlaylistContextType.MANIFEST,url:t.url,reason:e,response:t,context:i,networkDetails:s})},u.handleNetworkError=function(t,i,e,s){e===void 0&&(e=!1),M.logger.warn("[playlist-loader]: A network "+(e?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var l=m.ErrorDetails.UNKNOWN,a=!1,g=this.getInternalLoader(t);switch(t.type){case f.PlaylistContextType.MANIFEST:l=e?m.ErrorDetails.MANIFEST_LOAD_TIMEOUT:m.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case f.PlaylistContextType.LEVEL:l=e?m.ErrorDetails.LEVEL_LOAD_TIMEOUT:m.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case f.PlaylistContextType.AUDIO_TRACK:l=e?m.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:m.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;case f.PlaylistContextType.SUBTITLE_TRACK:l=e?m.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:m.ErrorDetails.SUBTITLE_LOAD_ERROR,a=!1;break}g&&this.resetInternalLoader(t.type);var A={type:m.ErrorTypes.NETWORK_ERROR,details:l,fatal:a,url:t.url,loader:g,context:t,networkDetails:i};s&&(A.response=s),this.hls.trigger(h.Events.ERROR,A)},u.handlePlaylistLoaded=function(t,i,e,s){var l=e.type,a=e.level,g=e.id,A=e.groupId,D=e.loader,y=e.levelDetails,E=e.deliveryDirectives;if(!(y!=null&&y.targetduration)){this.handleManifestParsingError(t,e,"invalid target duration",s);return}if(!!D)switch(y.live&&(D.getCacheAge&&(y.ageHeader=D.getCacheAge()||0),(!D.getCacheAge||isNaN(y.ageHeader))&&(y.ageHeader=0)),l){case f.PlaylistContextType.MANIFEST:case f.PlaylistContextType.LEVEL:this.hls.trigger(h.Events.LEVEL_LOADED,{details:y,level:a||0,id:g||0,stats:i,networkDetails:s,deliveryDirectives:E});break;case f.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(h.Events.AUDIO_TRACK_LOADED,{details:y,id:g||0,groupId:A||"",stats:i,networkDetails:s,deliveryDirectives:E});break;case f.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(h.Events.SUBTITLE_TRACK_LOADED,{details:y,id:g||0,groupId:A||"",stats:i,networkDetails:s,deliveryDirectives:E});break}},c}();C.default=v},"./src/polyfills/number.ts":function(O,C,x){x.r(C),x.d(C,"isFiniteNumber",function(){return S}),x.d(C,"MAX_SAFE_INTEGER",function(){return h});var S=Number.isFinite||function(m){return typeof m=="number"&&isFinite(m)},h=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(O,C,x){x.r(C);var S=function(){function h(){}return h.getSilentFrame=function(M,T){switch(M){case"mp4a.40.2":if(T===1)return new Uint8Array([0,200,0,128,35,128]);if(T===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(T===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(T===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(T===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(T===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(T===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(T===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(T===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},h}();C.default=S},"./src/remux/mp4-generator.ts":function(O,C,x){x.r(C);var S=Math.pow(2,32)-1,h=function(){function m(){}return m.init=function(){m.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var T;for(T in m.types)m.types.hasOwnProperty(T)&&(m.types[T]=[T.charCodeAt(0),T.charCodeAt(1),T.charCodeAt(2),T.charCodeAt(3)]);var p=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),f=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);m.HDLR_TYPES={video:p,audio:f};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),d=new Uint8Array([0,0,0,0,0,0,0,0]);m.STTS=m.STSC=m.STCO=d,m.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),m.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),m.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),m.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),v=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);m.FTYP=m.box(m.types.ftyp,o,c,o,v),m.DINF=m.box(m.types.dinf,m.box(m.types.dref,n))},m.box=function(T){for(var p=8,f=arguments.length,n=new Array(f>1?f-1:0),d=1;d<f;d++)n[d-1]=arguments[d];for(var o=n.length,v=o;o--;)p+=n[o].byteLength;var c=new Uint8Array(p);for(c[0]=p>>24&255,c[1]=p>>16&255,c[2]=p>>8&255,c[3]=p&255,c.set(T,4),o=0,p=8;o<v;o++)c.set(n[o],p),p+=n[o].byteLength;return c},m.hdlr=function(T){return m.box(m.types.hdlr,m.HDLR_TYPES[T])},m.mdat=function(T){return m.box(m.types.mdat,T)},m.mdhd=function(T,p){p*=T;var f=Math.floor(p/(S+1)),n=Math.floor(p%(S+1));return m.box(m.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,T>>24&255,T>>16&255,T>>8&255,T&255,f>>24,f>>16&255,f>>8&255,f&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))},m.mdia=function(T){return m.box(m.types.mdia,m.mdhd(T.timescale,T.duration),m.hdlr(T.type),m.minf(T))},m.mfhd=function(T){return m.box(m.types.mfhd,new Uint8Array([0,0,0,0,T>>24,T>>16&255,T>>8&255,T&255]))},m.minf=function(T){return T.type==="audio"?m.box(m.types.minf,m.box(m.types.smhd,m.SMHD),m.DINF,m.stbl(T)):m.box(m.types.minf,m.box(m.types.vmhd,m.VMHD),m.DINF,m.stbl(T))},m.moof=function(T,p,f){return m.box(m.types.moof,m.mfhd(T),m.traf(f,p))},m.moov=function(T){for(var p=T.length,f=[];p--;)f[p]=m.trak(T[p]);return m.box.apply(null,[m.types.moov,m.mvhd(T[0].timescale,T[0].duration)].concat(f).concat(m.mvex(T)))},m.mvex=function(T){for(var p=T.length,f=[];p--;)f[p]=m.trex(T[p]);return m.box.apply(null,[m.types.mvex].concat(f))},m.mvhd=function(T,p){p*=T;var f=Math.floor(p/(S+1)),n=Math.floor(p%(S+1)),d=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,T>>24&255,T>>16&255,T>>8&255,T&255,f>>24,f>>16&255,f>>8&255,f&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return m.box(m.types.mvhd,d)},m.sdtp=function(T){var p=T.samples||[],f=new Uint8Array(4+p.length),n,d;for(n=0;n<p.length;n++)d=p[n].flags,f[n+4]=d.dependsOn<<4|d.isDependedOn<<2|d.hasRedundancy;return m.box(m.types.sdtp,f)},m.stbl=function(T){return m.box(m.types.stbl,m.stsd(T),m.box(m.types.stts,m.STTS),m.box(m.types.stsc,m.STSC),m.box(m.types.stsz,m.STSZ),m.box(m.types.stco,m.STCO))},m.avc1=function(T){var p=[],f=[],n,d,o;for(n=0;n<T.sps.length;n++)d=T.sps[n],o=d.byteLength,p.push(o>>>8&255),p.push(o&255),p=p.concat(Array.prototype.slice.call(d));for(n=0;n<T.pps.length;n++)d=T.pps[n],o=d.byteLength,f.push(o>>>8&255),f.push(o&255),f=f.concat(Array.prototype.slice.call(d));var v=m.box(m.types.avcC,new Uint8Array([1,p[3],p[4],p[5],255,224|T.sps.length].concat(p).concat([T.pps.length]).concat(f))),c=T.width,u=T.height,r=T.pixelRatio[0],t=T.pixelRatio[1];return m.box(m.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),v,m.box(m.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),m.box(m.types.pasp,new Uint8Array([r>>24,r>>16&255,r>>8&255,r&255,t>>24,t>>16&255,t>>8&255,t&255])))},m.esds=function(T){var p=T.config.length;return new Uint8Array([0,0,0,0,3,23+p,0,1,0,4,15+p,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([p]).concat(T.config).concat([6,1,2]))},m.mp4a=function(T){var p=T.samplerate;return m.box(m.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,T.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]),m.box(m.types.esds,m.esds(T)))},m.mp3=function(T){var p=T.samplerate;return m.box(m.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,T.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]))},m.stsd=function(T){return T.type==="audio"?!T.isAAC&&T.codec==="mp3"?m.box(m.types.stsd,m.STSD,m.mp3(T)):m.box(m.types.stsd,m.STSD,m.mp4a(T)):m.box(m.types.stsd,m.STSD,m.avc1(T))},m.tkhd=function(T){var p=T.id,f=T.duration*T.timescale,n=T.width,d=T.height,o=Math.floor(f/(S+1)),v=Math.floor(f%(S+1));return m.box(m.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,p>>24&255,p>>16&255,p>>8&255,p&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,v>>24,v>>16&255,v>>8&255,v&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,d>>8&255,d&255,0,0]))},m.traf=function(T,p){var f=m.sdtp(T),n=T.id,d=Math.floor(p/(S+1)),o=Math.floor(p%(S+1));return m.box(m.types.traf,m.box(m.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),m.box(m.types.tfdt,new Uint8Array([1,0,0,0,d>>24,d>>16&255,d>>8&255,d&255,o>>24,o>>16&255,o>>8&255,o&255])),m.trun(T,f.length+16+20+8+16+8+8),f)},m.trak=function(T){return T.duration=T.duration||4294967295,m.box(m.types.trak,m.tkhd(T),m.mdia(T))},m.trex=function(T){var p=T.id;return m.box(m.types.trex,new Uint8Array([0,0,0,0,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},m.trun=function(T,p){var f=T.samples||[],n=f.length,d=12+16*n,o=new Uint8Array(d),v,c,u,r,t,i;for(p+=8+d,o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255],0),v=0;v<n;v++)c=f[v],u=c.duration,r=c.size,t=c.flags,i=c.cts,o.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t.isLeading<<2|t.dependsOn,t.isDependedOn<<6|t.hasRedundancy<<4|t.paddingValue<<1|t.isNonSync,t.degradPrio&240<<8,t.degradPrio&15,i>>>24&255,i>>>16&255,i>>>8&255,i&255],12+16*v);return m.box(m.types.trun,o)},m.initSegment=function(T){m.types||m.init();var p=m.moov(T),f=new Uint8Array(m.FTYP.byteLength+p.byteLength);return f.set(m.FTYP),f.set(p,m.FTYP.byteLength),f},m}();h.types=void 0,h.HDLR_TYPES=void 0,h.STTS=void 0,h.STSC=void 0,h.STCO=void 0,h.STSZ=void 0,h.VMHD=void 0,h.SMHD=void 0,h.STSD=void 0,h.FTYP=void 0,h.DINF=void 0,C.default=h},"./src/remux/mp4-remuxer.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return i}),x.d(C,"normalizePts",function(){return e});var S=x("./src/polyfills/number.ts"),h=x("./src/remux/aac-helper.ts"),m=x("./src/remux/mp4-generator.ts"),M=x("./src/events.ts"),T=x("./src/errors.ts"),p=x("./src/utils/logger.ts"),f=x("./src/types/loader.ts"),n=x("./src/utils/timescale-conversion.ts");function d(){return d=Object.assign||function(g){for(var A=1;A<arguments.length;A++){var D=arguments[A];for(var y in D)Object.prototype.hasOwnProperty.call(D,y)&&(g[y]=D[y])}return g},d.apply(this,arguments)}var o=10*1e3,v=1024,c=1152,u=null,r=null,t=!1,i=function(){function g(D,y,E,_){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=D,this.config=y,this.typeSupported=E,this.ISGenerated=!1,u===null){var L=navigator.userAgent||"",I=L.match(/Chrome\/(\d+)/i);u=I?parseInt(I[1]):0}if(r===null){var b=navigator.userAgent.match(/Safari\/(\d+)/i);r=b?parseInt(b[1]):0}t=!!u&&u<75||!!r&&r<600}var A=g.prototype;return A.destroy=function(){},A.resetTimeStamp=function(y){p.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=y},A.resetNextTimestamp=function(){p.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},A.resetInitSegment=function(){p.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},A.getVideoStartPts=function(y){var E=!1,_=y.reduce(function(L,I){var b=I.pts-L;return b<-4294967296?(E=!0,e(L,I.pts)):b>0?L:I.pts},y[0].pts);return E&&p.logger.debug("PTS rollover detected"),_},A.remux=function(y,E,_,L,I,b,R,P){var w,F,k,B,U,j,K=I,N=I,Z=y.pid>-1,X=E.pid>-1,Y=E.samples.length,ee=y.samples.length>0,Q=Y>1,G=(!Z||ee)&&(!X||Q)||this.ISGenerated||R;if(G){this.ISGenerated||(k=this.generateIS(y,E,I));var q=this.isVideoContiguous,te=-1;if(Q&&(te=s(E.samples),!q&&this.config.forceKeyFrameOnDiscontinuity))if(j=!0,te>0){p.logger.warn("[mp4-remuxer]: Dropped "+te+" out of "+Y+" video samples due to a missing keyframe");var ie=this.getVideoStartPts(E.samples);E.samples=E.samples.slice(te),E.dropped+=te,N+=(E.samples[0].pts-ie)/(E.timescale||9e4)}else te===-1&&(p.logger.warn("[mp4-remuxer]: No keyframe found out of "+Y+" video samples"),j=!1);if(this.ISGenerated){if(ee&&Q){var ne=this.getVideoStartPts(E.samples),le=e(y.samples[0].pts,ne)-ne,se=le/E.inputTimeScale;K+=Math.max(0,se),N+=Math.max(0,-se)}if(ee){if(y.samplerate||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),k=this.generateIS(y,E,I)),F=this.remuxAudio(y,K,this.isAudioContiguous,b,X||Q||P===f.PlaylistLevelType.AUDIO?N:void 0),Q){var oe=F?F.endPTS-F.startPTS:0;E.inputTimeScale||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),k=this.generateIS(y,E,I)),w=this.remuxVideo(E,N,q,oe)}}else Q&&(w=this.remuxVideo(E,N,q,0));w&&(w.firstKeyFrame=te,w.independent=te!==-1)}}return this.ISGenerated&&(_.samples.length&&(U=this.remuxID3(_,I)),L.samples.length&&(B=this.remuxText(L,I))),{audio:F,video:w,initSegment:k,independent:j,text:B,id3:U}},A.generateIS=function(y,E,_){var L=y.samples,I=E.samples,b=this.typeSupported,R={},P=!Object(S.isFiniteNumber)(this._initPTS),w="audio/mp4",F,k,B;if(P&&(F=k=1/0),y.config&&L.length&&(y.timescale=y.samplerate,y.isAAC||(b.mpeg?(w="audio/mpeg",y.codec=""):b.mp3&&(y.codec="mp3")),R.audio={id:"audio",container:w,codec:y.codec,initSegment:!y.isAAC&&b.mpeg?new Uint8Array(0):m.default.initSegment([y]),metadata:{channelCount:y.channelCount}},P&&(B=y.inputTimeScale,F=k=L[0].pts-Math.round(B*_))),E.sps&&E.pps&&I.length&&(E.timescale=E.inputTimeScale,R.video={id:"main",container:"video/mp4",codec:E.codec,initSegment:m.default.initSegment([E]),metadata:{width:E.width,height:E.height}},P)){B=E.inputTimeScale;var U=this.getVideoStartPts(I),j=Math.round(B*_);k=Math.min(k,e(I[0].dts,U)-j),F=Math.min(F,U-j)}if(Object.keys(R).length)return this.ISGenerated=!0,P&&(this._initPTS=F,this._initDTS=k),{tracks:R,initPTS:F,timescale:B}},A.remuxVideo=function(y,E,_,L){var I=y.inputTimeScale,b=y.samples,R=[],P=b.length,w=this._initPTS,F=this.nextAvcDts,k=8,B,U,j,K=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,Z=0,X=!1;if(!_||F===null){var Y=E*I,ee=b[0].pts-e(b[0].dts,b[0].pts);F=Y-ee}for(var Q=0;Q<P;Q++){var G=b[Q];if(G.pts=e(G.pts-w,F),G.dts=e(G.dts-w,F),G.dts>G.pts){var q=18e3;Z=Math.max(Math.min(Z,G.pts-G.dts),-1*q)}G.dts<b[Q>0?Q-1:Q].dts&&(X=!0)}X&&b.sort(function(Pe,Be){var Ze=Pe.dts-Be.dts,Qe=Pe.pts-Be.pts;return Ze||Qe}),U=b[0].dts,j=b[b.length-1].dts;var te=Math.round((j-U)/(P-1));if(Z<0){if(Z<te*-2){p.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(n.toMsFromMpegTsClock)(-te,!0)+" ms");for(var ie=Z,ne=0;ne<P;ne++)b[ne].dts=ie=Math.max(ie,b[ne].pts-te),b[ne].pts=Math.max(ie,b[ne].pts)}else{p.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(n.toMsFromMpegTsClock)(Z,!0)+" ms to overcome this issue");for(var le=0;le<P;le++)b[le].dts=b[le].dts+Z}U=b[0].dts}if(_){var se=U-F,oe=se>te,J=se<-1;if(oe||J){oe?p.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(se,!0)+" ms ("+se+"dts) hole between fragments detected, filling it"):p.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(-se,!0)+" ms ("+se+"dts) overlapping between fragments detected"),U=F;var ae=b[0].pts-se;b[0].dts=U,b[0].pts=ae,p.logger.log("Video: First PTS/DTS adjusted: "+Object(n.toMsFromMpegTsClock)(ae,!0)+"/"+Object(n.toMsFromMpegTsClock)(U,!0)+", delta: "+Object(n.toMsFromMpegTsClock)(se,!0)+" ms")}}t&&(U=Math.max(0,U));for(var fe=0,de=0,ve=0;ve<P;ve++){for(var ue=b[ve],_e=ue.units,he=_e.length,ye=0,W=0;W<he;W++)ye+=_e[W].data.length;de+=ye,fe+=he,ue.length=ye,ue.dts=Math.max(ue.dts,U),ue.pts=Math.max(ue.pts,ue.dts,0),K=Math.min(ue.pts,K),N=Math.max(ue.pts,N)}j=b[P-1].dts;var z=de+4*fe+8,V;try{V=new Uint8Array(z)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:T.ErrorTypes.MUX_ERROR,details:T.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:z,reason:"fail allocating video mdat "+z});return}var $=new DataView(V.buffer);$.setUint32(0,z),V.set(m.default.types.mdat,4);for(var H=0;H<P;H++){for(var re=b[H],ce=re.units,me=0,Ee=0,Se=ce.length;Ee<Se;Ee++){var xe=ce[Ee],Le=xe.data,be=xe.data.byteLength;$.setUint32(k,be),k+=4,V.set(Le,k),k+=be,me+=4+be}if(H<P-1)B=b[H+1].dts-re.dts;else{var Re=this.config,Oe=re.dts-b[H>0?H-1:H].dts;if(Re.stretchShortVideoTrack&&this.nextAudioPts!==null){var Ge=Math.floor(Re.maxBufferHole*I),Ce=(L?K+L*I:this.nextAudioPts)-re.pts;Ce>Ge?(B=Ce-Oe,B<0&&(B=Oe),p.logger.log("[mp4-remuxer]: It is approximately "+Ce/90+" ms to the next segment; using duration "+B/90+" ms for the last video frame.")):B=Oe}else B=Oe}var ze=Math.round(re.pts-re.dts);R.push(new l(re.key,B,me,ze))}if(R.length&&u&&u<70){var ke=R[0].flags;ke.dependsOn=2,ke.isNonSync=0}console.assert(B!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=F=j+B,this.isVideoContiguous=!0;var Ve=m.default.moof(y.sequenceNumber++,U,d({},y,{samples:R})),He="video",Ye={data1:Ve,data2:V,startPTS:K/I,endPTS:(N+B)/I,startDTS:U/I,endDTS:F/I,type:He,hasAudio:!1,hasVideo:!0,nb:R.length,dropped:y.dropped};return y.samples=[],y.dropped=0,console.assert(V.length,"MDAT length must not be zero"),Ye},A.remuxAudio=function(y,E,_,L,I){var b=y.inputTimeScale,R=y.samplerate?y.samplerate:b,P=b/R,w=y.isAAC?v:c,F=w*P,k=this._initPTS,B=!y.isAAC&&this.typeSupported.mpeg,U=[],j=y.samples,K=B?0:8,N=this.nextAudioPts||-1,Z=E*b;if(this.isAudioContiguous=_=_||j.length&&N>0&&(L&&Math.abs(Z-N)<9e3||Math.abs(e(j[0].pts-k,Z)-N)<20*F),j.forEach(function(Le){Le.pts=e(Le.pts-k,Z)}),!_||N<0){if(j=j.filter(function(Le){return Le.pts>=0}),!j.length)return;I===0?N=0:L?N=Math.max(0,Z):N=j[0].pts}if(y.isAAC)for(var X=I!==void 0,Y=this.config.maxAudioFramesDrift,ee=0,Q=N;ee<j.length;ee++){var G=j[ee],q=G.pts,te=q-Q,ie=Math.abs(1e3*te/b);if(te<=-Y*F&&X)ee===0&&(p.logger.warn("Audio frame @ "+(q/b).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*te/b)+" ms."),this.nextAudioPts=N=Q=q);else if(te>=Y*F&&ie<o&&X){var ne=Math.round(te/F);Q=q-ne*F,Q<0&&(ne--,Q+=F),ee===0&&(this.nextAudioPts=N=Q),p.logger.warn("[mp4-remuxer]: Injecting "+ne+" audio frame @ "+(Q/b).toFixed(3)+"s due to "+Math.round(1e3*te/b)+" ms gap.");for(var le=0;le<ne;le++){var se=Math.max(Q,0),oe=h.default.getSilentFrame(y.manifestCodec||y.codec,y.channelCount);oe||(p.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=G.unit.subarray()),j.splice(ee,0,{unit:oe,pts:se}),Q+=F,ee++}}G.pts=Q,Q+=F}for(var J=null,ae=null,fe,de=0,ve=j.length;ve--;)de+=j[ve].unit.byteLength;for(var ue=0,_e=j.length;ue<_e;ue++){var he=j[ue],ye=he.unit,W=he.pts;if(ae!==null){var z=U[ue-1];z.duration=Math.round((W-ae)/P)}else if(_&&y.isAAC&&(W=N),J=W,de>0){de+=K;try{fe=new Uint8Array(de)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:T.ErrorTypes.MUX_ERROR,details:T.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:de,reason:"fail allocating audio mdat "+de});return}if(!B){var V=new DataView(fe.buffer);V.setUint32(0,de),fe.set(m.default.types.mdat,4)}}else return;fe.set(ye,K);var $=ye.byteLength;K+=$,U.push(new l(!0,w,$,0)),ae=W}var H=U.length;if(!!H){var re=U[U.length-1];this.nextAudioPts=N=ae+P*re.duration;var ce=B?new Uint8Array(0):m.default.moof(y.sequenceNumber++,J/P,d({},y,{samples:U}));y.samples=[];var me=J/b,Ee=N/b,Se="audio",xe={data1:ce,data2:fe,startPTS:me,endPTS:Ee,startDTS:me,endDTS:Ee,type:Se,hasAudio:!0,hasVideo:!1,nb:H};return this.isAudioContiguous=!0,console.assert(fe.length,"MDAT length must not be zero"),xe}},A.remuxEmptyAudio=function(y,E,_,L){var I=y.inputTimeScale,b=y.samplerate?y.samplerate:I,R=I/b,P=this.nextAudioPts,w=(P!==null?P:L.startDTS*I)+this._initDTS,F=L.endDTS*I+this._initDTS,k=R*v,B=Math.ceil((F-w)/k),U=h.default.getSilentFrame(y.manifestCodec||y.codec,y.channelCount);if(p.logger.warn("[mp4-remuxer]: remux empty Audio"),!U){p.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var j=[],K=0;K<B;K++){var N=w+K*k;j.push({unit:U,pts:N,dts:N})}return y.samples=j,this.remuxAudio(y,E,_,!1)},A.remuxID3=function(y,E){var _=y.samples.length;if(!!_){for(var L=y.inputTimeScale,I=this._initPTS,b=this._initDTS,R=0;R<_;R++){var P=y.samples[R];P.pts=e(P.pts-I,E*L)/L,P.dts=e(P.dts-b,E*L)/L}var w=y.samples;return y.samples=[],{samples:w}}},A.remuxText=function(y,E){var _=y.samples.length;if(!!_){for(var L=y.inputTimeScale,I=this._initPTS,b=0;b<_;b++){var R=y.samples[b];R.pts=e(R.pts-I,E*L)/L}y.samples.sort(function(w,F){return w.pts-F.pts});var P=y.samples;return y.samples=[],{samples:P}}},g}();function e(g,A){var D;if(A===null)return g;for(A<g?D=-8589934592:D=8589934592;Math.abs(g-A)>4294967296;)g+=D;return g}function s(g){for(var A=0;A<g.length;A++)if(g[A].key)return A;return-1}var l=function(A,D,y,E){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=D,this.size=y,this.cts=E,this.flags=new a(A)},a=function(A){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=A?2:1,this.isNonSync=A?0:1}},"./src/remux/passthrough-remuxer.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),h=x("./src/utils/mp4-tools.ts"),m=x("./src/loader/fragment.ts"),M=x("./src/utils/logger.ts"),T=function(){function n(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var d=n.prototype;return d.destroy=function(){},d.resetTimeStamp=function(v){this.initPTS=v,this.lastEndDTS=null},d.resetNextTimestamp=function(){this.lastEndDTS=null},d.resetInitSegment=function(v,c,u){this.audioCodec=c,this.videoCodec=u,this.generateInitSegment(v),this.emitInitSegment=!0},d.generateInitSegment=function(v){var c=this.audioCodec,u=this.videoCodec;if(!v||!v.byteLength){this.initTracks=void 0,this.initData=void 0;return}var r=this.initData=Object(h.parseInitSegment)(v);c||(c=f(r.audio,m.ElementaryStreamTypes.AUDIO)),u||(u=f(r.video,m.ElementaryStreamTypes.VIDEO));var t={};r.audio&&r.video?t.audiovideo={container:"video/mp4",codec:c+","+u,initSegment:v,id:"main"}:r.audio?t.audio={container:"audio/mp4",codec:c,initSegment:v,id:"audio"}:r.video?t.video={container:"video/mp4",codec:u,initSegment:v,id:"main"}:M.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=t},d.remux=function(v,c,u,r,t){var i=this.initPTS,e=this.lastEndDTS,s={audio:void 0,video:void 0,text:r,id3:u,initSegment:void 0};Object(S.isFiniteNumber)(e)||(e=this.lastEndDTS=t||0);var l=c.samples;if(!l||!l.length)return s;var a={initPTS:void 0,timescale:1},g=this.initData;if((!g||!g.length)&&(this.generateInitSegment(l),g=this.initData),!g||!g.length)return M.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),s;this.emitInitSegment&&(a.tracks=this.initTracks,this.emitInitSegment=!1),Object(S.isFiniteNumber)(i)||(this.initPTS=a.initPTS=i=p(g,l,e));var A=Object(h.getDuration)(l,g),D=e,y=A+D;Object(h.offsetStartDTS)(g,l,i),A>0?this.lastEndDTS=y:(M.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!g.audio,_=!!g.video,L="";E&&(L+="audio"),_&&(L+="video");var I={data1:l,startPTS:D,startDTS:D,endPTS:y,endDTS:y,type:L,hasAudio:E,hasVideo:_,nb:1,dropped:0};return s.audio=I.type==="audio"?I:void 0,s.video=I.type!=="audio"?I:void 0,s.text=r,s.id3=u,s.initSegment=a,s},n}(),p=function(d,o,v){return Object(h.getStartDTS)(d,o)-v};function f(n,d){var o=n==null?void 0:n.codec;return o&&o.length>4?o:o==="hvc1"?"hvc1.1.c.L120.90":o==="av01"?"av01.0.04M.08":o==="avc1"||d===m.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}C.default=T},"./src/task-loop.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function h(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var m=h.prototype;return m.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},m.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},m.onHandlerDestroyed=function(){},m.hasInterval=function(){return!!this._tickInterval},m.hasNextTick=function(){return!!this._tickTimer},m.setInterval=function(T){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,T),!0)},m.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},m.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},m.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},m.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},m.doTick=function(){},h}()},"./src/types/cmcd.ts":function(O,C,x){x.r(C),x.d(C,"CMCDVersion",function(){return S}),x.d(C,"CMCDObjectType",function(){return h}),x.d(C,"CMCDStreamingFormat",function(){return m}),x.d(C,"CMCDStreamType",function(){return M});var S=1,h;(function(T){T.MANIFEST="m",T.AUDIO="a",T.VIDEO="v",T.MUXED="av",T.INIT="i",T.CAPTION="c",T.TIMED_TEXT="tt",T.KEY="k",T.OTHER="o"})(h||(h={}));var m;(function(T){T.DASH="d",T.HLS="h",T.SMOOTH="s",T.OTHER="o"})(m||(m={}));var M;(function(T){T.VOD="v",T.LIVE="l"})(M||(M={}))},"./src/types/level.ts":function(O,C,x){x.r(C),x.d(C,"HlsSkip",function(){return m}),x.d(C,"getSkipValue",function(){return M}),x.d(C,"HlsUrlParameters",function(){return T}),x.d(C,"Level",function(){return p});function S(f,n){for(var d=0;d<n.length;d++){var o=n[d];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(f,o.key,o)}}function h(f,n,d){return n&&S(f.prototype,n),d&&S(f,d),f}var m;(function(f){f.No="",f.Yes="YES",f.v2="v2"})(m||(m={}));function M(f,n){var d=f.canSkipUntil,o=f.canSkipDateRanges,v=f.endSN,c=n!==void 0?n-v:0;return d&&c<d?o?m.v2:m.Yes:m.No}var T=function(){function f(d,o,v){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=d,this.part=o,this.skip=v}var n=f.prototype;return n.addDirectives=function(o){var v=new self.URL(o);return this.msn!==void 0&&v.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&v.searchParams.set("_HLS_part",this.part.toString()),this.skip&&v.searchParams.set("_HLS_skip",this.skip),v.toString()},f}(),p=function(){function f(n){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[n.url],this.attrs=n.attrs,this.bitrate=n.bitrate,n.details&&(this.details=n.details),this.id=n.id||0,this.name=n.name,this.width=n.width||0,this.height=n.height||0,this.audioCodec=n.audioCodec,this.videoCodec=n.videoCodec,this.unknownCodecs=n.unknownCodecs,this.codecSet=[n.videoCodec,n.audioCodec].filter(function(d){return d}).join(",").replace(/\.[^.,]+/g,"")}return h(f,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(d){var o=d%this.url.length;this._urlId!==o&&(this.details=void 0,this._urlId=o)}}]),f}()},"./src/types/loader.ts":function(O,C,x){x.r(C),x.d(C,"PlaylistContextType",function(){return S}),x.d(C,"PlaylistLevelType",function(){return h});var S;(function(m){m.MANIFEST="manifest",m.LEVEL="level",m.AUDIO_TRACK="audioTrack",m.SUBTITLE_TRACK="subtitleTrack"})(S||(S={}));var h;(function(m){m.MAIN="main",m.AUDIO="audio",m.SUBTITLE="subtitle"})(h||(h={}))},"./src/types/transmuxer.ts":function(O,C,x){x.r(C),x.d(C,"ChunkMetadata",function(){return S});var S=function(M,T,p,f,n,d){f===void 0&&(f=0),n===void 0&&(n=-1),d===void 0&&(d=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=h(),this.buffering={audio:h(),video:h(),audiovideo:h()},this.level=M,this.sn=T,this.id=p,this.size=f,this.part=n,this.partial=d};function h(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(O,C,x){x.r(C),x.d(C,"AttrList",function(){return m});var S=/^(\d+)x(\d+)$/,h=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,m=function(){function M(p){typeof p=="string"&&(p=M.parseAttrList(p));for(var f in p)p.hasOwnProperty(f)&&(this[f]=p[f])}var T=M.prototype;return T.decimalInteger=function(f){var n=parseInt(this[f],10);return n>Number.MAX_SAFE_INTEGER?1/0:n},T.hexadecimalInteger=function(f){if(this[f]){var n=(this[f]||"0x").slice(2);n=(n.length&1?"0":"")+n;for(var d=new Uint8Array(n.length/2),o=0;o<n.length/2;o++)d[o]=parseInt(n.slice(o*2,o*2+2),16);return d}else return null},T.hexadecimalIntegerAsNumber=function(f){var n=parseInt(this[f],16);return n>Number.MAX_SAFE_INTEGER?1/0:n},T.decimalFloatingPoint=function(f){return parseFloat(this[f])},T.optionalFloat=function(f,n){var d=this[f];return d?parseFloat(d):n},T.enumeratedString=function(f){return this[f]},T.bool=function(f){return this[f]==="YES"},T.decimalResolution=function(f){var n=S.exec(this[f]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}},M.parseAttrList=function(f){var n,d={},o='"';for(h.lastIndex=0;(n=h.exec(f))!==null;){var v=n[2];v.indexOf(o)===0&&v.lastIndexOf(o)===v.length-1&&(v=v.slice(1,-1)),d[n[1]]=v}return d},M}()},"./src/utils/binary-search.ts":function(O,C,x){x.r(C);var S={search:function(m,M){for(var T=0,p=m.length-1,f=null,n=null;T<=p;){f=(T+p)/2|0,n=m[f];var d=M(n);if(d>0)T=f+1;else if(d<0)p=f-1;else return n}return null}};C.default=S},"./src/utils/buffer-helper.ts":function(O,C,x){x.r(C),x.d(C,"BufferHelper",function(){return m});var S=x("./src/utils/logger.ts"),h={length:0,start:function(){return 0},end:function(){return 0}},m=function(){function M(){}return M.isBuffered=function(p,f){try{if(p){for(var n=M.getBuffered(p),d=0;d<n.length;d++)if(f>=n.start(d)&&f<=n.end(d))return!0}}catch{}return!1},M.bufferInfo=function(p,f,n){try{if(p){var d=M.getBuffered(p),o=[],v;for(v=0;v<d.length;v++)o.push({start:d.start(v),end:d.end(v)});return this.bufferedInfo(o,f,n)}}catch{}return{len:0,start:f,end:f,nextStart:void 0}},M.bufferedInfo=function(p,f,n){f=Math.max(0,f),p.sort(function(a,g){var A=a.start-g.start;return A||g.end-a.end});var d=[];if(n)for(var o=0;o<p.length;o++){var v=d.length;if(v){var c=d[v-1].end;p[o].start-c<n?p[o].end>c&&(d[v-1].end=p[o].end):d.push(p[o])}else d.push(p[o])}else d=p;for(var u=0,r,t=f,i=f,e=0;e<d.length;e++){var s=d[e].start,l=d[e].end;if(f+n>=s&&f<l)t=s,i=l,u=i-f;else if(f+n<s){r=s;break}}return{len:u,start:t||0,end:i||0,nextStart:r}},M.getBuffered=function(p){try{return p.buffered}catch(f){return S.logger.log("failed to get media.buffered",f),h}},M}()},"./src/utils/cea-608-parser.ts":function(O,C,x){x.r(C),x.d(C,"Row",function(){return i}),x.d(C,"CaptionScreen",function(){return e});var S=x("./src/utils/logger.ts"),h={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},m=function(y){var E=y;return h.hasOwnProperty(y)&&(E=h[y]),String.fromCharCode(E)},M=15,T=100,p={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},f={17:2,18:4,21:6,22:8,23:10,19:13,20:15},n={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},o=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],v;(function(D){D[D.ERROR=0]="ERROR",D[D.TEXT=1]="TEXT",D[D.WARNING=2]="WARNING",D[D.INFO=2]="INFO",D[D.DEBUG=3]="DEBUG",D[D.DATA=3]="DATA"})(v||(v={}));var c=function(){function D(){this.time=null,this.verboseLevel=v.ERROR}var y=D.prototype;return y.log=function(_,L){this.verboseLevel>=_&&S.logger.log(this.time+" ["+_+"] "+L)},D}(),u=function(y){for(var E=[],_=0;_<y.length;_++)E.push(y[_].toString(16));return E},r=function(){function D(E,_,L,I,b){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=E||"white",this.underline=_||!1,this.italics=L||!1,this.background=I||"black",this.flash=b||!1}var y=D.prototype;return y.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},y.setStyles=function(_){for(var L=["foreground","underline","italics","background","flash"],I=0;I<L.length;I++){var b=L[I];_.hasOwnProperty(b)&&(this[b]=_[b])}},y.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},y.equals=function(_){return this.foreground===_.foreground&&this.underline===_.underline&&this.italics===_.italics&&this.background===_.background&&this.flash===_.flash},y.copy=function(_){this.foreground=_.foreground,this.underline=_.underline,this.italics=_.italics,this.background=_.background,this.flash=_.flash},y.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},D}(),t=function(){function D(E,_,L,I,b,R){this.uchar=void 0,this.penState=void 0,this.uchar=E||" ",this.penState=new r(_,L,I,b,R)}var y=D.prototype;return y.reset=function(){this.uchar=" ",this.penState.reset()},y.setChar=function(_,L){this.uchar=_,this.penState.copy(L)},y.setPenState=function(_){this.penState.copy(_)},y.equals=function(_){return this.uchar===_.uchar&&this.penState.equals(_.penState)},y.copy=function(_){this.uchar=_.uchar,this.penState.copy(_.penState)},y.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},D}(),i=function(){function D(E){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var _=0;_<T;_++)this.chars.push(new t);this.logger=E,this.pos=0,this.currPenState=new r}var y=D.prototype;return y.equals=function(_){for(var L=!0,I=0;I<T;I++)if(!this.chars[I].equals(_.chars[I])){L=!1;break}return L},y.copy=function(_){for(var L=0;L<T;L++)this.chars[L].copy(_.chars[L])},y.isEmpty=function(){for(var _=!0,L=0;L<T;L++)if(!this.chars[L].isEmpty()){_=!1;break}return _},y.setCursor=function(_){this.pos!==_&&(this.pos=_),this.pos<0?(this.logger.log(v.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>T&&(this.logger.log(v.DEBUG,"Too large cursor position "+this.pos),this.pos=T)},y.moveCursor=function(_){var L=this.pos+_;if(_>1)for(var I=this.pos+1;I<L+1;I++)this.chars[I].setPenState(this.currPenState);this.setCursor(L)},y.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},y.insertChar=function(_){_>=144&&this.backSpace();var L=m(_);if(this.pos>=T){this.logger.log(v.ERROR,"Cannot insert "+_.toString(16)+" ("+L+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(L,this.currPenState),this.moveCursor(1)},y.clearFromPos=function(_){var L;for(L=_;L<T;L++)this.chars[L].reset()},y.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},y.clearToEndOfRow=function(){this.clearFromPos(this.pos)},y.getTextString=function(){for(var _=[],L=!0,I=0;I<T;I++){var b=this.chars[I].uchar;b!==" "&&(L=!1),_.push(b)}return L?"":_.join("")},y.setPenStyles=function(_){this.currPenState.setStyles(_);var L=this.chars[this.pos];L.setPenState(this.currPenState)},D}(),e=function(){function D(E){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var _=0;_<M;_++)this.rows.push(new i(E));this.logger=E,this.currRow=M-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var y=D.prototype;return y.reset=function(){for(var _=0;_<M;_++)this.rows[_].clear();this.currRow=M-1},y.equals=function(_){for(var L=!0,I=0;I<M;I++)if(!this.rows[I].equals(_.rows[I])){L=!1;break}return L},y.copy=function(_){for(var L=0;L<M;L++)this.rows[L].copy(_.rows[L])},y.isEmpty=function(){for(var _=!0,L=0;L<M;L++)if(!this.rows[L].isEmpty()){_=!1;break}return _},y.backSpace=function(){var _=this.rows[this.currRow];_.backSpace()},y.clearToEndOfRow=function(){var _=this.rows[this.currRow];_.clearToEndOfRow()},y.insertChar=function(_){var L=this.rows[this.currRow];L.insertChar(_)},y.setPen=function(_){var L=this.rows[this.currRow];L.setPenStyles(_)},y.moveCursor=function(_){var L=this.rows[this.currRow];L.moveCursor(_)},y.setCursor=function(_){this.logger.log(v.INFO,"setCursor: "+_);var L=this.rows[this.currRow];L.setCursor(_)},y.setPAC=function(_){this.logger.log(v.INFO,"pacData = "+JSON.stringify(_));var L=_.row-1;if(this.nrRollUpRows&&L<this.nrRollUpRows-1&&(L=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==L){for(var I=0;I<M;I++)this.rows[I].clear();var b=this.currRow+1-this.nrRollUpRows,R=this.lastOutputScreen;if(R){var P=R.rows[b].cueStartTime,w=this.logger.time;if(P&&w!==null&&P<w)for(var F=0;F<this.nrRollUpRows;F++)this.rows[L-this.nrRollUpRows+F+1].copy(R.rows[b+F])}}this.currRow=L;var k=this.rows[this.currRow];if(_.indent!==null){var B=_.indent,U=Math.max(B-1,0);k.setCursor(_.indent),_.color=k.chars[U].penState.foreground}var j={foreground:_.color,underline:_.underline,italics:_.italics,background:"black",flash:!1};this.setPen(j)},y.setBkgData=function(_){this.logger.log(v.INFO,"bkgData = "+JSON.stringify(_)),this.backSpace(),this.setPen(_),this.insertChar(32)},y.setRollUpRows=function(_){this.nrRollUpRows=_},y.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(v.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(v.TEXT,this.getDisplayText());var _=this.currRow+1-this.nrRollUpRows,L=this.rows.splice(_,1)[0];L.clear(),this.rows.splice(this.currRow,0,L),this.logger.log(v.INFO,"Rolling up")},y.getDisplayText=function(_){_=_||!1;for(var L=[],I="",b=-1,R=0;R<M;R++){var P=this.rows[R].getTextString();P&&(b=R+1,_?L.push("Row "+b+": '"+P+"'"):L.push(P.trim()))}return L.length>0&&(_?I="["+L.join(" | ")+"]":I=L.join(`
`)),I},y.getTextAndFormat=function(){return this.rows},D}(),s=function(){function D(E,_,L){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=E,this.outputFilter=_,this.mode=null,this.verbose=0,this.displayedMemory=new e(L),this.nonDisplayedMemory=new e(L),this.lastOutputScreen=new e(L),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=L}var y=D.prototype;return y.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},y.getHandler=function(){return this.outputFilter},y.setHandler=function(_){this.outputFilter=_},y.setPAC=function(_){this.writeScreen.setPAC(_)},y.setBkgData=function(_){this.writeScreen.setBkgData(_)},y.setMode=function(_){_!==this.mode&&(this.mode=_,this.logger.log(v.INFO,"MODE="+_),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=_)},y.insertChars=function(_){for(var L=0;L<_.length;L++)this.writeScreen.insertChar(_[L]);var I=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(v.INFO,I+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(v.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},y.ccRCL=function(){this.logger.log(v.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},y.ccBS=function(){this.logger.log(v.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},y.ccAOF=function(){},y.ccAON=function(){},y.ccDER=function(){this.logger.log(v.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},y.ccRU=function(_){this.logger.log(v.INFO,"RU("+_+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(_)},y.ccFON=function(){this.logger.log(v.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},y.ccRDC=function(){this.logger.log(v.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},y.ccTR=function(){this.logger.log(v.INFO,"TR"),this.setMode("MODE_TEXT")},y.ccRTD=function(){this.logger.log(v.INFO,"RTD"),this.setMode("MODE_TEXT")},y.ccEDM=function(){this.logger.log(v.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},y.ccCR=function(){this.logger.log(v.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},y.ccENM=function(){this.logger.log(v.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},y.ccEOC=function(){if(this.logger.log(v.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var _=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=_,this.writeScreen=this.nonDisplayedMemory,this.logger.log(v.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},y.ccTO=function(_){this.logger.log(v.INFO,"TO("+_+") - Tab Offset"),this.writeScreen.moveCursor(_)},y.ccMIDROW=function(_){var L={flash:!1};if(L.underline=_%2===1,L.italics=_>=46,L.italics)L.foreground="white";else{var I=Math.floor(_/2)-16,b=["white","green","blue","cyan","red","yellow","magenta"];L.foreground=b[I]}this.logger.log(v.INFO,"MIDROW: "+JSON.stringify(L)),this.writeScreen.setPen(L)},y.outputDataUpdate=function(_){_===void 0&&(_=!1);var L=this.logger.time;L!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=L:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,L,this.lastOutputScreen),_&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:L),this.lastOutputScreen.copy(this.displayedMemory))},y.cueSplitAtTime=function(_){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,_,this.displayedMemory),this.cueStartTime=_))},D}(),l=function(){function D(E,_,L){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var I=new c;this.channels=[null,new s(E,_,I),new s(E+1,L,I)],this.cmdHistory=A(),this.logger=I}var y=D.prototype;return y.getHandler=function(_){return this.channels[_].getHandler()},y.setHandler=function(_,L){this.channels[_].setHandler(L)},y.addData=function(_,L){var I,b,R,P=!1;this.logger.time=_;for(var w=0;w<L.length;w+=2)if(b=L[w]&127,R=L[w+1]&127,!(b===0&&R===0)){if(this.logger.log(v.DATA,"["+u([L[w],L[w+1]])+"] -> ("+u([b,R])+")"),I=this.parseCmd(b,R),I||(I=this.parseMidrow(b,R)),I||(I=this.parsePAC(b,R)),I||(I=this.parseBackgroundAttributes(b,R)),!I&&(P=this.parseChars(b,R),P)){var F=this.currentChannel;if(F&&F>0){var k=this.channels[F];k.insertChars(P)}else this.logger.log(v.WARNING,"No channel found yet. TEXT-MODE?")}!I&&!P&&this.logger.log(v.WARNING,"Couldn't parse cleaned data "+u([b,R])+" orig: "+u([L[w],L[w+1]]))}},y.parseCmd=function(_,L){var I=this.cmdHistory,b=(_===20||_===28||_===21||_===29)&&L>=32&&L<=47,R=(_===23||_===31)&&L>=33&&L<=35;if(!(b||R))return!1;if(g(_,L,I))return a(null,null,I),this.logger.log(v.DEBUG,"Repeated command ("+u([_,L])+") is dropped"),!0;var P=_===20||_===21||_===23?1:2,w=this.channels[P];return _===20||_===21||_===28||_===29?L===32?w.ccRCL():L===33?w.ccBS():L===34?w.ccAOF():L===35?w.ccAON():L===36?w.ccDER():L===37?w.ccRU(2):L===38?w.ccRU(3):L===39?w.ccRU(4):L===40?w.ccFON():L===41?w.ccRDC():L===42?w.ccTR():L===43?w.ccRTD():L===44?w.ccEDM():L===45?w.ccCR():L===46?w.ccENM():L===47&&w.ccEOC():w.ccTO(L-32),a(_,L,I),this.currentChannel=P,!0},y.parseMidrow=function(_,L){var I=0;if((_===17||_===25)&&L>=32&&L<=47){if(_===17?I=1:I=2,I!==this.currentChannel)return this.logger.log(v.ERROR,"Mismatch channel in midrow parsing"),!1;var b=this.channels[I];return b?(b.ccMIDROW(L),this.logger.log(v.DEBUG,"MIDROW ("+u([_,L])+")"),!0):!1}return!1},y.parsePAC=function(_,L){var I,b=this.cmdHistory,R=(_>=17&&_<=23||_>=25&&_<=31)&&L>=64&&L<=127,P=(_===16||_===24)&&L>=64&&L<=95;if(!(R||P))return!1;if(g(_,L,b))return a(null,null,b),!0;var w=_<=23?1:2;L>=64&&L<=95?I=w===1?p[_]:n[_]:I=w===1?f[_]:d[_];var F=this.channels[w];return F?(F.setPAC(this.interpretPAC(I,L)),a(_,L,b),this.currentChannel=w,!0):!1},y.interpretPAC=function(_,L){var I,b={color:null,italics:!1,indent:null,underline:!1,row:_};return L>95?I=L-96:I=L-64,b.underline=(I&1)===1,I<=13?b.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(I/2)]:I<=15?(b.italics=!0,b.color="white"):b.indent=Math.floor((I-16)/2)*4,b},y.parseChars=function(_,L){var I,b=null,R=null;if(_>=25?(I=2,R=_-8):(I=1,R=_),R>=17&&R<=19){var P;R===17?P=L+80:R===18?P=L+112:P=L+144,this.logger.log(v.INFO,"Special char '"+m(P)+"' in channel "+I),b=[P]}else _>=32&&_<=127&&(b=L===0?[_]:[_,L]);if(b){var w=u(b);this.logger.log(v.DEBUG,"Char codes =  "+w.join(",")),a(_,L,this.cmdHistory)}return b},y.parseBackgroundAttributes=function(_,L){var I=(_===16||_===24)&&L>=32&&L<=47,b=(_===23||_===31)&&L>=45&&L<=47;if(!(I||b))return!1;var R,P={};_===16||_===24?(R=Math.floor((L-32)/2),P.background=o[R],L%2===1&&(P.background=P.background+"_semi")):L===45?P.background="transparent":(P.foreground="black",L===47&&(P.underline=!0));var w=_<=23?1:2,F=this.channels[w];return F.setBkgData(P),a(_,L,this.cmdHistory),!0},y.reset=function(){for(var _=0;_<Object.keys(this.channels).length;_++){var L=this.channels[_];L&&L.reset()}this.cmdHistory=A()},y.cueSplitAtTime=function(_){for(var L=0;L<this.channels.length;L++){var I=this.channels[L];I&&I.cueSplitAtTime(_)}},D}();function a(D,y,E){E.a=D,E.b=y}function g(D,y,E){return E.a===D&&E.b===y}function A(){return{a:null,b:null}}C.default=l},"./src/utils/codecs.ts":function(O,C,x){x.r(C),x.d(C,"isCodecType",function(){return h}),x.d(C,"isCodecSupportedInMp4",function(){return m});var S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function h(M,T){var p=S[T];return!!p&&p[M.slice(0,4)]===!0}function m(M,T){return MediaSource.isTypeSupported((T||"video")+'/mp4;codecs="'+M+'"')}},"./src/utils/cues.ts":function(O,C,x){x.r(C);var S=x("./src/utils/vttparser.ts"),h=x("./src/utils/webvtt-parser.ts"),m=x("./src/utils/texttrack-utils.ts"),M=/\s/,T={newCue:function(f,n,d,o){for(var v=[],c,u,r,t,i,e=self.VTTCue||self.TextTrackCue,s=0;s<o.rows.length;s++)if(c=o.rows[s],r=!0,t=0,i="",!c.isEmpty()){for(var l=0;l<c.chars.length;l++)M.test(c.chars[l].uchar)&&r?t++:(i+=c.chars[l].uchar,r=!1);c.cueStartTime=n,n===d&&(d+=1e-4),t>=16?t--:t++;var a=Object(S.fixLineBreaks)(i.trim()),g=Object(h.generateCueId)(n,d,a);(!f||!f.cues||!f.cues.getCueById(g))&&(u=new e(n,d,a),u.id=g,u.line=s+1,u.align="left",u.position=10+Math.min(80,Math.floor(t*8/32)*10),v.push(u))}return f&&v.length&&(v.sort(function(A,D){return A.line==="auto"||D.line==="auto"?0:A.line>8&&D.line>8?D.line-A.line:A.line-D.line}),v.forEach(function(A){return Object(m.addCueToTrack)(f,A)})),v}};C.default=T},"./src/utils/discontinuities.ts":function(O,C,x){x.r(C),x.d(C,"findFirstFragWithCC",function(){return M}),x.d(C,"shouldAlignOnDiscontinuities",function(){return T}),x.d(C,"findDiscontinuousReferenceFrag",function(){return p}),x.d(C,"adjustSlidingStart",function(){return n}),x.d(C,"alignStream",function(){return d}),x.d(C,"alignPDT",function(){return v}),x.d(C,"alignFragmentByPDTDelta",function(){return c}),x.d(C,"alignMediaPlaylistByPDT",function(){return u});var S=x("./src/polyfills/number.ts"),h=x("./src/utils/logger.ts"),m=x("./src/controller/level-helper.ts");function M(r,t){for(var i=null,e=0,s=r.length;e<s;e++){var l=r[e];if(l&&l.cc===t){i=l;break}}return i}function T(r,t,i){return!!(t.details&&(i.endCC>i.startCC||r&&r.cc<i.startCC))}function p(r,t){var i=r.fragments,e=t.fragments;if(!e.length||!i.length){h.logger.log("No fragments to align");return}var s=M(i,e[0].cc);if(!s||s&&!s.startPTS){h.logger.log("No frag in previous level to align on");return}return s}function f(r,t){if(r){var i=r.start+t;r.start=r.startPTS=i,r.endPTS=i+r.duration}}function n(r,t){for(var i=t.fragments,e=0,s=i.length;e<s;e++)f(i[e],r);t.fragmentHint&&f(t.fragmentHint,r),t.alignedSliding=!0}function d(r,t,i){!t||(o(r,i,t),!i.alignedSliding&&t.details&&v(i,t.details),!i.alignedSliding&&t.details&&!i.skippedSegments&&Object(m.adjustSliding)(t.details,i))}function o(r,t,i){if(T(r,i,t)){var e=p(i.details,t);e&&Object(S.isFiniteNumber)(e.start)&&(h.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),n(e.start,t))}}function v(r,t){if(!(!t.fragments.length||!r.hasProgramDateTime||!t.hasProgramDateTime)){var i=t.fragments[0].programDateTime,e=r.fragments[0].programDateTime,s=(e-i)/1e3+t.fragments[0].start;s&&Object(S.isFiniteNumber)(s)&&(h.logger.log("Adjusting PTS using programDateTime delta "+(e-i)+"ms, sliding:"+s.toFixed(3)+" "+r.url+" "),n(s,r))}}function c(r,t){var i=r.programDateTime;if(!!i){var e=(i-t)/1e3;r.start=r.startPTS=e,r.endPTS=e+r.duration}}function u(r,t){if(!(!t.fragments.length||!r.hasProgramDateTime||!t.hasProgramDateTime)){var i=t.fragments[0].programDateTime,e=t.fragments[0].start,s=i-e*1e3;r.fragments.forEach(function(l){c(l,s)}),r.fragmentHint&&c(r.fragmentHint,s),r.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(O,C,x){x.r(C);var S=x("./src/utils/ewma.ts"),h=function(){function m(T,p,f){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=f,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new S.default(T),this.fast_=new S.default(p)}var M=m.prototype;return M.update=function(p,f){var n=this.slow_,d=this.fast_;this.slow_.halfLife!==p&&(this.slow_=new S.default(p,n.getEstimate(),n.getTotalWeight())),this.fast_.halfLife!==f&&(this.fast_=new S.default(f,d.getEstimate(),d.getTotalWeight()))},M.sample=function(p,f){p=Math.max(p,this.minDelayMs_);var n=8*f,d=p/1e3,o=n/d;this.fast_.sample(d,o),this.slow_.sample(d,o)},M.canEstimate=function(){var p=this.fast_;return p&&p.getTotalWeight()>=this.minWeight_},M.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},M.destroy=function(){},m}();C.default=h},"./src/utils/ewma.ts":function(O,C,x){x.r(C);var S=function(){function h(M,T,p){T===void 0&&(T=0),p===void 0&&(p=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=M,this.alpha_=M?Math.exp(Math.log(.5)/M):0,this.estimate_=T,this.totalWeight_=p}var m=h.prototype;return m.sample=function(T,p){var f=Math.pow(this.alpha_,T);this.estimate_=p*(1-f)+f*this.estimate_,this.totalWeight_+=T},m.getTotalWeight=function(){return this.totalWeight_},m.getEstimate=function(){if(this.alpha_){var T=1-Math.pow(this.alpha_,this.totalWeight_);if(T)return this.estimate_/T}return this.estimate_},h}();C.default=S},"./src/utils/fetch-loader.ts":function(O,C,x){x.r(C),x.d(C,"fetchSupported",function(){return c});var S=x("./src/polyfills/number.ts"),h=x("./src/loader/load-stats.ts"),m=x("./src/demux/chunk-cache.ts");function M(e,s){e.prototype=Object.create(s.prototype),e.prototype.constructor=e,d(e,s)}function T(e){var s=typeof Map=="function"?new Map:void 0;return T=function(a){if(a===null||!n(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof s!="undefined"){if(s.has(a))return s.get(a);s.set(a,g)}function g(){return p(a,arguments,o(this).constructor)}return g.prototype=Object.create(a.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),d(g,a)},T(e)}function p(e,s,l){return f()?p=Reflect.construct:p=function(g,A,D){var y=[null];y.push.apply(y,A);var E=Function.bind.apply(g,y),_=new E;return D&&d(_,D.prototype),_},p.apply(null,arguments)}function f(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function n(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function d(e,s){return d=Object.setPrototypeOf||function(a,g){return a.__proto__=g,a},d(e,s)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},o(e)}function v(){return v=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},v.apply(this,arguments)}function c(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var u=function(){function e(l){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=l.fetchSetup||t,this.controller=new self.AbortController,this.stats=new h.LoadStats}var s=e.prototype;return s.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},s.abortInternal=function(){var a=this.response;(!a||!a.ok)&&(this.stats.aborted=!0,this.controller.abort())},s.abort=function(){var a;this.abortInternal(),(a=this.callbacks)!==null&&a!==void 0&&a.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},s.load=function(a,g,A){var D=this,y=this.stats;if(y.loading.start)throw new Error("Loader can only be used once.");y.loading.start=self.performance.now();var E=r(a,this.controller.signal),_=A.onProgress,L=a.responseType==="arraybuffer",I=L?"byteLength":"length";this.context=a,this.config=g,this.callbacks=A,this.request=this.fetchSetup(a,E),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){D.abortInternal(),A.onTimeout(y,a,D.response)},g.timeout),self.fetch(this.request).then(function(b){if(D.response=D.loader=b,!b.ok){var R=b.status,P=b.statusText;throw new i(P||"fetch, bad network response",R,b)}return y.loading.first=Math.max(self.performance.now(),y.loading.start),y.total=parseInt(b.headers.get("Content-Length")||"0"),_&&Object(S.isFiniteNumber)(g.highWaterMark)?D.loadProgressively(b,y,a,g.highWaterMark,_):L?b.arrayBuffer():b.text()}).then(function(b){var R=D.response;self.clearTimeout(D.requestTimeout),y.loading.end=Math.max(self.performance.now(),y.loading.first),y.loaded=y.total=b[I];var P={url:R.url,data:b};_&&!Object(S.isFiniteNumber)(g.highWaterMark)&&_(y,a,b,R),A.onSuccess(P,y,a,R)}).catch(function(b){if(self.clearTimeout(D.requestTimeout),!y.aborted){var R=b.code||0;A.onError({code:R,text:b.message},a,b.details)}})},s.getCacheAge=function(){var a=null;if(this.response){var g=this.response.headers.get("age");a=g?parseFloat(g):null}return a},s.loadProgressively=function(a,g,A,D,y){D===void 0&&(D=0);var E=new m.default,_=a.body.getReader(),L=function I(){return _.read().then(function(b){if(b.done)return E.dataLength&&y(g,A,E.flush(),a),Promise.resolve(new ArrayBuffer(0));var R=b.value,P=R.length;return g.loaded+=P,P<D||E.dataLength?(E.push(R),E.dataLength>=D&&y(g,A,E.flush(),a)):y(g,A,R,a),I()}).catch(function(){return Promise.reject()})};return L()},e}();function r(e,s){var l={method:"GET",mode:"cors",credentials:"same-origin",signal:s,headers:new self.Headers(v({},e.headers))};return e.rangeEnd&&l.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),l}function t(e,s){return new self.Request(e.url,s)}var i=function(e){M(s,e);function s(l,a,g){var A;return A=e.call(this,l)||this,A.code=void 0,A.details=void 0,A.code=a,A.details=g,A}return s}(T(Error));C.default=u},"./src/utils/imsc1-ttml-parser.ts":function(O,C,x){x.r(C),x.d(C,"IMSC1_CODEC",function(){return n}),x.d(C,"parseIMSC1",function(){return c});var S=x("./src/utils/mp4-tools.ts"),h=x("./src/utils/vttparser.ts"),m=x("./src/utils/vttcue.ts"),M=x("./src/demux/id3.ts"),T=x("./src/utils/timescale-conversion.ts"),p=x("./src/utils/webvtt-parser.ts");function f(){return f=Object.assign||function(D){for(var y=1;y<arguments.length;y++){var E=arguments[y];for(var _ in E)Object.prototype.hasOwnProperty.call(E,_)&&(D[_]=E[_])}return D},f.apply(this,arguments)}var n="stpp.ttml.im1t",d=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,o=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,v={left:"start",center:"center",right:"end",start:"start",end:"end"};function c(D,y,E,_,L){var I=Object(S.findBox)(new Uint8Array(D),["mdat"]);if(I.length===0){L(new Error("Could not parse IMSC1 mdat"));return}var b=I[0],R=Object(M.utf8ArrayToStr)(new Uint8Array(D,b.start,b.end-b.start)),P=Object(T.toTimescaleFromScale)(y,1,E);try{_(u(R,P))}catch(w){L(w)}}function u(D,y){var E=new DOMParser,_=E.parseFromString(D,"text/xml"),L=_.getElementsByTagName("tt")[0];if(!L)throw new Error("Invalid ttml");var I={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},b=Object.keys(I).reduce(function(k,B){return k[B]=L.getAttribute("ttp:"+B)||I[B],k},{}),R=L.getAttribute("xml:space")!=="preserve",P=t(r(L,"styling","style")),w=t(r(L,"layout","region")),F=r(L,"body","[begin]");return[].map.call(F,function(k){var B=i(k,R);if(!B||!k.hasAttribute("begin"))return null;var U=a(k.getAttribute("begin"),b),j=a(k.getAttribute("dur"),b),K=a(k.getAttribute("end"),b);if(U===null)throw l(k);if(K===null){if(j===null)throw l(k);K=U+j}var N=new m.default(U-y,K-y,B);N.id=Object(p.generateCueId)(N.startTime,N.endTime,N.text);var Z=w[k.getAttribute("region")],X=P[k.getAttribute("style")];N.position=10,N.size=80;var Y=e(Z,X),ee=Y.textAlign;if(ee){var Q=v[ee];Q&&(N.lineAlign=Q),N.align=ee}return f(N,Y),N}).filter(function(k){return k!==null})}function r(D,y,E){var _=D.getElementsByTagName(y)[0];return _?[].slice.call(_.querySelectorAll(E)):[]}function t(D){return D.reduce(function(y,E){var _=E.getAttribute("xml:id");return _&&(y[_]=E),y},{})}function i(D,y){return[].slice.call(D.childNodes).reduce(function(E,_,L){var I;return _.nodeName==="br"&&L?E+`
`:(I=_.childNodes)!==null&&I!==void 0&&I.length?i(_,y):y?E+_.textContent.trim().replace(/\s+/g," "):E+_.textContent},"")}function e(D,y){var E="http://www.w3.org/ns/ttml#styling",_=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return _.reduce(function(L,I){var b=s(y,E,I)||s(D,E,I);return b&&(L[I]=b),L},{})}function s(D,y,E){return D.hasAttributeNS(y,E)?D.getAttributeNS(y,E):null}function l(D){return new Error("Could not parse ttml timestamp "+D)}function a(D,y){if(!D)return null;var E=Object(h.parseTimeStamp)(D);return E===null&&(d.test(D)?E=g(D,y):o.test(D)&&(E=A(D,y))),E}function g(D,y){var E=d.exec(D),_=(E[4]|0)+(E[5]|0)/y.subFrameRate;return(E[1]|0)*3600+(E[2]|0)*60+(E[3]|0)+_/y.frameRate}function A(D,y){var E=o.exec(D),_=Number(E[1]),L=E[2];switch(L){case"h":return _*3600;case"m":return _*60;case"ms":return _*1e3;case"f":return _/y.frameRate;case"t":return _/y.tickRate}return _}},"./src/utils/logger.ts":function(O,C,x){x.r(C),x.d(C,"enableLogs",function(){return p}),x.d(C,"logger",function(){return f});var S=function(){},h={trace:S,debug:S,log:S,warn:S,info:S,error:S},m=h;function M(n){var d=self.console[n];return d?d.bind(self.console,"["+n+"] >"):S}function T(n){for(var d=arguments.length,o=new Array(d>1?d-1:0),v=1;v<d;v++)o[v-1]=arguments[v];o.forEach(function(c){m[c]=n[c]?n[c].bind(n):M(c)})}function p(n){if(self.console&&n===!0||typeof n=="object"){T(n,"debug","log","info","warn","error");try{m.log()}catch{m=h}}else m=h}var f=m},"./src/utils/mediakeys-helper.ts":function(O,C,x){x.r(C),x.d(C,"KeySystems",function(){return S}),x.d(C,"requestMediaKeySystemAccess",function(){return h});var S;(function(m){m.WIDEVINE="com.widevine.alpha",m.PLAYREADY="com.microsoft.playready"})(S||(S={}));var h=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(O,C,x){x.r(C),x.d(C,"getMediaSource",function(){return S});function S(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(O,C,x){x.r(C),x.d(C,"bin2str",function(){return T}),x.d(C,"readUint16",function(){return p}),x.d(C,"readUint32",function(){return f}),x.d(C,"writeUint32",function(){return n}),x.d(C,"findBox",function(){return d}),x.d(C,"parseSegmentIndex",function(){return o}),x.d(C,"parseInitSegment",function(){return v}),x.d(C,"getStartDTS",function(){return c}),x.d(C,"getDuration",function(){return u}),x.d(C,"computeRawDurationFromSamples",function(){return r}),x.d(C,"offsetStartDTS",function(){return t}),x.d(C,"segmentValidRange",function(){return i}),x.d(C,"appendUint8Array",function(){return e});var S=x("./src/utils/typed-array.ts"),h=x("./src/loader/fragment.ts"),m=Math.pow(2,32)-1,M=[].push;function T(s){return String.fromCharCode.apply(null,s)}function p(s,l){"data"in s&&(l+=s.start,s=s.data);var a=s[l]<<8|s[l+1];return a<0?65536+a:a}function f(s,l){"data"in s&&(l+=s.start,s=s.data);var a=s[l]<<24|s[l+1]<<16|s[l+2]<<8|s[l+3];return a<0?4294967296+a:a}function n(s,l,a){"data"in s&&(l+=s.start,s=s.data),s[l]=a>>24,s[l+1]=a>>16&255,s[l+2]=a>>8&255,s[l+3]=a&255}function d(s,l){var a=[];if(!l.length)return a;var g,A,D;"data"in s?(g=s.data,A=s.start,D=s.end):(g=s,A=0,D=g.byteLength);for(var y=A;y<D;){var E=f(g,y),_=T(g.subarray(y+4,y+8)),L=E>1?y+E:D;if(_===l[0])if(l.length===1)a.push({data:g,start:y+8,end:L});else{var I=d({data:g,start:y+8,end:L},l.slice(1));I.length&&M.apply(a,I)}y=L}return a}function o(s){var l=d(s,["moov"]),a=l[0],g=a?a.end:null,A=d(s,["sidx"]);if(!A||!A[0])return null;var D=[],y=A[0],E=y.data[0],_=E===0?8:16,L=f(y,_);_+=4;var I=0,b=0;E===0?_+=8:_+=16,_+=2;var R=y.end+b,P=p(y,_);_+=2;for(var w=0;w<P;w++){var F=_,k=f(y,F);F+=4;var B=k&2147483647,U=(k&2147483648)>>>31;if(U===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var j=f(y,F);F+=4,D.push({referenceSize:B,subsegmentDuration:j,info:{duration:j/L,start:R,end:R+B-1}}),R+=B,F+=4,_=F}return{earliestPresentationTime:I,timescale:L,version:E,referencesCount:P,references:D,moovEndOffset:g}}function v(s){for(var l=[],a=d(s,["moov","trak"]),g=0;g<a.length;g++){var A=a[g],D=d(A,["tkhd"])[0];if(D){var y=D.data[D.start],E=y===0?12:20,_=f(D,E),L=d(A,["mdia","mdhd"])[0];if(L){y=L.data[L.start],E=y===0?12:20;var I=f(L,E),b=d(A,["mdia","hdlr"])[0];if(b){var R=T(b.data.subarray(b.start+8,b.start+12)),P={soun:h.ElementaryStreamTypes.AUDIO,vide:h.ElementaryStreamTypes.VIDEO}[R];if(P){var w=d(A,["mdia","minf","stbl","stsd"])[0],F=void 0;w&&(F=T(w.data.subarray(w.start+12,w.start+16))),l[_]={timescale:I,type:P},l[P]={timescale:I,id:_,codec:F}}}}}}var k=d(s,["moov","mvex","trex"]);return k.forEach(function(B){var U=f(B,4),j=l[U];j&&(j.default={duration:f(B,12),flags:f(B,20)})}),l}function c(s,l){return d(l,["moof","traf"]).reduce(function(a,g){var A=d(g,["tfdt"])[0],D=A.data[A.start],y=d(g,["tfhd"]).reduce(function(E,_){var L=f(_,4),I=s[L];if(I){var b=f(A,4);D===1&&(b*=Math.pow(2,32),b+=f(A,8));var R=I.timescale||9e4,P=b/R;if(isFinite(P)&&(E===null||P<E))return P}return E},null);return y!==null&&isFinite(y)&&(a===null||y<a)?y:a},null)||0}function u(s,l){for(var a=0,g=0,A=0,D=d(s,["moof","traf"]),y=0;y<D.length;y++){var E=D[y],_=d(E,["tfhd"])[0],L=f(_,4),I=l[L];if(!!I){var b=I.default,R=f(_,0)|(b==null?void 0:b.flags),P=b==null?void 0:b.duration;R&8&&(R&2?P=f(_,12):P=f(_,8));for(var w=I.timescale||9e4,F=d(E,["trun"]),k=0;k<F.length;k++){if(a=r(F[k]),!a&&P){var B=f(F[k],4);a=P*B}I.type===h.ElementaryStreamTypes.VIDEO?g+=a/w:I.type===h.ElementaryStreamTypes.AUDIO&&(A+=a/w)}}}if(g===0&&A===0){var U=o(s);if(U!=null&&U.references)return U.references.reduce(function(j,K){return j+K.info.duration||0},0)}return g||A}function r(s){var l=f(s,0),a=8;l&1&&(a+=4),l&4&&(a+=4);for(var g=0,A=f(s,4),D=0;D<A;D++){if(l&256){var y=f(s,a);g+=y,a+=4}l&512&&(a+=4),l&1024&&(a+=4),l&2048&&(a+=4)}return g}function t(s,l,a){d(l,["moof","traf"]).forEach(function(g){d(g,["tfhd"]).forEach(function(A){var D=f(A,4),y=s[D];if(!!y){var E=y.timescale||9e4;d(g,["tfdt"]).forEach(function(_){var L=_.data[_.start],I=f(_,4);if(L===0)n(_,4,I-a*E);else{I*=Math.pow(2,32),I+=f(_,8),I-=a*E,I=Math.max(I,0);var b=Math.floor(I/(m+1)),R=Math.floor(I%(m+1));n(_,4,b),n(_,8,R)}})}})})}function i(s){var l={valid:null,remainder:null},a=d(s,["moof"]);if(a){if(a.length<2)return l.remainder=s,l}else return l;var g=a[a.length-1];return l.valid=Object(S.sliceUint8)(s,0,g.start-8),l.remainder=Object(S.sliceUint8)(s,g.start-8),l}function e(s,l){var a=new Uint8Array(s.length+l.length);return a.set(s),a.set(l,s.length),a}},"./src/utils/output-filter.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function h(M,T){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=M,this.trackName=T}var m=h.prototype;return m.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},m.newCue=function(T,p,f){(this.startTime===null||this.startTime>T)&&(this.startTime=T),this.endTime=p,this.screen=f,this.timelineController.createCaptionsTrack(this.trackName)},m.reset=function(){this.cueRanges=[],this.startTime=null},h}()},"./src/utils/texttrack-utils.ts":function(O,C,x){x.r(C),x.d(C,"sendAddTrackEvent",function(){return h}),x.d(C,"addCueToTrack",function(){return m}),x.d(C,"clearCurrentCues",function(){return M}),x.d(C,"removeCuesInRange",function(){return T}),x.d(C,"getCuesInRange",function(){return f});var S=x("./src/utils/logger.ts");function h(n,d){var o;try{o=new Event("addtrack")}catch{o=document.createEvent("Event"),o.initEvent("addtrack",!1,!1)}o.track=n,d.dispatchEvent(o)}function m(n,d){var o=n.mode;if(o==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(d.id))try{if(n.addCue(d),!n.cues.getCueById(d.id))throw new Error("addCue is failed for: "+d)}catch(c){S.logger.debug("[texttrack-utils]: "+c);var v=new self.TextTrackCue(d.startTime,d.endTime,d.text);v.id=d.id,n.addCue(v)}o==="disabled"&&(n.mode=o)}function M(n){var d=n.mode;if(d==="disabled"&&(n.mode="hidden"),n.cues)for(var o=n.cues.length;o--;)n.removeCue(n.cues[o]);d==="disabled"&&(n.mode=d)}function T(n,d,o){var v=n.mode;if(v==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0)for(var c=f(n.cues,d,o),u=0;u<c.length;u++)n.removeCue(c[u]);v==="disabled"&&(n.mode=v)}function p(n,d){if(d<n[0].startTime)return 0;var o=n.length-1;if(d>n[o].endTime)return-1;for(var v=0,c=o;v<=c;){var u=Math.floor((c+v)/2);if(d<n[u].startTime)c=u-1;else if(d>n[u].startTime&&v<o)v=u+1;else return u}return n[v].startTime-d<d-n[c].startTime?v:c}function f(n,d,o){var v=[],c=p(n,d);if(c>-1)for(var u=c,r=n.length;u<r;u++){var t=n[u];if(t.startTime>=d&&t.endTime<=o)v.push(t);else if(t.startTime>o)return v}return v}},"./src/utils/time-ranges.ts":function(O,C,x){x.r(C);var S={toString:function(m){for(var M="",T=m.length,p=0;p<T;p++)M+="["+m.start(p).toFixed(3)+","+m.end(p).toFixed(3)+"]";return M}};C.default=S},"./src/utils/timescale-conversion.ts":function(O,C,x){x.r(C),x.d(C,"toTimescaleFromBase",function(){return h}),x.d(C,"toTimescaleFromScale",function(){return m}),x.d(C,"toMsFromMpegTsClock",function(){return M}),x.d(C,"toMpegTsClockFromTimescale",function(){return T});var S=9e4;function h(p,f,n,d){n===void 0&&(n=1),d===void 0&&(d=!1);var o=p*f*n;return d?Math.round(o):o}function m(p,f,n,d){return n===void 0&&(n=1),d===void 0&&(d=!1),h(p,f,1/n,d)}function M(p,f){return f===void 0&&(f=!1),h(p,1e3,1/S,f)}function T(p,f){return f===void 0&&(f=1),h(p,S,1/f)}},"./src/utils/typed-array.ts":function(O,C,x){x.r(C),x.d(C,"sliceUint8",function(){return S});function S(h,m,M){return Uint8Array.prototype.slice?h.slice(m,M):new Uint8Array(Array.prototype.slice.call(h,m,M))}},"./src/utils/vttcue.ts":function(O,C,x){x.r(C),C.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var S=["","lr","rl"],h=["start","middle","end","left","right"];function m(n,d){if(typeof d!="string"||!Array.isArray(n))return!1;var o=d.toLowerCase();return~n.indexOf(o)?o:!1}function M(n){return m(S,n)}function T(n){return m(h,n)}function p(n){for(var d=arguments.length,o=new Array(d>1?d-1:0),v=1;v<d;v++)o[v-1]=arguments[v];for(var c=1;c<arguments.length;c++){var u=arguments[c];for(var r in u)n[r]=u[r]}return n}function f(n,d,o){var v=this,c={enumerable:!0};v.hasBeenReset=!1;var u="",r=!1,t=n,i=d,e=o,s=null,l="",a=!0,g="auto",A="start",D=50,y="middle",E=50,_="middle";Object.defineProperty(v,"id",p({},c,{get:function(){return u},set:function(I){u=""+I}})),Object.defineProperty(v,"pauseOnExit",p({},c,{get:function(){return r},set:function(I){r=!!I}})),Object.defineProperty(v,"startTime",p({},c,{get:function(){return t},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");t=I,this.hasBeenReset=!0}})),Object.defineProperty(v,"endTime",p({},c,{get:function(){return i},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");i=I,this.hasBeenReset=!0}})),Object.defineProperty(v,"text",p({},c,{get:function(){return e},set:function(I){e=""+I,this.hasBeenReset=!0}})),Object.defineProperty(v,"region",p({},c,{get:function(){return s},set:function(I){s=I,this.hasBeenReset=!0}})),Object.defineProperty(v,"vertical",p({},c,{get:function(){return l},set:function(I){var b=M(I);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");l=b,this.hasBeenReset=!0}})),Object.defineProperty(v,"snapToLines",p({},c,{get:function(){return a},set:function(I){a=!!I,this.hasBeenReset=!0}})),Object.defineProperty(v,"line",p({},c,{get:function(){return g},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");g=I,this.hasBeenReset=!0}})),Object.defineProperty(v,"lineAlign",p({},c,{get:function(){return A},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");A=b,this.hasBeenReset=!0}})),Object.defineProperty(v,"position",p({},c,{get:function(){return D},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");D=I,this.hasBeenReset=!0}})),Object.defineProperty(v,"positionAlign",p({},c,{get:function(){return y},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");y=b,this.hasBeenReset=!0}})),Object.defineProperty(v,"size",p({},c,{get:function(){return E},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");E=I,this.hasBeenReset=!0}})),Object.defineProperty(v,"align",p({},c,{get:function(){return _},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");_=b,this.hasBeenReset=!0}})),v.displayState=void 0}return f.prototype.getCueAsHTML=function(){var n=self.WebVTT;return n.convertCueToDOMTree(self,this.text)},f}()},"./src/utils/vttparser.ts":function(O,C,x){x.r(C),x.d(C,"parseTimeStamp",function(){return m}),x.d(C,"fixLineBreaks",function(){return d}),x.d(C,"VTTParser",function(){return o});var S=x("./src/utils/vttcue.ts"),h=function(){function v(){}var c=v.prototype;return c.decode=function(r,t){if(!r)return"";if(typeof r!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(r))},v}();function m(v){function c(r,t,i,e){return(r|0)*3600+(t|0)*60+(i|0)+parseFloat(e||0)}var u=v.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return u?parseFloat(u[2])>59?c(u[2],u[3],0,u[4]):c(u[1],u[2],u[3],u[4]):null}var M=function(){function v(){this.values=Object.create(null)}var c=v.prototype;return c.set=function(r,t){!this.get(r)&&t!==""&&(this.values[r]=t)},c.get=function(r,t,i){return i?this.has(r)?this.values[r]:t[i]:this.has(r)?this.values[r]:t},c.has=function(r){return r in this.values},c.alt=function(r,t,i){for(var e=0;e<i.length;++e)if(t===i[e]){this.set(r,t);break}},c.integer=function(r,t){/^-?\d+$/.test(t)&&this.set(r,parseInt(t,10))},c.percent=function(r,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var i=parseFloat(t);if(i>=0&&i<=100)return this.set(r,i),!0}return!1},v}();function T(v,c,u,r){var t=r?v.split(r):[v];for(var i in t)if(typeof t[i]=="string"){var e=t[i].split(u);if(e.length===2){var s=e[0],l=e[1];c(s,l)}}}var p=new S.default(0,0,""),f=p.align==="middle"?"middle":"center";function n(v,c,u){var r=v;function t(){var s=m(v);if(s===null)throw new Error("Malformed timestamp: "+r);return v=v.replace(/^[^\sa-zA-Z-]+/,""),s}function i(s,l){var a=new M;T(s,function(D,y){var E;switch(D){case"region":for(var _=u.length-1;_>=0;_--)if(u[_].id===y){a.set(D,u[_].region);break}break;case"vertical":a.alt(D,y,["rl","lr"]);break;case"line":E=y.split(","),a.integer(D,E[0]),a.percent(D,E[0])&&a.set("snapToLines",!1),a.alt(D,E[0],["auto"]),E.length===2&&a.alt("lineAlign",E[1],["start",f,"end"]);break;case"position":E=y.split(","),a.percent(D,E[0]),E.length===2&&a.alt("positionAlign",E[1],["start",f,"end","line-left","line-right","auto"]);break;case"size":a.percent(D,y);break;case"align":a.alt(D,y,["start",f,"end","left","right"]);break}},/:/,/\s/),l.region=a.get("region",null),l.vertical=a.get("vertical","");var g=a.get("line","auto");g==="auto"&&p.line===-1&&(g=-1),l.line=g,l.lineAlign=a.get("lineAlign","start"),l.snapToLines=a.get("snapToLines",!0),l.size=a.get("size",100),l.align=a.get("align",f);var A=a.get("position","auto");A==="auto"&&p.position===50&&(A=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=A}function e(){v=v.replace(/^\s+/,"")}if(e(),c.startTime=t(),e(),v.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);v=v.substr(3),e(),c.endTime=t(),e(),i(v,c)}function d(v){return v.replace(/<br(?: \/)?>/gi,`
`)}var o=function(){function v(){this.state="INITIAL",this.buffer="",this.decoder=new h,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var c=v.prototype;return c.parse=function(r){var t=this;r&&(t.buffer+=t.decoder.decode(r,{stream:!0}));function i(){var A=t.buffer,D=0;for(A=d(A);D<A.length&&A[D]!=="\r"&&A[D]!==`
`;)++D;var y=A.substr(0,D);return A[D]==="\r"&&++D,A[D]===`
`&&++D,t.buffer=A.substr(D),y}function e(A){T(A,function(D,y){},/:/)}try{var s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=i();var l=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!l||!l[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=i(),t.state){case"HEADER":/:/.test(s)?e(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new S.default(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{n(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{var g=s.indexOf("-->")!==-1;if(!s||g&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},c.flush=function(){var r=this;try{if((r.cue||r.state==="HEADER")&&(r.buffer+=`

`,r.parse()),r.state==="INITIAL"||r.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){r.onparsingerror&&r.onparsingerror(t)}return r.onflush&&r.onflush(),this},v}()},"./src/utils/webvtt-parser.ts":function(O,C,x){x.r(C),x.d(C,"generateCueId",function(){return o}),x.d(C,"parseWebVTT",function(){return c});var S=x("./src/polyfills/number.ts"),h=x("./src/utils/vttparser.ts"),m=x("./src/demux/id3.ts"),M=x("./src/utils/timescale-conversion.ts"),T=x("./src/remux/mp4-remuxer.ts"),p=/\r\n|\n\r|\n|\r/g,f=function(r,t,i){return i===void 0&&(i=0),r.substr(i,t.length)===t},n=function(r){var t=parseInt(r.substr(-3)),i=parseInt(r.substr(-6,2)),e=parseInt(r.substr(-9,2)),s=r.length>9?parseInt(r.substr(0,r.indexOf(":"))):0;if(!Object(S.isFiniteNumber)(t)||!Object(S.isFiniteNumber)(i)||!Object(S.isFiniteNumber)(e)||!Object(S.isFiniteNumber)(s))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+r);return t+=1e3*i,t+=60*1e3*e,t+=60*60*1e3*s,t},d=function(r){for(var t=5381,i=r.length;i;)t=t*33^r.charCodeAt(--i);return(t>>>0).toString()};function o(u,r,t){return d(u.toString())+d(r.toString())+d(t)}var v=function(r,t,i){var e=r[t],s=r[e.prevCC];if(!s||!s.new&&e.new){r.ccOffset=r.presentationOffset=e.start,e.new=!1;return}for(;(l=s)!==null&&l!==void 0&&l.new;){var l;r.ccOffset+=e.start-s.start,e.new=!1,e=s,s=r[e.prevCC]}r.presentationOffset=i};function c(u,r,t,i,e,s,l,a){var g=new h.VTTParser,A=Object(m.utf8ArrayToStr)(new Uint8Array(u)).trim().replace(p,`
`).split(`
`),D=[],y=Object(M.toMpegTsClockFromTimescale)(r,t),E="00:00.000",_=0,L=0,I,b=!0,R=!1;g.oncue=function(P){var w=i[e],F=i.ccOffset,k=(_-y)/9e4;if(w!=null&&w.new&&(L!==void 0?F=i.ccOffset=w.start:v(i,e,k)),k&&(F=k-i.presentationOffset),R){var B=P.endTime-P.startTime,U=Object(T.normalizePts)((P.startTime+F-L)*9e4,s*9e4)/9e4;P.startTime=U,P.endTime=U+B}var j=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(j)),P.id||(P.id=o(P.startTime,P.endTime,j)),P.endTime>0&&D.push(P)},g.onparsingerror=function(P){I=P},g.onflush=function(){if(I){a(I);return}l(D)},A.forEach(function(P){if(b)if(f(P,"X-TIMESTAMP-MAP=")){b=!1,R=!0,P.substr(16).split(",").forEach(function(w){f(w,"LOCAL:")?E=w.substr(6):f(w,"MPEGTS:")&&(_=parseInt(w.substr(7)))});try{L=n(E)/1e3}catch(w){R=!1,I=w}return}else P===""&&(b=!1);g.parse(P+`
`)}),g.flush()}},"./src/utils/xhr-loader.ts":function(O,C,x){x.r(C);var S=x("./src/utils/logger.ts"),h=x("./src/loader/load-stats.ts"),m=/^age:\s*[\d.]+\s*$/m,M=function(){function T(f){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=f?f.xhrSetup:null,this.stats=new h.LoadStats,this.retryDelay=0}var p=T.prototype;return p.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},p.abortInternal=function(){var n=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),n&&(n.onreadystatechange=null,n.onprogress=null,n.readyState!==4&&(this.stats.aborted=!0,n.abort()))},p.abort=function(){var n;this.abortInternal(),(n=this.callbacks)!==null&&n!==void 0&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},p.load=function(n,d,o){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=n,this.config=d,this.callbacks=o,this.retryDelay=d.retryDelay,this.loadInternal()},p.loadInternal=function(){var n=this.config,d=this.context;if(!!n){var o=this.loader=new self.XMLHttpRequest,v=this.stats;v.loading.first=0,v.loaded=0;var c=this.xhrSetup;try{if(c)try{c(o,d.url)}catch{o.open("GET",d.url,!0),c(o,d.url)}o.readyState||o.open("GET",d.url,!0);var u=this.context.headers;if(u)for(var r in u)o.setRequestHeader(r,u[r])}catch(t){this.callbacks.onError({code:o.status,text:t.message},d,o);return}d.rangeEnd&&o.setRequestHeader("Range","bytes="+d.rangeStart+"-"+(d.rangeEnd-1)),o.onreadystatechange=this.readystatechange.bind(this),o.onprogress=this.loadprogress.bind(this),o.responseType=d.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),o.send()}},p.readystatechange=function(){var n=this.context,d=this.loader,o=this.stats;if(!(!n||!d)){var v=d.readyState,c=this.config;if(!o.aborted&&v>=2)if(self.clearTimeout(this.requestTimeout),o.loading.first===0&&(o.loading.first=Math.max(self.performance.now(),o.loading.start)),v===4){d.onreadystatechange=null,d.onprogress=null;var u=d.status;if(u>=200&&u<300){o.loading.end=Math.max(self.performance.now(),o.loading.first);var r,t;if(n.responseType==="arraybuffer"?(r=d.response,t=r.byteLength):(r=d.responseText,t=r.length),o.loaded=o.total=t,!this.callbacks)return;var i=this.callbacks.onProgress;if(i&&i(o,n,r,d),!this.callbacks)return;var e={url:d.responseURL,data:r};this.callbacks.onSuccess(e,o,n,d)}else o.retry>=c.maxRetry||u>=400&&u<499?(S.logger.error(u+" while loading "+n.url),this.callbacks.onError({code:u,text:d.statusText},n,d)):(S.logger.warn(u+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,c.maxRetryDelay),o.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),c.timeout)}},p.loadtimeout=function(){S.logger.warn("timeout while loading "+this.context.url);var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))},p.loadprogress=function(n){var d=this.stats;d.loaded=n.loaded,n.lengthComputable&&(d.total=n.total)},p.getCacheAge=function(){var n=null;if(this.loader&&m.test(this.loader.getAllResponseHeaders())){var d=this.loader.getResponseHeader("age");n=d?parseFloat(d):null}return n},T}();C.default=M}}).default})})(We);var pt=Fe(We.exports);const Ae=Te=>(tt("data-v-79e0af22"),Te=Te(),rt(),Te),gt=Ae(()=>pe("div",{class:"artplayer-app"},null,-1)),mt={class:"zfile-video-tools"},yt=Me(" \u76F4\u63A5\u4E0B\u8F7D "),Et=Ae(()=>pe("img",{src:nt,alt:"\u4E0B\u8F7D"},null,-1)),xt=Me(" \u4F7F\u7528\u8FC5\u96F7\u4E0B\u8F7D "),_t=Ae(()=>pe("img",{src:st,alt:"\u8FC5\u96F7"},null,-1)),Tt=Me(" \u4F7F\u7528 motrix \u4E0B\u8F7D "),St=Ae(()=>pe("img",{src:at,alt:"motrix"},null,-1)),Lt=Me(" \u4F7F\u7528 PotPlayer \u64AD\u653E "),At=Ae(()=>pe("img",{src:ot,alt:"PotPlayer"},null,-1)),Dt=Me(" \u4F7F\u7528 IINA \u64AD\u653E "),Mt=Ae(()=>pe("img",{src:lt,alt:"IINA"},null,-1)),It=Me(" \u4F7F\u7528 VLC \u64AD\u653E "),bt=Ae(()=>pe("img",{src:ut,alt:"VLC"},null,-1)),Rt=Me(" \u4F7F\u7528 nPlayer \u64AD\u653E "),Ot=Ae(()=>pe("img",{src:ft,alt:"nPlayer"},null,-1)),Ct=Me(" \u4F7F\u7528 MXPlayer(Free) \u64AD\u653E "),Pt=Ae(()=>pe("img",{src:dt,alt:"MXPlayer(Free)"},null,-1)),wt=Me(" \u4F7F\u7528 MXPlayer(Pro) \u64AD\u653E "),Ft=Ae(()=>pe("img",{src:ct,alt:"MXPlayer(Pro)"},null,-1)),kt=Ae(()=>pe("div",{class:"zfile-video-tools-tips"}," tips: \u53EF\u70B9\u51FB\u4E0A\u65B9\u7684\u8F6F\u4EF6\u56FE\u6807\u8FDB\u884C\u4E0B\u8F7D\u64AD\u653E, \u672C\u5730\u64AD\u653E\u5668\u89E3\u7801\u6548\u679C\u66F4\u4F73. ",-1)),Bt={__name:"VideoPlayer",setup(Te){let Ie=it();const O=c=>{let u=[];return Ie.filterFileByType("video").forEach(r=>{u.push({default:r.name===c,html:r.name,url:r.url})}),u};let C;const x=c=>{switch(c){case"download":window.location=C.url;break;case"thunder":window.location=`thunder://${btoa("AA"+C.url+"ZZ")}`;break;case"motrix":window.location=`motrix://new-task?uri=${encodeURIComponent(C.url)}&out=${encodeURIComponent(C.name)}`;break;case"potplayer":window.location=`potplayer://${C.url}`;break;case"iina":window.location=`iina://weblink?url=${encodeURIComponent(C.url)}`;break;case"vlc":window.location=`vlc://${C.url}`;break;case"nplayer":window.location=`nplayer-${C.url}`;break;case"mxplayer":window.location="intent:"+C.url+"#Intent;package=com.mxtech.videoplayer.ad;S.title="+C.name+";end";break;case"mxplayer-pro":window.location="intent:"+C.url+"#Intent;package=com.mxtech.videoplayer.pro;S.title="+C.name+";end";break}},S=c=>{let u=Ie.filterFileByType("video");h();for(let r=0;r<u.length;r++)if(u[r].name===c)return{prev:u[r-1]||null,next:u[r+1]||null}},h=()=>{let c=JSON.parse(localStorage.getItem("_h5_player_play_progress_"));if(c){for(let u of Object.keys(c))u.endsWith(c[u].progress)&&delete c[u];localStorage.setItem("_h5_player_play_progress_",JSON.stringify(c))}},m=c=>{let u=[];return Ie.fileList.find((r,t)=>{let i=r.name.toLowerCase();(i===c+".vtt"||i===c+".srt"||i===c+".ass")&&u.push({default:u.length===0,url:r.url,html:i})}),u.length>0&&u.push({url:"",html:"\u5173\u95ED\u5B57\u5E55"}),u};let M='<i class="art-icon art-icon-video-list"><svg t="1650551038453" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12028" width="20" height="20"><path d="M111.395066 179.64038l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12029"></path><path d="M111.395066 468.067418l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12030"></path><path d="M111.395066 756.493433l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12031"></path></svg></i>',T=`<i class="art-icon art-icon-subtitle"><svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 48 48">
    <path d="M0 0h48v48H0z" fill="none"></path>
    <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
</svg></i>`,p='<i class="art-icon art-icon-next-video"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>',f='<i class="art-icon art-icon-prev-video" v-cloak style="transform: scale(-1,1);"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>';const n=Ue("zfile-video-auto-player-next",!1),d=Ue("zfile-video-auto-player",!1);let o=null;const v=(c,u)=>{C={name:c,url:u},document.querySelector(".zfile-video-dialog .el-dialog__title").innerHTML=c,o&&o.destroy();let r={container:".artplayer-app",title:c,url:u,setting:!0,playbackRate:!0,flip:!0,fullscreen:!0,aspectRatio:!0,fullscreenWeb:!0,theme:"#23ade5",subtitleOffset:!0,miniProgressBar:!0,autoplay:d.value,moreVideoAttr:{crossOrigin:"anonymous"},customType:{flv:function(i,e){const s=vt.createPlayer({type:"flv",url:e});s.attachMediaElement(i),s.load()},m3u8:function(i,e){let s=new pt;s.loadSource(e),s.attachMedia(i)}},contextmenu:[{html:"\u4E0B\u8F7D",click:function(){window.open(u)}}],settings:[{html:"\u81EA\u52A8\u64AD\u653E",tooltip:d.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:d.value,onSwitch:function(i,e,s){console.info(i,e,s);const l=!i.switch;return d.value=l,o.autoplay=l,i.tooltip=l?"\u5F00\u542F":"\u5173\u95ED",l}},{html:"\u81EA\u52A8\u64AD\u653E\u4E0B\u4E00\u4E2A\u89C6\u9891",tooltip:n.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:n.value,onSwitch:function(i,e,s){console.info(i,e,s);const l=!i.switch;return n.value=l,i.tooltip=l?"\u5F00\u542F":"\u5173\u95ED",l}}],controls:[{name:"video-list",position:"right",html:M,selector:O(c),onSelect:function(i,e){return v(i.html,i.url),M}}]},t=m(c);t.length>0&&t.length>1&&r.controls.push({name:"video-subtitle",position:"right",html:T,selector:t,onSelect:i=>(i.html==="\u5173\u95ED\u5B57\u5E55"?o.subtitle.show=!1:(o.subtitle.show=!0,o.subtitle.url=i.url),T)}),o=new ht(r),o.on("destory",()=>{debugger}),o.on("ready",()=>{let i=S(o.option.title);i.prev&&o.controls.add({name:"prev-video",position:"left",index:5,tooltip:"\u64AD\u653E\u4E0A\u4E00\u4E2A",html:f,click:()=>{v(i.prev.name,i.prev.url)}}),i.next&&o.controls.add({name:"next-video",position:"left",index:15,tooltip:"\u64AD\u653E\u4E0B\u4E00\u4E2A",html:p,click:()=>{v(i.next.name,i.next.url)}})}),o.on("video:ended",()=>{if(n.value){const i=S(o.option.title).next;i&&v(i.name,i.url)}}),t.length>0&&(o.subtitle.url=t[0].url)};return Je(()=>{v(Ie.currentClickRow.name,Ie.currentClickRow.url)}),(c,u)=>{const r=Xe;return qe(),et("div",null,[gt,pe("div",mt,[pe("div",{class:"zfile-video-tools-item",onClick:u[0]||(u[0]=t=>x("download"))},[De(r,{placement:"top"},{content:ge(()=>[yt]),default:ge(()=>[Et]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[1]||(u[1]=t=>x("thunder"))},[De(r,{placement:"top"},{content:ge(()=>[xt]),default:ge(()=>[_t]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[2]||(u[2]=t=>x("motrix"))},[De(r,{placement:"top"},{content:ge(()=>[Tt]),default:ge(()=>[St]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[3]||(u[3]=t=>x("potplayer"))},[De(r,{placement:"top"},{content:ge(()=>[Lt]),default:ge(()=>[At]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[4]||(u[4]=t=>x("iina"))},[De(r,{placement:"top"},{content:ge(()=>[Dt]),default:ge(()=>[Mt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[5]||(u[5]=t=>x("vlc"))},[De(r,{placement:"top"},{content:ge(()=>[It]),default:ge(()=>[bt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[6]||(u[6]=t=>x("nplayer"))},[De(r,{placement:"top"},{content:ge(()=>[Rt]),default:ge(()=>[Ot]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[7]||(u[7]=t=>x("mxplayer"))},[De(r,{placement:"top"},{content:ge(()=>[Ct]),default:ge(()=>[Pt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:u[8]||(u[8]=t=>x("mxplayer-pro"))},[De(r,{placement:"top"},{content:ge(()=>[wt]),default:ge(()=>[Ft]),_:1})])]),kt])}}};var tr=$e(Bt,[["__scopeId","data-v-79e0af22"]]);export{tr as default};
