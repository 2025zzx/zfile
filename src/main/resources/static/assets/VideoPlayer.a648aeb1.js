import{a as it,u as nt,b as st}from"./useFileUpload.b562d232.js";import{bN as Ke,M as Be,K as Ue,a as Pe,f as we,p as pe,_ as at,L as ot,r as lt,o as ut,u as Re,P as We,Q as Ge,h as Ae,e as ge,k as ft,S as dt,U as ct,J as De}from"./index.e67223f6.js";import{f as ze}from"./request.4e49ca07.js";import{r as ht}from"./base.03e490c8.js";import"./tooltip.f118fcb0.js";import{E as vt}from"./popper.460a55fd.js";/* empty css               */import"./common.663ac65f.js";import"./index.d38f7bb2.js";import"./index.af07ff27.js";import"./event.776e7e11.js";import"./index.0608157d.js";import"./scroll.14397f07.js";import"./event.3ec63147.js";import"./focus-trap.795b07b9.js";import"./validator.13ee9803.js";import"./index.23b60175.js";import"./directive.cbde8072.js";var pt="/assets/video-download.3a226681.png",gt="/assets/video-thunder.5e7f4cec.png",mt="/assets/video-motrix.95ef7e61.png",yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAOeUlEQVR4Xu3dy5EjuRWF4TMGyA550ibIgPZirJjFODIeaDVOaDMvSREKRdRKGy0UVF1mZTV5yGS+ACSA/G/EV1F1p7unu4pA4nEB6nK5fIeG/UN/vvyuL5df9fXyi75///zHq9/00+UP/fye+9vVr3q7cZnw7deMvy/+jPiz4s+MPz/+PyH+v//Wnx7+PmiKPIEKRUMbG/nYuIdG7Q34GPF3GTuJ4e/4hc6hDfIEDjY29njaRqN6/cSu29gxDCMTOoUKyRMoLIbS8dSs7ameS/wbx5FC/Nv9+4Gi5AlkNj7hhzl1/w1+ztghMEI4hDyBDOJJF8PgWFDzBoB745SB0UER8gQSGRs9T/nthl0MOoOM5AnswJM+n7EzYJqQlDyBDWL+OqzYP75wkd6w5fjl4eeA1eQJLDQU4MRqdrvbdK0bipWYIuwgT2AGT/s6xc+EjmA1eQITYt+auX394mfE9GAxeQI3YsGJlfw2DT+zrywaviZP4MNw8IX5fevoCF6SJ04tXiTDqTqe+L0ZOwL/mZ+cPHFaNPxzGEqPWSP4IE+cTrwYWNw7H3YNruSJ0/i2j//44sB5xGvgxOsD8sQpsMCHe/FaOOX6gDzRNYb7eCVeGyebFsgTXRrO4DPcxzIxQvTXUKfkie4M12uxuo91TrJbIE90g6c+Uuh8NCBPdGE4l89TH2l0vDYgTzRvuLf+8YcI7NfdToE80awY8nNMF7nFa6yjugF5okkM+VFSvNY6mRLIE81hyI9jdFE8JE80g1V+1CBeg/7abIg80YRo/FT0oRYNrwvIE9Vjvo8aNbouIE9UbXiHXA7xoFZvrXUC8kS1WOxDG95aKiGWJ6pE40d7mtghkCeqM5zd928uUL8GzhHIE1Vhmw+tq7wTkCeqQeNHLyruBOSJKtD40ZtKC4bkicPR+NGrCkcC8sShaPzoXWWdgDxxGFb7cRYVdQLyxCHY58f5VFEnIE8UN5T3+jcH6F8FFYPyRFHU9uPcDi8blieKiUMTNH7g0ANE8kQRcXaaI73AINrCQfcJyBNFcJkHcC8uFfF2UoA8kR17/cBzB2wPyhNZsd0HvFZ4UVCeyIZFP2CJoouC8kQWLPoByxVcFJQnsuAde4B1Ci0KyhPJMe8HtspeLixPJDXM+/0fBWCZ7OsB8kQyzPuB/aJmxttWQvJEMuz3A2lkrA+QJ5LghB+QVqapgDyRBEN/IK1oU97OEpAnduNmHyCPDFMBeWIXVv2BvBJPBeSJXTjlB+SVeFdAntiMgh+glGQFQvLEJrHnz0EfoJS3VGcF5IlN2PMHykr0TkPyxGos/AHHSLAgKE+sxsIfcIwEC4LyxCpU/AHH2nmDkDyxChV/wLF2VgjKE4ux7QfUYvO2oDyxGE9/oA47rhCTJxbh6b/Pv969/WXw9yf/HVhv0yhAnpjFRR/7/Pevl4f4zw90BNhn4yhAnpjF03+7eOJPxf/+Ofx3/z3AcqtHAfLELJ7+2z17+nvEr2E0gC027AjIEy+x77/Pmohpgf9+YN6qUYA88RJVf/usjZgWxIKh/znAlJXVgfLEJJ7++20NpgVYY0V1oDwxiXf32W9vsEiIJVa8q5A88RQn/tJIEUwLsMTCk4LyxFNc9JlGyqB2AK8svEBUnniK237SSB3UDmDa28Xb8RPyxAMW/9LJFbFIyLQAbsFioDzxgMW/dHIHtQO4tWAxUJ64M1z2+fgHY5sSwbQAt2bOB8gTd1j8S6tkUDuAMLMYKE/cofIvrSOC0cC5zVQGyhOf2PtP76igduDcXtQEyBOfGP6nd3RQO3BOL6YB8sQnhv/p1RJMC87lxTRAnrhi+J9HTUHtwLlMTAPkiSuG/3nUGNQOnMPENECeuKL4J49ag9qB/k0UBckTFP9kVHtQO9C3J0VB8gS1/xm1EkwL+vTkbIA8wVt9Z9RSUDvQnydvKS5PcOtvRi0G04J+PLk1WHcJtv/yajVYJOyHbQfq9osLb/qRV+tB7UAP7q4N1+0XzP8z6yUoKW6XrQPo9gvKfzPrKZgWtMnKgvX5Bfv/+fUYLBK256YeQOMn7P8X0HNQO9COm3oAjZ9Q/19A70HtQBtuzgVo/IT6/wLOEkwL6nZzLkDjJxQAFXC2YJGwTjcFQbp+wgJgGWcMpgV1+lgIVHygArCQMwe1A3X5WAhUfLhQAVjG2YPagZpcKwIVH6gALIQYgkXC431UBCo+sANQCHEf1A4c52MnQPGBEuBCiMdgkfAYHzsBig8X3v67DGI6mBaUd+0A2AIsh5gPFgnLeW/7YguwIGJZMC0o43d9EYeACiLWBbUDeV07AGoAyiHWB7UD+fyi78UpwIKI7cEiYXrXDoAioHKI/UHtQDrvbZ8OoCQiTbBImMZv+klUARZEpA2mBfv8oZ9FFWBBRJ5gkXCbawfARSDlEPmCacF6722fDqAkIn9QO7DGW9QBcA6gFKJMUDuw1LUD8CRyIcoGb2U2iw6gJOKYoHZgEh1AScRxEaMB/3mADqAo4thgXeABHUBJxLERi4P+Mzk5OoCSiOPDfyYnRwdQEnFssA7wgA6gJOLYYEvwAYVAJRHHBQuAz1AJWBRRPjgx+MobZwFKIsoF5cDzroeBOA5cDlEmOBC0zLUD4EKQcoi8Qe3/Otf7AOgAyiHyBMP9ba5XgnEnYDlE+mC4v931UlCuBS+HSBfcALTftQPgjUHKIdIEw/00Pt4XgLcGK4XYF+zpp/aVNwctidgWDPfzuL43IG8PXg6xPhju5/P+8H//ePnuQjlwGcTyYLif33vbj4/fUQ5cCDEfDPfLiDb/2QFQDFQG8Tq4vLOcaPOfHQDFQGUQz4PhfnnR5j87AGoByiDugxLeI3293IwAqAUogfgWDPePFW3+swNgK7AMguF+LaLNf3YA7ASUceZguF+Tt8tHu9f4CTsBBZw1OLFXl48dgKDxE04FFnC24IKOOkVbf+gAWAjM7yzBcL9uHwuAQeMnLAQWcIZguF+/jwXAoPGTKxYC8+o5GO634aMEeKTbL6gIzKzHYLjflo8KwJFuv7hQEZhXb8Fwv0XXCsCRbr/gcpDMeglO7LUr2vhkBxBYB8inh2C43y6b/wd5gnWAjFoOSnjbZ/P/IE9QD5BRi8Fwvx83+/8jeYJ6gIxaC4b7fbnZ/x/JE1e8YWgerQTD/f5Em/Z2PtkBcC4gj9qD4X6/bur/b8kTV2wH5lFzcEFH32z7byRPfGI7ML0ag+F+/55s/43kiU9MA9KrKSjhPY+J4X+QJz4xDUivlmC4fy4Tw/8gT9xhGpDW0cFw/3xeDP+DPHGHaUBaRwXD/fN6MfwP8sQdpgFpHRGc2Du3F8P/IE884LLQdEoGF3Tg5vLPKfLEA84GpFMiGO5j9KT238kTD4azAbx9eAq5g+E+vvm8+/8VeeIpjginkSsY7sM9Ofr7jDzxFIuBaaQOhvuYMrP4N5InJrEYuF/KYLiPKQsW/0byxCQWA/dLEZzYw5wFi38jeeIl7gnYZ28w3Mecmco/J0+8xLXh+2wNSnix3N2133PkiZdiS5DzAdutDYb7WCPa5pNrv16RJ2ZxPmC7NcFwH2vN1P0/I0/MojBouxjKzwXDfWzztvbpH+SJRRgFbBNP9alguI89Njz9gzyxCKOA7WL/3oPhPvbZ9PQP8sRi7AhsF0P8aPQ88ZHGqpX/W/LEYuwIAMfbsPJ/S55YhVEAcLTNT/8gT6xGdSBwjIl3+1lDnliNMwLAMVbU/E+RJzbhpCBQ1ooTf6/IE5sM9wWwLQiU8bb0vP8ceWIzioOAMjYW/TwjT2zGtiCQ38rjvnPkiV1YEATySrDwd0ue2I0LRIE8Fl70uYY8sRtTASC9nRV/U+SJJJgKAGklHvqP5IlkmAoAaWQY+o/kiWSYCgD7ZRr6j+SJpJgKAPskKviZIk8kR4EQsE3Cgp8p8kQWnBgE1klU6z9HnsiC9QBguczz/lvyRDasBwBLJDvos4Q8kRU3CAFzdt3ws5Y8kR31AcBzGff7p8gT2cXchkVB4F6C6722kCeKYFEQ+Kbgop+TJ4qIfyy3CAGh6KKfkyeKYmcA5/aW65DPUvJEcewM4KwObvxBnjgE5cI4n6LbfVPkicOwPYizKFDjv5Q8cSg6AfTugL3+V+SJw9EJoFeVNf4gT1SBdxpCbyps/EGeqAYjAfSi0sYf5Imq0AmgdRU3/iBPVIdOAK2qaLV/ijxRJeoE0J4q9vnnyBPVomIQbTi8vHcNeaJqw9kBDhChVoce7NlCnqhefIM5SozaxGuyscYf5IkmcKkIahJ1Kwed599LnmhGfMPZIcDRKt/mmyNPNIfFQRyjqcW+KfJEk1gXQEmNzvefkSeaFVMCzhAgt4bn+8/IE82jaAh5xPZzE8U9a8gTXWBKgJRix6mTIb+TJ7rBLgFSaKCefw95ojuxUstoAGvFa6aDVf458kSXGA1gjXjqd7TQ94o80TXWBvBKx3P9KfLEKQw7BRwqwqjLFf4l5InTYFqAEK+Bkwz3n5EnTmP8oceQj4NF5xMFPScb7j8jT5xWDAFZH+jfSVb3l5InTi1GBcPhItYHejN07qec578iT+AydAQsFPaBhv+SPAETHQFTg/bQ8BeRJzCBNYI2xIIuc/zF5AnMiBcXx47rw6r+JvIEFhqqClknOFKMyE5UtpuDPIENGBWU9Hb9XjPMT0KewA7jqIDCovSG7+lXnvZpyRNIZOwMWDjcLhp9fA+Z22cjTyADRgZLDcP7eNLT6IuQJ5DZcAjpy/UQCqODsTT3x+v3hOF9cfIECosnXTzxztIhDPv0NPhKyBM42DhCiClDDIdb7hTi7z78G76nwddJnkCFouHcjhSiUQ3rCTXUILxd/y5jQx/n7zT2JsgTaMzYOQxvnR7lyvG0jSH2t45iKJiJkUR0GKPHhjwaf/3YsIfpSexoDA08/l808i78HzPcPJXn8KhQAAAAAElFTkSuQmCC",Et="/assets/video-iina.1db26170.png",xt="/assets/video-vlc.54e63a7e.png",_t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAK2UlEQVR4Xu2dC3BUZxXHD4g4VlukLRTEIKhYochjeBRaCoggpQaqBSrQWFuCwLbFDpRhQIs4Y8YRO1Lr4JSWJkCJVihgy0PerxapUhqaQrCFIkUghM1rs7sJVCYcz3d3v+Tuud+9e/dFdpPvP/OfwAzs3j0//v9zv2x2ANDS0tLS0tLS0tLS0tLS0tLS0tJqEHrhi1gJM+jrOqyAf2A5vEFeSr8exP+sVopFg59C9pJR6UrYRu7F/55WCkQJWGABoPY1Ss9K+tqZP4ZWkkQwRtGAryuG7+QAgfmFqDj+eFoJiob7nmLgbl1KNTYdEVrzx9WKQ1gFvRVDjt2VcIx8P398rRhFdfWoZbiJ2AvbCcxd/Hm0XIqAeCxDTdz19Lj5qBd/7EoREOkApWWJXvwxKMVADFdXQmkRLX7Qiz+6UgHkagXgyWrAzTWAvw0APh1s8Im5Qb34HZUMINfJ5yoBd/sAl/sB5zYCUHpOELaT+/Jr0YL4gVwmAIcpBQUEYKFi6C5cPy8I+TNr9eKPkFsgAQLwPgFYTzX0K+tw43ctBH4WgLwlevGHZAfkGu2BjwjAVgLwXOQeSJrnRLqU4OSORGjDr7FFSQIRe+A8pWAfQXiRaugZxQCTaQajwU8FoeSJlrz4j1SBZw2lYJFiaKk0BxGGYZiA4Owg7JpdC/359TZ7zQuAhw8rleYQzCBMMKTr6ff5U2rhy/y6m61uJBAnEAoYODPsWQGom9FSFv+NAhIPDAKBPyXnkh8nT/dD6fQAzG7Wiz/VQDgIFQwzCDMMAULCkP4xOccPJVOb6+JPJRAOgsPgqZAwZCrMMH4ShvEIeSr5R+TJftg3obkt/lQA4RDcwFBVlDkVAoSwAYI8iW7Nf0B3hxNqoH68Dwqyq6Arf20ZqWQC4QDcgrCDoUrFw/5GGNnkB8hjyCN8UDe8BvImZ/riTxYQDoGDsNsV5oqyS4WAIVPxkN9IhQFiLHmUgEG+hzzEBwjVUAYXBzwB+5dk5uJPFAiHoAJhB0O1uM2pUFWUTIWAIUAMEhAudUU4PQeheBfCOz6Ew36EQ/4SeNufzV9v2iteIByCHQwVCGEOQqbCXFEShLBIhYAhQEA5+VwOQsk6hCNlCP8MEogAgRAmGG+HfZD8ln8/HKzOnMWfTCBOu8IpFbyieCp6VxKAiw8ifLQC4djHCO8SgH+F3QDD3whDgBDeXxPy3pp62Fv9KuyuS//FHw8QDiIWGHxfqCpqXLWoodEI/1mKcPwownvBEAThIyYYAoSEYU7FwTCIfQYMhN1UY7vIO6vrYIcvD/5eeQufQ9ooViDxgHBa3MJTKAntL/emGlqEcHIvpYCGVxQMgVDBcKqoAyYYe3xmGAjbydsMl8OW6sf5LNJCsQCxA+EEwy4VA6taIVzw0DLeRMvYSxDqCIJwbSOIoyYQFhh+sbitFSVTIWBIEDsEDF8Ixpaw36xCeKPqZUBsxWfSpHIDxCkV0hyEeV8ICA+Ku6GL06iGChBOnCEINPz360IgGmC4SIWqosyp2OuLhCFSIZMhQGw2QCBsqgz5b1WL+EyaVNGAcBgcCE+GhDGNauhm71iET36P8CHtgeJgCIJ0BIjaRhgyFSoY5oqyLm5TRclUmEA0pCIMYiN5A/n1iquwtjZ93te3A8IhcBAcxgzy3RX9qIZ+iXCK9sBxGswHtZEQLKkQIEwVxUEYMEypiKgotridKmpzdSgVEoYBgrxOuBzhLxUL+FyaTBwIh6ACISsqu0rcDT1FNbSRaqgsBECagzDD4KlQwVClQsKQqZAVpV7c1lREwKhA+KuAIVy5jc+lySSBcAgqGI/QmaBVGR3IzuVTDZ0mCDTYD65EglDBsOwKxeK2gxHv4hapUFXUegajkPzn8nf5XJpMAgiHIEGIu6O+5fcjnF9GNUR74EQwBEH4eIww3KTC6WzBFzdPRcTiDleUJRXhinpNwqC7u7XkV737+FyaTHNMQASEMVV0HihdjHBmD0KJrxGA2W5ACMebCleL2xe5uLc6VJQqFRLGGgPI83wuTaaJPvAYe+CTDQj/LrUO3+xYU6GCwUHEe7YwUuGwuEVFOaVCwlgtvl4eyufSdDp51WMZvMoGiBhg8IqKNRXRKsq8uI2zBUuFZXFHVFQIhHDBpfRZ6IbcAHEDIu6K8lthSBDy2x92i5tXVMPZIkpFGSDIq8pOQUGgAx9J08oJiNuKkiAaYIRBqCrK6cTNzxY8FU6L21xRAgSvKJEKM4z8SzvgT95OfBxNLzsgqoriIOJOhaKilItbpsIEgqfCrqJUqRBeVVYKr5RN42NIH6mAcBDxwrA7catguF3cvKKUi7vcurgLvNdglfcP8MfT6futd0MSiKgntxVlt7hVFSXPFqoTd6oXt4SRX3YI8i9nyAeEJJBYQDilQllRNqmwragYFrdTKlZ7vbQrHku7b7E7SgBJFAYHwSvKdnErUqFa3KqKclrcKz6sh8cWvzhs2LD2/OWmv4oFEAcQsVaUanFLGDIVzu/mWVMRraJWX0CY9xL2HTsa87vdcQQBBvKXmTkqDjQCsQOhSkXK381jqTC+/WFKRd4W7PDQw/jz/t3xU6BSAqC/BLPIGf7RawGEg7CkQjjOVERb3KqKsqSC/NIxhNz5mDNiIJ6F1gKA9HVyAfl2/tIyU8W1ViDRUhENhtPibkiFCYQqFYXnEBa+gNnjx+CBrDvMAMwmSnAPf0mZLQ7EDgYHwRe307t5blKxkXbB0k1497SpuGbAN/nguenB4GlyZv64qKMkEA4iGRUVbXGvPIRZT87F34wZhFegLR+6yqKeCsnp8x540iWAcBiuKoqnIlxRTot73SmEZ5ehZ9I4PNPtK3zY0VxCHskvv/lJAnGbiljOFlvLEJa9hlOnP4pvDfk2H7Bb0xPCAnJbfunNU0UExHUqoi1uSsLqA/jdZ+bj+ux7ETu348ON1a+Ts/glN28JIBxGxOKWMGwqatNx7J23DJfnjMcrfboj3vYZxC+0QmxtGW4sPk3+Hr/UlqEiOofYpULcRfHFvfMCtl1eiM8+mYtnRw5A7EYp6HIzpeEmxHZtENtahhuLqTthMflz/DJbjo4SEBUMWVEH6ZZ07U6ctXghvjNxNGKfLog9b0P8xi2IXQlEFwLRke6Q2iWcis3k7vzyWp4EEH62eLMIf/jc87hlxkTE+76F2K8zgaDDWc+OiHfeHoIhU5F4RZ0lj+eX1XIlgOw5i/e9XIj582fhlQcGIw7thjj4q4iDskIwenUKpeLO9o0VJVMRf0V9Sv41+fP8klq0/pszzoPf6YE4/OuI9xKIIWEQ/ama+lEqeplSISsq8VTsJPfg16JFwlFf8+Dw7qFUSBgRFRVOhYDRWaRCLO64YZwnT+bXoGUSjiAgsqKMVIQrykjFreFUJFxR/yP/jpzZnyG/EcIhWZ5QRYVTwSsq8cV9gKz/iwu3olR4lBWV+NmilJxDzqD3s9NA2Kejx5IKubjjO1tcI79A/hJ/Li0Xwrs6TYpc3OFUxFdRh8n9+HNoxSDs2aFHEs4W5eRc1PWUHGGnmw7HubjrySvIt/LH1EpA2AaGUirEyZkP3MlHyYP5Y2klSTTcmRj6F88Hz11N9mDG/7hNBoiG/H3yxwoIwuJw9wo5zT5P0cyFMOCzNPQJGLp13UBeSZ5HTsPPUmhpaWlpaWlpaWlpaWlpaWlpaWlpaWklqv8Da8GBU4g36CAAAAAASUVORK5CYII=",Tt="/assets/video-mxplayer.5dfa69aa.png",St="/assets/video-mxplayer-pro.10406916.png",Ye={exports:{}};/*!
 * artplayer.js v4.5.2
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(ye,Ie){(function(O,C,x,S,c){var m=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Be!="undefined"?Be:{},M=typeof m.parcelRequire4dc0=="function"&&m.parcelRequire4dc0,T=M.cache||{},g=typeof Ke=="function"&&Ke.bind(ye);function u(l,h){if(!T[l]){if(!O[l]){var v=typeof m.parcelRequire4dc0=="function"&&m.parcelRequire4dc0;if(!h&&v)return v(l,!0);if(M)return M(l,!0);if(g&&typeof l=="string")return g(l);var f=new Error("Cannot find module '"+l+"'");throw f.code="MODULE_NOT_FOUND",f}t.resolve=function(i){var e=O[l][1][i];return e!=null?e:i},t.cache={};var r=T[l]=new u.Module(l);O[l][0].call(r.exports,t,r,r.exports,this)}return T[l].exports;function t(i){var e=t.resolve(i);return e===!1?{}:u(e)}}u.isParcelRequire=!0,u.Module=function(l){this.id=l,this.bundle=u,this.exports={}},u.modules=O,u.cache=T,u.parent=M,u.register=function(l,h){O[l]=[function(v,f){f.exports=h},{}]},Object.defineProperty(u,"root",{get:function(){return m.parcelRequire4dc0}}),m.parcelRequire4dc0=u;for(var n=0;n<C.length;n++)u(C[n]);var d=u(x);ye.exports=d})({"6SN6P":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("bundle-text:./style/index.less"),m=S.interopDefault(c),M=O("option-validator"),T=S.interopDefault(M),g=O("./utils/emitter"),u=S.interopDefault(g),n=O("./utils"),d=O("./scheme"),l=S.interopDefault(d),h=O("./config"),v=S.interopDefault(h),f=O("./whitelist"),r=S.interopDefault(f),t=O("./template"),i=S.interopDefault(t),e=O("./i18n"),s=S.interopDefault(e),o=O("./player"),a=S.interopDefault(o),p=O("./control"),D=S.interopDefault(p),L=O("./contextmenu"),y=S.interopDefault(L),E=O("./info"),_=S.interopDefault(E),A=O("./subtitle"),I=S.interopDefault(A),b=O("./events"),R=S.interopDefault(b),P=O("./hotkey"),w=S.interopDefault(P),F=O("./layer"),k=S.interopDefault(F),B=O("./loading"),U=S.interopDefault(B),j=O("./notice"),K=S.interopDefault(j),N=O("./mask"),Z=S.interopDefault(N),$=O("./icons"),Y=S.interopDefault($),ee=O("./setting"),Q=S.interopDefault(ee),G=O("./storage"),q=S.interopDefault(G),te=O("./plugins"),ie=S.interopDefault(te),ne=O("./mobile"),le=S.interopDefault(ne);let se=0;const oe=[];class J extends u.default{constructor(fe,de){super(),this.id=++se;const ve=n.mergeDeep(J.option,fe);this.option=(0,T.default)(ve,l.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new r.default(this),this.template=new i.default(this),this.events=new R.default(this),this.whitelist.state?(this.storage=new q.default(this),this.icons=new Y.default(this),this.i18n=new s.default(this),this.notice=new K.default(this),this.player=new a.default(this),this.layers=new k.default(this),this.controls=new D.default(this),this.contextmenu=new y.default(this),this.subtitle=new I.default(this),this.info=new _.default(this),this.loading=new U.default(this),this.hotkey=new w.default(this),this.mask=new Z.default(this),this.setting=new Q.default(this),this.plugins=new ie.default(this)):this.mobile=new le.default(this),typeof de=="function"&&this.on("ready",()=>de.call(this)),oe.push(this)}static get instances(){return oe}static get version(){return"4.5.2"}static get env(){return"production"}static get build(){return"1655888299105"}static get config(){return v.default}static get utils(){return n}static get scheme(){return l.default}static get Emitter(){return u.default}static get validator(){return T.default}static get kindOf(){return T.default.kindOf}static get html(){return i.default.html}static get option(){return{container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:n.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(fe=!0){this.events.destroy(),this.template.destroy(fe),oe.splice(oe.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(x.default=J,J.NOTICE_TIME=2e3,J.SETTING_WIDTH=250,J.SETTING_ITEM_WIDTH=200,J.SETTING_ITEM_HEIGHT=35,J.INDICATOR_SIZE=14,J.INDICATOR_SIZE_ICON=16,J.INDICATOR_SIZE_MOBILE=18,J.INDICATOR_SIZE_MOBILE_ICON=20,J.VOLUME_PANEL_WIDTH=60,J.VOLUME_HANDLE_WIDTH=12,J.RESIZE_TIME=500,J.SCROLL_TIME=200,J.SCROLL_GAP=50,J.AUTO_PLAYBACK_MAX=10,J.AUTO_PLAYBACK_TIMEOUT=3e3,J.RECONNECT_TIME_MAX=5,J.RECONNECT_SLEEP_TIME=1e3,J.CONTROL_HIDE_TIME=3e3,J.DB_CLICE_TIME=300,J.MOBILE_AUTO_PLAYBACKRATE=3,J.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,J.MOBILE_AUTO_ORIENTATION_TIME=200,J.INFO_LOOP_TIME=1e3,J.FAST_FORWARD_VALUE=3,J.FAST_FORWARD_TIME=1e3,typeof document!="undefined"&&!document.getElementById("artplayer-style")){const ae=document.createElement("style");ae.id="artplayer-style",ae.textContent=m.default,document.head.appendChild(ae)}typeof window!="undefined"&&(window.Artplayer=J),console.log(`%c ArtPlayer %c ${J.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"9EPUe","option-validator":"2A2W5","./utils/emitter":"7pHuB","./utils":"geSvU","./scheme":"3vPoh","./config":"eksZR","./whitelist":"fCKwj","./template":"bqHdK","./i18n":"4O9ZY","./player":"fzROd","./control":"kJ9J9","./contextmenu":"7rh9q","./info":"c896w","./subtitle":"2hqso","./events":"j2hlX","./hotkey":"aTHWZ","./layer":"f2kxw","./loading":"bOs9w","./notice":"ic4th","./mask":"iLfmB","./icons":"5lAmI","./setting":"d5XKP","./storage":"5M8nN","./plugins":"jWfEd","./mobile":"fkUkB","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9EPUe":[function(O,C,x){C.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:none}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-auto-size .art-video-player{transition:all .2s}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player .art-layer-autoPlayback{background-color:#000c;border-radius:3px;align-items:center;padding:10px;line-height:1;display:none;position:absolute;bottom:60px;left:20px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close{cursor:pointer;align-items:center;margin-right:10px;display:flex}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close svg{width:15px;height:15px;fill:#00c9ff}.art-video-player .art-layer-autoPlayback .art-autoPlayback-last{margin-right:10px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-jump{color:#00c9ff;cursor:pointer}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],"2A2W5":[function(O,C,x){C.exports=function(){function S(n){return(S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(n)}var c=Object.prototype.toString,m=function(n){if(n===void 0)return"undefined";if(n===null)return"null";var d=S(n);if(d==="boolean")return"boolean";if(d==="string")return"string";if(d==="number")return"number";if(d==="symbol")return"symbol";if(d==="function")return function(l){return M(l)==="GeneratorFunction"}(n)?"generatorfunction":"function";if(function(l){return Array.isArray?Array.isArray(l):l instanceof Array}(n))return"array";if(function(l){return!(!l.constructor||typeof l.constructor.isBuffer!="function")&&l.constructor.isBuffer(l)}(n))return"buffer";if(function(l){try{if(typeof l.length=="number"&&typeof l.callee=="function")return!0}catch(h){if(h.message.indexOf("callee")!==-1)return!0}return!1}(n))return"arguments";if(function(l){return l instanceof Date||typeof l.toDateString=="function"&&typeof l.getDate=="function"&&typeof l.setDate=="function"}(n))return"date";if(function(l){return l instanceof Error||typeof l.message=="string"&&l.constructor&&typeof l.constructor.stackTraceLimit=="number"}(n))return"error";if(function(l){return l instanceof RegExp||typeof l.flags=="string"&&typeof l.ignoreCase=="boolean"&&typeof l.multiline=="boolean"&&typeof l.global=="boolean"}(n))return"regexp";switch(M(n)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(l){return typeof l.throw=="function"&&typeof l.return=="function"&&typeof l.next=="function"}(n))return"generator";switch(d=c.call(n)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return d.slice(8,-1).toLowerCase().replace(/\s/g,"")};function M(n){return n.constructor?n.constructor.name:null}function T(n,d){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return g(n,d,l),u(n,d,l),function(h,v,f){var r=m(v),t=m(h);if(r==="object"){if(t!=="object")throw new Error("[Type Error]: '".concat(f.join("."),"' require 'object' type, but got '").concat(t,"'"));Object.keys(v).forEach(function(i){var e=h[i],s=v[i],o=f.slice();o.push(i),g(e,s,o),u(e,s,o),T(e,s,o)})}if(r==="array"){if(t!=="array")throw new Error("[Type Error]: '".concat(f.join("."),"' require 'array' type, but got '").concat(t,"'"));h.forEach(function(i,e){var s=h[e],o=v[e]||v[0],a=f.slice();a.push(e),g(s,o,a),u(s,o,a),T(s,o,a)})}}(n,d,l),n}function g(n,d,l){if(m(d)==="string"){var h=m(n);if(d[0]==="?"&&(d=d.slice(1)+"|undefined"),!(-1<d.indexOf("|")?d.split("|").map(function(v){return v.toLowerCase().trim()}).filter(Boolean).some(function(v){return h===v}):d.toLowerCase().trim()===h))throw new Error("[Type Error]: '".concat(l.join("."),"' require '").concat(d,"' type, but got '").concat(h,"'"))}}function u(n,d,l){if(m(d)==="function"){var h=d(n,m(n),l);if(h!==!0){var v=m(h);throw v==="string"?new Error(h):v==="error"?h:new Error("[Validator Error]: The scheme for '".concat(l.join("."),"' validator require return true, but got '").concat(h,"'"))}}}return T.kindOf=m,T}()},{}],"7pHuB":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=class{on(S,c,m){const M=this.e||(this.e={});return(M[S]||(M[S]=[])).push({fn:c,ctx:m}),this}once(S,c,m){const M=this;function T(...g){M.off(S,T),c.apply(m,g)}return T._=c,this.on(S,T,m)}emit(S,...c){const m=((this.e||(this.e={}))[S]||[]).slice();for(let M=0;M<m.length;M+=1)m[M].fn.apply(m[M].ctx,c);return this}off(S,c){const m=this.e||(this.e={}),M=m[S],T=[];if(M&&c)for(let g=0,u=M.length;g<u;g+=1)M[g].fn!==c&&M[g].fn._!==c&&T.push(M[g]);return T.length?m[S]=T:delete m[S],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(O,C,x){x.interopDefault=function(S){return S&&S.__esModule?S:{default:S}},x.defineInteropFlag=function(S){Object.defineProperty(S,"__esModule",{value:!0})},x.exportAll=function(S,c){return Object.keys(S).forEach(function(m){m==="default"||m==="__esModule"||c.hasOwnProperty(m)||Object.defineProperty(c,m,{enumerable:!0,get:function(){return S[m]}})}),c},x.export=function(S,c,m){Object.defineProperty(S,c,{enumerable:!0,get:m})}},{}],geSvU:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./dom");S.exportAll(c,x);var m=O("./error");S.exportAll(m,x);var M=O("./subtitle");S.exportAll(M,x);var T=O("./file");S.exportAll(T,x);var g=O("./property");S.exportAll(g,x);var u=O("./time");S.exportAll(u,x);var n=O("./format");S.exportAll(n,x);var d=O("./compatibility");S.exportAll(d,x)},{"./dom":"ff6Hs","./error":"lDQPM","./subtitle":"1dyFb","./file":"96gQe","./property":"lMM6V","./time":"41yFW","./format":"MRJhs","./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ff6Hs:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"query",()=>m),S.export(x,"queryAll",()=>M),S.export(x,"addClass",()=>T),S.export(x,"removeClass",()=>g),S.export(x,"hasClass",()=>u),S.export(x,"append",()=>n),S.export(x,"remove",()=>d),S.export(x,"setStyle",()=>l),S.export(x,"setStyles",()=>h),S.export(x,"getStyle",()=>v),S.export(x,"sublings",()=>f),S.export(x,"inverseClass",()=>r),S.export(x,"tooltip",()=>t),S.export(x,"isInViewport",()=>i),S.export(x,"includeFromEvent",()=>e),S.export(x,"replaceElement",()=>s);var c=O("./compatibility");function m(o,a=document){return a.querySelector(o)}function M(o,a=document){return Array.from(a.querySelectorAll(o))}function T(o,a){return o.classList.add(a)}function g(o,a){return o.classList.remove(a)}function u(o,a){return o.classList.contains(a)}function n(o,a){return a instanceof Element?o.appendChild(a):o.insertAdjacentHTML("beforeend",String(a)),o.lastElementChild||o.lastChild}function d(o){return o.parentNode.removeChild(o)}function l(o,a,p){return o.style[a]=p,o}function h(o,a){return Object.keys(a).forEach(p=>{l(o,p,a[p])}),o}function v(o,a,p=!0){const D=window.getComputedStyle(o,null).getPropertyValue(a);return p?parseFloat(D):D}function f(o){return Array.from(o.parentElement.children).filter(a=>a!==o)}function r(o,a){f(o).forEach(p=>g(p,a)),T(o,a)}function t(o,a,p="top"){c.isMobile||(o.setAttribute("aria-label",a),T(o,"hint--rounded"),T(o,`hint--${p}`))}function i(o,a=0){const p=o.getBoundingClientRect(),D=window.innerHeight||document.documentElement.clientHeight,L=window.innerWidth||document.documentElement.clientWidth,y=p.top-a<=D&&p.top+p.height+a>=0,E=p.left-a<=L+a&&p.left+p.width+a>=0;return y&&E}function e(o,a){return o.composedPath&&o.composedPath().indexOf(a)>-1}function s(o,a){return a.parentNode.replaceChild(o,a),o}},{"./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ki3pQ:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"userAgent",()=>c),S.export(x,"isMobile",()=>m),S.export(x,"isSafari",()=>M),S.export(x,"isWechat",()=>T),S.export(x,"isIE",()=>g),S.export(x,"isAndroid",()=>u),S.export(x,"isIOS",()=>n);const c=typeof window!="undefined"?window.navigator.userAgent:"",m=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(c),M=/^((?!chrome|android).)*safari/i.test(c),T=/MicroMessenger/i.test(c),g=/MSIE|Trident/i.test(c),u=/android/i.test(c),n=/iPad|iPhone|iPod/i.test(c)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lDQPM:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"ArtPlayerError",()=>c),S.export(x,"errorHandle",()=>m);class c extends Error{constructor(T,g){super(T),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,g||this.constructor),this.name="ArtPlayerError"}}function m(M,T){if(!M)throw new c(T);return M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1dyFb":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(T){return`WEBVTT \r
\r
`.concat((g=T,g.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(u,n,d)=>{let l=d.slice(0,3);return d.length===1&&(l=d+"00"),d.length===2&&(l=d+"0"),`${n},${l}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var g}function m(T){return URL.createObjectURL(new Blob([T],{type:"text/vtt"}))}function M(T){const g=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function u(n=""){return n.split(/[:.]/).map((d,l,h)=>{if(l===h.length-1){if(d.length===1)return`.${d}00`;if(d.length===2)return`.${d}0`}else if(d.length===1)return(l===0?"0":":0")+d;return l===0?d:l===h.length-1?`.${d}`:`:${d}`}).join("")}return`WEBVTT

${T.split(/\r?\n/).map(n=>{const d=n.match(g);return d?{start:u(d[1].trim()),end:u(d[2].trim()),text:d[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(l=>l.trim()).join(`
`)}:null}).filter(n=>n).map((n,d)=>n?`${d+1}
${n.start} --> ${n.end}
${n.text}`:"").filter(n=>n.trim()).join(`

`)}`}S.defineInteropFlag(x),S.export(x,"srtToVtt",()=>c),S.export(x,"vttToBlob",()=>m),S.export(x,"assToVtt",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"96gQe":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(M){return M.includes("?")?c(M.split("?")[0]):M.includes("#")?c(M.split("#")[0]):M.trim().toLowerCase().split(".").pop()}function m(M,T){const g=document.createElement("a");g.style.display="none",g.href=M,g.download=T,document.body.appendChild(g),g.click(),document.body.removeChild(g)}S.defineInteropFlag(x),S.export(x,"getExt",()=>c),S.export(x,"download",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lMM6V:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"def",()=>c),S.export(x,"has",()=>M),S.export(x,"get",()=>T),S.export(x,"mergeDeep",()=>g);const c=Object.defineProperty,{hasOwnProperty:m}=Object.prototype;function M(u,n){return m.call(u,n)}function T(u,n){return Object.getOwnPropertyDescriptor(u,n)}function g(...u){const n=d=>d&&typeof d=="object"&&!Array.isArray(d);return u.reduce((d,l)=>(Object.keys(l).forEach(h=>{const v=d[h],f=l[h];Array.isArray(v)&&Array.isArray(f)?d[h]=v.concat(...f):!n(v)||!n(f)||f instanceof Element?d[h]=f:d[h]=g(v,f)}),d),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"41yFW":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(T=0){return new Promise(g=>setTimeout(g,T))}function m(T,g,u){let n;function d(...l){clearTimeout(n),n=setTimeout(function(){n=null,T.apply(u,l)},g)}return d.clearTimeout=function(){clearTimeout(n)},d}function M(T,g){let u,n,d=!1;return function l(...h){if(d)return u=h,void(n=this);d=!0,T.apply(this,h),setTimeout(()=>{d=!1,u&&(l.apply(n,u),u=null,n=null)},g)}}S.defineInteropFlag(x),S.export(x,"sleep",()=>c),S.export(x,"debounce",()=>m),S.export(x,"throttle",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],MRJhs:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(T,g,u){return Math.max(Math.min(T,Math.max(g,u)),Math.min(g,u))}function m(T){const g=Math.floor(T/3600),u=Math.floor((T-3600*g)/60),n=Math.floor(T-3600*g-60*u);return(g>0?[g,u,n]:[u,n]).map(d=>d<10?`0${d}`:String(d)).join(":")}function M(T){return T.replace(/[&<>'"]/g,g=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[g]||g)}S.defineInteropFlag(x),S.export(x,"clamp",()=>c),S.export(x,"secondToTime",()=>m),S.export(x,"escape",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3vPoh":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"ComponentOption",()=>l);var c=O("../utils");const m="array",M="boolean",T="string",g="number",u="object",n="function";function d(h,v,f){return(0,c.errorHandle)(v===T||v===g||h instanceof Element,`${f.join(".")} require '${T}' or 'Element' type`)}const l={html:d,disable:`?${M}`,name:`?${T}`,index:`?${g}`,style:`?${u}`,click:`?${n}`,mounted:`?${n}`,tooltip:`?${T}|${g}`,width:`?${g}`,selector:`?${m}`,onSelect:`?${n}`,switch:`?${M}`,onSwitch:`?${n}`,range:`?${m}`,onRange:`?${n}`};x.default={container:d,url:T,poster:T,title:T,type:T,theme:T,lang:T,volume:g,isLive:M,muted:M,autoplay:M,autoSize:M,autoMini:M,loop:M,flip:M,playbackRate:M,aspectRatio:M,screenshot:M,setting:M,hotkey:M,pip:M,mutex:M,backdrop:M,fullscreen:M,fullscreenWeb:M,subtitleOffset:M,miniProgressBar:M,useSSR:M,playsInline:M,lock:M,fastForward:M,autoPlayback:M,autoOrientation:M,plugins:[n],whitelist:[`${T}|${n}|regexp`],layers:[l],contextmenu:[l],settings:[l],controls:[{...l,position:(h,v,f)=>{const r=["top","left","right"];return(0,c.errorHandle)(r.includes(h),`${f.join(".")} only accept ${r.toString()} as parameters`)}}],quality:[{default:`?${M}`,html:T,url:T}],highlight:[{time:g,text:T}],thumbnails:{url:T,number:g,column:g},subtitle:{url:T,type:T,style:u,encoding:T},moreVideoAttr:u,icons:u,customType:u}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eksZR:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fCKwj:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");x.default=class{constructor(c){this.art=c}get state(){const{option:c,constructor:{kindOf:m}}=this.art;return!S.isMobile||c.whitelist.some(M=>{switch(m(M)){case"string":return M==="*"||S.userAgent.indexOf(M)>-1;case"function":return M(S.userAgent);case"regexp":return M.test(S.userAgent);default:return!1}})}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bqHdK:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");class c{constructor(M){this.art=M;const{option:T,constructor:g,whitelist:u}=M;T.container instanceof Element?this.$container=T.container:(this.$container=(0,S.query)(T.container),(0,S.errorHandle)(this.$container,`No container element found by ${T.container}`));const n=this.$container.tagName.toLowerCase();(0,S.errorHandle)(n==="div",`Unsupported container element type, only support 'div' but got '${n}'`),(0,S.errorHandle)(g.instances.every(d=>d.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=M.id,this.$original=this.$container.cloneNode(!0),u.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.5.2</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(M){return(0,S.query)(M,this.$container)}desktop(){const{option:M}=this.art;M.useSSR||(this.$container.innerHTML=c.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),M.backdrop&&((0,S.addClass)(this.$setting,"art-backdrop-filter"),(0,S.addClass)(this.$contextmenu,"art-backdrop-filter"),(0,S.addClass)(this.$info,"art-backdrop-filter")),S.isMobile&&(0,S.addClass)(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(M){M?(0,S.replaceElement)(this.$original,this.$container):(0,S.addClass)(this.$player,"art-destroy")}}x.default=c},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4O9ZY":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../utils"),m=O("./zh-cn.json"),M=S.interopDefault(m),T=O("./zh-tw.json"),g=S.interopDefault(T),u=O("./pl.json"),n=S.interopDefault(u),d=O("./cs.json"),l=S.interopDefault(d);x.default=class{constructor(h){this.art=h,this.languages={"zh-cn":M.default,"zh-tw":g.default,pl:n.default,cs:l.default},this.init()}init(){const h=this.art.option.lang.toLowerCase();this.language=this.languages[h]||{}}get(h){return this.language[h]||h}update(h){this.languages=(0,c.mergeDeep)(this.languages,h),this.init()}}},{"../utils":"geSvU","./zh-cn.json":"e7BQ4","./zh-tw.json":"5kFyN","./pl.json":"3cd1e","./cs.json":"an7cR","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e7BQ4:[function(O,C,x){C.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F6C\u64AD\u653E"}')},{}],"5kFyN":[function(O,C,x){C.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F49\u64AD\u653E"}')},{}],"3cd1e":[function(O,C,x){C.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Last Seen":"Ostatnio widziany","Jump Play":"Skocz do gry"}')},{}],an7cR:[function(O,C,x){C.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Last Seen":"Naposledy vid\u011Bn","Jump Play":"Hra na skok"}')},{}],fzROd:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./urlMix"),m=S.interopDefault(c),M=O("./attrMix"),T=S.interopDefault(M),g=O("./playMix"),u=S.interopDefault(g),n=O("./pauseMix"),d=S.interopDefault(n),l=O("./toggleMix"),h=S.interopDefault(l),v=O("./seekMix"),f=S.interopDefault(v),r=O("./volumeMix"),t=S.interopDefault(r),i=O("./currentTimeMix"),e=S.interopDefault(i),s=O("./durationMix"),o=S.interopDefault(s),a=O("./switchMix"),p=S.interopDefault(a),D=O("./playbackRateMix"),L=S.interopDefault(D),y=O("./aspectRatioMix"),E=S.interopDefault(y),_=O("./screenshotMix"),A=S.interopDefault(_),I=O("./fullscreenMix"),b=S.interopDefault(I),R=O("./fullscreenWebMix"),P=S.interopDefault(R),w=O("./pipMix"),F=S.interopDefault(w),k=O("./loadedMix"),B=S.interopDefault(k),U=O("./playedMix"),j=S.interopDefault(U),K=O("./playingMix"),N=S.interopDefault(K),Z=O("./autoSizeMix"),$=S.interopDefault(Z),Y=O("./rectMix"),ee=S.interopDefault(Y),Q=O("./flipMix"),G=S.interopDefault(Q),q=O("./miniMix"),te=S.interopDefault(q),ie=O("./loopMix"),ne=S.interopDefault(ie),le=O("./posterMix"),se=S.interopDefault(le),oe=O("./autoHeightMix"),J=S.interopDefault(oe),ae=O("./themeMix"),fe=S.interopDefault(ae),de=O("./titleMix"),ve=S.interopDefault(de),ue=O("./normalSizeMix"),Te=S.interopDefault(ue),he=O("./subtitleOffsetMix"),Ee=S.interopDefault(he),W=O("./optionInit"),z=S.interopDefault(W),V=O("./eventInit"),X=S.interopDefault(V);x.default=class{constructor(H){(0,m.default)(H),(0,T.default)(H),(0,u.default)(H),(0,d.default)(H),(0,h.default)(H),(0,f.default)(H),(0,t.default)(H),(0,e.default)(H),(0,o.default)(H),(0,p.default)(H),(0,L.default)(H),(0,E.default)(H),(0,A.default)(H),(0,b.default)(H),(0,P.default)(H),(0,F.default)(H),(0,B.default)(H),(0,j.default)(H),(0,N.default)(H),(0,$.default)(H),(0,ee.default)(H),(0,G.default)(H),(0,te.default)(H),(0,ne.default)(H),(0,se.default)(H),(0,J.default)(H),(0,fe.default)(H),(0,ve.default)(H),(0,Te.default)(H),(0,Ee.default)(H),(0,X.default)(H),(0,z.default)(H)}}},{"./urlMix":"cChak","./attrMix":"e6Qkm","./playMix":"1FNSV","./pauseMix":"aPHUd","./toggleMix":"joISC","./seekMix":"4wG3e","./volumeMix":"42Xo1","./currentTimeMix":"8Z3pM","./durationMix":"hpnJy","./switchMix":"aCsa8","./playbackRateMix":"61TVa","./aspectRatioMix":"8BV9k","./screenshotMix":"bop8O","./fullscreenMix":"i63VK","./fullscreenWebMix":"bEKHA","./pipMix":"ibIuh","./loadedMix":"kwpxq","./playedMix":"e4Iws","./playingMix":"fueZP","./autoSizeMix":"l6TMg","./rectMix":"6URTt","./flipMix":"joth7","./miniMix":"durkk","./loopMix":"5EZwI","./posterMix":"22WMt","./autoHeightMix":"8pdNr","./themeMix":"eADqm","./titleMix":"8T9U6","./normalSizeMix":"iEQHG","./subtitleOffsetMix":"8CMLG","./optionInit":"aqLU7","./eventInit":"59ETf","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],cChak:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{option:m,template:{$video:M}}=c;(0,S.def)(c,"url",{get:()=>M.currentSrc,async set(T){const g=m.type||(0,S.getExt)(T),u=m.customType[g];g&&u?(await(0,S.sleep)(),c.loading.show=!0,u.call(c,M,T,c)):(c.url&&c.url!==T&&c.once("video:canplay",()=>{c.isReady&&c.emit("restart")}),M.src=T,c.option.url=T,c.emit("url",T))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e6Qkm:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{template:{$video:m}}=c;(0,S.def)(c,"attr",{value(M,T){if(T===void 0)return m[M];m[M]=T}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1FNSV":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,notice:M,option:T,constructor:{instances:g},template:{$video:u}}=c;(0,S.def)(c,"play",{value(){const n=u.play();if(n&&n.then&&n.then().catch(d=>{throw M.show=d,d}),T.mutex)for(let d=0;d<g.length;d++){const l=g[d];l!==c&&l.pause()}return M.show=m.get("Play"),c.emit("play"),n}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPHUd:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{template:{$video:m},i18n:M,notice:T}=c;(0,S.def)(c,"pause",{value(){const g=m.pause();return T.show=M.get("Pause"),c.emit("pause"),g}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joISC:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){(0,S.def)(c,"toggle",{value:()=>c.playing?c.pause():c.play()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4wG3e":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{notice:m}=c;(0,S.def)(c,"seek",{set(M){c.currentTime=M,c.emit("seek",c.currentTime),c.duration&&(m.show=`${(0,S.secondToTime)(c.currentTime)} / ${(0,S.secondToTime)(c.duration)}`)}}),(0,S.def)(c,"forward",{set(M){c.seek=c.currentTime+M}}),(0,S.def)(c,"backward",{set(M){c.seek=c.currentTime-M}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"42Xo1":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{template:{$video:m},i18n:M,notice:T,storage:g}=c;(0,S.def)(c,"volume",{get:()=>m.volume||0,set:u=>{m.volume=(0,S.clamp)(u,0,1),T.show=`${M.get("Volume")}: ${parseInt(100*m.volume,10)}`,m.volume!==0&&g.set("volume",m.volume),c.emit("volume",m.volume)}}),(0,S.def)(c,"muted",{get:()=>m.muted,set:u=>{m.muted=u,c.emit("volume",m.volume)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8Z3pM":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{$video:m}=c.template;(0,S.def)(c,"currentTime",{get:()=>m.currentTime||0,set:M=>{M=parseFloat(M),Number.isNaN(M)||(m.currentTime=(0,S.clamp)(M,0,c.duration))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],hpnJy:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){(0,S.def)(c,"duration",{get:()=>{const{duration:m}=c.template.$video;return m===1/0?0:m||0}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aCsa8:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,option:M,notice:T}=c;function g(u,n,d){return new Promise(l=>{if(u===c.url)return l(u);const{playing:h}=c;c.pause(),URL.revokeObjectURL(c.url),c.url=u,c.once("video:canplay",()=>{c.playbackRate=!1,c.aspectRatio=!1,c.flip="normal",c.autoSize=M.autoSize,c.currentTime=d,c.notice.show="",h&&c.play(),n&&(T.show=`${m.get("Switch Video")}: ${n}`),c.emit("switch",u),l(u)})})}(0,S.def)(c,"switchQuality",{value:(u,n)=>g(u,n,c.currentTime)}),(0,S.def)(c,"switchUrl",{value:(u,n)=>g(u,n,0)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"61TVa":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{template:{$video:m},i18n:M,notice:T}=c;(0,S.def)(c,"playbackRate",{get:()=>m.playbackRate,set(g){if(g){if(g===m.playbackRate)return;const u=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];(0,S.errorHandle)(u.includes(g),`'playbackRate' only accept ${u.toString()} as parameters`),m.playbackRate=g,T.show=`${M.get("Rate")}: ${g===1?M.get("Normal"):`${g}x`}`,c.emit("playbackRate",g)}else c.playbackRate=1,c.emit("playbackRate")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8BV9k":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{template:{$video:m,$player:M},i18n:T,notice:g}=c;(0,S.def)(c,"aspectRatio",{get:()=>M.dataset.aspectRatio||"default",set(u){u||(u="default");const n=["default","4:3","16:9"];if((0,S.errorHandle)(n.includes(u),`'aspectRatio' only accept ${n.toString()} as parameters`),u==="default")(0,S.setStyle)(m,"width",null),(0,S.setStyle)(m,"height",null),(0,S.setStyle)(m,"padding",null),delete M.dataset.aspectRatio;else{const d=u.split(":").map(Number),{videoWidth:l,videoHeight:h}=m,{clientWidth:v,clientHeight:f}=M,r=l/h,t=d[0]/d[1];if(r>t){const i=t*h/l;(0,S.setStyle)(m,"width",100*i+"%"),(0,S.setStyle)(m,"height","100%"),(0,S.setStyle)(m,"padding",`0 ${(v-v*i)/2}px`)}else{const i=l/t/h;(0,S.setStyle)(m,"width","100%"),(0,S.setStyle)(m,"height",100*i+"%"),(0,S.setStyle)(m,"padding",(f-f*i)/2+"px 0")}M.dataset.aspectRatio=u}g.show=`${T.get("Aspect Ratio")}: ${u==="default"?T.get("Default"):u}`,c.emit("aspectRatio",u)}}),(0,S.def)(c,"aspectRatioReset",{set(u){if(u){const{aspectRatio:n}=c;c.aspectRatio=n}}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bop8O:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{option:m,notice:M,template:{$video:T}}=c,g=document.createElement("canvas");(0,S.def)(c,"getDataURL",{value:()=>new Promise((u,n)=>{try{g.width=T.videoWidth,g.height=T.videoHeight,g.getContext("2d").drawImage(T,0,0),u(g.toDataURL("image/png"))}catch(d){M.show=d,n(d)}})}),(0,S.def)(c,"getBlobUrl",{value:()=>new Promise((u,n)=>{try{g.width=T.videoWidth,g.height=T.videoHeight,g.getContext("2d").drawImage(T,0,0),g.toBlob(d=>{u(URL.createObjectURL(d))})}catch(d){M.show=d,n(d)}})}),(0,S.def)(c,"screenshot",{value:async()=>{const u=await c.getDataURL();return(0,S.download)(u,`${m.title||"artplayer"}_${(0,S.secondToTime)(T.currentTime)}.png`),c.emit("screenshot",u),u}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i63VK:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../libs/screenfull"),m=S.interopDefault(c),M=O("../utils");x.default=function(T){const{i18n:g,notice:u,template:{$video:n,$player:d}}=T,l=(0,m.default)();T.once("video:loadedmetadata",()=>{var h;l.isEnabled?(h=T,l.on("change",()=>h.emit("fullscreen",l.isFullscreen)),(0,M.def)(h,"fullscreen",{get:()=>l.isFullscreen,async set(v){v?(h.normalSize="fullscreen",h.aspectRatioReset=!0,h.autoSize=!1,await l.request(d),(0,M.addClass)(d,"art-fullscreen"),h.emit("resize"),h.emit("fullscreen",!0),u.show=""):(h.aspectRatioReset=!0,h.autoSize=h.option.autoSize,await l.exit(),(0,M.removeClass)(d,"art-fullscreen"),h.emit("resize"),h.emit("fullscreen"),u.show="")}})):document.fullscreenEnabled||n.webkitSupportsFullscreen?(v=>{(0,M.def)(v,"fullscreen",{get:()=>n.webkitDisplayingFullscreen,set(f){f?(v.normalSize="fullscreen",n.webkitEnterFullscreen(),v.emit("fullscreen",!0),u.show=""):(n.webkitExitFullscreen(),v.emit("fullscreen"),u.show="")}})})(T):(0,M.def)(T,"fullscreen",{get:()=>!1,set(){u.show=g.get("Fullscreen Not Supported")}}),(0,M.def)(T,"fullscreen",(0,M.get)(T,"fullscreen"))})}},{"../libs/screenfull":"aPwar","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPwar:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(){const S=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],c=(()=>{const T=S[0],g={};for(const u of S)if(u[1]in document){for(const[n,d]of u.entries())g[T[n]]=d;return g}return!1})(),m={change:c.fullscreenchange,error:c.fullscreenerror};let M={request:(T=document.documentElement,g)=>new Promise((u,n)=>{const d=()=>{M.off("change",d),u()};M.on("change",d);const l=T[c.requestFullscreen](g);l instanceof Promise&&l.then(d).catch(n)}),exit:()=>new Promise((T,g)=>{if(!M.isFullscreen)return void T();const u=()=>{M.off("change",u),T()};M.on("change",u);const n=document[c.exitFullscreen]();n instanceof Promise&&n.then(u).catch(g)}),toggle:(T,g)=>M.isFullscreen?M.exit():M.request(T,g),onchange(T){M.on("change",T)},onerror(T){M.on("error",T)},on(T,g){const u=m[T];u&&document.addEventListener(u,g,!1)},off(T,g){const u=m[T];u&&document.removeEventListener(u,g,!1)},raw:c};return Object.defineProperties(M,{isFullscreen:{get:()=>Boolean(document[c.fullscreenElement])},element:{enumerable:!0,get:()=>document[c.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[c.fullscreenEnabled])}}),c||(M={isEnabled:!1}),M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bEKHA:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{notice:m,template:{$player:M}}=c;(0,S.def)(c,"fullscreenWeb",{get:()=>(0,S.hasClass)(M,"art-fullscreen-web"),set(T){T?(c.normalSize="fullscreenWeb",(0,S.addClass)(M,"art-fullscreen-web"),c.aspectRatioReset=!0,c.autoSize=!1,c.emit("resize"),c.emit("fullscreenWeb",!0),m.show=""):((0,S.removeClass)(M,"art-fullscreen-web"),c.aspectRatioReset=!0,c.autoSize=c.option.autoSize,c.emit("resize"),c.emit("fullscreenWeb"),m.show="")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ibIuh:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,notice:M,template:{$video:T}}=c;document.pictureInPictureEnabled?function(g){const{template:{$video:u},events:{proxy:n},notice:d}=g;u.disablePictureInPicture=!1,(0,S.def)(g,"pip",{get:()=>document.pictureInPictureElement,set(l){l?(g.normalSize="pip",u.requestPictureInPicture().catch(h=>{throw d.show=h,h})):document.exitPictureInPicture().catch(h=>{throw d.show=h,h})}}),n(u,"enterpictureinpicture",()=>{g.emit("pip",!0)}),n(u,"leavepictureinpicture",()=>{g.emit("pip")})}(c):T.webkitSupportsPresentationMode?function(g){const{$video:u}=g.template;u.webkitSetPresentationMode("inline"),(0,S.def)(g,"pip",{get:()=>u.webkitPresentationMode==="picture-in-picture",set(n){n?(g.normalSize="pip",u.webkitSetPresentationMode("picture-in-picture"),g.emit("pip",!0)):(u.webkitSetPresentationMode("inline"),g.emit("pip"))}})}(c):(0,S.def)(c,"pip",{get:()=>!1,set(){M.show=m.get("PIP Not Supported")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kwpxq:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{$video:m}=c.template;(0,S.def)(c,"loaded",{get:()=>c.loadedTime/m.duration}),(0,S.def)(c,"loadedTime",{get:()=>m.buffered.length?m.buffered.end(m.buffered.length-1):0})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e4Iws:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){(0,S.def)(c,"played",{get:()=>c.currentTime/c.duration})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fueZP:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{$video:m}=c.template;(0,S.def)(c,"playing",{get:()=>m.currentTime>0&&!m.paused&&!m.ended&&m.readyState>2})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],l6TMg:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{$container:m,$player:M,$video:T}=c.template;(0,S.def)(c,"autoSize",{get:()=>(0,S.hasClass)(m,"art-auto-size"),set(g){if(g){const{videoWidth:u,videoHeight:n}=T,{width:d,height:l}=m.getBoundingClientRect(),h=u/n,v=d/l;if((0,S.addClass)(m,"art-auto-size"),v>h){const f=l*h/d*100;(0,S.setStyle)(M,"width",`${f}%`),(0,S.setStyle)(M,"height","100%")}else{const f=d/h/l*100;(0,S.setStyle)(M,"width","100%"),(0,S.setStyle)(M,"height",`${f}%`)}c.emit("autoSize",{width:c.width,height:c.height})}else(0,S.removeClass)(m,"art-auto-size"),(0,S.setStyle)(M,"width",null),(0,S.setStyle)(M,"height",null),c.emit("autoSize")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"6URTt":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){(0,S.def)(c,"rect",{get:()=>c.template.$player.getBoundingClientRect()});const m=["bottom","height","left","right","top","width"];for(let M=0;M<m.length;M++){const T=m[M];(0,S.def)(c,T,{get:()=>c.rect[T]})}(0,S.def)(c,"x",{get:()=>c.left+window.pageXOffset}),(0,S.def)(c,"y",{get:()=>c.top+window.pageYOffset})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joth7:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{template:{$player:m},i18n:M,notice:T}=c;(0,S.def)(c,"flip",{get:()=>m.dataset.flip||"normal",set(g){g||(g="normal");const u=["normal","horizontal","vertical"];(0,S.errorHandle)(u.includes(g),`'flip' only accept ${u.toString()} as parameters`),g==="normal"?delete m.dataset.flip:m.dataset.flip=g;const n=g.replace(g[0],g[0].toUpperCase());T.show=`${M.get("Video Flip")}: ${M.get(n)}`,c.emit("flip",g)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],durkk:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,option:M,storage:T,events:{proxy:g},template:{$player:u,$miniClose:n,$miniTitle:d,$miniHeader:l}}=c;let h=!1,v=0,f=0,r=0,t=0;g(l,"mousedown",i=>{h=!0,v=i.pageX,f=i.pageY,r=c.left,t=c.top}),g(document,"mousemove",i=>{if(h){(0,S.addClass)(u,"art-is-dragging");const e=t+i.pageY-f,s=r+i.pageX-v;(0,S.setStyle)(u,"top",`${e}px`),(0,S.setStyle)(u,"left",`${s}px`),T.set("top",e),T.set("left",s)}}),g(document,"mouseup",()=>{h=!1,(0,S.removeClass)(u,"art-is-dragging")}),g(n,"click",()=>{c.mini=!1,h=!1,(0,S.removeClass)(u,"art-is-dragging")}),(0,S.append)(d,M.title||m.get("Mini Player")),(0,S.def)(c,"mini",{get:()=>(0,S.hasClass)(u,"art-mini"),set(i){if(i){c.normalSize="mini",c.autoSize=!1,(0,S.addClass)(u,"art-mini");const e=T.get("top"),s=T.get("left");if(e&&s)(0,S.setStyle)(u,"top",`${e}px`),(0,S.setStyle)(u,"left",`${s}px`),(0,S.isInViewport)(l)||(T.del("top"),T.del("left"),c.mini=!0);else{const o=window.innerHeight-c.height-50,a=window.innerWidth-c.width-50;T.set("top",o),T.set("left",a),(0,S.setStyle)(u,"top",`${o}px`),(0,S.setStyle)(u,"left",`${a}px`)}c.aspectRatio=!1,c.playbackRate=!1,c.notice.show="",c.emit("mini",!0)}else(0,S.removeClass)(u,"art-mini"),(0,S.setStyle)(u,"top",null),(0,S.setStyle)(u,"left",null),c.aspectRatio=!1,c.playbackRate=!1,c.autoSize=M.autoSize,c.notice.show="",c.emit("mini")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5EZwI":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){let m=[];(0,S.def)(c,"loop",{get:()=>m,set:M=>{if(Array.isArray(M)&&typeof M[0]=="number"&&typeof M[1]=="number"){const T=(0,S.clamp)(M[0],0,Math.min(M[1],c.duration)),g=(0,S.clamp)(M[1],T,c.duration);g-T>=1?(m=[T,g],c.emit("loop",m)):(m=[],c.emit("loop"))}else m=[],c.emit("loop")}}),c.on("video:timeupdate",()=>{m.length&&(c.currentTime<m[0]||c.currentTime>m[1])&&(c.seek=m[0])})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"22WMt":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{option:m,template:{$poster:M}}=c;(0,S.def)(c,"poster",{get:()=>m.poster,set(T){m.poster=T,(0,S.setStyle)(M,"backgroundImage",`url(${T})`)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8pdNr":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{option:m,template:{$container:M,$video:T}}=c,g=M.style.height;(0,S.def)(c,"autoHeight",{get:()=>(0,S.hasClass)(M,"art-auto-height"),set(u){if(u){const{clientWidth:n}=M,{videoHeight:d,videoWidth:l}=T,h=d*(n/l);(0,S.setStyle)(M,"height",h+"px"),(0,S.addClass)(M,"art-auto-height"),c.autoSize=m.autoSize,c.emit("autoHeight",h)}else(0,S.setStyle)(M,"height",g),(0,S.removeClass)(M,"art-auto-height"),c.autoSize=m.autoSize,c.emit("autoHeight")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eADqm:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{option:m,template:{$player:M}}=c;(0,S.def)(c,"theme",{get:()=>getComputedStyle(M).getPropertyValue("--theme"),set(T){m.theme=T,M.style.setProperty("--theme",T)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8T9U6":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){(0,S.def)(c,"title",{get:()=>c.option.title,set(m){c.option.title=m}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iEQHG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const m=["mini","pip","fullscreen","fullscreenWeb"];(0,S.def)(c,"normalSize",{get:()=>m.every(M=>!c[M]),set(M){m.filter(T=>T!==M).forEach(T=>{c[T]&&(c[T]=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8CMLG":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{clamp:m}=c.constructor.utils,{notice:M,template:T,i18n:g}=c;let u=0,n=[];c.on("subtitle:switch",()=>{n=[]}),(0,S.def)(c,"subtitleOffset",{get:()=>u,set(d){if(T.$track&&T.$track.track){const l=Array.from(T.$track.track.cues);u=m(d,-5,5);for(let h=0;h<l.length;h++){const v=l[h];n[h]||(n[h]={startTime:v.startTime,endTime:v.endTime}),v.startTime=m(n[h].startTime+u,0,c.duration),v.endTime=m(n[h].endTime+u,0,c.duration)}c.subtitle.update(),M.show=`${g.get("Subtitle Offset")}: ${d}s`,c.emit("subtitleOffset",d)}else c.emit("subtitleOffset",0)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aqLU7:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{option:m,storage:M,template:{$video:T,$poster:g}}=c;Object.keys(m.moreVideoAttr).forEach(n=>{c.attr(n,m.moreVideoAttr[n])}),m.muted&&(c.muted=m.muted),m.volume&&(T.volume=(0,S.clamp)(m.volume,0,1));const u=M.get("volume");typeof u=="number"&&(T.volume=(0,S.clamp)(u,0,1)),m.poster&&(0,S.setStyle)(g,"backgroundImage",`url(${m.poster})`),m.autoplay&&(T.autoplay=m.autoplay),m.playsInline&&(T.playsInline=!0,T["webkit-playsinline"]=!0),m.theme&&(c.theme=m.theme),c.url=m.url}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"59ETf":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../config"),m=S.interopDefault(c),M=O("../utils");x.default=function(T){const{i18n:g,notice:u,option:n,constructor:d,events:{proxy:l},template:{$player:h,$video:v,$poster:f}}=T;let r=0;for(let t=0;t<m.default.events.length;t++)l(v,m.default.events[t],i=>{T.emit(`video:${i.type}`,i)});T.on("video:canplay",()=>{r=0,T.loading.show=!1}),T.once("video:canplay",()=>{T.loading.show=!1,T.controls.show=!0,T.mask.show=!0,T.isReady=!0,T.emit("ready")}),T.on("video:ended",()=>{n.loop?(T.seek=0,T.play(),T.controls.show=!1,T.mask.show=!1):(T.controls.show=!0,T.mask.show=!0)}),T.on("video:error",async()=>{r<d.RECONNECT_TIME_MAX?(await(0,M.sleep)(d.RECONNECT_SLEEP_TIME),r+=1,T.url=n.url,u.show=`${g.get("Reconnect")}: ${r}`,T.emit("error",r)):(T.mask.show=!0,T.loading.show=!1,T.controls.show=!0,(0,M.addClass)(h,"art-error"),await(0,M.sleep)(d.RECONNECT_SLEEP_TIME),u.show=g.get("Video Load Failed"),T.destroy(!1))}),T.on("video:loadedmetadata",()=>{T.autoSize=n.autoSize,M.isMobile&&(T.loading.show=!1,T.controls.show=!0,T.mask.show=!0)}),T.on("video:loadstart",()=>{T.loading.show=!0,T.mask.show=!1,T.controls.show=!0}),T.on("video:pause",()=>{T.controls.show=!0,T.mask.show=!0}),T.on("video:play",()=>{T.mask.show=!1,(0,M.setStyle)(f,"display","none")}),T.on("video:playing",()=>{T.mask.show=!1}),T.on("video:seeked",()=>{T.loading.show=!1}),T.on("video:seeking",()=>{T.loading.show=!0,T.mask.show=!1}),T.on("video:timeupdate",()=>{T.mask.show=!1}),T.on("video:waiting",()=>{T.loading.show=!0,T.mask.show=!1})}},{"../config":"eksZR","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kJ9J9:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../utils"),m=O("../utils/component"),M=S.interopDefault(m),T=O("./fullscreen"),g=S.interopDefault(T),u=O("./fullscreenWeb"),n=S.interopDefault(u),d=O("./pip"),l=S.interopDefault(d),h=O("./playAndPause"),v=S.interopDefault(h),f=O("./progress"),r=S.interopDefault(f),t=O("./time"),i=S.interopDefault(t),e=O("./volume"),s=S.interopDefault(e),o=O("./setting"),a=S.interopDefault(o),p=O("./thumbnails"),D=S.interopDefault(p),L=O("./screenshot"),y=S.interopDefault(L),E=O("./quality"),_=S.interopDefault(E),A=O("./loop"),I=S.interopDefault(A);class b extends M.default{constructor(P){super(P),this.name="control";const{constructor:w,events:{proxy:F},template:{$player:k}}=P;let B=Date.now();F(k,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,(0,c.removeClass)(k,"art-hide-cursor"),(0,c.addClass)(k,"art-hover"),B=Date.now()}),P.on("video:timeupdate",()=>{!P.isInput&&P.playing&&this.show&&Date.now()-B>=w.CONTROL_HIDE_TIME&&(this.show=!1,(0,c.addClass)(k,"art-hide-cursor"),(0,c.removeClass)(k,"art-hover"))}),this.init()}init(){const{option:P}=this.art;this.add((0,r.default)({name:"progress",disable:P.isLive,position:"top",index:10})),this.add((0,D.default)({name:"thumbnails",disable:!P.thumbnails.url||P.isLive||c.isMobile,position:"top",index:20})),this.add((0,I.default)({name:"loop",disable:!1,position:"top",index:30})),this.add((0,v.default)({name:"playAndPause",disable:!1,position:"left",index:10})),this.add((0,s.default)({name:"volume",disable:!1,position:"left",index:20})),this.add((0,i.default)({name:"time",disable:P.isLive,position:"left",index:30})),this.add((0,_.default)({name:"quality",disable:P.quality.length===0,position:"right",index:10})),this.add((0,y.default)({name:"screenshot",disable:!P.screenshot||c.isMobile,position:"right",index:20})),this.add((0,a.default)({name:"setting",disable:!P.setting,position:"right",index:30})),this.add((0,l.default)({name:"pip",disable:!P.pip,position:"right",index:40})),this.add((0,n.default)({name:"fullscreenWeb",disable:!P.fullscreenWeb,position:"right",index:50})),this.add((0,g.default)({name:"fullscreen",disable:!P.fullscreen,position:"right",index:60}));for(let w=0;w<P.controls.length;w++)this.add(P.controls[w])}add(P){const w=typeof P=="function"?P(this.art):P,{$progress:F,$controlsLeft:k,$controlsRight:B}=this.art.template;switch(w.position){case"top":this.$parent=F;break;case"left":this.$parent=k;break;case"right":this.$parent=B;break;default:(0,c.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(w)}}x.default=b},{"../utils":"geSvU","../utils/component":"kPHYl","./fullscreen":"awkUw","./fullscreenWeb":"3qoPe","./pip":"lFHYL","./playAndPause":"b8vU1","./progress":"dRwzT","./time":"ltYI1","./volume":"8O7mM","./setting":"lX5UX","./thumbnails":"lUoGG","./screenshot":"jvdQ0","./quality":"k9pKK","./loop":"aE690","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kPHYl:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./dom"),m=O("option-validator"),M=S.interopDefault(m),T=O("../scheme"),g=O("./property"),u=O("./error");x.default=class{constructor(n){this.id=0,this.art=n,this.add=this.add.bind(this)}get show(){return(0,c.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(n){const{$player:d}=this.art.template,l=`art-${this.name}-show`;n?(0,c.addClass)(d,l):(0,c.removeClass)(d,l),this.art.emit(this.name,n)}set toggle(n){n&&(this.show=!this.show)}add(n){const d=typeof n=="function"?n(this.art):n;if(d.html=d.html||"",(0,M.default)(d,T.ComponentOption),!this.$parent||!this.name||d.disable)return;const l=d.name||`${this.name}${this.id}`;(0,u.errorHandle)(!(0,g.has)(this,l),`Cannot add an existing name [${l}] to the [${this.name}]`),this.id+=1;const h=document.createElement("div");(0,c.addClass)(h,`art-${this.name}`),(0,c.addClass)(h,`art-${this.name}-${l}`);const v=Array.from(this.$parent.children);h.dataset.index=d.index||this.id;const f=v.find(r=>Number(r.dataset.index)>=Number(h.dataset.index));return f?f.insertAdjacentElement("beforebegin",h):(0,c.append)(this.$parent,h),d.html&&(0,c.append)(h,d.html),d.style&&(0,c.setStyles)(h,d.style),d.tooltip&&(0,c.tooltip)(h,d.tooltip),d.click&&this.art.events.proxy(h,"click",r=>{r.preventDefault(),d.click.call(this.art,this,r)}),d.selector&&["left","right"].includes(d.position)&&this.selector(d,h),d.mounted&&d.mounted.call(this.art,h),h.childNodes.length===1&&h.childNodes[0].nodeType===3&&(0,c.addClass)(h,"art-control-onlyText"),(0,g.def)(this,l,{value:h}),h}selector(n,d){const{hover:l,proxy:h}=this.art.events;(0,c.addClass)(d,"art-control-selector");const v=document.createElement("div");(0,c.addClass)(v,"art-selector-value"),(0,c.append)(v,n.html),d.innerText="",(0,c.append)(d,v);const f=n.selector.map((i,e)=>`<div class="art-selector-item ${i.default?"art-current":""}" data-index="${e}">${i.html}</div>`).join(""),r=document.createElement("div");(0,c.addClass)(r,"art-selector-list"),(0,c.append)(r,f),(0,c.append)(d,r);const t=()=>{const i=(0,c.getStyle)(d,"width")/2-(0,c.getStyle)(r,"width")/2;r.style.left=`${i}px`};l(d,t),h(r,"click",async i=>{const e=(i.composedPath()||[]).find(a=>(0,c.hasClass)(a,"art-selector-item"));if(!e)return;(0,c.inverseClass)(e,"art-current");const s=Number(e.dataset.index),o=n.selector[s]||{};if(v.innerText=e.innerText,n.onSelect){const a=await n.onSelect.call(this.art,o,e,i);typeof a!="string"&&typeof a!="number"||(v.innerHTML=a)}t(),this.art.emit("selector",o,e)})}}},{"./dom":"ff6Hs","option-validator":"2A2W5","../scheme":"3vPoh","./property":"lMM6V","./error":"lDQPM","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],awkUw:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,tooltip:m.i18n.get("Fullscreen"),mounted:M=>{const{events:{proxy:T},icons:g,i18n:u}=m,n=(0,S.append)(M,g.fullscreenOn),d=(0,S.append)(M,g.fullscreenOff);(0,S.setStyle)(d,"display","none"),T(M,"click",()=>{m.fullscreen=!m.fullscreen}),m.on("fullscreen",l=>{l?((0,S.tooltip)(M,u.get("Exit Fullscreen")),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","inline-flex")):((0,S.tooltip)(M,u.get("Fullscreen")),(0,S.setStyle)(n,"display","inline-flex"),(0,S.setStyle)(d,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3qoPe":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,tooltip:m.i18n.get("Web Fullscreen"),mounted:M=>{const{events:{proxy:T},icons:g,i18n:u}=m,n=(0,S.append)(M,g.fullscreenWebOn),d=(0,S.append)(M,g.fullscreenWebOff);(0,S.setStyle)(d,"display","none"),T(M,"click",()=>{m.fullscreenWeb=!m.fullscreenWeb}),m.on("fullscreenWeb",l=>{l?((0,S.tooltip)(M,u.get("Exit Web Fullscreen")),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","inline-flex")):((0,S.tooltip)(M,u.get("Web Fullscreen")),(0,S.setStyle)(n,"display","inline-flex"),(0,S.setStyle)(d,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lFHYL:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,tooltip:m.i18n.get("PIP Mode"),mounted:M=>{const{events:{proxy:T},icons:g,i18n:u}=m;(0,S.append)(M,g.pip),T(M,"click",()=>{m.pip=!m.pip}),m.on("pip",n=>{(0,S.tooltip)(M,u.get(n?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],b8vU1:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,mounted:M=>{const{events:{proxy:T},icons:g,i18n:u}=m,n=(0,S.append)(M,g.play),d=(0,S.append)(M,g.pause);function l(){(0,S.setStyle)(n,"display","flex"),(0,S.setStyle)(d,"display","none")}function h(){(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","flex")}(0,S.tooltip)(n,u.get("Play")),(0,S.tooltip)(d,u.get("Pause")),T(n,"click",()=>{m.play()}),T(d,"click",()=>{m.pause()}),m.playing?h():l(),m.on("video:playing",()=>{h()}),m.on("video:pause",()=>{l()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],dRwzT:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x),S.export(x,"getPosFromEvent",()=>m);var c=O("../utils");function m(M,T){const{$progress:g}=M.template,{left:u}=g.getBoundingClientRect(),n=T.pageX,d=(0,c.clamp)(n-u,0,g.clientWidth),l=d/g.clientWidth*M.duration;return{second:l,time:(0,c.secondToTime)(l),width:d,percentage:(0,c.clamp)(d/g.clientWidth,0,1)}}x.default=function(M){return T=>{const{icons:g,option:u,events:{proxy:n}}=T;return{...M,html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:d=>{let l=!1;const h=(0,c.query)(".art-progress-loaded",d),v=(0,c.query)(".art-progress-played",d),f=(0,c.query)(".art-progress-highlight",d),r=(0,c.query)(".art-progress-indicator",d),t=(0,c.query)(".art-progress-tip",d);(0,c.setStyle)(v,"backgroundColor","var(--theme)");let i=T.constructor.INDICATOR_SIZE;function e(s,o){s==="loaded"&&(0,c.setStyle)(h,"width",100*o+"%"),s==="played"&&((0,c.setStyle)(v,"width",100*o+"%"),(0,c.setStyle)(r,"left",`calc(${100*o}% - ${i/2}px)`))}g.indicator?(i=T.constructor.INDICATOR_SIZE_ICON,(0,c.append)(r,g.indicator)):(0,c.setStyles)(r,{backgroundColor:"var(--theme)"}),c.isMobile&&(i=T.constructor.INDICATOR_SIZE_MOBILE,g.indicator&&(i=T.constructor.INDICATOR_SIZE_MOBILE_ICON)),(0,c.setStyles)(r,{left:`-${i/2}px`,width:`${i}px`,height:`${i}px`}),T.on("video:loadedmetadata",()=>{for(let s=0;s<u.highlight.length;s++){const o=u.highlight[s],a=(0,c.clamp)(o.time,0,T.duration)/T.duration*100;(0,c.append)(f,`<span data-text="${o.text}" data-time="${o.time}" style="left: ${a}%"></span>`)}}),e("loaded",T.loaded),T.on("setBar",(s,o)=>{e(s,o)}),T.on("video:progress",()=>{e("loaded",T.loaded)}),T.on("video:timeupdate",()=>{e("played",T.played)}),T.on("video:ended",()=>{e("played",1)}),c.isMobile||(n(d,"click",s=>{if(s.target!==r){const{second:o,percentage:a}=m(T,s);e("played",a),T.seek=o}}),n(d,"mousemove",s=>{(0,c.setStyle)(t,"display","block"),(0,c.includeFromEvent)(s,f)?function(o){const{width:a}=m(T,o),{text:p}=o.target.dataset;t.innerHTML=p;const D=t.clientWidth;a<=D/2?(0,c.setStyle)(t,"left",0):a>d.clientWidth-D/2?(0,c.setStyle)(t,"left",d.clientWidth-D+"px"):(0,c.setStyle)(t,"left",a-D/2+"px")}(s):function(o){const{width:a,time:p}=m(T,o);t.innerHTML=p;const D=t.clientWidth;a<=D/2?(0,c.setStyle)(t,"left",0):a>d.clientWidth-D/2?(0,c.setStyle)(t,"left",d.clientWidth-D+"px"):(0,c.setStyle)(t,"left",a-D/2+"px")}(s)}),n(d,"mouseout",()=>{(0,c.setStyle)(t,"display","none")}),n(r,"mousedown",()=>{l=!0}),n(document,"mousemove",s=>{if(l){const{second:o,percentage:a}=m(T,s);e("played",a),T.seek=o}}),n(document,"mouseup",()=>{l&&(l=!1)}))}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ltYI1:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,style:{cursor:"auto"},mounted:M=>{function T(){const u=`${(0,S.secondToTime)(m.currentTime)} / ${(0,S.secondToTime)(m.duration)}`;u!==M.innerText&&(M.innerText=u)}T();const g=["video:loadedmetadata","video:timeupdate","video:progress"];for(let u=0;u<g.length;u++)m.on(g[u],T)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8O7mM":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,mounted:M=>{const{events:{proxy:T},icons:g,i18n:u}=m;let n=!1;const d=m.constructor.VOLUME_PANEL_WIDTH,l=m.constructor.VOLUME_HANDLE_WIDTH,h=(0,S.append)(M,g.volume),v=(0,S.append)(M,g.volumeClose),f=(0,S.append)(M,'<div class="art-volume-panel"></div>'),r=(0,S.append)(f,'<div class="art-volume-slider-handle"></div>');function t(e){const{left:s}=f.getBoundingClientRect();return(0,S.clamp)(e.pageX-s-l/2,0,d-l/2)/(d-l)}function i(e=.7){if(m.muted||e===0)(0,S.setStyle)(h,"display","none"),(0,S.setStyle)(v,"display","flex"),(0,S.setStyle)(r,"left","0");else{const s=(d-l)*e;(0,S.setStyle)(h,"display","flex"),(0,S.setStyle)(v,"display","none"),(0,S.setStyle)(r,"left",`${s}px`)}}(0,S.tooltip)(h,u.get("Mute")),(0,S.setStyle)(v,"display","none"),S.isMobile&&(0,S.setStyle)(f,"display","none"),i(m.volume),m.on("video:volumechange",()=>{i(m.volume)}),T(h,"click",()=>{m.muted=!0}),T(v,"click",()=>{m.muted=!1}),T(f,"click",e=>{m.muted=!1,m.volume=t(e)}),T(r,"mousedown",()=>{n=!0}),T(M,"mousemove",e=>{n&&(m.muted=!1,m.volume=t(e))}),T(document,"mouseup",()=>{n&&(n=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lX5UX:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,tooltip:m.i18n.get("Show Setting"),mounted:M=>{const{events:{proxy:T},icons:g,i18n:u}=m;(0,S.append)(M,g.setting),T(M,"click",()=>{m.setting.toggle=!0}),m.on("setting",n=>{(0,S.tooltip)(M,u.get(n?"Hide Setting":"Show Setting"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lUoGG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils"),c=O("./progress");x.default=function(m){return M=>({...m,mounted:T=>{const{option:g,template:{$progress:u,$video:n},events:{proxy:d,loadImg:l}}=M;let h=null,v=!1,f=!1;d(u,"mousemove",async r=>{v||(v=!0,h=await l(g.thumbnails.url),f=!0),f&&((0,S.setStyle)(T,"display","block"),function(t){const{width:i}=(0,c.getPosFromEvent)(M,t),{url:e,number:s,column:o}=g.thumbnails,a=h.naturalWidth/o,p=a/(n.videoWidth/n.videoHeight),D=u.clientWidth/s,L=Math.floor(i/D),y=Math.ceil(L/o)-1,E=L%o||o-1;(0,S.setStyle)(T,"backgroundImage",`url(${e})`),(0,S.setStyle)(T,"height",`${p}px`),(0,S.setStyle)(T,"width",`${a}px`),(0,S.setStyle)(T,"backgroundPosition",`-${E*a}px -${y*p}px`),i<=a/2?(0,S.setStyle)(T,"left",0):i>u.clientWidth-a/2?(0,S.setStyle)(T,"left",u.clientWidth-a+"px"):(0,S.setStyle)(T,"left",i-a/2+"px")}(r))}),d(u,"mouseout",()=>{(0,S.setStyle)(T,"display","none")})}})}},{"../utils":"geSvU","./progress":"dRwzT","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jvdQ0:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,tooltip:m.i18n.get("Screenshot"),mounted:M=>{const{events:{proxy:T},icons:g}=m;(0,S.append)(M,g.screenshot),T(M,"click",()=>{m.screenshot()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k9pKK:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return c=>{const m=c.option.quality,M=m.find(T=>T.default)||m[0];return{...S,html:M?M.html:"",selector:m,onSelect(T){c.switchQuality(T.url,T.html)}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aE690:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>({...c,mounted:M=>{const T=(0,S.append)(M,'<span class="art-loop-point"></span>'),g=(0,S.append)(M,'<span class="art-loop-point"></span>');m.on("loop",u=>{u?((0,S.setStyle)(M,"display","block"),(0,S.setStyle)(T,"left",`calc(${u[0]/m.duration*100}% - ${T.clientWidth}px)`),(0,S.setStyle)(g,"left",u[1]/m.duration*100+"%")):(0,S.setStyle)(M,"display","none")})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7rh9q":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../utils"),m=O("../utils/component"),M=S.interopDefault(m),T=O("./playbackRate"),g=S.interopDefault(T),u=O("./aspectRatio"),n=S.interopDefault(u),d=O("./flip"),l=S.interopDefault(d),h=O("./info"),v=S.interopDefault(h),f=O("./version"),r=S.interopDefault(f),t=O("./close"),i=S.interopDefault(t);class e extends M.default{constructor(o){super(o),this.name="contextmenu",this.$parent=o.template.$contextmenu,c.isMobile||this.init()}init(){const{option:o,template:{$player:a,$contextmenu:p},events:{proxy:D}}=this.art;this.add((0,g.default)({disable:!o.playbackRate,name:"playbackRate",index:10})),this.add((0,n.default)({disable:!o.aspectRatio,name:"aspectRatio",index:20})),this.add((0,l.default)({disable:!o.flip,name:"flip",index:30})),this.add((0,v.default)({disable:!1,name:"info",index:40})),this.add((0,r.default)({disable:!1,name:"version",index:50})),this.add((0,i.default)({disable:!1,name:"close",index:60}));for(let L=0;L<o.contextmenu.length;L++)this.add(o.contextmenu[L]);D(a,"contextmenu",L=>{L.preventDefault(),this.show=!0;const y=L.clientX,E=L.clientY,{height:_,width:A,left:I,top:b}=a.getBoundingClientRect(),{height:R,width:P}=p.getBoundingClientRect();let w=y-I,F=E-b;y+P>I+A&&(w=A-P),E+R>b+_&&(F=_-R),(0,c.setStyles)(p,{top:`${F}px`,left:`${w}px`})}),D(a,"click",L=>{(0,c.includeFromEvent)(L,p)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}x.default=e},{"../utils":"geSvU","../utils/component":"kPHYl","./playbackRate":"9P3rd","./aspectRatio":"3OqVf","./flip":"iMg4Y","./info":"9FFXO","./version":"duhqU","./close":"k3lJQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9P3rd":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>{const{i18n:M}=m;return{...c,html:`${M.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${M.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(T,g)=>{const{value:u}=g.target.dataset;u&&(m.playbackRate=Number(u),T.show=!1)},mounted:T=>{m.on("playbackRate",g=>{const u=(0,S.queryAll)("span",T).find(n=>Number(n.dataset.value)===g);u&&(0,S.inverseClass)(u,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3OqVf":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>{const{i18n:M}=m;return{...c,html:`${M.get("Aspect Ratio")}:<span data-value="default" class="art-current">${M.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(T,g)=>{const{value:u}=g.target.dataset;u&&(m.aspectRatio=u,T.show=!1)},mounted:T=>{m.on("aspectRatio",g=>{const u=(0,S.queryAll)("span",T).find(n=>n.dataset.value===g);u&&(0,S.inverseClass)(u,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iMg4Y:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){return m=>{const{i18n:M}=m;return{...c,html:`${M.get("Video Flip")}:<span data-value="normal" class="art-current">${M.get("Normal")}</span><span data-value="horizontal">${M.get("Horizontal")}</span><span data-value="vertical">${M.get("Vertical")}</span>`,click:(T,g)=>{const{value:u}=g.target.dataset;u&&(m.flip=u,T.show=!1)},mounted:T=>{m.on("flip",g=>{const u=(0,S.queryAll)("span",T).find(n=>n.dataset.value===g);u&&(0,S.inverseClass)(u,"art-current")})}}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9FFXO":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return c=>({...S,html:c.i18n.get("Video Info"),click:m=>{c.info.show=!0,m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],duhqU:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return{...S,html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.5.2</a>'}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k3lJQ:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return c=>({...S,html:c.i18n.get("Close"),click:m=>{m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],c896w:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m);class T extends M.default{constructor(u){super(u),this.name="info",c.isMobile||this.init()}init(){const{constructor:u,events:{proxy:n},template:{$infoPanel:d,$infoClose:l,$video:h}}=this.art;n(l,"click",()=>{this.show=!1});let v=null;const f=(0,c.queryAll)("[data-video]",d)||[];this.art.on("destroy",()=>{clearTimeout(v)}),function r(){for(let t=0;t<f.length;t++){const i=f[t],e=h[i.dataset.video],s=typeof e=="number"?e.toFixed(2):e;i.innerText!==s&&(i.innerText=s)}v=setTimeout(r,u.INFO_LOOP_TIME)}()}}x.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"2hqso":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m),T=O("option-validator"),g=S.interopDefault(T),u=O("./scheme"),n=S.interopDefault(u);class d extends M.default{constructor(h){super(h),this.name="subtitle",this.init(h.option.subtitle)}get url(){return this.art.template.$track.src}set url(h){this.switch(h)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(h,v){const{$subtitle:f}=this.art.template;return typeof h=="object"?(0,c.setStyles)(f,h):(0,c.setStyle)(f,h,v)}update(){const{$subtitle:h}=this.art.template;h.innerHTML="",this.activeCue&&(h.innerHTML=this.activeCue.text.split(/\r?\n/).map(v=>`<p>${(0,c.escape)(v)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}async switch(h,v={}){const{i18n:f,notice:r,option:t}=this.art,i={...t.subtitle,...v,url:h},e=await this.init(i);return v.name&&(r.show=`${f.get("Switch Subtitle")}: ${v.name}`),e}init(h){if((0,g.default)(h,n.default.subtitle),!h.url)return;const{notice:v,events:{proxy:f},template:{$subtitle:r,$video:t,$track:i}}=this.art;if(!i){const e=document.createElement("track");e.default=!0,e.kind="metadata",t.appendChild(e),this.art.template.$track=e,f(this.textTrack,"cuechange",this.update.bind(this))}return this.style(h.style),(0,c.errorHandle)(window.fetch,"fetch not support"),fetch(h.url).then(e=>e.arrayBuffer()).then(e=>{(0,c.errorHandle)(window.TextDecoder,"TextDecoder not support");const s=new TextDecoder(h.encoding).decode(e);switch(this.art.emit("subtitleLoad",h.url),h.type||(0,c.getExt)(h.url)){case"srt":return(0,c.vttToBlob)((0,c.srtToVtt)(s));case"ass":return(0,c.vttToBlob)((0,c.assToVtt)(s));case"vtt":return(0,c.vttToBlob)(s);default:return h.url}}).then(e=>(r.innerHTML="",this.url===e||(URL.revokeObjectURL(this.url),this.art.template.$track.src=e,this.art.emit("subtitleSwitch",e)),e)).catch(e=>{throw v.show=e,e})}}x.default=d},{"./utils":"geSvU","./utils/component":"kPHYl","option-validator":"2A2W5","./scheme":"3vPoh","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j2hlX:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../utils/error"),m=O("./clickInit"),M=S.interopDefault(m),T=O("./hoverInit"),g=S.interopDefault(T),u=O("./mousemoveInit"),n=S.interopDefault(u),d=O("./resizeInit"),l=S.interopDefault(d),h=O("./gestureInit"),v=S.interopDefault(h),f=O("./viewInit"),r=S.interopDefault(f);x.default=class{constructor(t){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),t.whitelist.state&&((0,M.default)(t,this),(0,g.default)(t,this),(0,n.default)(t,this),(0,l.default)(t,this),(0,v.default)(t,this),(0,r.default)(t,this))}proxy(t,i,e,s={}){if(Array.isArray(i))return i.map(a=>this.proxy(t,a,e,s));t.addEventListener(i,e,s);const o=()=>t.removeEventListener(i,e,s);return this.destroyEvents.push(o),o}hover(t,i,e){i&&this.proxy(t,"mouseenter",i),e&&this.proxy(t,"mouseleave",e)}loadImg(t){return new Promise((i,e)=>{let s;if(t instanceof HTMLImageElement)s=t;else{if(typeof t!="string")return e(new c.ArtPlayerError("Unable to get Image"));s=new Image,s.src=t}if(s.complete)return i(s);this.proxy(s,"load",()=>i(s)),this.proxy(s,"error",()=>e(new c.ArtPlayerError(`Failed to load Image: ${s.src}`)))})}destroy(){for(let t=0;t<this.destroyEvents.length;t++)this.destroyEvents[t]()}}},{"../utils/error":"lDQPM","./clickInit":"iP4Z9","./hoverInit":"aoIIW","./mousemoveInit":"4WC5c","./resizeInit":"7fpan","./gestureInit":"ixtiG","./viewInit":"5WvmH","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iP4Z9:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c,m){const{constructor:M,template:{$player:T,$video:g}}=c;m.proxy(document,["click","contextmenu"],n=>{(0,S.includeFromEvent)(n,T)?(c.isInput=n.target.tagName==="INPUT",c.isFocus=!0,c.emit("focus")):(c.isInput=!1,c.isFocus=!1,c.emit("blur"))});let u=0;m.proxy(g,"click",()=>{const n=Date.now();n-u<=M.DB_CLICE_TIME?(c.emit("dblclick"),S.isMobile?c.isLock||c.toggle():c.fullscreen=!c.fullscreen):(c.emit("click"),S.isMobile||c.toggle()),u=n})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aoIIW:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c,m){const{$player:M}=c.template;m.hover(M,()=>{(0,S.addClass)(M,"art-hover"),c.emit("hover",!0)},()=>{(0,S.removeClass)(M,"art-hover"),c.emit("hover")})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4WC5c":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S,c){const{$player:m}=S.template;c.proxy(m,"mousemove",M=>{S.emit("mousemove",M)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7fpan":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c,m){const{option:M}=c,T=(0,S.throttle)(()=>{c.normalSize&&(c.autoSize=M.autoSize),c.aspectRatioReset=!0,c.notice.show="",c.emit("resize")},c.constructor.RESIZE_TIME);m.proxy(window,["orientationchange","resize"],()=>{T()}),screen&&screen.orientation&&screen.orientation.onchange&&m.proxy(screen.orientation,"change",()=>{T()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ixtiG:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c,m){if(S.isMobile&&!c.option.isLive){const{$video:M,$bottom:T,$controls:g}=c.template;let u=!1,n=0,d=0,l=0;const h=r=>{if(r.touches.length===1&&!c.isLock){u=!0;const{clientX:t,clientY:i}=r.touches[0];n=t,d=i,l=c.currentTime}},v=r=>{if(r.touches.length===1&&u&&c.duration){const t=c.plugins.autoOrientation&&c.plugins.autoOrientation.state,{clientX:i,clientY:e}=r.touches[0],s=(0,S.clamp)((i-n)/c.width,-1,1),o=(0,S.clamp)((e-d)/c.height,-1,1),a=t?o:s,p=(0,S.clamp)(l+c.duration*a/2,0,c.duration);c.seek=p,c.emit("setBar","played",(0,S.clamp)(p/c.duration,0,1)),c.notice.show=`${(0,S.secondToTime)(p)} / ${(0,S.secondToTime)(c.duration)}`}},f=()=>{u&&(n=0,d=0,l=0,u=!1)};m.proxy(T,"touchstart",r=>{(0,S.includeFromEvent)(r,g)||h(r)}),m.proxy(T,"touchmove",v),m.proxy(M,"touchstart",h),m.proxy(M,"touchmove",v),m.proxy(document,"touchend",f)}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5WvmH":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c,m){const{option:M,constructor:T,template:{$container:g}}=c,u=(0,S.throttle)(()=>{c.emit("view",(0,S.isInViewport)(g,T.SCROLL_GAP))},T.SCROLL_TIME);m.proxy(window,"scroll",()=>{u()}),c.on("view",n=>{M.autoMini&&(c.mini=!n)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aTHWZ:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");x.default=class{constructor(c){this.art=c,this.keys={},c.option.hotkey&&!S.isMobile&&this.init()}init(){const{proxy:c}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),c(window,"keydown",m=>{if(this.art.isFocus){const M=document.activeElement.tagName.toUpperCase(),T=document.activeElement.getAttribute("contenteditable");if(M!=="INPUT"&&M!=="TEXTAREA"&&T!==""&&T!=="true"){const g=this.keys[m.keyCode];if(g){m.preventDefault();for(let u=0;u<g.length;u++)g[u].call(this.art,m);this.art.emit("hotkey",m)}}}})}add(c,m){return this.keys[c]?this.keys[c].push(m):this.keys[c]=[m],this}remove(c,m){if(this.keys[c]){const M=this.keys[c].indexOf(m);M!==-1&&this.keys[c].splice(M,1)}return this}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],f2kxw:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./utils/component"),m=S.interopDefault(c);class M extends m.default{constructor(g){super(g);const{option:u,template:{$layer:n}}=g;this.name="layer",this.$parent=n;for(let d=0;d<u.layers.length;d++)this.add(u.layers[d])}}x.default=M},{"./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bOs9w:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m);class T extends M.default{constructor(u){super(u),this.name="loading",(0,c.append)(u.template.$loading,u.icons.loading)}}x.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ic4th:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("./utils");x.default=class{constructor(c){this.art=c,this.timer=null}set show(c){const{constructor:m,template:{$player:M,$noticeInner:T}}=this.art;c?(T.innerText=c instanceof Error?c.message.trim():c,(0,S.addClass)(M,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{T.innerText="",(0,S.removeClass)(M,"art-notice-show")},m.NOTICE_TIME)):(0,S.removeClass)(M,"art-notice-show")}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iLfmB:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./utils"),m=O("./utils/component"),M=S.interopDefault(m);class T extends M.default{constructor(u){super(u),this.name="mask";const{template:n,icons:d,events:l}=u,h=(0,c.append)(n.$state,d.state),v=(0,c.append)(n.$state,d.error);(0,c.setStyle)(v,"display","none"),u.on("destroy",()=>{(0,c.setStyle)(h,"display","none"),(0,c.setStyle)(v,"display",null)}),l.proxy(n.$state,"click",()=>u.play())}}x.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5lAmI":[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../utils"),m=O("bundle-text:./loading.svg"),M=S.interopDefault(m),T=O("bundle-text:./state.svg"),g=S.interopDefault(T),u=O("bundle-text:./check.svg"),n=S.interopDefault(u),d=O("bundle-text:./play.svg"),l=S.interopDefault(d),h=O("bundle-text:./pause.svg"),v=S.interopDefault(h),f=O("bundle-text:./volume.svg"),r=S.interopDefault(f),t=O("bundle-text:./volume-close.svg"),i=S.interopDefault(t),e=O("bundle-text:./screenshot.svg"),s=S.interopDefault(e),o=O("bundle-text:./setting.svg"),a=S.interopDefault(o),p=O("bundle-text:./arrow-left.svg"),D=S.interopDefault(p),L=O("bundle-text:./arrow-right.svg"),y=S.interopDefault(L),E=O("bundle-text:./playback-rate.svg"),_=S.interopDefault(E),A=O("bundle-text:./aspect-ratio.svg"),I=S.interopDefault(A),b=O("bundle-text:./config.svg"),R=S.interopDefault(b),P=O("bundle-text:./pip.svg"),w=S.interopDefault(P),F=O("bundle-text:./lock.svg"),k=S.interopDefault(F),B=O("bundle-text:./unlock.svg"),U=S.interopDefault(B),j=O("bundle-text:./fullscreen-off.svg"),K=S.interopDefault(j),N=O("bundle-text:./fullscreen-on.svg"),Z=S.interopDefault(N),$=O("bundle-text:./fullscreen-web-off.svg"),Y=S.interopDefault($),ee=O("bundle-text:./fullscreen-web-on.svg"),Q=S.interopDefault(ee),G=O("bundle-text:./switch-on.svg"),q=S.interopDefault(G),te=O("bundle-text:./switch-off.svg"),ie=S.interopDefault(te),ne=O("bundle-text:./flip.svg"),le=S.interopDefault(ne),se=O("bundle-text:./error.svg"),oe=S.interopDefault(se),J=O("bundle-text:./close.svg"),ae=S.interopDefault(J);x.default=class{constructor(fe){const de={loading:M.default,state:g.default,play:l.default,pause:v.default,check:n.default,volume:r.default,volumeClose:i.default,screenshot:s.default,setting:a.default,pip:w.default,arrowLeft:D.default,arrowRight:y.default,playbackRate:_.default,aspectRatio:I.default,config:R.default,lock:k.default,flip:le.default,unlock:U.default,fullscreenOff:K.default,fullscreenOn:Z.default,fullscreenWebOff:Y.default,fullscreenWebOn:Q.default,switchOn:q.default,switchOff:ie.default,error:oe.default,close:ae.default,...fe.option.icons};Object.keys(de).forEach(ve=>{(0,c.def)(this,ve,{get:()=>{const ue=document.createElement("i");return(0,c.addClass)(ue,"art-icon"),(0,c.addClass)(ue,`art-icon-${ve}`),(0,c.append)(ue,de[ve]),ue}})})}}},{"../utils":"geSvU","bundle-text:./loading.svg":"hX0lQ","bundle-text:./state.svg":"01U3R","bundle-text:./check.svg":"9jaCP","bundle-text:./play.svg":"invok","bundle-text:./pause.svg":"68285","bundle-text:./volume.svg":"3zSKr","bundle-text:./volume-close.svg":"ft8Zf","bundle-text:./screenshot.svg":"dfLel","bundle-text:./setting.svg":"j8dnn","bundle-text:./arrow-left.svg":"fMoi9","bundle-text:./arrow-right.svg":"auIjA","bundle-text:./playback-rate.svg":"g3V1U","bundle-text:./aspect-ratio.svg":"3LQJt","bundle-text:./config.svg":"bcTkc","bundle-text:./pip.svg":"jDSoL","bundle-text:./lock.svg":"jqFLt","bundle-text:./unlock.svg":"5qYod","bundle-text:./fullscreen-off.svg":"25MvP","bundle-text:./fullscreen-on.svg":"6CCX4","bundle-text:./fullscreen-web-off.svg":"m9TwS","bundle-text:./fullscreen-web-on.svg":"iWJrW","bundle-text:./switch-on.svg":"8cFxH","bundle-text:./switch-off.svg":"6tBmw","bundle-text:./flip.svg":"6N8Hu","bundle-text:./error.svg":"bNBRZ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","bundle-text:./close.svg":"8pxPz"}],hX0lQ:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],"01U3R":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],"9jaCP":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],invok:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],68285:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],"3zSKr":[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],ft8Zf:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],dfLel:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],j8dnn:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],fMoi9:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],auIjA:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],g3V1U:[function(O,C,x){C.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"3LQJt":[function(O,C,x){C.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],bcTkc:[function(O,C,x){C.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],jDSoL:[function(O,C,x){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],jqFLt:[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],"5qYod":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],"25MvP":[function(O,C,x){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],"6CCX4":[function(O,C,x){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],m9TwS:[function(O,C,x){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],iWJrW:[function(O,C,x){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"8cFxH":[function(O,C,x){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],"6tBmw":[function(O,C,x){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],"6N8Hu":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],bNBRZ:[function(O,C,x){C.exports='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.082 93.082 0 0 1 34.448 33.341zM512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88zm0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2z"/></svg>'},{}],"8pxPz":[function(O,C,x){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733-17.066-17.067-42.666-17.067-59.733 0L512 452.267l-268.8-268.8c-17.067-17.067-42.667-17.067-59.733 0-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733L571.733 512z"/></svg>'},{}],d5XKP:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./flip"),m=S.interopDefault(c),M=O("./aspectRatio"),T=S.interopDefault(M),g=O("./playbackRate"),u=S.interopDefault(g),n=O("./subtitleOffset"),d=S.interopDefault(n),l=O("../utils/component"),h=S.interopDefault(l),v=O("../utils");function f(i,e,s){for(let o=0;o<i.length;o++){const a=i[o];a.$parentItem=e,a.$parentList=s,a.selector&&f(a.selector,a,i)}return i}function r(i){return["string","number"].includes(typeof i)}class t extends h.default{constructor(e){super(e);const{option:s,events:{proxy:o},template:{$setting:a,$player:p}}=e;if(this.name="setting",this.$parent=a,this.option=[],this.events=[],this.cache=new Map,s.setting){s.playbackRate&&this.option.push((0,u.default)(e)),s.aspectRatio&&this.option.push((0,T.default)(e)),s.flip&&this.option.push((0,m.default)(e)),s.subtitleOffset&&this.option.push((0,d.default)(e));for(let D=0;D<s.settings.length;D++)this.option.push(s.settings[D]);this.option=f(this.option),this.init(this.option),e.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),o(p,"click",D=>{!this.show||(0,v.includeFromEvent)(D,e.controls.setting)||(0,v.includeFromEvent)(D,this.$parent)||(this.show=!1,this.init(this.option))})}}add(e){typeof e=="function"?this.option.push(e(this.art)):this.option.push(e),this.cache=new Map,this.events.forEach(s=>s()),this.events=[],this.$parent.innerHTML="",this.option=f(this.option),this.init(this.option)}creatHeader(e){const{icons:s,events:{proxy:o}}=this.art,a=document.createElement("div");(0,v.addClass)(a,"art-setting-item"),(0,v.addClass)(a,"art-setting-item-back");const p=(0,v.append)(a,'<div class="art-setting-item-left"></div>'),D=document.createElement("div");(0,v.addClass)(D,"art-setting-item-left-icon"),(0,v.append)(D,s.arrowLeft),(0,v.append)(p,D),(0,v.append)(p,e.$parentItem.html);const L=o(a,"click",()=>{this.init(e.$parentList)});return this.events.push(L),a}creatItem(e,s){const{icons:o,events:{proxy:a}}=this.art,p=document.createElement("div");(0,v.addClass)(p,"art-setting-item"),r(s.name)&&(p.dataset.name=s.name),r(s.value)&&(p.dataset.value=s.value);const D=(0,v.append)(p,'<div class="art-setting-item-left"></div>'),L=(0,v.append)(p,'<div class="art-setting-item-right"></div>'),y=document.createElement("div");switch((0,v.addClass)(y,"art-setting-item-left-icon"),e){case"switch":case"range":(0,v.append)(y,r(s.icon)||s.icon instanceof Element?s.icon:o.config);break;case"selector":s.selector&&s.selector.length?(0,v.append)(y,r(s.icon)||s.icon instanceof Element?s.icon:o.config):(0,v.append)(y,o.check)}(0,v.append)(D,y),s.$icon=y,(0,v.def)(s,"icon",{configurable:!0,get:()=>y.innerHTML,set(A){r(A)&&(y.innerHTML=A)}});const E=document.createElement("div");(0,v.addClass)(E,"art-setting-item-left-text"),(0,v.append)(E,s.html||""),(0,v.append)(D,E),s.$html=E,(0,v.def)(s,"html",{configurable:!0,get:()=>E.innerHTML,set(A){r(A)&&(E.innerHTML=A)}});const _=document.createElement("div");switch((0,v.addClass)(_,"art-setting-item-right-tooltip"),(0,v.append)(_,s.tooltip||""),(0,v.append)(L,_),s.$tooltip=_,(0,v.def)(s,"tooltip",{configurable:!0,get:()=>_.innerHTML,set(A){r(A)&&(_.innerHTML=A)}}),e){case"switch":{const A=document.createElement("div");(0,v.addClass)(A,"art-setting-item-right-icon");const I=(0,v.append)(A,o.switchOn),b=(0,v.append)(A,o.switchOff);(0,v.setStyle)(s.switch?b:I,"display","none"),(0,v.append)(L,A),s.$switch=s.switch,(0,v.def)(s,"switch",{configurable:!0,get:()=>s.$switch,set(R){s.$switch=R,R?((0,v.setStyle)(b,"display","none"),(0,v.setStyle)(I,"display",null)):((0,v.setStyle)(b,"display",null),(0,v.setStyle)(I,"display","none"))}});break}case"range":{const A=document.createElement("div");(0,v.addClass)(A,"art-setting-item-right-icon");const I=(0,v.append)(A,'<input type="range">');I.value=s.range[0]||0,I.min=s.range[1]||0,I.max=s.range[2]||10,I.step=s.range[3]||1,(0,v.addClass)(I,"art-setting-range"),(0,v.append)(L,A),s.$range=I,(0,v.def)(s,"range",{configurable:!0,get:()=>I.valueAsNumber,set(b){I.value=Number(b)}})}break;case"selector":if(s.selector&&s.selector.length){const A=document.createElement("div");(0,v.addClass)(A,"art-setting-item-right-icon"),(0,v.append)(A,o.arrowRight),(0,v.append)(L,A)}}switch(e){case"switch":if(s.onSwitch){const A=a(p,"click",async I=>{s.switch=await s.onSwitch.call(this.art,s,p,I)});this.events.push(A)}break;case"range":if(s.onRange&&s.$range){const A=a(s.$range,"change",async I=>{s.tooltip=await s.onRange.call(this.art,s,p,I)});this.events.push(A)}break;case"selector":{const A=a(p,"click",async I=>{if(s.selector&&s.selector.length)this.init(s.selector,s.width);else if((0,v.inverseClass)(p,"art-current"),s.$parentList&&this.init(s.$parentList),s.$parentItem&&s.$parentItem.onSelect){const b=await s.$parentItem.onSelect.call(this.art,s,p,I);s.$parentItem.$tooltip&&r(b)&&(s.$parentItem.$tooltip.innerHTML=b)}});this.events.push(A),s.default&&(0,v.addClass)(p,"art-current")}}return p}init(e,s){const{constructor:o}=this.art;if(this.cache.has(e)){const a=this.cache.get(e);(0,v.inverseClass)(a,"art-current"),(0,v.setStyle)(this.$parent,"width",`${a.dataset.width}px`),(0,v.setStyle)(this.$parent,"height",`${a.dataset.height}px`)}else{const a=document.createElement("div");(0,v.addClass)(a,"art-setting-panel"),a.dataset.width=s||o.SETTING_WIDTH,a.dataset.height=e.length*o.SETTING_ITEM_HEIGHT,e[0]&&e[0].$parentItem&&((0,v.append)(a,this.creatHeader(e[0])),a.dataset.height=Number(a.dataset.height)+o.SETTING_ITEM_HEIGHT);for(let p=0;p<e.length;p++){const D=e[p];(0,v.has)(D,"switch")?(0,v.append)(a,this.creatItem("switch",D)):(0,v.has)(D,"range")?(0,v.append)(a,this.creatItem("range",D)):(0,v.append)(a,this.creatItem("selector",D))}(0,v.append)(this.$parent,a),this.cache.set(e,a),(0,v.inverseClass)(a,"art-current"),(0,v.setStyle)(this.$parent,"width",`${a.dataset.width}px`),(0,v.setStyle)(this.$parent,"height",`${a.dataset.height}px`),e[0]&&e[0].$parentItem&&e[0].$parentItem.mounted&&e[0].$parentItem.mounted.call(this.art,a,e[0].$parentItem)}}}x.default=t},{"./flip":"ah3Qs","./aspectRatio":"1gs5B","./playbackRate":"j50mh","./subtitleOffset":"i17b6","../utils/component":"kPHYl","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ah3Qs:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,icons:M,constructor:T}=c,g={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function u(n,d,l){d&&(d.innerText=m.get(g[l]));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>v.dataset.value===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Video Flip"),tooltip:m.get(g[c.flip]),icon:M.flip,selector:Object.keys(g).map(n=>({value:n,default:n===c.flip,html:m.get(g[n])})),onSelect(n){c.flip=n.value},mounted:(n,d)=>{u(n,d.$tooltip,c.flip),c.on("flip",()=>{u(n,d.$tooltip,c.flip)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1gs5B":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,icons:M,constructor:T}=c;function g(n){return n==="default"?m.get("Default"):n}function u(n,d,l){d&&(d.innerText=g(l));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>v.dataset.value===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Aspect Ratio"),icon:M.aspectRatio,tooltip:g(c.aspectRatio),selector:["default","4:3","16:9"].map(n=>({value:n,default:n===c.aspectRatio,html:g(n)})),onSelect(n){c.aspectRatio=n.value},mounted:(n,d)=>{u(n,d.$tooltip,c.aspectRatio),c.on("aspectRatio",()=>{u(n,d.$tooltip,c.aspectRatio)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j50mh:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,icons:M,constructor:T}=c;function g(n){return n===1?m.get("Normal"):n}function u(n,d,l){d&&(d.innerText=g(l));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>Number(v.dataset.value)===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Play Speed"),tooltip:g(c.playbackRate),icon:M.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(n=>({value:n,default:n===c.playbackRate,html:g(n)})),onSelect(n){c.playbackRate=n.value},mounted:(n,d)=>{u(n,d.$tooltip,c.playbackRate),c.on("playbackRate",()=>{u(n,d.$tooltip,c.playbackRate)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i17b6:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,icons:M,constructor:T}=c;function g(n){return n===0?m.get("Normal"):n}function u(n,d,l){d&&(d.innerText=g(l));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>Number(v.dataset.value)===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:m.get("Subtitle Offset"),tooltip:g(c.subtitleOffset),icon:M.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(n=>({value:n,default:n===c.subtitleOffset,html:g(n)})),onSelect(n){c.subtitleOffset=n.value},mounted:(n,d)=>{u(n,d.$tooltip,c.subtitleOffset),c.on("subtitleOffset",()=>{u(n,d.$tooltip,c.subtitleOffset)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5M8nN":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(S){try{const c=JSON.parse(window.localStorage.getItem(this.name))||{};return S?c[S]:c}catch{return S?this.settings[S]:this.settings}}set(S,c){try{const m=Object.assign({},this.get(),{[S]:c});window.localStorage.setItem(this.name,JSON.stringify(m))}catch{this.settings[S]=c}}del(S){try{const c=this.get();delete c[S],window.localStorage.setItem(this.name,JSON.stringify(c))}catch{delete this.settings[S]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jWfEd:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("../utils"),m=O("./miniProgressBar"),M=S.interopDefault(m),T=O("./autoOrientation"),g=S.interopDefault(T),u=O("./autoPlayback"),n=S.interopDefault(u),d=O("./fastForward"),l=S.interopDefault(d),h=O("./lock"),v=S.interopDefault(h);x.default=class{constructor(f){this.art=f,this.id=0;const{option:r}=f;r.miniProgressBar&&!r.isLive&&this.add(M.default),r.lock&&c.isMobile&&this.add(v.default),r.autoPlayback&&this.add(n.default),r.autoOrientation&&c.isMobile&&this.add(g.default),r.fastForward&&c.isMobile&&!r.isLive&&this.add(l.default);for(let t=0;t<r.plugins.length;t++)this.add(r.plugins[t])}add(f){this.id+=1;const r=f.call(this,this.art),t=r&&r.name||f.name||`plugin${this.id}`;return(0,c.errorHandle)(!(0,c.has)(this,t),`Cannot add a plugin that already has the same name: ${t}`),(0,c.def)(this,t,{value:r}),this}}},{"../utils":"geSvU","./miniProgressBar":"7KBj0","./autoOrientation":"aPIVP","./autoPlayback":"j87OI","./fastForward":"1VTki","./lock":"7BtoE","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7KBj0":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x),x.default=function(S){return S.on("ready",()=>{S.layers.add({name:"miniProgressBar",mounted(c){S.on("destroy",()=>{c.style.display="none"}),S.on("video:timeupdate",()=>{c.style.width=100*S.played+"%"}),S.on("setBar",(m,M)=>{m==="played"&&(c.style.width=100*M+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPIVP:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{option:m,constructor:M,template:{$player:T,$video:g}}=c;return c.on("fullscreenWeb",u=>{if(u){const{videoWidth:n,videoHeight:d}=g,{clientWidth:l,clientHeight:h}=document.documentElement;(n>d&&l<h||n<d&&l>h)&&setTimeout(()=>{(0,S.setStyle)(T,"width",`${h}px`),(0,S.setStyle)(T,"height",`${l}px`),(0,S.setStyle)(T,"transform-origin","0 0"),(0,S.setStyle)(T,"transform",`rotate(90deg) translate(0, -${l}px)`),(0,S.addClass)(T,"art-auto-orientation"),c.emit("resize")},M.MOBILE_AUTO_ORIENTATION_TIME)}else(0,S.hasClass)(T,"art-auto-orientation")&&((0,S.setStyle)(T,"width",null),(0,S.setStyle)(T,"height",null),(0,S.setStyle)(T,"transform",null),(0,S.setStyle)(T,"transform-origin",null),(0,S.removeClass)(T,"art-auto-orientation"),c.aspectRatioReset=!0,c.autoSize=m.autoSize,c.notice.show="",c.emit("resize"))}),c.on("fullscreen",async u=>{const n=screen.orientation.type;if(u){const{videoWidth:d,videoHeight:l}=g,{clientWidth:h,clientHeight:v}=document.documentElement;if(d>l&&h<v||d<l&&h>v){const f=n.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(f),(0,S.addClass)(T,"art-auto-orientation-fullscreen")}}else(0,S.hasClass)(T,"art-auto-orientation-fullscreen")&&(await screen.orientation.lock(n),(0,S.removeClass)(T,"art-auto-orientation-fullscreen"))}),{name:"autoOrientation",get state(){return(0,S.hasClass)(T,"art-auto-orientation")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j87OI:[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{i18n:m,icons:M,storage:T,constructor:g,events:{proxy:u},template:{$poster:n}}=c,d=c.layers.add({name:"autoPlayback",html:'<div class="art-autoPlayback-close"></div><div class="art-autoPlayback-last"></div><div class="art-autoPlayback-jump"></div>'}),l=(0,S.query)(".art-autoPlayback-last",d),h=(0,S.query)(".art-autoPlayback-jump",d),v=(0,S.query)(".art-autoPlayback-close",d);return c.on("video:timeupdate",()=>{const f=T.get("times")||{},r=Object.keys(f);r.length>g.AUTO_PLAYBACK_MAX&&delete f[r[0]],f[c.option.url]=c.currentTime,T.set("times",f)}),c.on("ready",()=>{const f=(T.get("times")||{})[c.option.url];f&&((0,S.append)(v,M.close),(0,S.setStyle)(d,"display","flex"),l.innerText=`${m.get("Last Seen")} ${(0,S.secondToTime)(f)}`,h.innerText=m.get("Jump Play"),u(v,"click",()=>{(0,S.setStyle)(d,"display","none")}),u(h,"click",()=>{c.seek=f,c.play(),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(d,"display","none")}),c.once("video:timeupdate",()=>{setTimeout(()=>{(0,S.setStyle)(d,"display","none")},g.AUTO_PLAYBACK_TIMEOUT)}))}),{name:"autoPlayback",get times(){return T.get("times")||{}},clear:()=>T.del("times")}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1VTki":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{constructor:m,events:{proxy:M},template:{$player:T,$video:g}}=c;let u=null,n=!1;const d=()=>{clearTimeout(u),n&&(n=!1,c.playbackRate=1,(0,S.removeClass)(T,"art-fast-forward"))};return M(g,"touchstart",l=>{l.touches.length===1&&c.playing&&!c.isLock&&(u=setTimeout(()=>{n=!0,c.playbackRate=m.FAST_FORWARD_VALUE,(0,S.addClass)(T,"art-fast-forward")},m.FAST_FORWARD_TIME))}),M(document,"touchmove",d),M(document,"touchend",d),{name:"fastForward",get state(){return(0,S.hasClass)(T,"art-fast-forward")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7BtoE":[function(O,C,x){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(x);var S=O("../utils");x.default=function(c){const{layers:m,icons:M,template:{$player:T}}=c;return m.add({name:"lock",mounted(g){const u=(0,S.append)(g,M.lock),n=(0,S.append)(g,M.unlock);(0,S.setStyle)(u,"display","none"),c.on("lock",d=>{d?((0,S.setStyle)(u,"display","inline-flex"),(0,S.setStyle)(n,"display","none")):((0,S.setStyle)(u,"display","none"),(0,S.setStyle)(n,"display","inline-flex"))})},click(){(0,S.hasClass)(T,"art-lock")?((0,S.removeClass)(T,"art-lock"),this.isLock=!1,c.emit("lock",!1)):((0,S.addClass)(T,"art-lock"),this.isLock=!0,c.emit("lock",!0))}}),{name:"lock",get state(){return(0,S.hasClass)(T,"art-lock")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fkUkB:[function(O,C,x){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(x);var c=O("./config"),m=S.interopDefault(c),M=O("./utils");x.default=class{constructor(T){const{option:g,events:{proxy:u},template:{$video:n}}=T;for(let h=0;h<m.default.events.length;h++)u(n,m.default.events[h],v=>{T.emit(`video:${v.type}`,v)});Object.keys(g.moreVideoAttr).forEach(h=>{n[h]=g.moreVideoAttr[h]}),g.muted&&(n.muted=g.muted),g.volume&&(n.volume=(0,M.clamp)(g.volume,0,1)),g.poster&&(n.poster=g.poster),g.autoplay&&(n.autoplay=g.autoplay),g.playsInline&&(n.playsInline=!0,n["webkit-playsinline"]=!0);const d=g.type||(0,M.getExt)(g.url),l=g.customType[d];d&&l?(l(n,g.url,T),T.emit("customType",d)):(n.src=g.url,T.emit("url",n.src))}}},{"./config":"eksZR","./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}]},["6SN6P"],"6SN6P")})(Ye);var Lt=Ue(Ye.exports);const At={style:{transform:"scale(-1,1)"},height:"25",width:"25",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Dt=pe("path",{d:"M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"},null,-1),Mt=[Dt];function It(ye,Ie){return Pe(),we("svg",At,Mt)}var bt={name:"custom-prev",render:It};const Rt={height:"25",width:"25",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ot=pe("path",{d:"M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"},null,-1),Ct=[Ot];function Pt(ye,Ie){return Pe(),we("svg",Rt,Ct)}var wt={name:"custom-next",render:Pt},Ze={exports:{}};(function(ye,Ie){(function(C,x){ye.exports=x()})(self,function(){return function(){var O={"./node_modules/es6-promise/dist/es6-promise.js":function(c,m,M){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(T,g){c.exports=g()})(this,function(){function T(W){var z=typeof W;return W!==null&&(z==="object"||z==="function")}function g(W){return typeof W=="function"}var u=void 0;Array.isArray?u=Array.isArray:u=function(W){return Object.prototype.toString.call(W)==="[object Array]"};var n=u,d=0,l=void 0,h=void 0,v=function(z,V){E[d]=z,E[d+1]=V,d+=2,d===2&&(h?h(_):I())};function f(W){h=W}function r(W){v=W}var t=typeof window!="undefined"?window:void 0,i=t||{},e=i.MutationObserver||i.WebKitMutationObserver,s=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",o=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function a(){return function(){return process.nextTick(_)}}function p(){return typeof l!="undefined"?function(){l(_)}:y()}function D(){var W=0,z=new e(_),V=document.createTextNode("");return z.observe(V,{characterData:!0}),function(){V.data=W=++W%2}}function L(){var W=new MessageChannel;return W.port1.onmessage=_,function(){return W.port2.postMessage(0)}}function y(){var W=setTimeout;return function(){return W(_,1)}}var E=new Array(1e3);function _(){for(var W=0;W<d;W+=2){var z=E[W],V=E[W+1];z(V),E[W]=void 0,E[W+1]=void 0}d=0}function A(){try{var W=Function("return this")().require("vertx");return l=W.runOnLoop||W.runOnContext,p()}catch{return y()}}var I=void 0;s?I=a():e?I=D():o?I=L():t===void 0?I=A():I=y();function b(W,z){var V=this,X=new this.constructor(w);X[P]===void 0&&oe(X);var H=V._state;if(H){var re=arguments[H-1];v(function(){return ie(H,X,re,V._result)})}else q(V,X,W,z);return X}function R(W){var z=this;if(W&&typeof W=="object"&&W.constructor===z)return W;var V=new z(w);return Y(V,W),V}var P=Math.random().toString(36).substring(2);function w(){}var F=void 0,k=1,B=2;function U(){return new TypeError("You cannot resolve a promise with itself")}function j(){return new TypeError("A promises callback cannot return that same promise.")}function K(W,z,V,X){try{W.call(z,V,X)}catch(H){return H}}function N(W,z,V){v(function(X){var H=!1,re=K(V,z,function(ce){H||(H=!0,z!==ce?Y(X,ce):Q(X,ce))},function(ce){H||(H=!0,G(X,ce))},"Settle: "+(X._label||" unknown promise"));!H&&re&&(H=!0,G(X,re))},W)}function Z(W,z){z._state===k?Q(W,z._result):z._state===B?G(W,z._result):q(z,void 0,function(V){return Y(W,V)},function(V){return G(W,V)})}function $(W,z,V){z.constructor===W.constructor&&V===b&&z.constructor.resolve===R?Z(W,z):V===void 0?Q(W,z):g(V)?N(W,z,V):Q(W,z)}function Y(W,z){if(W===z)G(W,U());else if(T(z)){var V=void 0;try{V=z.then}catch(X){G(W,X);return}$(W,z,V)}else Q(W,z)}function ee(W){W._onerror&&W._onerror(W._result),te(W)}function Q(W,z){W._state===F&&(W._result=z,W._state=k,W._subscribers.length!==0&&v(te,W))}function G(W,z){W._state===F&&(W._state=B,W._result=z,v(ee,W))}function q(W,z,V,X){var H=W._subscribers,re=H.length;W._onerror=null,H[re]=z,H[re+k]=V,H[re+B]=X,re===0&&W._state&&v(te,W)}function te(W){var z=W._subscribers,V=W._state;if(z.length!==0){for(var X=void 0,H=void 0,re=W._result,ce=0;ce<z.length;ce+=3)X=z[ce],H=z[ce+V],X?ie(V,X,H,re):H(re);W._subscribers.length=0}}function ie(W,z,V,X){var H=g(V),re=void 0,ce=void 0,me=!0;if(H){try{re=V(X)}catch(xe){me=!1,ce=xe}if(z===re){G(z,j());return}}else re=X;z._state!==F||(H&&me?Y(z,re):me===!1?G(z,ce):W===k?Q(z,re):W===B&&G(z,re))}function ne(W,z){try{z(function(X){Y(W,X)},function(X){G(W,X)})}catch(V){G(W,V)}}var le=0;function se(){return le++}function oe(W){W[P]=le++,W._state=void 0,W._result=void 0,W._subscribers=[]}function J(){return new Error("Array Methods must be provided an Array")}var ae=function(){function W(z,V){this._instanceConstructor=z,this.promise=new z(w),this.promise[P]||oe(this.promise),n(V)?(this.length=V.length,this._remaining=V.length,this._result=new Array(this.length),this.length===0?Q(this.promise,this._result):(this.length=this.length||0,this._enumerate(V),this._remaining===0&&Q(this.promise,this._result))):G(this.promise,J())}return W.prototype._enumerate=function(V){for(var X=0;this._state===F&&X<V.length;X++)this._eachEntry(V[X],X)},W.prototype._eachEntry=function(V,X){var H=this._instanceConstructor,re=H.resolve;if(re===R){var ce=void 0,me=void 0,xe=!1;try{ce=V.then}catch(_e){xe=!0,me=_e}if(ce===b&&V._state!==F)this._settledAt(V._state,X,V._result);else if(typeof ce!="function")this._remaining--,this._result[X]=V;else if(H===he){var Se=new H(w);xe?G(Se,me):$(Se,V,ce),this._willSettleAt(Se,X)}else this._willSettleAt(new H(function(_e){return _e(V)}),X)}else this._willSettleAt(re(V),X)},W.prototype._settledAt=function(V,X,H){var re=this.promise;re._state===F&&(this._remaining--,V===B?G(re,H):this._result[X]=H),this._remaining===0&&Q(re,this._result)},W.prototype._willSettleAt=function(V,X){var H=this;q(V,void 0,function(re){return H._settledAt(k,X,re)},function(re){return H._settledAt(B,X,re)})},W}();function fe(W){return new ae(this,W).promise}function de(W){var z=this;return n(W)?new z(function(V,X){for(var H=W.length,re=0;re<H;re++)z.resolve(W[re]).then(V,X)}):new z(function(V,X){return X(new TypeError("You must pass an array to race."))})}function ve(W){var z=this,V=new z(w);return G(V,W),V}function ue(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Te(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var he=function(){function W(z){this[P]=se(),this._result=this._state=void 0,this._subscribers=[],w!==z&&(typeof z!="function"&&ue(),this instanceof W?ne(this,z):Te())}return W.prototype.catch=function(V){return this.then(null,V)},W.prototype.finally=function(V){var X=this,H=X.constructor;return g(V)?X.then(function(re){return H.resolve(V()).then(function(){return re})},function(re){return H.resolve(V()).then(function(){throw re})}):X.then(V,V)},W}();he.prototype.then=b,he.all=fe,he.race=de,he.resolve=R,he.reject=ve,he._setScheduler=f,he._setAsap=r,he._asap=v;function Ee(){var W=void 0;if(typeof M.g!="undefined")W=M.g;else if(typeof self!="undefined")W=self;else try{W=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var z=W.Promise;if(z){var V=null;try{V=Object.prototype.toString.call(z.resolve())}catch{}if(V==="[object Promise]"&&!z.cast)return}W.Promise=he}return he.polyfill=Ee,he.Promise=he,he})},"./node_modules/events/events.js":function(c){var m=typeof Reflect=="object"?Reflect:null,M=m&&typeof m.apply=="function"?m.apply:function(y,E,_){return Function.prototype.apply.call(y,E,_)},T;m&&typeof m.ownKeys=="function"?T=m.ownKeys:Object.getOwnPropertySymbols?T=function(y){return Object.getOwnPropertyNames(y).concat(Object.getOwnPropertySymbols(y))}:T=function(y){return Object.getOwnPropertyNames(y)};function g(L){console&&console.warn&&console.warn(L)}var u=Number.isNaN||function(y){return y!==y};function n(){n.init.call(this)}c.exports=n,c.exports.once=a,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var d=10;function l(L){if(typeof L!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof L)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(L){if(typeof L!="number"||L<0||u(L))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+L+".");d=L}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||u(y))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+y+".");return this._maxListeners=y,this};function h(L){return L._maxListeners===void 0?n.defaultMaxListeners:L._maxListeners}n.prototype.getMaxListeners=function(){return h(this)},n.prototype.emit=function(y){for(var E=[],_=1;_<arguments.length;_++)E.push(arguments[_]);var A=y==="error",I=this._events;if(I!==void 0)A=A&&I.error===void 0;else if(!A)return!1;if(A){var b;if(E.length>0&&(b=E[0]),b instanceof Error)throw b;var R=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw R.context=b,R}var P=I[y];if(P===void 0)return!1;if(typeof P=="function")M(P,this,E);else for(var w=P.length,F=e(P,w),_=0;_<w;++_)M(F[_],this,E);return!0};function v(L,y,E,_){var A,I,b;if(l(E),I=L._events,I===void 0?(I=L._events=Object.create(null),L._eventsCount=0):(I.newListener!==void 0&&(L.emit("newListener",y,E.listener?E.listener:E),I=L._events),b=I[y]),b===void 0)b=I[y]=E,++L._eventsCount;else if(typeof b=="function"?b=I[y]=_?[E,b]:[b,E]:_?b.unshift(E):b.push(E),A=h(L),A>0&&b.length>A&&!b.warned){b.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(y)+" listeners added. Use emitter.setMaxListeners() to increase limit");R.name="MaxListenersExceededWarning",R.emitter=L,R.type=y,R.count=b.length,g(R)}return L}n.prototype.addListener=function(y,E){return v(this,y,E,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(y,E){return v(this,y,E,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(L,y,E){var _={fired:!1,wrapFn:void 0,target:L,type:y,listener:E},A=f.bind(_);return A.listener=E,_.wrapFn=A,A}n.prototype.once=function(y,E){return l(E),this.on(y,r(this,y,E)),this},n.prototype.prependOnceListener=function(y,E){return l(E),this.prependListener(y,r(this,y,E)),this},n.prototype.removeListener=function(y,E){var _,A,I,b,R;if(l(E),A=this._events,A===void 0)return this;if(_=A[y],_===void 0)return this;if(_===E||_.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete A[y],A.removeListener&&this.emit("removeListener",y,_.listener||E));else if(typeof _!="function"){for(I=-1,b=_.length-1;b>=0;b--)if(_[b]===E||_[b].listener===E){R=_[b].listener,I=b;break}if(I<0)return this;I===0?_.shift():s(_,I),_.length===1&&(A[y]=_[0]),A.removeListener!==void 0&&this.emit("removeListener",y,R||E)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(y){var E,_,A;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[y]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[y]),this;if(arguments.length===0){var I=Object.keys(_),b;for(A=0;A<I.length;++A)b=I[A],b!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=_[y],typeof E=="function")this.removeListener(y,E);else if(E!==void 0)for(A=E.length-1;A>=0;A--)this.removeListener(y,E[A]);return this};function t(L,y,E){var _=L._events;if(_===void 0)return[];var A=_[y];return A===void 0?[]:typeof A=="function"?E?[A.listener||A]:[A]:E?o(A):e(A,A.length)}n.prototype.listeners=function(y){return t(this,y,!0)},n.prototype.rawListeners=function(y){return t(this,y,!1)},n.listenerCount=function(L,y){return typeof L.listenerCount=="function"?L.listenerCount(y):i.call(L,y)},n.prototype.listenerCount=i;function i(L){var y=this._events;if(y!==void 0){var E=y[L];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?T(this._events):[]};function e(L,y){for(var E=new Array(y),_=0;_<y;++_)E[_]=L[_];return E}function s(L,y){for(;y+1<L.length;y++)L[y]=L[y+1];L.pop()}function o(L){for(var y=new Array(L.length),E=0;E<y.length;++E)y[E]=L[E].listener||L[E];return y}function a(L,y){return new Promise(function(E,_){function A(b){L.removeListener(y,I),_(b)}function I(){typeof L.removeListener=="function"&&L.removeListener("error",A),E([].slice.call(arguments))}D(L,y,I,{once:!0}),y!=="error"&&p(L,A,{once:!0})})}function p(L,y,E){typeof L.on=="function"&&D(L,"error",y,E)}function D(L,y,E,_){if(typeof L.on=="function")_.once?L.once(y,E):L.on(y,E);else if(typeof L.addEventListener=="function")L.addEventListener(y,function A(I){_.once&&L.removeEventListener(y,A),E(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof L)}},"./node_modules/webworkify-webpack/index.js":function(c,m,M){function T(f){var r={};function t(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return f[e].call(s.exports,s,s.exports,t),s.l=!0,s.exports}t.m=f,t.c=r,t.i=function(e){return e},t.d=function(e,s,o){t.o(e,s)||Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:o})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="/",t.oe=function(e){throw console.error(e),e};var i=t(t.s=ENTRY_MODULE);return i.default||i}var g="[\\.|\\-|\\+|\\w|/|@]+",u="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+g+").*?\\)";function n(f){return(f+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(f){return!isNaN(1*f)}function l(f,r,t){var i={};i[t]=[];var e=r.toString(),s=e.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return i;for(var o=s[1],a=new RegExp("(\\\\n|\\W)"+n(o)+u,"g"),p;p=a.exec(e);)p[3]!=="dll-reference"&&i[t].push(p[3]);for(a=new RegExp("\\("+n(o)+'\\("(dll-reference\\s('+g+'))"\\)\\)'+u,"g");p=a.exec(e);)f[p[2]]||(i[t].push(p[1]),f[p[2]]=M(p[1]).m),i[p[2]]=i[p[2]]||[],i[p[2]].push(p[4]);for(var D=Object.keys(i),L=0;L<D.length;L++)for(var y=0;y<i[D[L]].length;y++)d(i[D[L]][y])&&(i[D[L]][y]=1*i[D[L]][y]);return i}function h(f){var r=Object.keys(f);return r.reduce(function(t,i){return t||f[i].length>0},!1)}function v(f,r){for(var t={main:[r]},i={main:[]},e={main:{}};h(t);)for(var s=Object.keys(t),o=0;o<s.length;o++){var a=s[o],p=t[a],D=p.pop();if(e[a]=e[a]||{},!(e[a][D]||!f[a][D])){e[a][D]=!0,i[a]=i[a]||[],i[a].push(D);for(var L=l(f,f[a][D],a),y=Object.keys(L),E=0;E<y.length;E++)t[y[E]]=t[y[E]]||[],t[y[E]]=t[y[E]].concat(L[y[E]])}}return i}c.exports=function(f,r){r=r||{};var t={main:M.m},i=r.all?{main:Object.keys(t.main)}:v(t,f),e="";Object.keys(i).filter(function(D){return D!=="main"}).forEach(function(D){for(var L=0;i[D][L];)L++;i[D].push(L),t[D][L]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",e=e+"var "+D+" = ("+T.toString().replace("ENTRY_MODULE",JSON.stringify(L))+")({"+i[D].map(function(y){return""+JSON.stringify(y)+": "+t[D][y].toString()}).join(",")+`});
`}),e=e+"new (("+T.toString().replace("ENTRY_MODULE",JSON.stringify(f))+")({"+i.main.map(function(D){return""+JSON.stringify(D)+": "+t.main[D].toString()}).join(",")+"}))(self);";var s=new window.Blob([e],{type:"text/javascript"});if(r.bare)return s;var o=window.URL||window.webkitURL||window.mozURL||window.msURL,a=o.createObjectURL(s),p=new window.Worker(a);return p.objectURL=a,p}},"./src/config.js":function(c,m,M){M.r(m),M.d(m,{defaultConfig:function(){return T},createDefaultConfig:function(){return g}});var T={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function g(){return Object.assign({},T)}},"./src/core/features.js":function(c,m,M){M.r(m);var T=M("./src/io/io-controller.js"),g=M("./src/config.js"),u=function(){function n(){}return n.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},n.supportNetworkStreamIO=function(){var d=new T.default({},(0,g.createDefaultConfig)()),l=d.loaderType;return d.destroy(),l=="fetch-stream-loader"||l=="xhr-moz-chunked-loader"},n.getNetworkLoaderTypeName=function(){var d=new T.default({},(0,g.createDefaultConfig)()),l=d.loaderType;return d.destroy(),l},n.supportNativeMediaPlayback=function(d){n.videoElement==null&&(n.videoElement=window.document.createElement("video"));var l=n.videoElement.canPlayType(d);return l==="probably"||l=="maybe"},n.getFeatureList=function(){var d={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return d.mseFlvPlayback=n.supportMSEH264Playback(),d.networkStreamIO=n.supportNetworkStreamIO(),d.networkLoaderName=n.getNetworkLoaderTypeName(),d.mseLiveFlvPlayback=d.mseFlvPlayback&&d.networkStreamIO,d.nativeMP4H264Playback=n.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),d.nativeWebmVP8Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),d.nativeWebmVP9Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp9"'),d},n}();m.default=u},"./src/core/media-info.js":function(c,m,M){M.r(m);var T=function(){function g(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return g.prototype.isComplete=function(){var u=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,n=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&u&&n},g.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},g.prototype.getNearestKeyframe=function(u){if(this.keyframesIndex==null)return null;var n=this.keyframesIndex,d=this._search(n.times,u);return{index:d,milliseconds:n.times[d],fileposition:n.filepositions[d]}},g.prototype._search=function(u,n){var d=0,l=u.length-1,h=0,v=0,f=l;for(n<u[0]&&(d=0,v=f+1);v<=f;)if(h=v+Math.floor((f-v)/2),h===l||n>=u[h]&&n<u[h+1]){d=h;break}else u[h]<n?v=h+1:f=h-1;return d},g}();m.default=T},"./src/core/media-segment-info.js":function(c,m,M){M.r(m),M.d(m,{SampleInfo:function(){return T},MediaSegmentInfo:function(){return g},IDRSampleList:function(){return u},MediaSegmentInfoList:function(){return n}});var T=function(){function d(l,h,v,f,r){this.dts=l,this.pts=h,this.duration=v,this.originalDts=f,this.isSyncPoint=r,this.fileposition=null}return d}(),g=function(){function d(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return d.prototype.appendSyncPoint=function(l){l.isSyncPoint=!0,this.syncPoints.push(l)},d}(),u=function(){function d(){this._list=[]}return d.prototype.clear=function(){this._list=[]},d.prototype.appendArray=function(l){var h=this._list;l.length!==0&&(h.length>0&&l[0].originalDts<h[h.length-1].originalDts&&this.clear(),Array.prototype.push.apply(h,l))},d.prototype.getLastSyncPointBeforeDts=function(l){if(this._list.length==0)return null;var h=this._list,v=0,f=h.length-1,r=0,t=0,i=f;for(l<h[0].dts&&(v=0,t=i+1);t<=i;)if(r=t+Math.floor((i-t)/2),r===f||l>=h[r].dts&&l<h[r+1].dts){v=r;break}else h[r].dts<l?t=r+1:i=r-1;return this._list[v]},d}(),n=function(){function d(l){this._type=l,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(d.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),d.prototype.isEmpty=function(){return this._list.length===0},d.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},d.prototype._searchNearestSegmentBefore=function(l){var h=this._list;if(h.length===0)return-2;var v=h.length-1,f=0,r=0,t=v,i=0;if(l<h[0].originalBeginDts)return i=-1,i;for(;r<=t;)if(f=r+Math.floor((t-r)/2),f===v||l>h[f].lastSample.originalDts&&l<h[f+1].originalBeginDts){i=f;break}else h[f].originalBeginDts<l?r=f+1:t=f-1;return i},d.prototype._searchNearestSegmentAfter=function(l){return this._searchNearestSegmentBefore(l)+1},d.prototype.append=function(l){var h=this._list,v=l,f=this._lastAppendLocation,r=0;f!==-1&&f<h.length&&v.originalBeginDts>=h[f].lastSample.originalDts&&(f===h.length-1||f<h.length-1&&v.originalBeginDts<h[f+1].originalBeginDts)?r=f+1:h.length>0&&(r=this._searchNearestSegmentBefore(v.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,v)},d.prototype.getLastSegmentBefore=function(l){var h=this._searchNearestSegmentBefore(l);return h>=0?this._list[h]:null},d.prototype.getLastSampleBefore=function(l){var h=this.getLastSegmentBefore(l);return h!=null?h.lastSample:null},d.prototype.getLastSyncPointBefore=function(l){for(var h=this._searchNearestSegmentBefore(l),v=this._list[h].syncPoints;v.length===0&&h>0;)h--,v=this._list[h].syncPoints;return v.length>0?v[v.length-1]:null},d}()},"./src/core/mse-controller.js":function(c,m,M){M.r(m);var T=M("./node_modules/events/events.js"),g=M.n(T),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),d=M("./src/core/mse-events.js"),l=M("./src/core/media-segment-info.js"),h=M("./src/utils/exception.js"),v=function(){function f(r){this.TAG="MSEController",this._config=r,this._emitter=new(g()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new l.IDRSampleList}return f.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},f.prototype.on=function(r,t){this._emitter.addListener(r,t)},f.prototype.off=function(r,t){this._emitter.removeListener(r,t)},f.prototype.attachMediaElement=function(r){if(this._mediaSource)throw new h.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=r,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),r.src=this._mediaSourceObjectURL},f.prototype.detachMediaElement=function(){if(this._mediaSource){var r=this._mediaSource;for(var t in this._sourceBuffers){var i=this._pendingSegments[t];i.splice(0,i.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var e=this._sourceBuffers[t];if(e){if(r.readyState!=="closed"){try{r.removeSourceBuffer(e)}catch(s){u.default.e(this.TAG,s.message)}e.removeEventListener("error",this.e.onSourceBufferError),e.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if(r.readyState==="open")try{r.endOfStream()}catch(s){u.default.e(this.TAG,s.message)}r.removeEventListener("sourceopen",this.e.onSourceOpen),r.removeEventListener("sourceended",this.e.onSourceEnded),r.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},f.prototype.appendInitSegment=function(r,t){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(r),this._pendingSegments[r.type].push(r);return}var i=r,e=""+i.container;i.codec&&i.codec.length>0&&(e+=";codecs="+i.codec);var s=!1;if(u.default.v(this.TAG,"Received Initialization Segment, mimeType: "+e),this._lastInitSegments[i.type]=i,e!==this._mimeTypes[i.type]){if(this._mimeTypes[i.type])u.default.v(this.TAG,"Notice: "+i.type+" mimeType changed, origin: "+this._mimeTypes[i.type]+", target: "+e);else{s=!0;try{var o=this._sourceBuffers[i.type]=this._mediaSource.addSourceBuffer(e);o.addEventListener("error",this.e.onSourceBufferError),o.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(a){u.default.e(this.TAG,a.message),this._emitter.emit(d.default.ERROR,{code:a.code,msg:a.message});return}}this._mimeTypes[i.type]=e}t||this._pendingSegments[i.type].push(i),s||this._sourceBuffers[i.type]&&!this._sourceBuffers[i.type].updating&&this._doAppendSegments(),n.default.safari&&i.container==="audio/mpeg"&&i.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=i.mediaDuration/1e3,this._updateMediaSourceDuration())},f.prototype.appendMediaSegment=function(r){var t=r;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var i=this._sourceBuffers[t.type];i&&!i.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},f.prototype.seek=function(r){for(var t in this._sourceBuffers)if(!!this._sourceBuffers[t]){var i=this._sourceBuffers[t];if(this._mediaSource.readyState==="open")try{i.abort()}catch(D){u.default.e(this.TAG,D.message)}this._idrList.clear();var e=this._pendingSegments[t];if(e.splice(0,e.length),this._mediaSource.readyState!=="closed"){for(var s=0;s<i.buffered.length;s++){var o=i.buffered.start(s),a=i.buffered.end(s);this._pendingRemoveRanges[t].push({start:o,end:a})}if(i.updating||this._doRemoveRanges(),n.default.safari){var p=this._lastInitSegments[t];p&&(this._pendingSegments[t].push(p),i.updating||this._doAppendSegments())}}}},f.prototype.endOfStream=function(){var r=this._mediaSource,t=this._sourceBuffers;if(!r||r.readyState!=="open"){r&&r.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,r.endOfStream())},f.prototype.getNearestKeyframe=function(r){return this._idrList.getLastSyncPointBeforeDts(r)},f.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var r=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){var e=i.buffered;if(e.length>=1&&r-e.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},f.prototype._doCleanupSourceBuffer=function(){var r=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){for(var e=i.buffered,s=!1,o=0;o<e.length;o++){var a=e.start(o),p=e.end(o);if(a<=r&&r<p+3){if(r-a>=this._config.autoCleanupMaxBackwardDuration){s=!0;var D=r-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:a,end:D})}}else p<r&&(s=!0,this._pendingRemoveRanges[t].push({start:a,end:p}))}s&&!i.updating&&this._doRemoveRanges()}}},f.prototype._updateMediaSourceDuration=function(){var r=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(r.video&&r.video.updating||r.audio&&r.audio.updating)){var t=this._mediaSource.duration,i=this._pendingMediaDuration;i>0&&(isNaN(t)||i>t)&&(u.default.v(this.TAG,"Update MediaSource duration from "+t+" to "+i),this._mediaSource.duration=i),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},f.prototype._doRemoveRanges=function(){for(var r in this._pendingRemoveRanges)if(!(!this._sourceBuffers[r]||this._sourceBuffers[r].updating))for(var t=this._sourceBuffers[r],i=this._pendingRemoveRanges[r];i.length&&!t.updating;){var e=i.shift();t.remove(e.start,e.end)}},f.prototype._doAppendSegments=function(){var r=this._pendingSegments;for(var t in r)if(!(!this._sourceBuffers[t]||this._sourceBuffers[t].updating)&&r[t].length>0){var i=r[t].shift();if(i.timestampOffset){var e=this._sourceBuffers[t].timestampOffset,s=i.timestampOffset/1e3,o=Math.abs(e-s);o>.1&&(u.default.v(this.TAG,"Update MPEG audio timestampOffset from "+e+" to "+s),this._sourceBuffers[t].timestampOffset=s),delete i.timestampOffset}if(!i.data||i.data.byteLength===0)continue;try{this._sourceBuffers[t].appendBuffer(i.data),this._isBufferFull=!1,t==="video"&&i.hasOwnProperty("info")&&this._idrList.appendArray(i.info.syncPoints)}catch(a){this._pendingSegments[t].unshift(i),a.code===22?(this._isBufferFull||this._emitter.emit(d.default.BUFFER_FULL),this._isBufferFull=!0):(u.default.e(this.TAG,a.message),this._emitter.emit(d.default.ERROR,{code:a.code,msg:a.message}))}}},f.prototype._onSourceOpen=function(){if(u.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var r=this._pendingSourceBufferInit;r.length;){var t=r.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(d.default.SOURCE_OPEN)},f.prototype._onSourceEnded=function(){u.default.v(this.TAG,"MediaSource onSourceEnded")},f.prototype._onSourceClose=function(){u.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},f.prototype._hasPendingSegments=function(){var r=this._pendingSegments;return r.video.length>0||r.audio.length>0},f.prototype._hasPendingRemoveRanges=function(){var r=this._pendingRemoveRanges;return r.video.length>0||r.audio.length>0},f.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(d.default.UPDATE_END)},f.prototype._onSourceBufferError=function(r){u.default.e(this.TAG,"SourceBuffer Error: "+r)},f}();m.default=v},"./src/core/mse-events.js":function(c,m,M){M.r(m);var T={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};m.default=T},"./src/core/transmuxer.js":function(c,m,M){M.r(m);var T=M("./node_modules/events/events.js"),g=M.n(T),u=M("./node_modules/webworkify-webpack/index.js"),n=M.n(u),d=M("./src/utils/logger.js"),l=M("./src/utils/logging-control.js"),h=M("./src/core/transmuxing-controller.js"),v=M("./src/core/transmuxing-events.js"),f=M("./src/core/media-info.js"),r=function(){function t(i,e){if(this.TAG="Transmuxer",this._emitter=new(g()),e.enableWorker&&typeof Worker!="undefined")try{this._worker=n()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[i,e]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},l.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:l.default.getConfig()})}catch{d.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new h.default(i,e)}else this._controller=new h.default(i,e);if(this._controller){var s=this._controller;s.on(v.default.IO_ERROR,this._onIOError.bind(this)),s.on(v.default.DEMUX_ERROR,this._onDemuxError.bind(this)),s.on(v.default.INIT_SEGMENT,this._onInitSegment.bind(this)),s.on(v.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),s.on(v.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),s.on(v.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),s.on(v.default.MEDIA_INFO,this._onMediaInfo.bind(this)),s.on(v.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),s.on(v.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),s.on(v.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),s.on(v.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return t.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),l.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},t.prototype.on=function(i,e){this._emitter.addListener(i,e)},t.prototype.off=function(i,e){this._emitter.removeListener(i,e)},t.prototype.hasWorker=function(){return this._worker!=null},t.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},t.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},t.prototype.seek=function(i){this._worker?this._worker.postMessage({cmd:"seek",param:i}):this._controller.seek(i)},t.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},t.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},t.prototype._onInitSegment=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.INIT_SEGMENT,i,e)})},t.prototype._onMediaSegment=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.MEDIA_SEGMENT,i,e)})},t.prototype._onLoadingComplete=function(){var i=this;Promise.resolve().then(function(){i._emitter.emit(v.default.LOADING_COMPLETE)})},t.prototype._onRecoveredEarlyEof=function(){var i=this;Promise.resolve().then(function(){i._emitter.emit(v.default.RECOVERED_EARLY_EOF)})},t.prototype._onMediaInfo=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.MEDIA_INFO,i)})},t.prototype._onMetaDataArrived=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.METADATA_ARRIVED,i)})},t.prototype._onScriptDataArrived=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.SCRIPTDATA_ARRIVED,i)})},t.prototype._onStatisticsInfo=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.STATISTICS_INFO,i)})},t.prototype._onIOError=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.IO_ERROR,i,e)})},t.prototype._onDemuxError=function(i,e){var s=this;Promise.resolve().then(function(){s._emitter.emit(v.default.DEMUX_ERROR,i,e)})},t.prototype._onRecommendSeekpoint=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.RECOMMEND_SEEKPOINT,i)})},t.prototype._onLoggingConfigChanged=function(i){this._worker&&this._worker.postMessage({cmd:"logging_config",param:i})},t.prototype._onWorkerMessage=function(i){var e=i.data,s=e.data;if(e.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(e.msg){case v.default.INIT_SEGMENT:case v.default.MEDIA_SEGMENT:this._emitter.emit(e.msg,s.type,s.data);break;case v.default.LOADING_COMPLETE:case v.default.RECOVERED_EARLY_EOF:this._emitter.emit(e.msg);break;case v.default.MEDIA_INFO:Object.setPrototypeOf(s,f.default.prototype),this._emitter.emit(e.msg,s);break;case v.default.METADATA_ARRIVED:case v.default.SCRIPTDATA_ARRIVED:case v.default.STATISTICS_INFO:this._emitter.emit(e.msg,s);break;case v.default.IO_ERROR:case v.default.DEMUX_ERROR:this._emitter.emit(e.msg,s.type,s.info);break;case v.default.RECOMMEND_SEEKPOINT:this._emitter.emit(e.msg,s);break;case"logcat_callback":d.default.emitter.emit("log",s.type,s.logcat);break}},t}();m.default=r},"./src/core/transmuxing-controller.js":function(c,m,M){M.r(m);var T=M("./node_modules/events/events.js"),g=M.n(T),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),d=M("./src/core/media-info.js"),l=M("./src/demux/flv-demuxer.js"),h=M("./src/remux/mp4-remuxer.js"),v=M("./src/demux/demux-errors.js"),f=M("./src/io/io-controller.js"),r=M("./src/core/transmuxing-events.js"),t=function(){function i(e,s){this.TAG="TransmuxingController",this._emitter=new(g()),this._config=s,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),typeof e.cors!="boolean"&&(e.cors=!0),typeof e.withCredentials!="boolean"&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var o=0;this._mediaDataSource.segments.forEach(function(a){a.timestampBase=o,o+=a.duration,a.cors=e.cors,a.withCredentials=e.withCredentials,s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy)}),!isNaN(o)&&this._mediaDataSource.duration!==o&&(this._mediaDataSource.duration=o),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return i.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},i.prototype.on=function(e,s){this._emitter.addListener(e,s)},i.prototype.off=function(e,s){this._emitter.removeListener(e,s)},i.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},i.prototype._loadSegment=function(e,s){this._currentSegmentIndex=e;var o=this._mediaDataSource.segments[e],a=this._ioctl=new f.default(o,this._config,e);a.onError=this._onIOException.bind(this),a.onSeeked=this._onIOSeeked.bind(this),a.onComplete=this._onIOComplete.bind(this),a.onRedirect=this._onIORedirect.bind(this),a.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),s?this._demuxer.bindDataSource(this._ioctl):a.onDataArrival=this._onInitChunkArrival.bind(this),a.open(s)},i.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},i.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},i.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},i.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},i.prototype.seek=function(e){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var s=this._searchSegmentIndexContains(e);if(s===this._currentSegmentIndex){var o=this._mediaInfo.segments[s];if(o==null)this._pendingSeekTime=e;else{var a=o.getNearestKeyframe(e);this._remuxer.seek(a.milliseconds),this._ioctl.seek(a.fileposition),this._pendingResolveSeekPoint=a.milliseconds}}else{var p=this._mediaInfo.segments[s];if(p==null)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(s);else{var a=p.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[s].timestampBase,this._loadSegment(s,a.fileposition),this._pendingResolveSeekPoint=a.milliseconds,this._reportSegmentMediaInfo(s)}}this._enableStatisticsReporter()}},i.prototype._searchSegmentIndexContains=function(e){for(var s=this._mediaDataSource.segments,o=s.length-1,a=0;a<s.length;a++)if(e<s[a].timestampBase){o=a-1;break}return o},i.prototype._onInitChunkArrival=function(e,s){var o=this,a=null,p=0;if(s>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,p=this._demuxer.parseChunks(e,s);else if((a=l.default.probe(e)).match){this._demuxer=new l.default(a,this._config),this._remuxer||(this._remuxer=new h.default(this._config));var D=this._mediaDataSource;D.duration!=null&&!isNaN(D.duration)&&(this._demuxer.overridedDuration=D.duration),typeof D.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=D.hasAudio),typeof D.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=D.hasVideo),this._demuxer.timestampBase=D.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),p=this._demuxer.parseChunks(e,s)}else a=null,u.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){o._internalAbort()}),this._emitter.emit(r.default.DEMUX_ERROR,v.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),p=0;return p},i.prototype._onMediaInfo=function(e){var s=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,d.default.prototype));var o=Object.assign({},e);Object.setPrototypeOf(o,d.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=o,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var a=s._pendingSeekTime;s._pendingSeekTime=null,s.seek(a)})},i.prototype._onMetaDataArrived=function(e){this._emitter.emit(r.default.METADATA_ARRIVED,e)},i.prototype._onScriptDataArrived=function(e){this._emitter.emit(r.default.SCRIPTDATA_ARRIVED,e)},i.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},i.prototype._onIOComplete=function(e){var s=e,o=s+1;o<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(o)):(this._remuxer.flushStashedSamples(),this._emitter.emit(r.default.LOADING_COMPLETE),this._disableStatisticsReporter())},i.prototype._onIORedirect=function(e){var s=this._ioctl.extraData;this._mediaDataSource.segments[s].redirectedURL=e},i.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(r.default.RECOVERED_EARLY_EOF)},i.prototype._onIOException=function(e,s){u.default.e(this.TAG,"IOException: type = "+e+", code = "+s.code+", msg = "+s.msg),this._emitter.emit(r.default.IO_ERROR,e,s),this._disableStatisticsReporter()},i.prototype._onDemuxException=function(e,s){u.default.e(this.TAG,"DemuxException: type = "+e+", info = "+s),this._emitter.emit(r.default.DEMUX_ERROR,e,s)},i.prototype._onRemuxerInitSegmentArrival=function(e,s){this._emitter.emit(r.default.INIT_SEGMENT,e,s)},i.prototype._onRemuxerMediaSegmentArrival=function(e,s){if(this._pendingSeekTime==null&&(this._emitter.emit(r.default.MEDIA_SEGMENT,e,s),this._pendingResolveSeekPoint!=null&&e==="video")){var o=s.info.syncPoints,a=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,n.default.safari&&o.length>0&&o[0].originalDts===a&&(a=o[0].pts),this._emitter.emit(r.default.RECOMMEND_SEEKPOINT,a)}},i.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},i.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},i.prototype._reportSegmentMediaInfo=function(e){var s=this._mediaInfo.segments[e],o=Object.assign({},s);o.duration=this._mediaInfo.duration,o.segmentCount=this._mediaInfo.segmentCount,delete o.segments,delete o.keyframesIndex,this._emitter.emit(r.default.MEDIA_INFO,o)},i.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(r.default.STATISTICS_INFO,e)},i}();m.default=t},"./src/core/transmuxing-events.js":function(c,m,M){M.r(m);var T={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};m.default=T},"./src/core/transmuxing-worker.js":function(c,m,M){M.r(m);var T=M("./src/utils/logging-control.js"),g=M("./src/utils/polyfill.js"),u=M("./src/core/transmuxing-controller.js"),n=M("./src/core/transmuxing-events.js"),d=function(l){var h=null,v=y.bind(this);g.default.install(),l.addEventListener("message",function(E){switch(E.data.cmd){case"init":h=new u.default(E.data.param[0],E.data.param[1]),h.on(n.default.IO_ERROR,p.bind(this)),h.on(n.default.DEMUX_ERROR,D.bind(this)),h.on(n.default.INIT_SEGMENT,f.bind(this)),h.on(n.default.MEDIA_SEGMENT,r.bind(this)),h.on(n.default.LOADING_COMPLETE,t.bind(this)),h.on(n.default.RECOVERED_EARLY_EOF,i.bind(this)),h.on(n.default.MEDIA_INFO,e.bind(this)),h.on(n.default.METADATA_ARRIVED,s.bind(this)),h.on(n.default.SCRIPTDATA_ARRIVED,o.bind(this)),h.on(n.default.STATISTICS_INFO,a.bind(this)),h.on(n.default.RECOMMEND_SEEKPOINT,L.bind(this));break;case"destroy":h&&(h.destroy(),h=null),l.postMessage({msg:"destroyed"});break;case"start":h.start();break;case"stop":h.stop();break;case"seek":h.seek(E.data.param);break;case"pause":h.pause();break;case"resume":h.resume();break;case"logging_config":{var _=E.data.param;T.default.applyConfig(_),_.enableCallback===!0?T.default.addLogListener(v):T.default.removeLogListener(v);break}}});function f(E,_){var A={msg:n.default.INIT_SEGMENT,data:{type:E,data:_}};l.postMessage(A,[_.data])}function r(E,_){var A={msg:n.default.MEDIA_SEGMENT,data:{type:E,data:_}};l.postMessage(A,[_.data])}function t(){var E={msg:n.default.LOADING_COMPLETE};l.postMessage(E)}function i(){var E={msg:n.default.RECOVERED_EARLY_EOF};l.postMessage(E)}function e(E){var _={msg:n.default.MEDIA_INFO,data:E};l.postMessage(_)}function s(E){var _={msg:n.default.METADATA_ARRIVED,data:E};l.postMessage(_)}function o(E){var _={msg:n.default.SCRIPTDATA_ARRIVED,data:E};l.postMessage(_)}function a(E){var _={msg:n.default.STATISTICS_INFO,data:E};l.postMessage(_)}function p(E,_){l.postMessage({msg:n.default.IO_ERROR,data:{type:E,info:_}})}function D(E,_){l.postMessage({msg:n.default.DEMUX_ERROR,data:{type:E,info:_}})}function L(E){l.postMessage({msg:n.default.RECOMMEND_SEEKPOINT,data:E})}function y(E,_){l.postMessage({msg:"logcat_callback",data:{type:E,logcat:_}})}};m.default=d},"./src/demux/amf-parser.js":function(c,m,M){M.r(m);var T=M("./src/utils/logger.js"),g=M("./src/utils/utf8-conv.js"),u=M("./src/utils/exception.js"),n=function(){var l=new ArrayBuffer(2);return new DataView(l).setInt16(0,256,!0),new Int16Array(l)[0]===256}(),d=function(){function l(){}return l.parseScriptData=function(h,v,f){var r={};try{var t=l.parseValue(h,v,f),i=l.parseValue(h,v+t.size,f-t.size);r[t.data]=i.data}catch(e){T.default.e("AMF",e.toString())}return r},l.parseObject=function(h,v,f){if(f<3)throw new u.IllegalStateException("Data not enough when parse ScriptDataObject");var r=l.parseString(h,v,f),t=l.parseValue(h,v+r.size,f-r.size),i=t.objectEnd;return{data:{name:r.data,value:t.data},size:r.size+t.size,objectEnd:i}},l.parseVariable=function(h,v,f){return l.parseObject(h,v,f)},l.parseString=function(h,v,f){if(f<2)throw new u.IllegalStateException("Data not enough when parse String");var r=new DataView(h,v,f),t=r.getUint16(0,!n),i;return t>0?i=(0,g.default)(new Uint8Array(h,v+2,t)):i="",{data:i,size:2+t}},l.parseLongString=function(h,v,f){if(f<4)throw new u.IllegalStateException("Data not enough when parse LongString");var r=new DataView(h,v,f),t=r.getUint32(0,!n),i;return t>0?i=(0,g.default)(new Uint8Array(h,v+4,t)):i="",{data:i,size:4+t}},l.parseDate=function(h,v,f){if(f<10)throw new u.IllegalStateException("Data size invalid when parse Date");var r=new DataView(h,v,f),t=r.getFloat64(0,!n),i=r.getInt16(8,!n);return t+=i*60*1e3,{data:new Date(t),size:8+2}},l.parseValue=function(h,v,f){if(f<1)throw new u.IllegalStateException("Data not enough when parse Value");var r=new DataView(h,v,f),t=1,i=r.getUint8(0),e,s=!1;try{switch(i){case 0:e=r.getFloat64(1,!n),t+=8;break;case 1:{var o=r.getUint8(1);e=!!o,t+=1;break}case 2:{var a=l.parseString(h,v+1,f-1);e=a.data,t+=a.size;break}case 3:{e={};var p=0;for((r.getUint32(f-4,!n)&16777215)===9&&(p=3);t<f-4;){var D=l.parseObject(h,v+t,f-t-p);if(D.objectEnd)break;e[D.data.name]=D.data.value,t+=D.size}if(t<=f-3){var L=r.getUint32(t-1,!n)&16777215;L===9&&(t+=3)}break}case 8:{e={},t+=4;var p=0;for((r.getUint32(f-4,!n)&16777215)===9&&(p=3);t<f-8;){var y=l.parseVariable(h,v+t,f-t-p);if(y.objectEnd)break;e[y.data.name]=y.data.value,t+=y.size}if(t<=f-3){var L=r.getUint32(t-1,!n)&16777215;L===9&&(t+=3)}break}case 9:e=void 0,t=1,s=!0;break;case 10:{e=[];var E=r.getUint32(1,!n);t+=4;for(var _=0;_<E;_++){var A=l.parseValue(h,v+t,f-t);e.push(A.data),t+=A.size}break}case 11:{var I=l.parseDate(h,v+1,f-1);e=I.data,t+=I.size;break}case 12:{var b=l.parseString(h,v+1,f-1);e=b.data,t+=b.size;break}default:t=f,T.default.w("AMF","Unsupported AMF value type "+i)}}catch(R){T.default.e("AMF",R.toString())}return{data:e,size:t,objectEnd:s}},l}();m.default=d},"./src/demux/demux-errors.js":function(c,m,M){M.r(m);var T={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};m.default=T},"./src/demux/exp-golomb.js":function(c,m,M){M.r(m);var T=M("./src/utils/exception.js"),g=function(){function u(n){this.TAG="ExpGolomb",this._buffer=n,this._buffer_index=0,this._total_bytes=n.byteLength,this._total_bits=n.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return u.prototype.destroy=function(){this._buffer=null},u.prototype._fillCurrentWord=function(){var n=this._total_bytes-this._buffer_index;if(n<=0)throw new T.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var d=Math.min(4,n),l=new Uint8Array(4);l.set(this._buffer.subarray(this._buffer_index,this._buffer_index+d)),this._current_word=new DataView(l.buffer).getUint32(0,!1),this._buffer_index+=d,this._current_word_bits_left=d*8},u.prototype.readBits=function(n){if(n>32)throw new T.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(n<=this._current_word_bits_left){var d=this._current_word>>>32-n;return this._current_word<<=n,this._current_word_bits_left-=n,d}var l=this._current_word_bits_left?this._current_word:0;l=l>>>32-this._current_word_bits_left;var h=n-this._current_word_bits_left;this._fillCurrentWord();var v=Math.min(h,this._current_word_bits_left),f=this._current_word>>>32-v;return this._current_word<<=v,this._current_word_bits_left-=v,l=l<<v|f,l},u.prototype.readBool=function(){return this.readBits(1)===1},u.prototype.readByte=function(){return this.readBits(8)},u.prototype._skipLeadingZero=function(){var n;for(n=0;n<this._current_word_bits_left;n++)if((this._current_word&2147483648>>>n)!==0)return this._current_word<<=n,this._current_word_bits_left-=n,n;return this._fillCurrentWord(),n+this._skipLeadingZero()},u.prototype.readUEG=function(){var n=this._skipLeadingZero();return this.readBits(n+1)-1},u.prototype.readSEG=function(){var n=this.readUEG();return n&1?n+1>>>1:-1*(n>>>1)},u}();m.default=g},"./src/demux/flv-demuxer.js":function(c,m,M){M.r(m);var T=M("./src/utils/logger.js"),g=M("./src/demux/amf-parser.js"),u=M("./src/demux/sps-parser.js"),n=M("./src/demux/demux-errors.js"),d=M("./src/core/media-info.js"),l=M("./src/utils/exception.js");function h(f,r){return f[r]<<24|f[r+1]<<16|f[r+2]<<8|f[r+3]}var v=function(){function f(r,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=r.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=r.hasAudioTrack,this._hasVideo=r.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new d.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var i=new ArrayBuffer(2);return new DataView(i).setInt16(0,256,!0),new Int16Array(i)[0]===256}()}return f.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},f.probe=function(r){var t=new Uint8Array(r),i={match:!1};if(t[0]!==70||t[1]!==76||t[2]!==86||t[3]!==1)return i;var e=(t[4]&4)>>>2!==0,s=(t[4]&1)!==0,o=h(t,5);return o<9?i:{match:!0,consumed:o,dataOffset:o,hasAudioTrack:e,hasVideoTrack:s}},f.prototype.bindDataSource=function(r){return r.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(f.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(r){this._onTrackMetadata=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(r){this._onMediaInfo=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(r){this._onMetaDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(r){this._onScriptDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onError",{get:function(){return this._onError},set:function(r){this._onError=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(r){this._onDataAvailable=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(r){this._timestampBase=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"overridedDuration",{get:function(){return this._duration},set:function(r){this._durationOverrided=!0,this._duration=r,this._mediaInfo.duration=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"overridedHasAudio",{set:function(r){this._hasAudioFlagOverrided=!0,this._hasAudio=r,this._mediaInfo.hasAudio=r},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"overridedHasVideo",{set:function(r){this._hasVideoFlagOverrided=!0,this._hasVideo=r,this._mediaInfo.hasVideo=r},enumerable:!1,configurable:!0}),f.prototype.resetMediaInfo=function(){this._mediaInfo=new d.default},f.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},f.prototype.parseChunks=function(r,t){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new l.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=0,e=this._littleEndian;if(t===0)if(r.byteLength>13){var s=f.probe(r);i=s.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,t+i!==this._dataOffset&&T.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var o=new DataView(r,i),a=o.getUint32(0,!e);a!==0&&T.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),i+=4}for(;i<r.byteLength;){this._dispatch=!0;var o=new DataView(r,i);if(i+11+4>r.byteLength)break;var p=o.getUint8(0),D=o.getUint32(0,!e)&16777215;if(i+11+D+4>r.byteLength)break;if(p!==8&&p!==9&&p!==18){T.default.w(this.TAG,"Unsupported tag type "+p+", skipped"),i+=11+D+4;continue}var L=o.getUint8(4),y=o.getUint8(5),E=o.getUint8(6),_=o.getUint8(7),A=E|y<<8|L<<16|_<<24,I=o.getUint32(7,!e)&16777215;I!==0&&T.default.w(this.TAG,"Meet tag which has StreamID != 0!");var b=i+11;switch(p){case 8:this._parseAudioData(r,b,D,A);break;case 9:this._parseVideoData(r,b,D,A,t+i);break;case 18:this._parseScriptData(r,b,D);break}var R=o.getUint32(11+D,!e);R!==11+D&&T.default.w(this.TAG,"Invalid PrevTagSize "+R),i+=11+D+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),i},f.prototype._parseScriptData=function(r,t,i){var e=g.default.parseScriptData(r,t,i);if(e.hasOwnProperty("onMetaData")){if(e.onMetaData==null||typeof e.onMetaData!="object"){T.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&T.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=e;var s=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},s)),typeof s.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=s.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof s.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=s.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof s.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=s.audiodatarate),typeof s.videodatarate=="number"&&(this._mediaInfo.videoDataRate=s.videodatarate),typeof s.width=="number"&&(this._mediaInfo.width=s.width),typeof s.height=="number"&&(this._mediaInfo.height=s.height),typeof s.duration=="number"){if(!this._durationOverrided){var o=Math.floor(s.duration*this._timescale);this._duration=o,this._mediaInfo.duration=o}}else this._mediaInfo.duration=0;if(typeof s.framerate=="number"){var a=Math.floor(s.framerate*1e3);if(a>0){var p=a/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=p,this._referenceFrameRate.fps_num=a,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=p}}if(typeof s.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var D=s.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(D),s.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=s,T.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(e).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},e))},f.prototype._parseKeyframesIndex=function(r){for(var t=[],i=[],e=1;e<r.times.length;e++){var s=this._timestampBase+Math.floor(r.times[e]*1e3);t.push(s),i.push(r.filepositions[e])}return{times:t,filepositions:i}},f.prototype._parseAudioData=function(r,t,i,e){if(i<=1){T.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var s=new DataView(r,t,i),o=s.getUint8(0),a=o>>>4;if(a!==2&&a!==10){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+a);return}var p=0,D=(o&12)>>>2;if(D>=0&&D<=4)p=this._flvSoundRateTable[D];else{this._onError(n.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+D);return}var L=o&1,y=this._audioMetadata,E=this._audioTrack;if(y||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),y=this._audioMetadata={},y.type="audio",y.id=E.id,y.timescale=this._timescale,y.duration=this._duration,y.audioSampleRate=p,y.channelCount=L===0?1:2),a===10){var _=this._parseAACAudioData(r,t+1,i-1);if(_==null)return;if(_.packetType===0){y.config&&T.default.w(this.TAG,"Found another AudioSpecificConfig!");var A=_.data;y.audioSampleRate=A.samplingRate,y.channelCount=A.channelCount,y.codec=A.codec,y.originalCodec=A.originalCodec,y.config=A.config,y.refSampleDuration=1024/y.audioSampleRate*y.timescale,T.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",y);var I=this._mediaInfo;I.audioCodec=y.originalCodec,I.audioSampleRate=y.audioSampleRate,I.audioChannelCount=y.channelCount,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}else if(_.packetType===1){var b=this._timestampBase+e,R={unit:_.data,length:_.data.byteLength,dts:b,pts:b};E.samples.push(R),E.length+=_.data.length}else T.default.e(this.TAG,"Flv: Unsupported AAC data type "+_.packetType)}else if(a===2){if(!y.codec){var A=this._parseMP3AudioData(r,t+1,i-1,!0);if(A==null)return;y.audioSampleRate=A.samplingRate,y.channelCount=A.channelCount,y.codec=A.codec,y.originalCodec=A.originalCodec,y.refSampleDuration=1152/y.audioSampleRate*y.timescale,T.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",y);var I=this._mediaInfo;I.audioCodec=y.codec,I.audioSampleRate=y.audioSampleRate,I.audioChannelCount=y.channelCount,I.audioDataRate=A.bitRate,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}var P=this._parseMP3AudioData(r,t+1,i-1,!1);if(P==null)return;var b=this._timestampBase+e,w={unit:P,length:P.byteLength,dts:b,pts:b};E.samples.push(w),E.length+=P.length}}},f.prototype._parseAACAudioData=function(r,t,i){if(i<=1){T.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var e={},s=new Uint8Array(r,t,i);return e.packetType=s[0],s[0]===0?e.data=this._parseAACAudioSpecificConfig(r,t+1,i-1):e.data=s.subarray(1),e},f.prototype._parseAACAudioSpecificConfig=function(r,t,i){var e=new Uint8Array(r,t,i),s=null,o=0,a=0,p=0,D=null;if(o=a=e[0]>>>3,p=(e[0]&7)<<1|e[1]>>>7,p<0||p>=this._mpegSamplingRates.length){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var L=this._mpegSamplingRates[p],y=(e[1]&120)>>>3;if(y<0||y>=8){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}o===5&&(D=(e[1]&7)<<1|e[2]>>>7,(e[2]&124)>>>2);var E=self.navigator.userAgent.toLowerCase();return E.indexOf("firefox")!==-1?p>=6?(o=5,s=new Array(4),D=p-3):(o=2,s=new Array(2),D=p):E.indexOf("android")!==-1?(o=2,s=new Array(2),D=p):(o=5,D=p,s=new Array(4),p>=6?D=p-3:y===1&&(o=2,s=new Array(2),D=p)),s[0]=o<<3,s[0]|=(p&15)>>>1,s[1]=(p&15)<<7,s[1]|=(y&15)<<3,o===5&&(s[1]|=(D&15)>>>1,s[2]=(D&1)<<7,s[2]|=2<<2,s[3]=0),{config:s,samplingRate:L,channelCount:y,codec:"mp4a.40."+o,originalCodec:"mp4a.40."+a}},f.prototype._parseMP3AudioData=function(r,t,i,e){if(i<4){T.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var s=new Uint8Array(r,t,i),o=null;if(e){if(s[0]!==255)return;var a=s[1]>>>3&3,p=(s[1]&6)>>1,D=(s[2]&240)>>>4,L=(s[2]&12)>>>2,y=s[3]>>>6&3,E=y!==3?2:1,_=0,A=0,I="mp3";switch(a){case 0:_=this._mpegAudioV25SampleRateTable[L];break;case 2:_=this._mpegAudioV20SampleRateTable[L];break;case 3:_=this._mpegAudioV10SampleRateTable[L];break}switch(p){case 1:D<this._mpegAudioL3BitRateTable.length&&(A=this._mpegAudioL3BitRateTable[D]);break;case 2:D<this._mpegAudioL2BitRateTable.length&&(A=this._mpegAudioL2BitRateTable[D]);break;case 3:D<this._mpegAudioL1BitRateTable.length&&(A=this._mpegAudioL1BitRateTable[D]);break}o={bitRate:A,samplingRate:_,channelCount:E,codec:I,originalCodec:I}}else o=s;return o},f.prototype._parseVideoData=function(r,t,i,e,s){if(i<=1){T.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var o=new Uint8Array(r,t,i)[0],a=(o&240)>>>4,p=o&15;if(p!==7){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+p);return}this._parseAVCVideoPacket(r,t+1,i-1,e,s,a)}},f.prototype._parseAVCVideoPacket=function(r,t,i,e,s,o){if(i<4){T.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var a=this._littleEndian,p=new DataView(r,t,i),D=p.getUint8(0),L=p.getUint32(0,!a)&16777215,y=L<<8>>8;if(D===0)this._parseAVCDecoderConfigurationRecord(r,t+4,i-4);else if(D===1)this._parseAVCVideoData(r,t+4,i-4,e,s,o,y);else if(D!==2){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid video packet type "+D);return}},f.prototype._parseAVCDecoderConfigurationRecord=function(r,t,i){if(i<7){T.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var e=this._videoMetadata,s=this._videoTrack,o=this._littleEndian,a=new DataView(r,t,i);e?typeof e.avcc!="undefined"&&T.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),e=this._videoMetadata={},e.type="video",e.id=s.id,e.timescale=this._timescale,e.duration=this._duration);var p=a.getUint8(0),D=a.getUint8(1);if(a.getUint8(2),a.getUint8(3),p!==1||D===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(a.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(n.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var L=a.getUint8(5)&31;if(L===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else L>1&&T.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+L);for(var y=6,E=0;E<L;E++){var _=a.getUint16(y,!o);if(y+=2,_!==0){var A=new Uint8Array(r,t+y,_);y+=_;var I=u.default.parseSPS(A);if(E===0){e.codecWidth=I.codec_size.width,e.codecHeight=I.codec_size.height,e.presentWidth=I.present_size.width,e.presentHeight=I.present_size.height,e.profile=I.profile_string,e.level=I.level_string,e.bitDepth=I.bit_depth,e.chromaFormat=I.chroma_format,e.sarRatio=I.sar_ratio,e.frameRate=I.frame_rate,(I.frame_rate.fixed===!1||I.frame_rate.fps_num===0||I.frame_rate.fps_den===0)&&(e.frameRate=this._referenceFrameRate);var b=e.frameRate.fps_den,R=e.frameRate.fps_num;e.refSampleDuration=e.timescale*(b/R);for(var P=A.subarray(1,4),w="avc1.",F=0;F<3;F++){var k=P[F].toString(16);k.length<2&&(k="0"+k),w+=k}e.codec=w;var B=this._mediaInfo;B.width=e.codecWidth,B.height=e.codecHeight,B.fps=e.frameRate.fps,B.profile=e.profile,B.level=e.level,B.refFrames=I.ref_frames,B.chromaFormat=I.chroma_format_string,B.sarNum=e.sarRatio.width,B.sarDen=e.sarRatio.height,B.videoCodec=w,B.hasAudio?B.audioCodec!=null&&(B.mimeType='video/x-flv; codecs="'+B.videoCodec+","+B.audioCodec+'"'):B.mimeType='video/x-flv; codecs="'+B.videoCodec+'"',B.isComplete()&&this._onMediaInfo(B)}}}var U=a.getUint8(y);if(U===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else U>1&&T.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+U);y++;for(var E=0;E<U;E++){var _=a.getUint16(y,!o);y+=2,_!==0&&(y+=_)}e.avcc=new Uint8Array(i),e.avcc.set(new Uint8Array(r,t,i),0),T.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",e)},f.prototype._parseAVCVideoData=function(r,t,i,e,s,o,a){for(var p=this._littleEndian,D=new DataView(r,t,i),L=[],y=0,E=0,_=this._naluLengthSize,A=this._timestampBase+e,I=o===1;E<i;){if(E+4>=i){T.default.w(this.TAG,"Malformed Nalu near timestamp "+A+", offset = "+E+", dataSize = "+i);break}var b=D.getUint32(E,!p);if(_===3&&(b>>>=8),b>i-_){T.default.w(this.TAG,"Malformed Nalus near timestamp "+A+", NaluSize > DataSize!");return}var R=D.getUint8(E+_)&31;R===5&&(I=!0);var P=new Uint8Array(r,t+E,_+b),w={type:R,data:P};L.push(w),y+=P.byteLength,E+=_+b}if(L.length){var F=this._videoTrack,k={units:L,length:y,isKeyframe:I,dts:A,cts:a,pts:A+a};I&&(k.fileposition=s),F.samples.push(k),F.length+=y}},f}();m.default=v},"./src/demux/sps-parser.js":function(c,m,M){M.r(m);var T=M("./src/demux/exp-golomb.js"),g=function(){function u(){}return u._ebsp2rbsp=function(n){for(var d=n,l=d.byteLength,h=new Uint8Array(l),v=0,f=0;f<l;f++)f>=2&&d[f]===3&&d[f-1]===0&&d[f-2]===0||(h[v]=d[f],v++);return new Uint8Array(h.buffer,0,v)},u.parseSPS=function(n){var d=u._ebsp2rbsp(n),l=new T.default(d);l.readByte();var h=l.readByte();l.readByte();var v=l.readByte();l.readUEG();var f=u.getProfileString(h),r=u.getLevelString(v),t=1,i=420,e=[0,420,422,444],s=8;if((h===100||h===110||h===122||h===244||h===44||h===83||h===86||h===118||h===128||h===138||h===144)&&(t=l.readUEG(),t===3&&l.readBits(1),t<=3&&(i=e[t]),s=l.readUEG()+8,l.readUEG(),l.readBits(1),l.readBool()))for(var o=t!==3?8:12,a=0;a<o;a++)l.readBool()&&(a<6?u._skipScalingList(l,16):u._skipScalingList(l,64));l.readUEG();var p=l.readUEG();if(p===0)l.readUEG();else if(p===1){l.readBits(1),l.readSEG(),l.readSEG();for(var D=l.readUEG(),a=0;a<D;a++)l.readSEG()}var L=l.readUEG();l.readBits(1);var y=l.readUEG(),E=l.readUEG(),_=l.readBits(1);_===0&&l.readBits(1),l.readBits(1);var A=0,I=0,b=0,R=0,P=l.readBool();P&&(A=l.readUEG(),I=l.readUEG(),b=l.readUEG(),R=l.readUEG());var w=1,F=1,k=0,B=!0,U=0,j=0,K=l.readBool();if(K){if(l.readBool()){var N=l.readByte(),Z=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],$=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];N>0&&N<16?(w=Z[N-1],F=$[N-1]):N===255&&(w=l.readByte()<<8|l.readByte(),F=l.readByte()<<8|l.readByte())}if(l.readBool()&&l.readBool(),l.readBool()&&(l.readBits(4),l.readBool()&&l.readBits(24)),l.readBool()&&(l.readUEG(),l.readUEG()),l.readBool()){var Y=l.readBits(32),ee=l.readBits(32);B=l.readBool(),U=ee,j=Y*2,k=U/j}}var Q=1;(w!==1||F!==1)&&(Q=w/F);var G=0,q=0;if(t===0)G=1,q=2-_;else{var te=t===3?1:2,ie=t===1?2:1;G=te,q=ie*(2-_)}var ne=(y+1)*16,le=(2-_)*((E+1)*16);ne-=(A+I)*G,le-=(b+R)*q;var se=Math.ceil(ne*Q);return l.destroy(),l=null,{profile_string:f,level_string:r,bit_depth:s,ref_frames:L,chroma_format:i,chroma_format_string:u.getChromaFormatString(i),frame_rate:{fixed:B,fps:k,fps_den:j,fps_num:U},sar_ratio:{width:w,height:F},codec_size:{width:ne,height:le},present_size:{width:se,height:le}}},u._skipScalingList=function(n,d){for(var l=8,h=8,v=0,f=0;f<d;f++)h!==0&&(v=n.readSEG(),h=(l+v+256)%256),l=h===0?l:h},u.getProfileString=function(n){switch(n){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},u.getLevelString=function(n){return(n/10).toFixed(1)},u.getChromaFormatString=function(n){switch(n){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},u}();m.default=g},"./src/flv.js":function(c,m,M){M.r(m);var T=M("./src/utils/polyfill.js"),g=M("./src/core/features.js"),u=M("./src/io/loader.js"),n=M("./src/player/flv-player.js"),d=M("./src/player/native-player.js"),l=M("./src/player/player-events.js"),h=M("./src/player/player-errors.js"),v=M("./src/utils/logging-control.js"),f=M("./src/utils/exception.js");T.default.install();function r(s,o){var a=s;if(a==null||typeof a!="object")throw new f.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!a.hasOwnProperty("type"))throw new f.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(a.type){case"flv":return new n.default(a,o);default:return new d.default(a,o)}}function t(){return g.default.supportMSEH264Playback()}function i(){return g.default.getFeatureList()}var e={};e.createPlayer=r,e.isSupported=t,e.getFeatureList=i,e.BaseLoader=u.BaseLoader,e.LoaderStatus=u.LoaderStatus,e.LoaderErrors=u.LoaderErrors,e.Events=l.default,e.ErrorTypes=h.ErrorTypes,e.ErrorDetails=h.ErrorDetails,e.FlvPlayer=n.default,e.NativePlayer=d.default,e.LoggingControl=v.default,Object.defineProperty(e,"version",{enumerable:!0,get:function(){return"1.6.2"}}),m.default=e},"./src/index.js":function(c,m,M){c.exports=M("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(c,m,M){M.r(m);var T=M("./src/utils/browser.js"),g=M("./src/io/loader.js"),u=M("./src/utils/exception.js"),n=function(){var l=function(h,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,r){f.__proto__=r}||function(f,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(f[t]=r[t])},l(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(h,v);function f(){this.constructor=h}h.prototype=v===null?Object.create(v):(f.prototype=v.prototype,new f)}}(),d=function(l){n(h,l);function h(v,f){var r=l.call(this,"fetch-stream-loader")||this;return r.TAG="FetchStreamLoader",r._seekHandler=v,r._config=f,r._needStash=!0,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return h.isSupported=function(){try{var v=T.default.msedge&&T.default.version.minor>=15048,f=T.default.msedge?v:!0;return self.fetch&&self.ReadableStream&&f}catch{return!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),l.prototype.destroy.call(this)},h.prototype.open=function(v,f){var r=this;this._dataSource=v,this._range=f;var t=v.url;this._config.reuseRedirectedURL&&v.redirectedURL!=null&&(t=v.redirectedURL);var i=this._seekHandler.getConfig(t,f),e=new self.Headers;if(typeof i.headers=="object"){var s=i.headers;for(var o in s)s.hasOwnProperty(o)&&e.append(o,s[o])}var a={method:"GET",headers:e,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var o in this._config.headers)e.append(o,this._config.headers[o]);v.cors===!1&&(a.mode="same-origin"),v.withCredentials&&(a.credentials="include"),v.referrerPolicy&&(a.referrerPolicy=v.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,a.signal=this._abortController.signal),this._status=g.LoaderStatus.kConnecting,self.fetch(i.url,a).then(function(p){if(r._requestAbort){r._status=g.LoaderStatus.kIdle,p.body.cancel();return}if(p.ok&&p.status>=200&&p.status<=299){if(p.url!==i.url&&r._onURLRedirect){var D=r._seekHandler.removeURLParameters(p.url);r._onURLRedirect(D)}var L=p.headers.get("Content-Length");return L!=null&&(r._contentLength=parseInt(L),r._contentLength!==0&&r._onContentLengthKnown&&r._onContentLengthKnown(r._contentLength)),r._pump.call(r,p.body.getReader())}else if(r._status=g.LoaderStatus.kError,r._onError)r._onError(g.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:p.status,msg:p.statusText});else throw new u.RuntimeException("FetchStreamLoader: Http code invalid, "+p.status+" "+p.statusText)}).catch(function(p){if(!(r._abortController&&r._abortController.signal.aborted))if(r._status=g.LoaderStatus.kError,r._onError)r._onError(g.LoaderErrors.EXCEPTION,{code:-1,msg:p.message});else throw p})},h.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==g.LoaderStatus.kBuffering||!T.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},h.prototype._pump=function(v){var f=this;return v.read().then(function(r){if(r.done)if(f._contentLength!==null&&f._receivedLength<f._contentLength){f._status=g.LoaderStatus.kError;var t=g.LoaderErrors.EARLY_EOF,i={code:-1,msg:"Fetch stream meet Early-EOF"};if(f._onError)f._onError(t,i);else throw new u.RuntimeException(i.msg)}else f._status=g.LoaderStatus.kComplete,f._onComplete&&f._onComplete(f._range.from,f._range.from+f._receivedLength-1);else{if(f._abortController&&f._abortController.signal.aborted){f._status=g.LoaderStatus.kComplete;return}else if(f._requestAbort===!0)return f._status=g.LoaderStatus.kComplete,v.cancel();f._status=g.LoaderStatus.kBuffering;var e=r.value.buffer,s=f._range.from+f._receivedLength;f._receivedLength+=e.byteLength,f._onDataArrival&&f._onDataArrival(e,s,f._receivedLength),f._pump(v)}}).catch(function(r){if(f._abortController&&f._abortController.signal.aborted){f._status=g.LoaderStatus.kComplete;return}if(!(r.code===11&&T.default.msedge)){f._status=g.LoaderStatus.kError;var t=0,i=null;if((r.code===19||r.message==="network error")&&(f._contentLength===null||f._contentLength!==null&&f._receivedLength<f._contentLength)?(t=g.LoaderErrors.EARLY_EOF,i={code:r.code,msg:"Fetch stream meet Early-EOF"}):(t=g.LoaderErrors.EXCEPTION,i={code:r.code,msg:r.message}),f._onError)f._onError(t,i);else throw new u.RuntimeException(i.msg)}})},h}(g.BaseLoader);m.default=d},"./src/io/io-controller.js":function(c,m,M){M.r(m);var T=M("./src/utils/logger.js"),g=M("./src/io/speed-sampler.js"),u=M("./src/io/loader.js"),n=M("./src/io/fetch-stream-loader.js"),d=M("./src/io/xhr-moz-chunked-loader.js"),l=M("./src/io/xhr-range-loader.js"),h=M("./src/io/websocket-loader.js"),v=M("./src/io/range-seek-handler.js"),f=M("./src/io/param-seek-handler.js"),r=M("./src/utils/exception.js"),t=function(){function i(e,s,o){this.TAG="IOController",this._config=s,this._extraData=o,this._stashInitialSize=1024*384,s.stashInitialSize!=null&&s.stashInitialSize>0&&(this._stashInitialSize=s.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,s.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new g.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return i.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},i.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},i.prototype.isPaused=function(){return this._paused},Object.defineProperty(i.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentSpeed",{get:function(){return this._loaderClass===l.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),i.prototype._selectSeekHandler=function(){var e=this._config;if(e.seekType==="range")this._seekHandler=new v.default(this._config.rangeLoadZeroStart);else if(e.seekType==="param"){var s=e.seekParamStart||"bstart",o=e.seekParamEnd||"bend";this._seekHandler=new f.default(s,o)}else if(e.seekType==="custom"){if(typeof e.customSeekHandler!="function")throw new r.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}else throw new r.InvalidArgumentException("Invalid seekType in config: "+e.seekType)},i.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=h.default;else if(n.default.isSupported())this._loaderClass=n.default;else if(d.default.isSupported())this._loaderClass=d.default;else if(l.default.isSupported())this._loaderClass=l.default;else throw new r.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},i.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},i.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},i.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},i.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},i.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},i.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},i.prototype._internalSeek=function(e,s){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(s),this._loader.destroy(),this._loader=null;var o={from:e,to:-1};this._currentRange={from:o.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,o),this._onSeeked&&this._onSeeked()},i.prototype.updateUrl=function(e){if(!e||typeof e!="string"||e.length===0)throw new r.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=e},i.prototype._expandBuffer=function(e){for(var s=this._stashSize;s+1024*1024*1<e;)s*=2;if(s+=1024*1024*1,s!==this._bufferSize){var o=new ArrayBuffer(s);if(this._stashUsed>0){var a=new Uint8Array(this._stashBuffer,0,this._stashUsed),p=new Uint8Array(o,0,s);p.set(a,0)}this._stashBuffer=o,this._bufferSize=s}},i.prototype._normalizeSpeed=function(e){var s=this._speedNormalizeList,o=s.length-1,a=0,p=0,D=o;if(e<s[0])return s[0];for(;p<=D;){if(a=p+Math.floor((D-p)/2),a===o||e>=s[a]&&e<s[a+1])return s[a];s[a]<e?p=a+1:D=a-1}},i.prototype._adjustStashSize=function(e){var s=0;this._config.isLive||e<512?s=e:e>=512&&e<=1024?s=Math.floor(e*1.5):s=e*2,s>8192&&(s=8192);var o=s*1024+1024*1024*1;this._bufferSize<o&&this._expandBuffer(o),this._stashSize=s*1024},i.prototype._dispatchChunks=function(e,s){return this._currentRange.to=s+e.byteLength-1,this._onDataArrival(e,s)},i.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},i.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},i.prototype._onLoaderChunkArrival=function(e,s,o){if(!this._onDataArrival)throw new r.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var a=this._speedSampler.lastSecondKBps;if(a!==0){var p=this._normalizeSpeed(a);this._speedNormalized!==p&&(this._speedNormalized=p,this._adjustStashSize(p))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=s),this._stashUsed+e.byteLength<=this._stashSize){var y=new Uint8Array(this._stashBuffer,0,this._stashSize);y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var _=this._stashBuffer.slice(0,this._stashUsed),D=this._dispatchChunks(_,this._stashByteStart);if(D<_.byteLength){if(D>0){var E=new Uint8Array(_,D);y.set(E,0),this._stashUsed=E.byteLength,this._stashByteStart+=D}}else this._stashUsed=0,this._stashByteStart+=D;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var D=this._dispatchChunks(e,s);if(D<e.byteLength){var L=e.byteLength-D;L>this._bufferSize&&(this._expandBuffer(L),y=new Uint8Array(this._stashBuffer,0,this._bufferSize)),y.set(new Uint8Array(e,D),0),this._stashUsed+=L,this._stashByteStart=s+D}}}else if(this._stashUsed===0){var D=this._dispatchChunks(e,s);if(D<e.byteLength){var L=e.byteLength-D;L>this._bufferSize&&this._expandBuffer(L);var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);y.set(new Uint8Array(e,D),0),this._stashUsed+=L,this._stashByteStart=s+D}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);var y=new Uint8Array(this._stashBuffer,0,this._bufferSize);y.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;var D=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(D<this._stashUsed&&D>0){var E=new Uint8Array(this._stashBuffer,D);y.set(E,0)}this._stashUsed-=D,this._stashByteStart+=D}}},i.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var s=this._stashBuffer.slice(0,this._stashUsed),o=this._dispatchChunks(s,this._stashByteStart),a=s.byteLength-o;if(o<s.byteLength)if(e)T.default.w(this.TAG,a+" bytes unconsumed data remain when flush buffer, dropped");else{if(o>0){var p=new Uint8Array(this._stashBuffer,0,this._bufferSize),D=new Uint8Array(s,o);p.set(D,0),this._stashUsed=D.byteLength,this._stashByteStart+=o}return 0}return this._stashUsed=0,this._stashByteStart=0,a}return 0},i.prototype._onLoaderComplete=function(e,s){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},i.prototype._onLoaderError=function(e,s){switch(T.default.e(this.TAG,"Loader error, code = "+s.code+", msg = "+s.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF),e){case u.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var o=this._currentRange.to+1;o<this._totalLength&&(T.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(o,!1));return}e=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case u.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case u.LoaderErrors.CONNECTING_TIMEOUT:case u.LoaderErrors.HTTP_STATUS_CODE_INVALID:case u.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(e,s);else throw new r.RuntimeException("IOException: "+s.msg)},i}();m.default=t},"./src/io/loader.js":function(c,m,M){M.r(m),M.d(m,{LoaderStatus:function(){return g},LoaderErrors:function(){return u},BaseLoader:function(){return n}});var T=M("./src/utils/exception.js"),g={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},u={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},n=function(){function d(l){this._type=l||"undefined",this._status=g.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return d.prototype.destroy=function(){this._status=g.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},d.prototype.isWorking=function(){return this._status===g.kConnecting||this._status===g.kBuffering},Object.defineProperty(d.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(l){this._onContentLengthKnown=l},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(l){this._onURLRedirect=l},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(l){this._onDataArrival=l},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onError",{get:function(){return this._onError},set:function(l){this._onError=l},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onComplete",{get:function(){return this._onComplete},set:function(l){this._onComplete=l},enumerable:!1,configurable:!0}),d.prototype.open=function(l,h){throw new T.NotImplementedException("Unimplemented abstract function!")},d.prototype.abort=function(){throw new T.NotImplementedException("Unimplemented abstract function!")},d}()},"./src/io/param-seek-handler.js":function(c,m,M){M.r(m);var T=function(){function g(u,n){this._startName=u,this._endName=n}return g.prototype.getConfig=function(u,n){var d=u;if(n.from!==0||n.to!==-1){var l=!0;d.indexOf("?")===-1&&(d+="?",l=!1),l&&(d+="&"),d+=this._startName+"="+n.from.toString(),n.to!==-1&&(d+="&"+this._endName+"="+n.to.toString())}return{url:d,headers:{}}},g.prototype.removeURLParameters=function(u){var n=u.split("?")[0],d=void 0,l=u.indexOf("?");l!==-1&&(d=u.substring(l+1));var h="";if(d!=null&&d.length>0)for(var v=d.split("&"),f=0;f<v.length;f++){var r=v[f].split("="),t=f>0;r[0]!==this._startName&&r[0]!==this._endName&&(t&&(h+="&"),h+=v[f])}return h.length===0?n:n+"?"+h},g}();m.default=T},"./src/io/range-seek-handler.js":function(c,m,M){M.r(m);var T=function(){function g(u){this._zeroStart=u||!1}return g.prototype.getConfig=function(u,n){var d={};if(n.from!==0||n.to!==-1){var l=void 0;n.to!==-1?l="bytes="+n.from.toString()+"-"+n.to.toString():l="bytes="+n.from.toString()+"-",d.Range=l}else this._zeroStart&&(d.Range="bytes=0-");return{url:u,headers:d}},g.prototype.removeURLParameters=function(u){return u},g}();m.default=T},"./src/io/speed-sampler.js":function(c,m,M){M.r(m);var T=function(){function g(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return g.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},g.prototype.addBytes=function(u){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=u,this._totalBytes+=u):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=u,this._totalBytes+=u):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=u,this._totalBytes+=u,this._lastCheckpoint=this._now())},Object.defineProperty(g.prototype,"currentKBps",{get:function(){this.addBytes(0);var u=(this._now()-this._lastCheckpoint)/1e3;return u==0&&(u=1),this._intervalBytes/u/1024},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"averageKBps",{get:function(){var u=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/u/1024},enumerable:!1,configurable:!0}),g}();m.default=T},"./src/io/websocket-loader.js":function(c,m,M){M.r(m);var T=M("./src/io/loader.js"),g=M("./src/utils/exception.js"),u=function(){var d=function(l,h){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,f){v.__proto__=f}||function(v,f){for(var r in f)Object.prototype.hasOwnProperty.call(f,r)&&(v[r]=f[r])},d(l,h)};return function(l,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");d(l,h);function v(){this.constructor=l}l.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),n=function(d){u(l,d);function l(){var h=d.call(this,"websocket-loader")||this;return h.TAG="WebSocketLoader",h._needStash=!0,h._ws=null,h._requestAbort=!1,h._receivedLength=0,h}return l.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch{return!1}},l.prototype.destroy=function(){this._ws&&this.abort(),d.prototype.destroy.call(this)},l.prototype.open=function(h){try{var v=this._ws=new self.WebSocket(h.url);v.binaryType="arraybuffer",v.onopen=this._onWebSocketOpen.bind(this),v.onclose=this._onWebSocketClose.bind(this),v.onmessage=this._onWebSocketMessage.bind(this),v.onerror=this._onWebSocketError.bind(this),this._status=T.LoaderStatus.kConnecting}catch(r){this._status=T.LoaderStatus.kError;var f={code:r.code,msg:r.message};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,f);else throw new g.RuntimeException(f.msg)}},l.prototype.abort=function(){var h=this._ws;h&&(h.readyState===0||h.readyState===1)&&(this._requestAbort=!0,h.close()),this._ws=null,this._status=T.LoaderStatus.kComplete},l.prototype._onWebSocketOpen=function(h){this._status=T.LoaderStatus.kBuffering},l.prototype._onWebSocketClose=function(h){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=T.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},l.prototype._onWebSocketMessage=function(h){var v=this;if(h.data instanceof ArrayBuffer)this._dispatchArrayBuffer(h.data);else if(h.data instanceof Blob){var f=new FileReader;f.onload=function(){v._dispatchArrayBuffer(f.result)},f.readAsArrayBuffer(h.data)}else{this._status=T.LoaderStatus.kError;var r={code:-1,msg:"Unsupported WebSocket message type: "+h.data.constructor.name};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,r);else throw new g.RuntimeException(r.msg)}},l.prototype._dispatchArrayBuffer=function(h){var v=h,f=this._receivedLength;this._receivedLength+=v.byteLength,this._onDataArrival&&this._onDataArrival(v,f,this._receivedLength)},l.prototype._onWebSocketError=function(h){this._status=T.LoaderStatus.kError;var v={code:h.code,msg:h.message};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,v);else throw new g.RuntimeException(v.msg)},l}(T.BaseLoader);m.default=n},"./src/io/xhr-moz-chunked-loader.js":function(c,m,M){M.r(m);var T=M("./src/utils/logger.js"),g=M("./src/io/loader.js"),u=M("./src/utils/exception.js"),n=function(){var l=function(h,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,r){f.__proto__=r}||function(f,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(f[t]=r[t])},l(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(h,v);function f(){this.constructor=h}h.prototype=v===null?Object.create(v):(f.prototype=v.prototype,new f)}}(),d=function(l){n(h,l);function h(v,f){var r=l.call(this,"xhr-moz-chunked-loader")||this;return r.TAG="MozChunkedLoader",r._seekHandler=v,r._config=f,r._needStash=!0,r._xhr=null,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return h.isSupported=function(){try{var v=new XMLHttpRequest;return v.open("GET","https://example.com",!0),v.responseType="moz-chunked-arraybuffer",v.responseType==="moz-chunked-arraybuffer"}catch(f){return T.default.w("MozChunkedLoader",f.message),!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),l.prototype.destroy.call(this)},h.prototype.open=function(v,f){this._dataSource=v,this._range=f;var r=v.url;this._config.reuseRedirectedURL&&v.redirectedURL!=null&&(r=v.redirectedURL);var t=this._seekHandler.getConfig(r,f);this._requestURL=t.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",t.url,!0),i.responseType="moz-chunked-arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onloadend=this._onLoadEnd.bind(this),i.onerror=this._onXhrError.bind(this),v.withCredentials&&(i.withCredentials=!0),typeof t.headers=="object"){var e=t.headers;for(var s in e)e.hasOwnProperty(s)&&i.setRequestHeader(s,e[s])}if(typeof this._config.headers=="object"){var e=this._config.headers;for(var s in e)e.hasOwnProperty(s)&&i.setRequestHeader(s,e[s])}this._status=g.LoaderStatus.kConnecting,i.send()},h.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=g.LoaderStatus.kComplete},h.prototype._onReadyStateChange=function(v){var f=v.target;if(f.readyState===2){if(f.responseURL!=null&&f.responseURL!==this._requestURL&&this._onURLRedirect){var r=this._seekHandler.removeURLParameters(f.responseURL);this._onURLRedirect(r)}if(f.status!==0&&(f.status<200||f.status>299))if(this._status=g.LoaderStatus.kError,this._onError)this._onError(g.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:f.status,msg:f.statusText});else throw new u.RuntimeException("MozChunkedLoader: Http code invalid, "+f.status+" "+f.statusText);else this._status=g.LoaderStatus.kBuffering}},h.prototype._onProgress=function(v){if(this._status!==g.LoaderStatus.kError){this._contentLength===null&&v.total!==null&&v.total!==0&&(this._contentLength=v.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var f=v.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=f.byteLength,this._onDataArrival&&this._onDataArrival(f,r,this._receivedLength)}},h.prototype._onLoadEnd=function(v){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===g.LoaderStatus.kError)return;this._status=g.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},h.prototype._onXhrError=function(v){this._status=g.LoaderStatus.kError;var f=0,r=null;if(this._contentLength&&v.loaded<this._contentLength?(f=g.LoaderErrors.EARLY_EOF,r={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(f=g.LoaderErrors.EXCEPTION,r={code:-1,msg:v.constructor.name+" "+v.type}),this._onError)this._onError(f,r);else throw new u.RuntimeException(r.msg)},h}(g.BaseLoader);m.default=d},"./src/io/xhr-range-loader.js":function(c,m,M){M.r(m);var T=M("./src/utils/logger.js"),g=M("./src/io/speed-sampler.js"),u=M("./src/io/loader.js"),n=M("./src/utils/exception.js"),d=function(){var h=function(v,f){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])},h(v,f)};return function(v,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");h(v,f);function r(){this.constructor=v}v.prototype=f===null?Object.create(f):(r.prototype=f.prototype,new r)}}(),l=function(h){d(v,h);function v(f,r){var t=h.call(this,"xhr-range-loader")||this;return t.TAG="RangeLoader",t._seekHandler=f,t._config=r,t._needStash=!1,t._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],t._currentChunkSizeKB=384,t._currentSpeedNormalized=0,t._zeroSpeedChunkCount=0,t._xhr=null,t._speedSampler=new g.default,t._requestAbort=!1,t._waitForTotalLength=!1,t._totalLengthReceived=!1,t._currentRequestURL=null,t._currentRedirectedURL=null,t._currentRequestRange=null,t._totalLength=null,t._contentLength=null,t._receivedLength=0,t._lastTimeLoaded=0,t}return v.isSupported=function(){try{var f=new XMLHttpRequest;return f.open("GET","https://example.com",!0),f.responseType="arraybuffer",f.responseType==="arraybuffer"}catch(r){return T.default.w("RangeLoader",r.message),!1}},v.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),h.prototype.destroy.call(this)},Object.defineProperty(v.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),v.prototype.open=function(f,r){this._dataSource=f,this._range=r,this._status=u.LoaderStatus.kConnecting;var t=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(t=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!t?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},v.prototype._openSubRange=function(){var f=this._currentChunkSizeKB*1024,r=this._range.from+this._receivedLength,t=r+f;this._contentLength!=null&&t-this._range.from>=this._contentLength&&(t=this._range.from+this._contentLength-1),this._currentRequestRange={from:r,to:t},this._internalOpen(this._dataSource,this._currentRequestRange)},v.prototype._internalOpen=function(f,r){this._lastTimeLoaded=0;var t=f.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?t=this._currentRedirectedURL:f.redirectedURL!=null&&(t=f.redirectedURL));var i=this._seekHandler.getConfig(t,r);this._currentRequestURL=i.url;var e=this._xhr=new XMLHttpRequest;if(e.open("GET",i.url,!0),e.responseType="arraybuffer",e.onreadystatechange=this._onReadyStateChange.bind(this),e.onprogress=this._onProgress.bind(this),e.onload=this._onLoad.bind(this),e.onerror=this._onXhrError.bind(this),f.withCredentials&&(e.withCredentials=!0),typeof i.headers=="object"){var s=i.headers;for(var o in s)s.hasOwnProperty(o)&&e.setRequestHeader(o,s[o])}if(typeof this._config.headers=="object"){var s=this._config.headers;for(var o in s)s.hasOwnProperty(o)&&e.setRequestHeader(o,s[o])}e.send()},v.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=u.LoaderStatus.kComplete},v.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},v.prototype._onReadyStateChange=function(f){var r=f.target;if(r.readyState===2){if(r.responseURL!=null){var t=this._seekHandler.removeURLParameters(r.responseURL);r.responseURL!==this._currentRequestURL&&t!==this._currentRedirectedURL&&(this._currentRedirectedURL=t,this._onURLRedirect&&this._onURLRedirect(t))}if(r.status>=200&&r.status<=299){if(this._waitForTotalLength)return;this._status=u.LoaderStatus.kBuffering}else if(this._status=u.LoaderStatus.kError,this._onError)this._onError(u.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText});else throw new n.RuntimeException("RangeLoader: Http code invalid, "+r.status+" "+r.statusText)}},v.prototype._onProgress=function(f){if(this._status!==u.LoaderStatus.kError){if(this._contentLength===null){var r=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,r=!0;var t=f.total;this._internalAbort(),t!=null&t!==0&&(this._totalLength=t)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,r){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var i=f.loaded-this._lastTimeLoaded;this._lastTimeLoaded=f.loaded,this._speedSampler.addBytes(i)}},v.prototype._normalizeSpeed=function(f){var r=this._chunkSizeKBList,t=r.length-1,i=0,e=0,s=t;if(f<r[0])return r[0];for(;e<=s;){if(i=e+Math.floor((s-e)/2),i===t||f>=r[i]&&f<r[i+1])return r[i];r[i]<f?e=i+1:s=i-1}},v.prototype._onLoad=function(f){if(this._status!==u.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var r=this._speedSampler.lastSecondKBps;if(r===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(r=this._speedSampler.currentKBps)),r!==0){var t=this._normalizeSpeed(r);this._currentSpeedNormalized!==t&&(this._currentSpeedNormalized=t,this._currentChunkSizeKB=t)}var i=f.target.response,e=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength;var s=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():s=!0,this._onDataArrival&&this._onDataArrival(i,e,this._receivedLength),s&&(this._status=u.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},v.prototype._onXhrError=function(f){this._status=u.LoaderStatus.kError;var r=0,t=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(r=u.LoaderErrors.EARLY_EOF,t={code:-1,msg:"RangeLoader meet Early-Eof"}):(r=u.LoaderErrors.EXCEPTION,t={code:-1,msg:f.constructor.name+" "+f.type}),this._onError)this._onError(r,t);else throw new n.RuntimeException(t.msg)},v}(u.BaseLoader);m.default=l},"./src/player/flv-player.js":function(c,m,M){M.r(m);var T=M("./node_modules/events/events.js"),g=M.n(T),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),d=M("./src/player/player-events.js"),l=M("./src/core/transmuxer.js"),h=M("./src/core/transmuxing-events.js"),v=M("./src/core/mse-controller.js"),f=M("./src/core/mse-events.js"),r=M("./src/player/player-errors.js"),t=M("./src/config.js"),i=M("./src/utils/exception.js"),e=function(){function s(o,a){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(g()),this._config=(0,t.createDefaultConfig)(),typeof a=="object"&&Object.assign(this._config,a),o.type.toLowerCase()!=="flv")throw new i.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");o.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=o,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var p=n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661);this._alwaysSeekKeyframe=!!(p||n.default.msedge||n.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return s.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},s.prototype.on=function(o,a){var p=this;o===d.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){p._emitter.emit(d.default.MEDIA_INFO,p.mediaInfo)}):o===d.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){p._emitter.emit(d.default.STATISTICS_INFO,p.statisticsInfo)}),this._emitter.addListener(o,a)},s.prototype.off=function(o,a){this._emitter.removeListener(o,a)},s.prototype.attachMediaElement=function(o){var a=this;if(this._mediaElement=o,o.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),o.addEventListener("seeking",this.e.onvSeeking),o.addEventListener("canplay",this.e.onvCanPlay),o.addEventListener("stalled",this.e.onvStalled),o.addEventListener("progress",this.e.onvProgress),this._msectl=new v.default(this._config),this._msectl.on(f.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(f.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(f.default.SOURCE_OPEN,function(){a._mseSourceOpened=!0,a._hasPendingLoad&&(a._hasPendingLoad=!1,a.load())}),this._msectl.on(f.default.ERROR,function(p){a._emitter.emit(d.default.ERROR,r.ErrorTypes.MEDIA_ERROR,r.ErrorDetails.MEDIA_MSE_ERROR,p)}),this._msectl.attachMediaElement(o),this._pendingSeekTime!=null)try{o.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},s.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},s.prototype.load=function(){var o=this;if(!this._mediaElement)throw new i.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new i.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new l.default(this._mediaDataSource,this._config),this._transmuxer.on(h.default.INIT_SEGMENT,function(a,p){o._msectl.appendInitSegment(p)}),this._transmuxer.on(h.default.MEDIA_SEGMENT,function(a,p){if(o._msectl.appendMediaSegment(p),o._config.lazyLoad&&!o._config.isLive){var D=o._mediaElement.currentTime;p.info.endDts>=(D+o._config.lazyLoadMaxDuration)*1e3&&o._progressChecker==null&&(u.default.v(o.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),o._suspendTransmuxer())}}),this._transmuxer.on(h.default.LOADING_COMPLETE,function(){o._msectl.endOfStream(),o._emitter.emit(d.default.LOADING_COMPLETE)}),this._transmuxer.on(h.default.RECOVERED_EARLY_EOF,function(){o._emitter.emit(d.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(h.default.IO_ERROR,function(a,p){o._emitter.emit(d.default.ERROR,r.ErrorTypes.NETWORK_ERROR,a,p)}),this._transmuxer.on(h.default.DEMUX_ERROR,function(a,p){o._emitter.emit(d.default.ERROR,r.ErrorTypes.MEDIA_ERROR,a,{code:-1,msg:p})}),this._transmuxer.on(h.default.MEDIA_INFO,function(a){o._mediaInfo=a,o._emitter.emit(d.default.MEDIA_INFO,Object.assign({},a))}),this._transmuxer.on(h.default.METADATA_ARRIVED,function(a){o._emitter.emit(d.default.METADATA_ARRIVED,a)}),this._transmuxer.on(h.default.SCRIPTDATA_ARRIVED,function(a){o._emitter.emit(d.default.SCRIPTDATA_ARRIVED,a)}),this._transmuxer.on(h.default.STATISTICS_INFO,function(a){o._statisticsInfo=o._fillStatisticsInfo(a),o._emitter.emit(d.default.STATISTICS_INFO,Object.assign({},o._statisticsInfo))}),this._transmuxer.on(h.default.RECOMMEND_SEEKPOINT,function(a){o._mediaElement&&!o._config.accurateSeek&&(o._requestSetTime=!0,o._mediaElement.currentTime=a/1e3)}),this._transmuxer.open()}},s.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},s.prototype.play=function(){return this._mediaElement.play()},s.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(s.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(o){this._mediaElement.volume=o},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(o){this._mediaElement.muted=o},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(o){this._mediaElement?this._internalSeek(o):this._pendingSeekTime=o},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),s.prototype._fillStatisticsInfo=function(o){if(o.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return o;var a=!0,p=0,D=0;if(this._mediaElement.getVideoPlaybackQuality){var L=this._mediaElement.getVideoPlaybackQuality();p=L.totalVideoFrames,D=L.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(p=this._mediaElement.webkitDecodedFrameCount,D=this._mediaElement.webkitDroppedFrameCount):a=!1;return a&&(o.decodedFrames=p,o.droppedFrames=D),o},s.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var o=this._mediaElement.buffered,a=this._mediaElement.currentTime,p=0,D=0;D<o.length;D++){var L=o.start(D),y=o.end(D);if(L<=a&&a<y){p=y;break}}p>=a+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(u.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},s.prototype._onmseBufferFull=function(){u.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},s.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},s.prototype._checkProgressAndResume=function(){for(var o=this._mediaElement.currentTime,a=this._mediaElement.buffered,p=!1,D=0;D<a.length;D++){var L=a.start(D),y=a.end(D);if(o>=L&&o<y){o>=y-this._config.lazyLoadRecoverDuration&&(p=!0);break}}p&&(window.clearInterval(this._progressChecker),this._progressChecker=null,p&&(u.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},s.prototype._isTimepointBuffered=function(o){for(var a=this._mediaElement.buffered,p=0;p<a.length;p++){var D=a.start(p),L=a.end(p);if(o>=D&&o<L)return!0}return!1},s.prototype._internalSeek=function(o){var a=this._isTimepointBuffered(o),p=!1,D=0;if(o<1&&this._mediaElement.buffered.length>0){var L=this._mediaElement.buffered.start(0);(L<1&&o<L||n.default.safari)&&(p=!0,D=n.default.safari?.1:L)}if(p)this._requestSetTime=!0,this._mediaElement.currentTime=D;else if(a){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=o;else{var y=this._msectl.getNearestKeyframe(Math.floor(o*1e3));this._requestSetTime=!0,y!=null?this._mediaElement.currentTime=y.dts/1e3:this._mediaElement.currentTime=o}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(o*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o)},s.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var o=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(o)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(o*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},s.prototype._checkAndResumeStuckPlayback=function(o){var a=this._mediaElement;if(o||!this._receivedCanPlay||a.readyState<2){var p=a.buffered;p.length>0&&a.currentTime<p.start(0)&&(u.default.w(this.TAG,"Playback seems stuck at "+a.currentTime+", seek to "+p.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=p.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},s.prototype._onvLoadedMetadata=function(o){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},s.prototype._onvSeeking=function(o){var a=this._mediaElement.currentTime,p=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(a<1&&p.length>0){var D=p.start(0);if(D<1&&a<D||n.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=n.default.safari?.1:D;return}}if(this._isTimepointBuffered(a)){if(this._alwaysSeekKeyframe){var L=this._msectl.getNearestKeyframe(Math.floor(a*1e3));L!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=L.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:a,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},s.prototype._onvCanPlay=function(o){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},s.prototype._onvStalled=function(o){this._checkAndResumeStuckPlayback(!0)},s.prototype._onvProgress=function(o){this._checkAndResumeStuckPlayback()},s}();m.default=e},"./src/player/native-player.js":function(c,m,M){M.r(m);var T=M("./node_modules/events/events.js"),g=M.n(T),u=M("./src/player/player-events.js"),n=M("./src/config.js"),d=M("./src/utils/exception.js"),l=function(){function h(v,f){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(g()),this._config=(0,n.createDefaultConfig)(),typeof f=="object"&&Object.assign(this._config,f),v.type.toLowerCase()==="flv")throw new d.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(v.hasOwnProperty("segments"))throw new d.InvalidArgumentException("NativePlayer("+v.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=v,this._mediaElement=null}return h.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},h.prototype.on=function(v,f){var r=this;v===u.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(u.default.MEDIA_INFO,r.mediaInfo)}):v===u.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(u.default.STATISTICS_INFO,r.statisticsInfo)}),this._emitter.addListener(v,f)},h.prototype.off=function(v,f){this._emitter.removeListener(v,f)},h.prototype.attachMediaElement=function(v){if(this._mediaElement=v,v.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{v.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},h.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},h.prototype.load=function(){if(!this._mediaElement)throw new d.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},h.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},h.prototype.play=function(){return this._mediaElement.play()},h.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(h.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(v){this._mediaElement.volume=v},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(v){this._mediaElement.muted=v},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(v){this._mediaElement?this._mediaElement.currentTime=v:this._pendingSeekTime=v},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"mediaInfo",{get:function(){var v=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",f={mimeType:v+this._mediaDataSource.type};return this._mediaElement&&(f.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(f.width=this._mediaElement.videoWidth,f.height=this._mediaElement.videoHeight)),f},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"statisticsInfo",{get:function(){var v={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return v;var f=!0,r=0,t=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();r=i.totalVideoFrames,t=i.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(r=this._mediaElement.webkitDecodedFrameCount,t=this._mediaElement.webkitDroppedFrameCount):f=!1;return f&&(v.decodedFrames=r,v.droppedFrames=t),v},enumerable:!1,configurable:!0}),h.prototype._onvLoadedMetadata=function(v){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(u.default.MEDIA_INFO,this.mediaInfo)},h.prototype._reportStatisticsInfo=function(){this._emitter.emit(u.default.STATISTICS_INFO,this.statisticsInfo)},h}();m.default=l},"./src/player/player-errors.js":function(c,m,M){M.r(m),M.d(m,{ErrorTypes:function(){return u},ErrorDetails:function(){return n}});var T=M("./src/io/loader.js"),g=M("./src/demux/demux-errors.js"),u={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},n={NETWORK_EXCEPTION:T.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:T.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:T.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:T.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:g.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:g.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:g.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(c,m,M){M.r(m);var T={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};m.default=T},"./src/remux/aac-silent.js":function(c,m,M){M.r(m);var T=function(){function g(){}return g.getSilentFrame=function(u,n){if(u==="mp4a.40.2"){if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},g}();m.default=T},"./src/remux/mp4-generator.js":function(c,m,M){M.r(m);var T=function(){function g(){}return g.init=function(){g.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var u in g.types)g.types.hasOwnProperty(u)&&(g.types[u]=[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3)]);var n=g.constants={};n.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),n.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),n.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSC=n.STCO=n.STTS,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},g.box=function(u){for(var n=8,d=null,l=Array.prototype.slice.call(arguments,1),h=l.length,v=0;v<h;v++)n+=l[v].byteLength;d=new Uint8Array(n),d[0]=n>>>24&255,d[1]=n>>>16&255,d[2]=n>>>8&255,d[3]=n&255,d.set(u,4);for(var f=8,v=0;v<h;v++)d.set(l[v],f),f+=l[v].byteLength;return d},g.generateInitSegment=function(u){var n=g.box(g.types.ftyp,g.constants.FTYP),d=g.moov(u),l=new Uint8Array(n.byteLength+d.byteLength);return l.set(n,0),l.set(d,n.byteLength),l},g.moov=function(u){var n=g.mvhd(u.timescale,u.duration),d=g.trak(u),l=g.mvex(u);return g.box(g.types.moov,n,d,l)},g.mvhd=function(u,n){return g.box(g.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},g.trak=function(u){return g.box(g.types.trak,g.tkhd(u),g.mdia(u))},g.tkhd=function(u){var n=u.id,d=u.duration,l=u.presentWidth,h=u.presentHeight;return g.box(g.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,l>>>8&255,l&255,0,0,h>>>8&255,h&255,0,0]))},g.mdia=function(u){return g.box(g.types.mdia,g.mdhd(u),g.hdlr(u),g.minf(u))},g.mdhd=function(u){var n=u.timescale,d=u.duration;return g.box(g.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,85,196,0,0]))},g.hdlr=function(u){var n=null;return u.type==="audio"?n=g.constants.HDLR_AUDIO:n=g.constants.HDLR_VIDEO,g.box(g.types.hdlr,n)},g.minf=function(u){var n=null;return u.type==="audio"?n=g.box(g.types.smhd,g.constants.SMHD):n=g.box(g.types.vmhd,g.constants.VMHD),g.box(g.types.minf,n,g.dinf(),g.stbl(u))},g.dinf=function(){var u=g.box(g.types.dinf,g.box(g.types.dref,g.constants.DREF));return u},g.stbl=function(u){var n=g.box(g.types.stbl,g.stsd(u),g.box(g.types.stts,g.constants.STTS),g.box(g.types.stsc,g.constants.STSC),g.box(g.types.stsz,g.constants.STSZ),g.box(g.types.stco,g.constants.STCO));return n},g.stsd=function(u){return u.type==="audio"?u.codec==="mp3"?g.box(g.types.stsd,g.constants.STSD_PREFIX,g.mp3(u)):g.box(g.types.stsd,g.constants.STSD_PREFIX,g.mp4a(u)):g.box(g.types.stsd,g.constants.STSD_PREFIX,g.avc1(u))},g.mp3=function(u){var n=u.channelCount,d=u.audioSampleRate,l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,d>>>8&255,d&255,0,0]);return g.box(g.types[".mp3"],l)},g.mp4a=function(u){var n=u.channelCount,d=u.audioSampleRate,l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,d>>>8&255,d&255,0,0]);return g.box(g.types.mp4a,l,g.esds(u))},g.esds=function(u){var n=u.config||[],d=n.length,l=new Uint8Array([0,0,0,0,3,23+d,0,1,0,4,15+d,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([d]).concat(n).concat([6,1,2]));return g.box(g.types.esds,l)},g.avc1=function(u){var n=u.avcc,d=u.codecWidth,l=u.codecHeight,h=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>>8&255,d&255,l>>>8&255,l&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return g.box(g.types.avc1,h,g.box(g.types.avcC,n))},g.mvex=function(u){return g.box(g.types.mvex,g.trex(u))},g.trex=function(u){var n=u.id,d=new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return g.box(g.types.trex,d)},g.moof=function(u,n){return g.box(g.types.moof,g.mfhd(u.sequenceNumber),g.traf(u,n))},g.mfhd=function(u){var n=new Uint8Array([0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255]);return g.box(g.types.mfhd,n)},g.traf=function(u,n){var d=u.id,l=g.box(g.types.tfhd,new Uint8Array([0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255])),h=g.box(g.types.tfdt,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255])),v=g.sdtp(u),f=g.trun(u,v.byteLength+16+16+8+16+8+8);return g.box(g.types.traf,l,h,f,v)},g.sdtp=function(u){for(var n=u.samples||[],d=n.length,l=new Uint8Array(4+d),h=0;h<d;h++){var v=n[h].flags;l[h+4]=v.isLeading<<6|v.dependsOn<<4|v.isDependedOn<<2|v.hasRedundancy}return g.box(g.types.sdtp,l)},g.trun=function(u,n){var d=u.samples||[],l=d.length,h=12+16*l,v=new Uint8Array(h);n+=8+h,v.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,l&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0);for(var f=0;f<l;f++){var r=d[f].duration,t=d[f].size,i=d[f].flags,e=d[f].cts;v.set([r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.isNonSync,0,0,e>>>24&255,e>>>16&255,e>>>8&255,e&255],12+16*f)}return g.box(g.types.trun,v)},g.mdat=function(u){return g.box(g.types.mdat,u)},g}();T.init(),m.default=T},"./src/remux/mp4-remuxer.js":function(c,m,M){M.r(m);var T=M("./src/utils/logger.js"),g=M("./src/remux/mp4-generator.js"),u=M("./src/remux/aac-silent.js"),n=M("./src/utils/browser.js"),d=M("./src/core/media-segment-info.js"),l=M("./src/utils/exception.js"),h=function(){function v(f){this.TAG="MP4Remuxer",this._config=f,this._isLive=f.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new d.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new d.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661)),this._fillSilentAfterSeek=n.default.msedge||n.default.msie,this._mp3UseMpegAudio=!n.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return v.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},v.prototype.bindDataSource=function(f){return f.onDataAvailable=this.remux.bind(this),f.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(v.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(f){this._onInitSegment=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(f){this._onMediaSegment=f},enumerable:!1,configurable:!0}),v.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},v.prototype.seek=function(f){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},v.prototype.remux=function(f,r){if(!this._onMediaSegment)throw new l.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(f,r),this._remuxVideo(r),this._remuxAudio(f)},v.prototype._onTrackMetadataReceived=function(f,r){var t=null,i="mp4",e=r.codec;if(f==="audio")this._audioMeta=r,r.codec==="mp3"&&this._mp3UseMpegAudio?(i="mpeg",e="",t=new Uint8Array):t=g.default.generateInitSegment(r);else if(f==="video")this._videoMeta=r,t=g.default.generateInitSegment(r);else return;if(!this._onInitSegment)throw new l.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(f,{type:f,data:t.buffer,codec:e,container:f+"/"+i,mediaDuration:r.duration})},v.prototype._calculateDtsBase=function(f,r){this._dtsBaseInited||(f.samples&&f.samples.length&&(this._audioDtsBase=f.samples[0].dts),r.samples&&r.samples.length&&(this._videoDtsBase=r.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},v.prototype.flushStashedSamples=function(){var f=this._videoStashedLastSample,r=this._audioStashedLastSample,t={type:"video",id:1,sequenceNumber:0,samples:[],length:0};f!=null&&(t.samples.push(f),t.length=f.length);var i={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};r!=null&&(i.samples.push(r),i.length=r.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(t,!0),this._remuxAudio(i,!0)},v.prototype._remuxAudio=function(f,r){if(this._audioMeta!=null){var t=f,i=t.samples,e=void 0,s=-1,o=-1,a=this._audioMeta.refSampleDuration,p=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,D=this._dtsBaseInited&&this._audioNextDts===void 0,L=!1;if(!(!i||i.length===0)&&!(i.length===1&&!r)){var y=0,E=null,_=0;p?(y=0,_=t.length):(y=8,_=8+t.length);var A=null;if(i.length>1&&(A=i.pop(),_-=A.length),this._audioStashedLastSample!=null){var I=this._audioStashedLastSample;this._audioStashedLastSample=null,i.unshift(I),_+=I.length}A!=null&&(this._audioStashedLastSample=A);var b=i[0].dts-this._dtsBase;if(this._audioNextDts)e=b-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())e=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(L=!0);else{var R=this._audioSegmentInfoList.getLastSampleBefore(b);if(R!=null){var P=b-(R.originalDts+R.duration);P<=3&&(P=0);var w=R.dts+R.duration+P;e=b-w}else e=0}if(L){var F=b-e,k=this._videoSegmentInfoList.getLastSegmentBefore(b);if(k!=null&&k.beginDts<F){var B=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(B){var U=k.beginDts,j=F-k.beginDts;T.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+U+", duration: "+j),i.unshift({unit:B,dts:U,pts:U}),_+=B.byteLength}}else L=!1}for(var K=[],N=0;N<i.length;N++){var I=i[N],Z=I.unit,$=I.dts-this._dtsBase,U=$,Y=!1,ee=null,Q=0;if(!($<-.001)){if(this._audioMeta.codec!=="mp3"){var G=$,q=3;if(this._audioNextDts&&(G=this._audioNextDts),e=$-G,e<=-q*a){T.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+$+" ms ,curRefDts: "+G+" ms)  due to dtsCorrection: "+e+" ms overlap.");continue}else if(e>=q*a&&this._fillAudioTimestampGap&&!n.default.safari){Y=!0;var te=Math.floor(e/a);T.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+$+" ms, curRefDts: "+G+" ms, ")+("dtsCorrection: "+Math.round(e)+" ms, generate: "+te+" frames")),U=Math.floor(G),Q=Math.floor(G+a)-U;var B=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);B==null&&(T.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),B=Z),ee=[];for(var ie=0;ie<te;ie++){G=G+a;var ne=Math.floor(G),le=Math.floor(G+a)-ne,se={dts:ne,pts:ne,cts:0,unit:B,size:B.byteLength,duration:le,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};ee.push(se),_+=se.size}this._audioNextDts=G+a}else U=Math.floor(G),Q=Math.floor(G+a)-U,this._audioNextDts=G+a}else{if(U=$-e,N!==i.length-1){var oe=i[N+1].dts-this._dtsBase-e;Q=oe-U}else if(A!=null){var oe=A.dts-this._dtsBase-e;Q=oe-U}else K.length>=1?Q=K[K.length-1].duration:Q=Math.floor(a);this._audioNextDts=U+Q}s===-1&&(s=U),K.push({dts:U,pts:U,cts:0,unit:I.unit,size:I.unit.byteLength,duration:Q,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Y&&K.push.apply(K,ee)}}if(K.length===0){t.samples=[],t.length=0;return}p?E=new Uint8Array(_):(E=new Uint8Array(_),E[0]=_>>>24&255,E[1]=_>>>16&255,E[2]=_>>>8&255,E[3]=_&255,E.set(g.default.types.mdat,4));for(var N=0;N<K.length;N++){var Z=K[N].unit;E.set(Z,y),y+=Z.byteLength}var J=K[K.length-1];o=J.dts+J.duration;var ae=new d.MediaSegmentInfo;ae.beginDts=s,ae.endDts=o,ae.beginPts=s,ae.endPts=o,ae.originalBeginDts=K[0].originalDts,ae.originalEndDts=J.originalDts+J.duration,ae.firstSample=new d.SampleInfo(K[0].dts,K[0].pts,K[0].duration,K[0].originalDts,!1),ae.lastSample=new d.SampleInfo(J.dts,J.pts,J.duration,J.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(ae),t.samples=K,t.sequenceNumber++;var fe=null;p?fe=new Uint8Array:fe=g.default.moof(t,s),t.samples=[],t.length=0;var de={type:"audio",data:this._mergeBoxes(fe,E).buffer,sampleCount:K.length,info:ae};p&&D&&(de.timestampOffset=s),this._onMediaSegment("audio",de)}}},v.prototype._remuxVideo=function(f,r){if(this._videoMeta!=null){var t=f,i=t.samples,e=void 0,s=-1,o=-1,a=-1,p=-1;if(!(!i||i.length===0)&&!(i.length===1&&!r)){var D=8,L=null,y=8+f.length,E=null;if(i.length>1&&(E=i.pop(),y-=E.length),this._videoStashedLastSample!=null){var _=this._videoStashedLastSample;this._videoStashedLastSample=null,i.unshift(_),y+=_.length}E!=null&&(this._videoStashedLastSample=E);var A=i[0].dts-this._dtsBase;if(this._videoNextDts)e=A-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())e=0;else{var I=this._videoSegmentInfoList.getLastSampleBefore(A);if(I!=null){var b=A-(I.originalDts+I.duration);b<=3&&(b=0);var R=I.dts+I.duration+b;e=A-R}else e=0}for(var P=new d.MediaSegmentInfo,w=[],F=0;F<i.length;F++){var _=i[F],k=_.dts-this._dtsBase,B=_.isKeyframe,U=k-e,j=_.cts,K=U+j;s===-1&&(s=U,a=K);var N=0;if(F!==i.length-1){var Z=i[F+1].dts-this._dtsBase-e;N=Z-U}else if(E!=null){var Z=E.dts-this._dtsBase-e;N=Z-U}else w.length>=1?N=w[w.length-1].duration:N=Math.floor(this._videoMeta.refSampleDuration);if(B){var $=new d.SampleInfo(U,K,N,_.dts,!0);$.fileposition=_.fileposition,P.appendSyncPoint($)}w.push({dts:U,pts:K,cts:j,units:_.units,size:_.length,isKeyframe:B,duration:N,originalDts:k,flags:{isLeading:0,dependsOn:B?2:1,isDependedOn:B?1:0,hasRedundancy:0,isNonSync:B?0:1}})}L=new Uint8Array(y),L[0]=y>>>24&255,L[1]=y>>>16&255,L[2]=y>>>8&255,L[3]=y&255,L.set(g.default.types.mdat,4);for(var F=0;F<w.length;F++)for(var Y=w[F].units;Y.length;){var ee=Y.shift(),Q=ee.data;L.set(Q,D),D+=Q.byteLength}var G=w[w.length-1];if(o=G.dts+G.duration,p=G.pts+G.duration,this._videoNextDts=o,P.beginDts=s,P.endDts=o,P.beginPts=a,P.endPts=p,P.originalBeginDts=w[0].originalDts,P.originalEndDts=G.originalDts+G.duration,P.firstSample=new d.SampleInfo(w[0].dts,w[0].pts,w[0].duration,w[0].originalDts,w[0].isKeyframe),P.lastSample=new d.SampleInfo(G.dts,G.pts,G.duration,G.originalDts,G.isKeyframe),this._isLive||this._videoSegmentInfoList.append(P),t.samples=w,t.sequenceNumber++,this._forceFirstIDR){var q=w[0].flags;q.dependsOn=2,q.isNonSync=0}var te=g.default.moof(t,s);t.samples=[],t.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(te,L).buffer,sampleCount:w.length,info:P})}}},v.prototype._mergeBoxes=function(f,r){var t=new Uint8Array(f.byteLength+r.byteLength);return t.set(f,0),t.set(r,f.byteLength),t},v}();m.default=h},"./src/utils/browser.js":function(c,m,M){M.r(m);var T={};function g(){var u=self.navigator.userAgent.toLowerCase(),n=/(edge)\/([\w.]+)/.exec(u)||/(opr)[\/]([\w.]+)/.exec(u)||/(chrome)[ \/]([\w.]+)/.exec(u)||/(iemobile)[\/]([\w.]+)/.exec(u)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+)/.exec(u)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||u.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(u)||u.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(u)||[],d=/(ipad)/.exec(u)||/(ipod)/.exec(u)||/(windows phone)/.exec(u)||/(iphone)/.exec(u)||/(kindle)/.exec(u)||/(android)/.exec(u)||/(windows)/.exec(u)||/(mac)/.exec(u)||/(linux)/.exec(u)||/(cros)/.exec(u)||[],l={browser:n[5]||n[3]||n[1]||"",version:n[2]||n[4]||"0",majorVersion:n[4]||n[2]||"0",platform:d[0]||""},h={};if(l.browser){h[l.browser]=!0;var v=l.majorVersion.split(".");h.version={major:parseInt(l.majorVersion,10),string:l.version},v.length>1&&(h.version.minor=parseInt(v[1],10)),v.length>2&&(h.version.build=parseInt(v[2],10))}if(l.platform&&(h[l.platform]=!0),(h.chrome||h.opr||h.safari)&&(h.webkit=!0),h.rv||h.iemobile){h.rv&&delete h.rv;var f="msie";l.browser=f,h[f]=!0}if(h.edge){delete h.edge;var r="msedge";l.browser=r,h[r]=!0}if(h.opr){var t="opera";l.browser=t,h[t]=!0}if(h.safari&&h.android){var i="android";l.browser=i,h[i]=!0}h.name=l.browser,h.platform=l.platform;for(var e in T)T.hasOwnProperty(e)&&delete T[e];Object.assign(T,h)}g(),m.default=T},"./src/utils/exception.js":function(c,m,M){M.r(m),M.d(m,{RuntimeException:function(){return g},IllegalStateException:function(){return u},InvalidArgumentException:function(){return n},NotImplementedException:function(){return d}});var T=function(){var l=function(h,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,r){f.__proto__=r}||function(f,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(f[t]=r[t])},l(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(h,v);function f(){this.constructor=h}h.prototype=v===null?Object.create(v):(f.prototype=v.prototype,new f)}}(),g=function(){function l(h){this._message=h}return Object.defineProperty(l.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),l.prototype.toString=function(){return this.name+": "+this.message},l}(),u=function(l){T(h,l);function h(v){return l.call(this,v)||this}return Object.defineProperty(h.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),h}(g),n=function(l){T(h,l);function h(v){return l.call(this,v)||this}return Object.defineProperty(h.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),h}(g),d=function(l){T(h,l);function h(v){return l.call(this,v)||this}return Object.defineProperty(h.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),h}(g)},"./src/utils/logger.js":function(c,m,M){M.r(m);var T=M("./node_modules/events/events.js"),g=M.n(T),u=function(){function n(){}return n.e=function(d,l){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var h="["+d+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","error",h),n.ENABLE_ERROR&&(console.error?console.error(h):console.warn?console.warn(h):console.log(h))},n.i=function(d,l){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var h="["+d+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","info",h),n.ENABLE_INFO&&(console.info?console.info(h):console.log(h))},n.w=function(d,l){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var h="["+d+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","warn",h),n.ENABLE_WARN&&(console.warn?console.warn(h):console.log(h))},n.d=function(d,l){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var h="["+d+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","debug",h),n.ENABLE_DEBUG&&(console.debug?console.debug(h):console.log(h))},n.v=function(d,l){(!d||n.FORCE_GLOBAL_TAG)&&(d=n.GLOBAL_TAG);var h="["+d+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","verbose",h),n.ENABLE_VERBOSE&&console.log(h)},n}();u.GLOBAL_TAG="flv.js",u.FORCE_GLOBAL_TAG=!1,u.ENABLE_ERROR=!0,u.ENABLE_INFO=!0,u.ENABLE_WARN=!0,u.ENABLE_DEBUG=!0,u.ENABLE_VERBOSE=!0,u.ENABLE_CALLBACK=!1,u.emitter=new(g()),m.default=u},"./src/utils/logging-control.js":function(c,m,M){M.r(m);var T=M("./node_modules/events/events.js"),g=M.n(T),u=M("./src/utils/logger.js"),n=function(){function d(){}return Object.defineProperty(d,"forceGlobalTag",{get:function(){return u.default.FORCE_GLOBAL_TAG},set:function(l){u.default.FORCE_GLOBAL_TAG=l,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"globalTag",{get:function(){return u.default.GLOBAL_TAG},set:function(l){u.default.GLOBAL_TAG=l,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableAll",{get:function(){return u.default.ENABLE_VERBOSE&&u.default.ENABLE_DEBUG&&u.default.ENABLE_INFO&&u.default.ENABLE_WARN&&u.default.ENABLE_ERROR},set:function(l){u.default.ENABLE_VERBOSE=l,u.default.ENABLE_DEBUG=l,u.default.ENABLE_INFO=l,u.default.ENABLE_WARN=l,u.default.ENABLE_ERROR=l,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableDebug",{get:function(){return u.default.ENABLE_DEBUG},set:function(l){u.default.ENABLE_DEBUG=l,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableVerbose",{get:function(){return u.default.ENABLE_VERBOSE},set:function(l){u.default.ENABLE_VERBOSE=l,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableInfo",{get:function(){return u.default.ENABLE_INFO},set:function(l){u.default.ENABLE_INFO=l,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableWarn",{get:function(){return u.default.ENABLE_WARN},set:function(l){u.default.ENABLE_WARN=l,d._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(d,"enableError",{get:function(){return u.default.ENABLE_ERROR},set:function(l){u.default.ENABLE_ERROR=l,d._notifyChange()},enumerable:!1,configurable:!0}),d.getConfig=function(){return{globalTag:u.default.GLOBAL_TAG,forceGlobalTag:u.default.FORCE_GLOBAL_TAG,enableVerbose:u.default.ENABLE_VERBOSE,enableDebug:u.default.ENABLE_DEBUG,enableInfo:u.default.ENABLE_INFO,enableWarn:u.default.ENABLE_WARN,enableError:u.default.ENABLE_ERROR,enableCallback:u.default.ENABLE_CALLBACK}},d.applyConfig=function(l){u.default.GLOBAL_TAG=l.globalTag,u.default.FORCE_GLOBAL_TAG=l.forceGlobalTag,u.default.ENABLE_VERBOSE=l.enableVerbose,u.default.ENABLE_DEBUG=l.enableDebug,u.default.ENABLE_INFO=l.enableInfo,u.default.ENABLE_WARN=l.enableWarn,u.default.ENABLE_ERROR=l.enableError,u.default.ENABLE_CALLBACK=l.enableCallback},d._notifyChange=function(){var l=d.emitter;if(l.listenerCount("change")>0){var h=d.getConfig();l.emit("change",h)}},d.registerListener=function(l){d.emitter.addListener("change",l)},d.removeListener=function(l){d.emitter.removeListener("change",l)},d.addLogListener=function(l){u.default.emitter.addListener("log",l),u.default.emitter.listenerCount("log")>0&&(u.default.ENABLE_CALLBACK=!0,d._notifyChange())},d.removeLogListener=function(l){u.default.emitter.removeListener("log",l),u.default.emitter.listenerCount("log")===0&&(u.default.ENABLE_CALLBACK=!1,d._notifyChange())},d}();n.emitter=new(g()),m.default=n},"./src/utils/polyfill.js":function(c,m,M){M.r(m);var T=function(){function g(){}return g.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(u,n){return u.__proto__=n,u},Object.assign=Object.assign||function(u){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(u),d=1;d<arguments.length;d++){var l=arguments[d];if(l!=null)for(var h in l)l.hasOwnProperty(h)&&(n[h]=l[h])}return n},typeof self.Promise!="function"&&M("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},g}();T.install(),m.default=T},"./src/utils/utf8-conv.js":function(c,m,M){M.r(m);function T(u,n,d){var l=u;if(n+d<l.length){for(;d--;)if((l[++n]&192)!==128)return!1;return!0}else return!1}function g(u){for(var n=[],d=u,l=0,h=u.length;l<h;){if(d[l]<128){n.push(String.fromCharCode(d[l])),++l;continue}else if(!(d[l]<192)){if(d[l]<224){if(T(d,l,1)){var v=(d[l]&31)<<6|d[l+1]&63;if(v>=128){n.push(String.fromCharCode(v&65535)),l+=2;continue}}}else if(d[l]<240){if(T(d,l,2)){var v=(d[l]&15)<<12|(d[l+1]&63)<<6|d[l+2]&63;if(v>=2048&&(v&63488)!==55296){n.push(String.fromCharCode(v&65535)),l+=3;continue}}}else if(d[l]<248&&T(d,l,3)){var v=(d[l]&7)<<18|(d[l+1]&63)<<12|(d[l+2]&63)<<6|d[l+3]&63;if(v>65536&&v<1114112){v-=65536,n.push(String.fromCharCode(v>>>10|55296)),n.push(String.fromCharCode(v&1023|56320)),l+=4;continue}}}n.push(String.fromCharCode(65533)),++l}return n.join("")}m.default=g}},C={};function x(c){var m=C[c];if(m!==void 0)return m.exports;var M=C[c]={exports:{}};return O[c].call(M.exports,M,M.exports,x),M.exports}x.m=O,function(){x.n=function(c){var m=c&&c.__esModule?function(){return c.default}:function(){return c};return x.d(m,{a:m}),m}}(),function(){x.d=function(c,m){for(var M in m)x.o(m,M)&&!x.o(c,M)&&Object.defineProperty(c,M,{enumerable:!0,get:m[M]})}}(),function(){x.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){x.o=function(c,m){return Object.prototype.hasOwnProperty.call(c,m)}}(),function(){x.r=function(c){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}}();var S=x("./src/index.js");return S}()})})(Ze);var Ve=Ue(Ze.exports),Qe={exports:{}};(function(ye,Ie){typeof window!="undefined"&&function(C,x){ye.exports=x()}(Be,function(){return function(O){var C={};function x(S){if(C[S])return C[S].exports;var c=C[S]={i:S,l:!1,exports:{}};return O[S].call(c.exports,c,c.exports,x),c.l=!0,c.exports}return x.m=O,x.c=C,x.d=function(S,c,m){x.o(S,c)||Object.defineProperty(S,c,{enumerable:!0,get:m})},x.r=function(S){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(S,"__esModule",{value:!0})},x.t=function(S,c){if(c&1&&(S=x(S)),c&8||c&4&&typeof S=="object"&&S&&S.__esModule)return S;var m=Object.create(null);if(x.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:S}),c&2&&typeof S!="string")for(var M in S)x.d(m,M,function(T){return S[T]}.bind(null,M));return m},x.n=function(S){var c=S&&S.__esModule?function(){return S.default}:function(){return S};return x.d(c,"a",c),c},x.o=function(S,c){return Object.prototype.hasOwnProperty.call(S,c)},x.p="/dist/",x(x.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(O,C,x){var S=Object.prototype.hasOwnProperty,c="~";function m(){}Object.create&&(m.prototype=Object.create(null),new m().__proto__||(c=!1));function M(n,d,l){this.fn=n,this.context=d,this.once=l||!1}function T(n,d,l,h,v){if(typeof l!="function")throw new TypeError("The listener must be a function");var f=new M(l,h||n,v),r=c?c+d:d;return n._events[r]?n._events[r].fn?n._events[r]=[n._events[r],f]:n._events[r].push(f):(n._events[r]=f,n._eventsCount++),n}function g(n,d){--n._eventsCount===0?n._events=new m:delete n._events[d]}function u(){this._events=new m,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],l,h;if(this._eventsCount===0)return d;for(h in l=this._events)S.call(l,h)&&d.push(c?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(l)):d},u.prototype.listeners=function(d){var l=c?c+d:d,h=this._events[l];if(!h)return[];if(h.fn)return[h.fn];for(var v=0,f=h.length,r=new Array(f);v<f;v++)r[v]=h[v].fn;return r},u.prototype.listenerCount=function(d){var l=c?c+d:d,h=this._events[l];return h?h.fn?1:h.length:0},u.prototype.emit=function(d,l,h,v,f,r){var t=c?c+d:d;if(!this._events[t])return!1;var i=this._events[t],e=arguments.length,s,o;if(i.fn){switch(i.once&&this.removeListener(d,i.fn,void 0,!0),e){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,l),!0;case 3:return i.fn.call(i.context,l,h),!0;case 4:return i.fn.call(i.context,l,h,v),!0;case 5:return i.fn.call(i.context,l,h,v,f),!0;case 6:return i.fn.call(i.context,l,h,v,f,r),!0}for(o=1,s=new Array(e-1);o<e;o++)s[o-1]=arguments[o];i.fn.apply(i.context,s)}else{var a=i.length,p;for(o=0;o<a;o++)switch(i[o].once&&this.removeListener(d,i[o].fn,void 0,!0),e){case 1:i[o].fn.call(i[o].context);break;case 2:i[o].fn.call(i[o].context,l);break;case 3:i[o].fn.call(i[o].context,l,h);break;case 4:i[o].fn.call(i[o].context,l,h,v);break;default:if(!s)for(p=1,s=new Array(e-1);p<e;p++)s[p-1]=arguments[p];i[o].fn.apply(i[o].context,s)}}return!0},u.prototype.on=function(d,l,h){return T(this,d,l,h,!1)},u.prototype.once=function(d,l,h){return T(this,d,l,h,!0)},u.prototype.removeListener=function(d,l,h,v){var f=c?c+d:d;if(!this._events[f])return this;if(!l)return g(this,f),this;var r=this._events[f];if(r.fn)r.fn===l&&(!v||r.once)&&(!h||r.context===h)&&g(this,f);else{for(var t=0,i=[],e=r.length;t<e;t++)(r[t].fn!==l||v&&!r[t].once||h&&r[t].context!==h)&&i.push(r[t]);i.length?this._events[f]=i.length===1?i[0]:i:g(this,f)}return this},u.prototype.removeAllListeners=function(d){var l;return d?(l=c?c+d:d,this._events[l]&&g(this,l)):(this._events=new m,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=c,u.EventEmitter=u,O.exports=u},"./node_modules/url-toolkit/src/url-toolkit.js":function(O,C,x){(function(S){var c=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,m=/^([^\/?#]*)([^]*)$/,M=/(?:\/|^)\.(?=\/)/g,T=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,g={buildAbsoluteURL:function(u,n,d){if(d=d||{},u=u.trim(),n=n.trim(),!n){if(!d.alwaysNormalize)return u;var l=g.parseURL(u);if(!l)throw new Error("Error trying to parse base URL.");return l.path=g.normalizePath(l.path),g.buildURLFromParts(l)}var h=g.parseURL(n);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return d.alwaysNormalize?(h.path=g.normalizePath(h.path),g.buildURLFromParts(h)):n;var v=g.parseURL(u);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var f=m.exec(v.path);v.netLoc=f[1],v.path=f[2]}v.netLoc&&!v.path&&(v.path="/");var r={scheme:v.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(r.netLoc=v.netLoc,h.path[0]!=="/"))if(!h.path)r.path=v.path,h.params||(r.params=v.params,h.query||(r.query=v.query));else{var t=v.path,i=t.substring(0,t.lastIndexOf("/")+1)+h.path;r.path=g.normalizePath(i)}return r.path===null&&(r.path=d.alwaysNormalize?g.normalizePath(h.path):h.path),g.buildURLFromParts(r)},parseURL:function(u){var n=c.exec(u);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(M,"");u.length!==(u=u.replace(T,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};O.exports=g})()},"./node_modules/webworkify-webpack/index.js":function(O,C,x){function S(d){var l={};function h(f){if(l[f])return l[f].exports;var r=l[f]={i:f,l:!1,exports:{}};return d[f].call(r.exports,r,r.exports,h),r.l=!0,r.exports}h.m=d,h.c=l,h.i=function(f){return f},h.d=function(f,r,t){h.o(f,r)||Object.defineProperty(f,r,{configurable:!1,enumerable:!0,get:t})},h.r=function(f){Object.defineProperty(f,"__esModule",{value:!0})},h.n=function(f){var r=f&&f.__esModule?function(){return f.default}:function(){return f};return h.d(r,"a",r),r},h.o=function(f,r){return Object.prototype.hasOwnProperty.call(f,r)},h.p="/",h.oe=function(f){throw console.error(f),f};var v=h(h.s=ENTRY_MODULE);return v.default||v}var c="[\\.|\\-|\\+|\\w|/|@]+",m="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+c+").*?\\)";function M(d){return(d+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function T(d){return!isNaN(1*d)}function g(d,l,h){var v={};v[h]=[];var f=l.toString(),r=f.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!r)return v;for(var t=r[1],i=new RegExp("(\\\\n|\\W)"+M(t)+m,"g"),e;e=i.exec(f);)e[3]!=="dll-reference"&&v[h].push(e[3]);for(i=new RegExp("\\("+M(t)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+m,"g");e=i.exec(f);)d[e[2]]||(v[h].push(e[1]),d[e[2]]=x(e[1]).m),v[e[2]]=v[e[2]]||[],v[e[2]].push(e[4]);for(var s=Object.keys(v),o=0;o<s.length;o++)for(var a=0;a<v[s[o]].length;a++)T(v[s[o]][a])&&(v[s[o]][a]=1*v[s[o]][a]);return v}function u(d){var l=Object.keys(d);return l.reduce(function(h,v){return h||d[v].length>0},!1)}function n(d,l){for(var h={main:[l]},v={main:[]},f={main:{}};u(h);)for(var r=Object.keys(h),t=0;t<r.length;t++){var i=r[t],e=h[i],s=e.pop();if(f[i]=f[i]||{},!(f[i][s]||!d[i][s])){f[i][s]=!0,v[i]=v[i]||[],v[i].push(s);for(var o=g(d,d[i][s],i),a=Object.keys(o),p=0;p<a.length;p++)h[a[p]]=h[a[p]]||[],h[a[p]]=h[a[p]].concat(o[a[p]])}}return v}O.exports=function(d,l){l=l||{};var h={main:x.m},v=l.all?{main:Object.keys(h.main)}:n(h,d),f="";Object.keys(v).filter(function(s){return s!=="main"}).forEach(function(s){for(var o=0;v[s][o];)o++;v[s].push(o),h[s][o]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",f=f+"var "+s+" = ("+S.toString().replace("ENTRY_MODULE",JSON.stringify(o))+")({"+v[s].map(function(a){return""+JSON.stringify(a)+": "+h[s][a].toString()}).join(",")+`});
`}),f=f+"new (("+S.toString().replace("ENTRY_MODULE",JSON.stringify(d))+")({"+v.main.map(function(s){return""+JSON.stringify(s)+": "+h.main[s].toString()}).join(",")+"}))(self);";var r=new window.Blob([f],{type:"text/javascript"});if(l.bare)return r;var t=window.URL||window.webkitURL||window.mozURL||window.msURL,i=t.createObjectURL(r),e=new window.Worker(i);return e.objectURL=i,e}},"./src/config.ts":function(O,C,x){x.r(C),x.d(C,"hlsDefaultConfig",function(){return p}),x.d(C,"mergeConfig",function(){return L}),x.d(C,"enableStreamingMode",function(){return y});var S=x("./src/controller/abr-controller.ts"),c=x("./src/controller/audio-stream-controller.ts"),m=x("./src/controller/audio-track-controller.ts"),M=x("./src/controller/subtitle-stream-controller.ts"),T=x("./src/controller/subtitle-track-controller.ts"),g=x("./src/controller/buffer-controller.ts"),u=x("./src/controller/timeline-controller.ts"),n=x("./src/controller/cap-level-controller.ts"),d=x("./src/controller/fps-controller.ts"),l=x("./src/controller/eme-controller.ts"),h=x("./src/controller/cmcd-controller.ts"),v=x("./src/utils/xhr-loader.ts"),f=x("./src/utils/fetch-loader.ts"),r=x("./src/utils/cues.ts"),t=x("./src/utils/mediakeys-helper.ts"),i=x("./src/utils/logger.ts");function e(){return e=Object.assign||function(E){for(var _=1;_<arguments.length;_++){var A=arguments[_];for(var I in A)Object.prototype.hasOwnProperty.call(A,I)&&(E[I]=A[I])}return E},e.apply(this,arguments)}function s(E,_){var A=Object.keys(E);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(E);_&&(I=I.filter(function(b){return Object.getOwnPropertyDescriptor(E,b).enumerable})),A.push.apply(A,I)}return A}function o(E){for(var _=1;_<arguments.length;_++){var A=arguments[_]!=null?arguments[_]:{};_%2?s(Object(A),!0).forEach(function(I){a(E,I,A[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(A)):s(Object(A)).forEach(function(I){Object.defineProperty(E,I,Object.getOwnPropertyDescriptor(A,I))})}return E}function a(E,_,A){return _ in E?Object.defineProperty(E,_,{value:A,enumerable:!0,configurable:!0,writable:!0}):E[_]=A,E}var p=o(o({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:v.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:S.default,bufferController:g.default,capLevelController:n.default,fpsController:d.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:t.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},D()),{},{subtitleStreamController:M.SubtitleStreamController,subtitleTrackController:T.default,timelineController:u.TimelineController,audioStreamController:c.default,audioTrackController:m.default,emeController:l.default,cmcdController:h.default});function D(){return{cueHandler:r.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function L(E,_){if((_.liveSyncDurationCount||_.liveMaxLatencyDurationCount)&&(_.liveSyncDuration||_.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(_.liveMaxLatencyDurationCount!==void 0&&(_.liveSyncDurationCount===void 0||_.liveMaxLatencyDurationCount<=_.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(_.liveMaxLatencyDuration!==void 0&&(_.liveSyncDuration===void 0||_.liveMaxLatencyDuration<=_.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return e({},E,_)}function y(E){var _=E.loader;if(_!==f.default&&_!==v.default)i.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),E.progressive=!1;else{var A=Object(f.fetchSupported)();A&&(E.loader=f.default,E.progressive=!0,E.enableSoftwareAES=!0,i.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),c=x("./src/utils/ewma-bandwidth-estimator.ts"),m=x("./src/events.ts"),M=x("./src/utils/buffer-helper.ts"),T=x("./src/errors.ts"),g=x("./src/types/loader.ts"),u=x("./src/utils/logger.ts");function n(h,v){for(var f=0;f<v.length;f++){var r=v[f];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(h,r.key,r)}}function d(h,v,f){return v&&n(h.prototype,v),f&&n(h,f),h}var l=function(){function h(f){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=f;var r=f.config;this.bwEstimator=new c.default(r.abrEwmaSlowVoD,r.abrEwmaFastVoD,r.abrEwmaDefaultEstimate),this.registerListeners()}var v=h.prototype;return v.registerListeners=function(){var r=this.hls;r.on(m.Events.FRAG_LOADING,this.onFragLoading,this),r.on(m.Events.FRAG_LOADED,this.onFragLoaded,this),r.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),r.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),r.on(m.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){var r=this.hls;r.off(m.Events.FRAG_LOADING,this.onFragLoading,this),r.off(m.Events.FRAG_LOADED,this.onFragLoaded,this),r.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),r.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),r.off(m.Events.ERROR,this.onError,this)},v.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},v.onFragLoading=function(r,t){var i=t.frag;if(i.type===g.PlaylistLevelType.MAIN&&!this.timer){var e;this.fragCurrent=i,this.partCurrent=(e=t.part)!=null?e:null,this.timer=self.setInterval(this.onCheck,100)}},v.onLevelLoaded=function(r,t){var i=this.hls.config;t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)},v._abandonRulesCheck=function(){var r=this.fragCurrent,t=this.partCurrent,i=this.hls,e=i.autoLevelEnabled,s=i.config,o=i.media;if(!(!r||!o)){var a=t?t.stats:r.stats,p=t?t.duration:r.duration;if(a.aborted){u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!e||o.paused||!o.playbackRate||!o.readyState)){var D=performance.now()-a.loading.start,L=Math.abs(o.playbackRate);if(!(D<=500*p/L)){var y=i.levels,E=i.minAutoLevel,_=y[r.level],A=a.total||Math.max(a.loaded,Math.round(p*_.maxBitrate/8)),I=Math.max(1,a.bwEstimate?a.bwEstimate/8:a.loaded*1e3/D),b=(A-a.loaded)/I,R=o.currentTime,P=(M.BufferHelper.bufferInfo(o,R,s.maxBufferHole).end-R)/L;if(!(P>=2*p/L||b<=P)){var w=Number.POSITIVE_INFINITY,F;for(F=r.level-1;F>E;F--){var k=y[F].maxBitrate;if(w=p*k/(8*.8*I),w<P)break}if(!(w>=b)){var B=this.bwEstimator.getEstimate();u.logger.warn("Fragment "+r.sn+(t?" part "+t.index:"")+" of level "+r.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+F+`
      Current BW estimate: `+(Object(S.isFiniteNumber)(B)?(B/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+b.toFixed(3)+` s
      Estimated load time for the next fragment: `+w.toFixed(3)+` s
      Time to underbuffer: `+P.toFixed(3)+" s"),i.nextLoadLevel=F,this.bwEstimator.sample(D,a.loaded),this.clearTimer(),r.loader&&(this.fragCurrent=this.partCurrent=null,r.loader.abort()),i.trigger(m.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:t,stats:a})}}}}}},v.onFragLoaded=function(r,t){var i=t.frag,e=t.part;if(i.type===g.PlaylistLevelType.MAIN&&Object(S.isFiniteNumber)(i.sn)){var s=e?e.stats:i.stats,o=e?e.duration:i.duration;if(this.clearTimer(),this.lastLoadedFragLevel=i.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[i.level],p=(a.loaded?a.loaded.bytes:0)+s.loaded,D=(a.loaded?a.loaded.duration:0)+o;a.loaded={bytes:p,duration:D},a.realBitrate=Math.round(8*p/D)}if(i.bitrateTest){var L={stats:s,frag:i,part:e,id:i.type};this.onFragBuffered(m.Events.FRAG_BUFFERED,L),i.bitrateTest=!1}}},v.onFragBuffered=function(r,t){var i=t.frag,e=t.part,s=e?e.stats:i.stats;if(!s.aborted&&!(i.type!==g.PlaylistLevelType.MAIN||i.sn==="initSegment")){var o=s.parsing.end-s.loading.start;this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}},v.onError=function(r,t){switch(t.details){case T.ErrorDetails.FRAG_LOAD_ERROR:case T.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},v.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},v.getNextABRAutoLevel=function(){var r=this.fragCurrent,t=this.partCurrent,i=this.hls,e=i.maxAutoLevel,s=i.config,o=i.minAutoLevel,a=i.media,p=t?t.duration:r?r.duration:0,D=a?a.currentTime:0,L=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,y=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,E=(M.BufferHelper.bufferInfo(a,D,s.maxBufferHole).end-D)/L,_=this.findBestLevel(y,o,e,E,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(_>=0)return _;u.logger.trace((E?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var A=p?Math.min(p,s.maxStarvationDelay):s.maxStarvationDelay,I=s.abrBandWidthFactor,b=s.abrBandWidthUpFactor;if(!E){var R=this.bitrateTestDelay;if(R){var P=p?Math.min(p,s.maxLoadingDelay):s.maxLoadingDelay;A=P-R,u.logger.trace("bitrate test took "+Math.round(1e3*R)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*A)+" ms"),I=b=1}}return _=this.findBestLevel(y,o,e,E+A,I,b),Math.max(_,0)},v.findBestLevel=function(r,t,i,e,s,o){for(var a,p=this.fragCurrent,D=this.partCurrent,L=this.lastLoadedFragLevel,y=this.hls.levels,E=y[L],_=!!(E!=null&&(a=E.details)!==null&&a!==void 0&&a.live),A=E==null?void 0:E.codecSet,I=D?D.duration:p?p.duration:0,b=i;b>=t;b--){var R=y[b];if(!(!R||A&&R.codecSet!==A)){var P=R.details,w=(D?P==null?void 0:P.partTarget:P==null?void 0:P.averagetargetduration)||I,F=void 0;b<=L?F=s*r:F=o*r;var k=y[b].maxBitrate,B=k*w/F;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+b+"/"+Math.round(F)+"/"+k+"/"+w+"/"+e+"/"+B),F>k&&(!B||_&&!this.bitrateTestDelay||B<e))return b}}return-1},d(h,[{key:"nextAutoLevel",get:function(){var r=this._nextAutoLevel,t=this.bwEstimator;if(r!==-1&&(!t||!t.canEstimate()))return r;var i=this.getNextABRAutoLevel();return r!==-1&&(i=Math.min(r,i)),i},set:function(r){this._nextAutoLevel=r}}]),h}();C.default=l},"./src/controller/audio-stream-controller.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),c=x("./src/controller/base-stream-controller.ts"),m=x("./src/events.ts"),M=x("./src/utils/buffer-helper.ts"),T=x("./src/controller/fragment-tracker.ts"),g=x("./src/types/level.ts"),u=x("./src/types/loader.ts"),n=x("./src/loader/fragment.ts"),d=x("./src/demux/chunk-cache.ts"),l=x("./src/demux/transmuxer-interface.ts"),h=x("./src/types/transmuxer.ts"),v=x("./src/controller/fragment-finders.ts"),f=x("./src/utils/discontinuities.ts"),r=x("./src/errors.ts"),t=x("./src/utils/logger.ts");function i(){return i=Object.assign||function(p){for(var D=1;D<arguments.length;D++){var L=arguments[D];for(var y in L)Object.prototype.hasOwnProperty.call(L,y)&&(p[y]=L[y])}return p},i.apply(this,arguments)}function e(p,D){p.prototype=Object.create(D.prototype),p.prototype.constructor=p,s(p,D)}function s(p,D){return s=Object.setPrototypeOf||function(y,E){return y.__proto__=E,y},s(p,D)}var o=100,a=function(p){e(D,p);function D(y,E){var _;return _=p.call(this,y,E,"[audio-stream-controller]")||this,_.videoBuffer=null,_.videoTrackCC=-1,_.waitingVideoCC=-1,_.audioSwitch=!1,_.trackId=-1,_.waitingData=null,_.mainDetails=null,_.bufferFlushed=!1,_._registerListeners(),_}var L=D.prototype;return L.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},L._registerListeners=function(){var E=this.hls;E.on(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.on(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.on(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.on(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.on(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.on(m.Events.ERROR,this.onError,this),E.on(m.Events.BUFFER_RESET,this.onBufferReset,this),E.on(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.on(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.on(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L._unregisterListeners=function(){var E=this.hls;E.off(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.off(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.off(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.off(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.off(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.off(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.off(m.Events.ERROR,this.onError,this),E.off(m.Events.BUFFER_RESET,this.onBufferReset,this),E.off(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.off(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.off(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L.onInitPtsFound=function(E,_){var A=_.frag,I=_.id,b=_.initPTS;if(I==="main"){var R=A.cc;this.initPTS[A.cc]=b,this.log("InitPTS for cc: "+R+" found from main: "+b),this.videoTrackCC=R,this.state===c.State.WAITING_INIT_PTS&&this.tick()}},L.startLoad=function(E){if(!this.levels){this.startPosition=E,this.state=c.State.STOPPED;return}var _=this.lastCurrentTime;this.stopLoad(),this.setInterval(o),this.fragLoadError=0,_>0&&E===-1?(this.log("Override startPosition with lastCurrentTime @"+_.toFixed(3)),this.state=c.State.IDLE):(this.loadedmetadata=!1,this.state=c.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=E,this.tick()},L.doTick=function(){switch(this.state){case c.State.IDLE:this.doTickIdle();break;case c.State.WAITING_TRACK:{var E,_=this.levels,A=this.trackId,I=_==null||(E=_[A])===null||E===void 0?void 0:E.details;if(I){if(this.waitForCdnTuneIn(I))break;this.state=c.State.WAITING_INIT_PTS}break}case c.State.FRAG_LOADING_WAITING_RETRY:{var b,R=performance.now(),P=this.retryDate;(!P||R>=P||(b=this.media)!==null&&b!==void 0&&b.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=c.State.IDLE);break}case c.State.WAITING_INIT_PTS:{var w=this.waitingData;if(w){var F=w.frag,k=w.part,B=w.cache,U=w.complete;if(this.initPTS[F.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=c.State.FRAG_LOADING;var j=B.flush(),K={frag:F,part:k,payload:j,networkDetails:null};this._handleFragmentLoadProgress(K),U&&p.prototype._handleFragmentLoadComplete.call(this,K)}else if(this.videoTrackCC!==this.waitingVideoCC)t.logger.log("Waiting fragment cc ("+F.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var N=this.getLoadPosition(),Z=M.BufferHelper.bufferInfo(this.mediaBuffer,N,this.config.maxBufferHole),$=Object(v.fragmentWithinToleranceTest)(Z.end,this.config.maxFragLookUpTolerance,F);$<0&&(t.logger.log("Waiting fragment cc ("+F.cc+") @ "+F.start+" cancelled because another fragment at "+Z.end+" is needed"),this.clearWaitingFragment())}}else this.state=c.State.IDLE}}this.onTickEnd()},L.clearWaitingFragment=function(){var E=this.waitingData;E&&(this.fragmentTracker.removeFragment(E.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=c.State.IDLE)},L.onTickEnd=function(){var E=this.media;if(!(!E||!E.readyState)){var _=this.mediaBuffer?this.mediaBuffer:E,A=_.buffered;!this.loadedmetadata&&A.length&&(this.loadedmetadata=!0),this.lastCurrentTime=E.currentTime}},L.doTickIdle=function(){var E,_,A=this.hls,I=this.levels,b=this.media,R=this.trackId,P=A.config;if(!(!I||!I[R])&&!(!b&&(this.startFragRequested||!P.startFragPrefetch))){var w=I[R],F=w.details;if(!F||F.live&&this.levelLastLoaded!==R||this.waitForCdnTuneIn(F)){this.state=c.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,n.ElementaryStreamTypes.AUDIO,u.PlaylistLevelType.AUDIO));var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,u.PlaylistLevelType.AUDIO);if(k!==null){var B=k.len,U=this.getMaxBufferLength(),j=this.audioSwitch;if(!(B>=U&&!j)){if(!j&&this._streamEnded(k,F)){A.trigger(m.Events.BUFFER_EOS,{type:"audio"}),this.state=c.State.ENDED;return}var K=F.fragments,N=K[0].start,Z=k.end;if(j){var $=this.getLoadPosition();Z=$,F.PTSKnown&&$<N&&(k.end>N||k.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),b.currentTime=N+.05)}var Y=this.getNextFragment(Z,F);if(!Y){this.bufferFlushed=!0;return}((E=Y.decryptdata)===null||E===void 0?void 0:E.keyFormat)==="identity"&&!((_=Y.decryptdata)!==null&&_!==void 0&&_.key)?this.loadKey(Y,F):this.loadFragment(Y,F,Z)}}}},L.getMaxBufferLength=function(){var E=p.prototype.getMaxBufferLength.call(this),_=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,u.PlaylistLevelType.MAIN);return _===null?E:Math.max(E,_.len)},L.onMediaDetaching=function(){this.videoBuffer=null,p.prototype.onMediaDetaching.call(this)},L.onAudioTracksUpdated=function(E,_){var A=_.audioTracks;this.resetTransmuxer(),this.levels=A.map(function(I){return new g.Level(I)})},L.onAudioTrackSwitching=function(E,_){var A=!!_.url;this.trackId=_.id;var I=this.fragCurrent;I!=null&&I.loader&&I.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),A?this.setInterval(o):this.resetTransmuxer(),A?(this.audioSwitch=!0,this.state=c.State.IDLE):this.state=c.State.STOPPED,this.tick()},L.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},L.onLevelLoaded=function(E,_){this.mainDetails=_.details},L.onAudioTrackLoaded=function(E,_){var A,I=this.levels,b=_.details,R=_.id;if(!I){this.warn("Audio tracks were reset while loading level "+R);return}this.log("Track "+R+" loaded ["+b.startSN+","+b.endSN+"],duration:"+b.totalduration);var P=I[R],w=0;if(b.live||(A=P.details)!==null&&A!==void 0&&A.live){var F=this.mainDetails;if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed||!F)return;!P.details&&b.hasProgramDateTime&&F.hasProgramDateTime?(Object(f.alignMediaPlaylistByPDT)(b,F),w=b.fragments[0].start):w=this.alignPlaylists(b,P.details)}P.details=b,this.levelLastLoaded=R,!this.startFragRequested&&(this.mainDetails||!b.live)&&this.setStartPosition(P.details,w),this.state===c.State.WAITING_TRACK&&!this.waitForCdnTuneIn(b)&&(this.state=c.State.IDLE),this.tick()},L._handleFragmentLoadProgress=function(E){var _,A=E.frag,I=E.part,b=E.payload,R=this.config,P=this.trackId,w=this.levels;if(!w){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+A.sn+" of level "+A.level+" will not be buffered");return}var F=w[P];console.assert(F,"Audio track is defined on fragment load progress");var k=F.details;console.assert(k,"Audio track details are defined on fragment load progress");var B=R.defaultAudioCodec||F.audioCodec||"mp4a.40.2",U=this.transmuxer;U||(U=this.transmuxer=new l.default(this.hls,u.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var j=this.initPTS[A.cc],K=(_=A.initSegment)===null||_===void 0?void 0:_.data;if(j!==void 0){var N=!1,Z=I?I.index:-1,$=Z!==-1,Y=new h.ChunkMetadata(A.level,A.sn,A.stats.chunkCount,b.byteLength,Z,$);U.push(b,K,B,"",A,I,k.totalduration,N,Y,j)}else{t.logger.log("Unknown video PTS for cc "+A.cc+", waiting for video PTS before demuxing audio frag "+A.sn+" of ["+k.startSN+" ,"+k.endSN+"],track "+P);var ee=this.waitingData=this.waitingData||{frag:A,part:I,cache:new d.default,complete:!1},Q=ee.cache;Q.push(new Uint8Array(b)),this.waitingVideoCC=this.videoTrackCC,this.state=c.State.WAITING_INIT_PTS}},L._handleFragmentLoadComplete=function(E){if(this.waitingData){this.waitingData.complete=!0;return}p.prototype._handleFragmentLoadComplete.call(this,E)},L.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},L.onBufferCreated=function(E,_){var A=_.tracks.audio;A&&(this.mediaBuffer=A.buffer),_.tracks.video&&(this.videoBuffer=_.tracks.video.buffer)},L.onFragBuffered=function(E,_){var A=_.frag,I=_.part;if(A.type===u.PlaylistLevelType.AUDIO){if(this.fragContextChanged(A)){this.warn("Fragment "+A.sn+(I?" p: "+I.index:"")+" of level "+A.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}A.sn!=="initSegment"&&(this.fragPrevious=A,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(A,I)}},L.onError=function(E,_){switch(_.details){case r.ErrorDetails.FRAG_LOAD_ERROR:case r.ErrorDetails.FRAG_LOAD_TIMEOUT:case r.ErrorDetails.KEY_LOAD_ERROR:case r.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.AUDIO,_);break;case r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==c.State.ERROR&&this.state!==c.State.STOPPED&&(this.state=_.fatal?c.State.ERROR:c.State.IDLE,this.warn(_.details+" while loading frag, switching to "+this.state+" state"));break;case r.ErrorDetails.BUFFER_FULL_ERROR:if(_.parent==="audio"&&(this.state===c.State.PARSING||this.state===c.State.PARSED)){var A=!0,I=this.getFwdBufferInfo(this.mediaBuffer,u.PlaylistLevelType.AUDIO);I&&I.len>.5&&(A=!this.reduceMaxBufferLength(I.len)),A&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,p.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},L.onBufferFlushed=function(E,_){var A=_.type;A===n.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},L._handleTransmuxComplete=function(E){var _,A="audio",I=this.hls,b=E.remuxResult,R=E.chunkMeta,P=this.getCurrentContext(R);if(!P){this.warn("The loading context changed while buffering fragment "+R.sn+" of level "+R.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(R.level);return}var w=P.frag,F=P.part,k=b.audio,B=b.text,U=b.id3,j=b.initSegment;if(!this.fragContextChanged(w)){if(this.state=c.State.PARSING,this.audioSwitch&&k&&this.completeAudioSwitch(),j!=null&&j.tracks&&(this._bufferInitSegment(j.tracks,w,R),I.trigger(m.Events.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:A,tracks:j.tracks})),k){var K=k.startPTS,N=k.endPTS,Z=k.startDTS,$=k.endDTS;F&&(F.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:K,endPTS:N,startDTS:Z,endDTS:$}),w.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,K,N,Z,$),this.bufferFragmentData(k,w,F,R)}if(U!=null&&(_=U.samples)!==null&&_!==void 0&&_.length){var Y=i({frag:w,id:A},U);I.trigger(m.Events.FRAG_PARSING_METADATA,Y)}if(B){var ee=i({frag:w,id:A},B);I.trigger(m.Events.FRAG_PARSING_USERDATA,ee)}}},L._bufferInitSegment=function(E,_,A){if(this.state===c.State.PARSING){E.video&&delete E.video;var I=E.audio;if(!!I){I.levelCodec=I.codec,I.id="audio",this.log("Init audio buffer, container:"+I.container+", codecs[parsed]=["+I.codec+"]"),this.hls.trigger(m.Events.BUFFER_CODECS,E);var b=I.initSegment;if(b!=null&&b.byteLength){var R={type:"audio",frag:_,part:null,chunkMeta:A,parent:_.type,data:b};this.hls.trigger(m.Events.BUFFER_APPENDING,R)}this.tick()}}},L.loadFragment=function(E,_,A){var I=this.fragmentTracker.getState(E);this.fragCurrent=E,(this.audioSwitch||I===T.FragmentState.NOT_LOADED||I===T.FragmentState.PARTIAL)&&(E.sn==="initSegment"?this._loadInitSegment(E):_.live&&!Object(S.isFiniteNumber)(this.initPTS[E.cc])?(this.log("Waiting for video PTS in continuity counter "+E.cc+" of live stream before loading audio fragment "+E.sn+" of level "+this.trackId),this.state=c.State.WAITING_INIT_PTS):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,E,_,A)))},L.completeAudioSwitch=function(){var E=this.hls,_=this.media,A=this.trackId;_&&(this.log("Switching audio track : flushing all audio"),p.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,E.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:A})},D}(c.default);C.default=a},"./src/controller/audio-track-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),c=x("./src/errors.ts"),m=x("./src/controller/base-playlist-controller.ts"),M=x("./src/types/loader.ts");function T(l,h){for(var v=0;v<h.length;v++){var f=h[v];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}function g(l,h,v){return h&&T(l.prototype,h),v&&T(l,v),l}function u(l,h){l.prototype=Object.create(h.prototype),l.prototype.constructor=l,n(l,h)}function n(l,h){return n=Object.setPrototypeOf||function(f,r){return f.__proto__=r,f},n(l,h)}var d=function(l){u(h,l);function h(f){var r;return r=l.call(this,f,"[audio-track-controller]")||this,r.tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.trackName="",r.selectDefaultTrack=!0,r.registerListeners(),r}var v=h.prototype;return v.registerListeners=function(){var r=this.hls;r.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),r.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),r.on(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),r.on(S.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),r.on(S.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){var r=this.hls;r.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),r.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),r.off(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),r.off(S.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),r.off(S.Events.ERROR,this.onError,this)},v.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,l.prototype.destroy.call(this)},v.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},v.onManifestParsed=function(r,t){this.tracks=t.audioTracks||[]},v.onAudioTrackLoaded=function(r,t){var i=t.id,e=t.details,s=this.tracksInGroup[i];if(!s){this.warn("Invalid audio track id "+i);return}var o=s.details;s.details=t.details,this.log("audioTrack "+i+" loaded ["+e.startSN+"-"+e.endSN+"]"),i===this.trackId&&(this.retryCount=0,this.playlistLoaded(i,t,o))},v.onLevelLoading=function(r,t){this.switchLevel(t.level)},v.onLevelSwitching=function(r,t){this.switchLevel(t.level)},v.switchLevel=function(r){var t=this.hls.levels[r];if(!!(t!=null&&t.audioGroupIds)){var i=t.audioGroupIds[t.urlId];if(this.groupId!==i){this.groupId=i;var e=this.tracks.filter(function(o){return!i||o.groupId===i});this.selectDefaultTrack&&!e.some(function(o){return o.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;var s={audioTracks:e};this.log("Updating audio tracks, "+e.length+' track(s) found in "'+i+'" group-id'),this.hls.trigger(S.Events.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}}},v.onError=function(r,t){l.prototype.onError.call(this,r,t),!(t.fatal||!t.context)&&t.context.type===M.PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.retryLoadingOrFail(t)},v.setAudioTrack=function(r){var t=this.tracksInGroup;if(r<0||r>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var i=t[this.trackId];this.log("Now switching to audio-track index "+r);var e=t[r],s=e.id,o=e.groupId,a=o===void 0?"":o,p=e.name,D=e.type,L=e.url;if(this.trackId=r,this.trackName=p,this.selectDefaultTrack=!1,this.hls.trigger(S.Events.AUDIO_TRACK_SWITCHING,{id:s,groupId:a,name:p,type:D,url:L}),!(e.details&&!e.details.live)){var y=this.switchParams(e.url,i==null?void 0:i.details);this.loadPlaylist(y)}},v.selectInitialTrack=function(){var r=this.tracksInGroup;console.assert(r.length,"Initial audio track should be selected when tracks are known");var t=this.trackName,i=this.findTrackId(t)||this.findTrackId();i!==-1?this.setAudioTrack(i):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},v.findTrackId=function(r){for(var t=this.tracksInGroup,i=0;i<t.length;i++){var e=t[i];if((!this.selectDefaultTrack||e.default)&&(!r||r===e.name))return e.id}return-1},v.loadPlaylist=function(r){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var i=t.id,e=t.groupId,s=t.url;if(r)try{s=r.addDirectives(s)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("loading audio-track playlist for id: "+i),this.clearTimer(),this.hls.trigger(S.Events.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:e,deliveryDirectives:r||null})}},g(h,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(r){this.selectDefaultTrack=!1,this.setAudioTrack(r)}}]),h}(m.default);C.default=d},"./src/controller/base-playlist-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return g});var S=x("./src/polyfills/number.ts"),c=x("./src/types/level.ts"),m=x("./src/controller/level-helper.ts"),M=x("./src/utils/logger.ts"),T=x("./src/errors.ts"),g=function(){function u(d,l){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=M.logger.log.bind(M.logger,l+":"),this.warn=M.logger.warn.bind(M.logger,l+":"),this.hls=d}var n=u.prototype;return n.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},n.onError=function(l,h){h.fatal&&h.type===T.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},n.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},n.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},n.stopLoad=function(){this.canLoad=!1,this.clearTimer()},n.switchParams=function(l,h){var v=h==null?void 0:h.renditionReports;if(v)for(var f=0;f<v.length;f++){var r=v[f],t=""+r.URI;if(t===l.substr(-t.length)){var i=parseInt(r["LAST-MSN"]),e=parseInt(r["LAST-PART"]);if(h&&this.hls.config.lowLatencyMode){var s=Math.min(h.age-h.partTarget,h.targetduration);e!==void 0&&s>h.partTarget&&(e+=1)}if(Object(S.isFiniteNumber)(i))return new c.HlsUrlParameters(i,Object(S.isFiniteNumber)(e)?e:void 0,c.HlsSkip.No)}}},n.loadPlaylist=function(l){},n.shouldLoadTrack=function(l){return this.canLoad&&l&&!!l.url&&(!l.details||l.details.live)},n.playlistLoaded=function(l,h,v){var f=this,r=h.details,t=h.stats,i=t.loading.end?Math.max(0,self.performance.now()-t.loading.end):0;if(r.advancedDateTime=Date.now()-i,r.live||v!=null&&v.live){if(r.reloaded(v),v&&this.log("live playlist "+l+" "+(r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:"MISSED")),v&&r.fragments.length>0&&Object(m.mergeDetails)(v,r),!this.canLoad||!r.live)return;var e,s=void 0,o=void 0;if(r.canBlockReload&&r.endSN&&r.advanced){var a=this.hls.config.lowLatencyMode,p=r.lastPartSn,D=r.endSN,L=r.lastPartIndex,y=L!==-1,E=p===D,_=a?0:L;y?(s=E?D+1:p,o=E?_:L+1):s=D+1;var A=r.age,I=A+r.ageHeader,b=Math.min(I-r.partTarget,r.targetduration*1.5);if(b>0){if(v&&b>v.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+v.tuneInGoal+" to: "+b+" with playlist age: "+r.age),b=0;else{var R=Math.floor(b/r.targetduration);if(s+=R,o!==void 0){var P=Math.round(b%r.targetduration/r.partTarget);o+=P}this.log("CDN Tune-in age: "+r.ageHeader+"s last advanced "+A.toFixed(2)+"s goal: "+b+" skip sn "+R+" to part "+o)}r.tuneInGoal=b}if(e=this.getDeliveryDirectives(r,h.deliveryDirectives,s,o),a||!E){this.loadPlaylist(e);return}}else e=this.getDeliveryDirectives(r,h.deliveryDirectives,s,o);var w=Object(m.computeReloadInterval)(r,t);s!==void 0&&r.canBlockReload&&(w-=r.partTarget||1),this.log("reload live playlist "+l+" in "+Math.round(w)+" ms"),this.timer=self.setTimeout(function(){return f.loadPlaylist(e)},w)}else this.clearTimer()},n.getDeliveryDirectives=function(l,h,v,f){var r=Object(c.getSkipValue)(l,v);return h!=null&&h.skip&&l.deltaUpdateFailed&&(v=h.msn,f=h.part,r=c.HlsSkip.No),new c.HlsUrlParameters(v,f,r)},n.retryLoadingOrFail=function(l){var h=this,v=this.hls.config,f=this.retryCount<v.levelLoadingMaxRetry;if(f){var r;if(this.retryCount++,l.details.indexOf("LoadTimeOut")>-1&&(r=l.context)!==null&&r!==void 0&&r.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+l.details+'"'),this.loadPlaylist();else{var t=Math.min(Math.pow(2,this.retryCount)*v.levelLoadingRetryDelay,v.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return h.loadPlaylist()},t),this.warn("retry playlist loading #"+this.retryCount+" in "+t+' ms after "'+l.details+'"')}}else this.warn('cannot recover from error "'+l.details+'"'),this.clearTimer(),l.fatal=!0;return f},u}()},"./src/controller/base-stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"State",function(){return D}),x.d(C,"default",function(){return L});var S=x("./src/polyfills/number.ts"),c=x("./src/task-loop.ts"),m=x("./src/controller/fragment-tracker.ts"),M=x("./src/utils/buffer-helper.ts"),T=x("./src/utils/logger.ts"),g=x("./src/events.ts"),u=x("./src/errors.ts"),n=x("./src/types/transmuxer.ts"),d=x("./src/utils/mp4-tools.ts"),l=x("./src/utils/discontinuities.ts"),h=x("./src/controller/fragment-finders.ts"),v=x("./src/controller/level-helper.ts"),f=x("./src/loader/fragment-loader.ts"),r=x("./src/crypt/decrypter.ts"),t=x("./src/utils/time-ranges.ts"),i=x("./src/types/loader.ts");function e(y,E){for(var _=0;_<E.length;_++){var A=E[_];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(y,A.key,A)}}function s(y,E,_){return E&&e(y.prototype,E),_&&e(y,_),y}function o(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function a(y,E){y.prototype=Object.create(E.prototype),y.prototype.constructor=y,p(y,E)}function p(y,E){return p=Object.setPrototypeOf||function(A,I){return A.__proto__=I,A},p(y,E)}var D={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},L=function(y){a(E,y);function E(A,I,b){var R;return R=y.call(this)||this,R.hls=void 0,R.fragPrevious=null,R.fragCurrent=null,R.fragmentTracker=void 0,R.transmuxer=null,R._state=D.STOPPED,R.media=void 0,R.mediaBuffer=void 0,R.config=void 0,R.bitrateTest=!1,R.lastCurrentTime=0,R.nextLoadPosition=0,R.startPosition=0,R.loadedmetadata=!1,R.fragLoadError=0,R.retryDate=0,R.levels=null,R.fragmentLoader=void 0,R.levelLastLoaded=null,R.startFragRequested=!1,R.decrypter=void 0,R.initPTS=[],R.onvseeking=null,R.onvended=null,R.logPrefix="",R.log=void 0,R.warn=void 0,R.logPrefix=b,R.log=T.logger.log.bind(T.logger,b+":"),R.warn=T.logger.warn.bind(T.logger,b+":"),R.hls=A,R.fragmentLoader=new f.default(A.config),R.fragmentTracker=I,R.config=A.config,R.decrypter=new r.default(A,A.config),A.on(g.Events.KEY_LOADED,R.onKeyLoaded,o(R)),R}var _=E.prototype;return _.doTick=function(){this.onTickEnd()},_.onTickEnd=function(){},_.startLoad=function(I){},_.stopLoad=function(){this.fragmentLoader.abort();var I=this.fragCurrent;I&&this.fragmentTracker.removeFragment(I),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=D.STOPPED},_._streamEnded=function(I,b){var R=this.fragCurrent,P=this.fragmentTracker;if(!b.live&&R&&R.sn>=b.endSN&&!I.nextStart){var w=b.partList;if(w!=null&&w.length){var F=w[w.length-1],k=M.BufferHelper.isBuffered(this.media,F.start+F.duration/2);return k}var B=P.getState(R);return B===m.FragmentState.PARTIAL||B===m.FragmentState.OK}return!1},_.onMediaAttached=function(I,b){var R=this.media=this.mediaBuffer=b.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),R.addEventListener("seeking",this.onvseeking),R.addEventListener("ended",this.onvended);var P=this.config;this.levels&&P.autoStartLoad&&this.state===D.STOPPED&&this.startLoad(P.startPosition)},_.onMediaDetaching=function(){var I=this.media;I!=null&&I.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),I&&(I.removeEventListener("seeking",this.onvseeking),I.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},_.onMediaSeeking=function(){var I=this.config,b=this.fragCurrent,R=this.media,P=this.mediaBuffer,w=this.state,F=R?R.currentTime:0,k=M.BufferHelper.bufferInfo(P||R,F,I.maxBufferHole);if(this.log("media seeking to "+(Object(S.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+w),w===D.ENDED)this.resetLoadingState();else if(b&&!k.len){var B=I.maxFragLookUpTolerance,U=b.start-B,j=b.start+b.duration+B,K=F>j;(F<U||K)&&(K&&b.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),b.loader.abort()),this.resetLoadingState())}R&&(this.lastCurrentTime=F),!this.loadedmetadata&&!k.len&&(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},_.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},_.onKeyLoaded=function(I,b){if(!(this.state!==D.KEY_LOADING||b.frag!==this.fragCurrent||!this.levels)){this.state=D.IDLE;var R=this.levels[b.frag.level].details;R&&this.loadFragment(b.frag,R,b.frag.start)}},_.onHandlerDestroying=function(){this.stopLoad(),y.prototype.onHandlerDestroying.call(this)},_.onHandlerDestroyed=function(){this.state=D.STOPPED,this.hls.off(g.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,y.prototype.onHandlerDestroyed.call(this)},_.loadKey=function(I,b){this.log("Loading key for "+I.sn+" of ["+b.startSN+"-"+b.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level),this.state=D.KEY_LOADING,this.fragCurrent=I,this.hls.trigger(g.Events.KEY_LOADING,{frag:I})},_.loadFragment=function(I,b,R){this._loadFragForPlayback(I,b,R)},_._loadFragForPlayback=function(I,b,R){var P=this,w=function(k){if(P.fragContextChanged(I)){P.warn("Fragment "+I.sn+(k.part?" p: "+k.part.index:"")+" of level "+I.level+" was dropped during download."),P.fragmentTracker.removeFragment(I);return}I.stats.chunkCount++,P._handleFragmentLoadProgress(k)};this._doFragLoad(I,b,R,w).then(function(F){if(!!F){P.fragLoadError=0;var k=P.state;if(P.fragContextChanged(I)){(k===D.FRAG_LOADING||k===D.BACKTRACKING||!P.fragCurrent&&k===D.PARSING)&&(P.fragmentTracker.removeFragment(I),P.state=D.IDLE);return}if("payload"in F&&(P.log("Loaded fragment "+I.sn+" of level "+I.level),P.hls.trigger(g.Events.FRAG_LOADED,F),P.state===D.BACKTRACKING)){P.fragmentTracker.backtrack(I,F),P.resetFragmentLoading(I);return}P._handleFragmentLoadComplete(F)}}).catch(function(F){P.warn(F),P.resetFragmentLoading(I)})},_.flushMainBuffer=function(I,b,R){if(R===void 0&&(R=null),!!(I-b)){var P={startOffset:I,endOffset:b,type:R};this.fragLoadError=0,this.hls.trigger(g.Events.BUFFER_FLUSHING,P)}},_._loadInitSegment=function(I){var b=this;this._doFragLoad(I).then(function(R){if(!R||b.fragContextChanged(I)||!b.levels)throw new Error("init load aborted");return R}).then(function(R){var P=b.hls,w=R.payload,F=I.decryptdata;if(w&&w.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var k=self.performance.now();return b.decrypter.webCryptoDecrypt(new Uint8Array(w),F.key.buffer,F.iv.buffer).then(function(B){var U=self.performance.now();return P.trigger(g.Events.FRAG_DECRYPTED,{frag:I,payload:B,stats:{tstart:k,tdecrypt:U}}),R.payload=B,R})}return R}).then(function(R){var P=b.fragCurrent,w=b.hls,F=b.levels;if(!F)throw new Error("init load aborted, missing levels");var k=F[I.level].details;console.assert(k,"Level details are defined when init segment is loaded");var B=I.stats;b.state=D.IDLE,b.fragLoadError=0,I.data=new Uint8Array(R.payload),B.parsing.start=B.buffering.start=self.performance.now(),B.parsing.end=B.buffering.end=self.performance.now(),R.frag===P&&w.trigger(g.Events.FRAG_BUFFERED,{stats:B,frag:P,part:null,id:I.type}),b.tick()}).catch(function(R){b.warn(R),b.resetFragmentLoading(I)})},_.fragContextChanged=function(I){var b=this.fragCurrent;return!I||!b||I.level!==b.level||I.sn!==b.sn||I.urlId!==b.urlId},_.fragBufferedComplete=function(I,b){var R=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+I.type+" sn: "+I.sn+(b?" part: "+b.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level+" "+t.default.toString(M.BufferHelper.getBuffered(R))),this.state=D.IDLE,this.tick()},_._handleFragmentLoadComplete=function(I){var b=this.transmuxer;if(!!b){var R=I.frag,P=I.part,w=I.partsLoaded,F=!w||w.length===0||w.some(function(B){return!B}),k=new n.ChunkMetadata(R.level,R.sn,R.stats.chunkCount+1,0,P?P.index:-1,!F);b.flush(k)}},_._handleFragmentLoadProgress=function(I){},_._doFragLoad=function(I,b,R,P){var w=this;if(R===void 0&&(R=null),!this.levels)throw new Error("frag load aborted, missing levels");if(R=Math.max(I.start,R||0),this.config.lowLatencyMode&&b){var F=b.partList;if(F&&P){R>I.end&&b.fragmentHint&&(I=b.fragmentHint);var k=this.getNextPart(F,I,R);if(k>-1){var B=F[k];return this.log("Loading part sn: "+I.sn+" p: "+B.index+" cc: "+I.cc+" of playlist ["+b.startSN+"-"+b.endSN+"] parts [0-"+k+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),this.nextLoadPosition=B.start+B.duration,this.state=D.FRAG_LOADING,this.hls.trigger(g.Events.FRAG_LOADING,{frag:I,part:F[k],targetBufferTime:R}),this.doFragPartsLoad(I,F,k,P).catch(function(U){return w.handleFragLoadError(U)})}else if(!I.url||this.loadedEndOfParts(F,R))return Promise.resolve(null)}}return this.log("Loading fragment "+I.sn+" cc: "+I.cc+" "+(b?"of ["+b.startSN+"-"+b.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),Object(S.isFiniteNumber)(I.sn)&&!this.bitrateTest&&(this.nextLoadPosition=I.start+I.duration),this.state=D.FRAG_LOADING,this.hls.trigger(g.Events.FRAG_LOADING,{frag:I,targetBufferTime:R}),this.fragmentLoader.load(I,P).catch(function(U){return w.handleFragLoadError(U)})},_.doFragPartsLoad=function(I,b,R,P){var w=this;return new Promise(function(F,k){var B=[],U=function j(K){var N=b[K];w.fragmentLoader.loadPart(I,N,P).then(function(Z){B[N.index]=Z;var $=Z.part;w.hls.trigger(g.Events.FRAG_LOADED,Z);var Y=b[K+1];if(Y&&Y.fragment===I)j(K+1);else return F({frag:I,part:$,partsLoaded:B})}).catch(k)};U(R)})},_.handleFragLoadError=function(I){var b=I.data;return b&&b.details===u.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(b.frag,b.part):this.hls.trigger(g.Events.ERROR,b),null},_._handleTransmuxerFlush=function(I){var b=this.getCurrentContext(I);if(!b||this.state!==D.PARSING){this.fragCurrent||(this.state=D.IDLE);return}var R=b.frag,P=b.part,w=b.level,F=self.performance.now();R.stats.parsing.end=F,P&&(P.stats.parsing.end=F),this.updateLevelTiming(R,P,w,I.partial)},_.getCurrentContext=function(I){var b=this.levels,R=I.level,P=I.sn,w=I.part;if(!b||!b[R])return this.warn("Levels object was unset while buffering fragment "+P+" of level "+R+". The current chunk will not be buffered."),null;var F=b[R],k=w>-1?Object(v.getPartWith)(F,P,w):null,B=k?k.fragment:Object(v.getFragmentWithSN)(F,P,this.fragCurrent);return B?{frag:B,part:k,level:F}:null},_.bufferFragmentData=function(I,b,R,P){if(!(!I||this.state!==D.PARSING)){var w=I.data1,F=I.data2,k=w;if(w&&F&&(k=Object(d.appendUint8Array)(w,F)),!(!k||!k.length)){var B={type:I.type,frag:b,part:R,chunkMeta:P,parent:b.type,data:k};this.hls.trigger(g.Events.BUFFER_APPENDING,B),I.dropped&&I.independent&&!R&&this.flushBufferGap(b)}}},_.flushBufferGap=function(I){var b=this.media;if(!!b){if(!M.BufferHelper.isBuffered(b,b.currentTime)){this.flushMainBuffer(0,I.start);return}var R=b.currentTime,P=M.BufferHelper.bufferInfo(b,R,0),w=I.duration,F=Math.min(this.config.maxFragLookUpTolerance*2,w*.25),k=Math.max(Math.min(I.start-F,P.end-F),R+F);I.start-k>F&&this.flushMainBuffer(k,I.start)}},_.getFwdBufferInfo=function(I,b){var R=this.config,P=this.getLoadPosition();if(!Object(S.isFiniteNumber)(P))return null;var w=M.BufferHelper.bufferInfo(I,P,R.maxBufferHole);if(w.len===0&&w.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(P,b);if(F&&w.nextStart<F.end)return M.BufferHelper.bufferInfo(I,P,Math.max(w.nextStart,R.maxBufferHole))}return w},_.getMaxBufferLength=function(I){var b=this.config,R;return I?R=Math.max(8*b.maxBufferSize/I,b.maxBufferLength):R=b.maxBufferLength,Math.min(R,b.maxMaxBufferLength)},_.reduceMaxBufferLength=function(I){var b=this.config,R=I||b.maxBufferLength;return b.maxMaxBufferLength>=R?(b.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+b.maxMaxBufferLength+"s"),!0):!1},_.getNextFragment=function(I,b){var R,P,w=b.fragments,F=w.length;if(!F)return null;var k=this.config,B=w[0].start,U;if(b.live){var j=k.initialLiveManifestSize;if(F<j)return this.warn("Not enough fragments to start playback (have: "+F+", need: "+j+")"),null;!b.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(U=this.getInitialLiveFragment(b,w),this.startPosition=U?this.hls.liveSyncPosition||U.start:I)}else I<=B&&(U=w[0]);if(!U){var K=k.lowLatencyMode?b.partEnd:b.fragmentEnd;U=this.getFragmentAtPosition(I,K,b)}return(R=U)!==null&&R!==void 0&&R.initSegment&&!((P=U)!==null&&P!==void 0&&P.initSegment.data)&&!this.bitrateTest&&(U=U.initSegment),U},_.getNextPart=function(I,b,R){for(var P=-1,w=!1,F=!0,k=0,B=I.length;k<B;k++){var U=I[k];if(F=F&&!U.independent,P>-1&&R<U.start)break;var j=U.loaded;!j&&(w||U.independent||F)&&U.fragment===b&&(P=k),w=j}return P},_.loadedEndOfParts=function(I,b){var R=I[I.length-1];return R&&b>R.start&&R.loaded},_.getInitialLiveFragment=function(I,b){var R=this.fragPrevious,P=null;if(R){if(I.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+R.programDateTime),P=Object(h.findFragmentByPDT)(b,R.endProgramDateTime,this.config.maxFragLookUpTolerance)),!P){var w=R.sn+1;if(w>=I.startSN&&w<=I.endSN){var F=b[w-I.startSN];R.cc===F.cc&&(P=F,this.log("Live playlist, switching playlist, load frag with next SN: "+P.sn))}P||(P=Object(h.findFragWithCC)(b,R.cc),P&&this.log("Live playlist, switching playlist, load frag with same CC: "+P.sn))}}else{var k=this.hls.liveSyncPosition;k!==null&&(P=this.getFragmentAtPosition(k,this.bitrateTest?I.fragmentEnd:I.edge,I))}return P},_.getFragmentAtPosition=function(I,b,R){var P=this.config,w=this.fragPrevious,F=R.fragments,k=R.endSN,B=R.fragmentHint,U=P.maxFragLookUpTolerance,j=!!(P.lowLatencyMode&&R.partList&&B);j&&B&&!this.bitrateTest&&(F=F.concat(B),k=B.sn);var K;if(I<b){var N=I>b-U?0:U;K=Object(h.findFragmentByPTS)(w,F,I,N)}else K=F[F.length-1];if(K){var Z=K.sn-R.startSN,$=w&&K.level===w.level,Y=F[Z+1],ee=this.fragmentTracker.getState(K);if(ee===m.FragmentState.BACKTRACKED){K=null;for(var Q=Z;F[Q]&&this.fragmentTracker.getState(F[Q])===m.FragmentState.BACKTRACKED;)w?K=F[Q--]:K=F[--Q];K||(K=Y)}else w&&K.sn===w.sn&&!j&&$&&(K.sn<k&&this.fragmentTracker.getState(Y)!==m.FragmentState.OK?(this.log("SN "+K.sn+" just loaded, load next one: "+Y.sn),K=Y):K=null)}return K},_.synchronizeToLiveEdge=function(I){var b=this.config,R=this.media;if(!!R){var P=this.hls.liveSyncPosition,w=R.currentTime,F=I.fragments[0].start,k=I.edge,B=w>=F-b.maxFragLookUpTolerance&&w<=k;if(P!==null&&R.duration>P&&(w<P||!B)){var U=b.liveMaxLatencyDuration!==void 0?b.liveMaxLatencyDuration:b.liveMaxLatencyDurationCount*I.targetduration;(!B&&R.readyState<4||w<k-U)&&(this.loadedmetadata||(this.nextLoadPosition=P),R.readyState&&(this.warn("Playback: "+w.toFixed(3)+" is located too far from the end of live sliding playlist: "+k+", reset currentTime to : "+P.toFixed(3)),R.currentTime=P))}}},_.alignPlaylists=function(I,b){var R=this.levels,P=this.levelLastLoaded,w=this.fragPrevious,F=P!==null?R[P]:null,k=I.fragments.length;if(!k)return this.warn("No fragments in live playlist"),0;var B=I.fragments[0].start,U=!b,j=I.alignedSliding&&Object(S.isFiniteNumber)(B);if(U||!j&&!B){Object(l.alignStream)(w,F,I);var K=I.fragments[0].start;return this.log("Live playlist sliding: "+K.toFixed(2)+" start-sn: "+(b?b.startSN:"na")+"->"+I.startSN+" prev-sn: "+(w?w.sn:"na")+" fragments: "+k),K}return B},_.waitForCdnTuneIn=function(I){var b=3;return I.live&&I.canBlockReload&&I.tuneInGoal>Math.max(I.partHoldBack,I.partTarget*b)},_.setStartPosition=function(I,b){var R=this.startPosition;if(R<b&&(R=-1),R===-1||this.lastCurrentTime===-1){var P=I.startTimeOffset;Object(S.isFiniteNumber)(P)?(R=b+P,P<0&&(R+=I.totalduration),R=Math.min(Math.max(b,R),b+I.totalduration),this.log("Start time offset "+P+" found in playlist, adjust startPosition to "+R),this.startPosition=R):I.live?R=this.hls.liveSyncPosition||b:this.startPosition=R=0,this.lastCurrentTime=R}this.nextLoadPosition=R},_.getLoadPosition=function(){var I=this.media,b=0;return this.loadedmetadata&&I?b=I.currentTime:this.nextLoadPosition&&(b=this.nextLoadPosition),b},_.handleFragLoadAborted=function(I,b){this.transmuxer&&I.sn!=="initSegment"&&I.stats.aborted&&(this.warn("Fragment "+I.sn+(b?" part"+b.index:"")+" of level "+I.level+" was aborted"),this.resetFragmentLoading(I))},_.resetFragmentLoading=function(I){(!this.fragCurrent||!this.fragContextChanged(I))&&(this.state=D.IDLE)},_.onFragmentOrKeyLoadError=function(I,b){if(!b.fatal){var R=b.frag;if(!(!R||R.type!==I)){var P=this.fragCurrent;console.assert(P&&R.sn===P.sn&&R.level===P.level&&R.urlId===P.urlId,"Frag load error must match current frag to retry");var w=this.config;if(this.fragLoadError+1<=w.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(R.level))return;var F=Math.min(Math.pow(2,this.fragLoadError)*w.fragLoadingRetryDelay,w.fragLoadingMaxRetryTimeout);this.warn("Fragment "+R.sn+" of "+I+" "+R.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=D.FRAG_LOADING_WAITING_RETRY}else b.levelRetry?(I===i.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=D.IDLE):(T.logger.error(b.details+" reaches max retry, redispatch as fatal ..."),b.fatal=!0,this.hls.stopLoad(),this.state=D.ERROR)}}},_.afterBufferFlushed=function(I,b,R){if(!!I){var P=M.BufferHelper.getBuffered(I);this.fragmentTracker.detectEvictedFragments(b,P,R),this.state===D.ENDED&&this.resetLoadingState()}},_.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=D.IDLE},_.resetLiveStartWhenNotLoaded=function(I){if(!this.loadedmetadata){this.startFragRequested=!1;var b=this.levels?this.levels[I].details:null;if(b!=null&&b.live)return this.startPosition=-1,this.setStartPosition(b,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},_.updateLevelTiming=function(I,b,R,P){var w=this,F=R.details;console.assert(!!F,"level.details must be defined");var k=Object.keys(I.elementaryStreams).reduce(function(B,U){var j=I.elementaryStreams[U];if(j){var K=j.endPTS-j.startPTS;if(K<=0)return w.warn("Could not parse fragment "+I.sn+" "+U+" duration reliably ("+K+") resetting transmuxer to fallback to playlist timing"),w.resetTransmuxer(),B||!1;var N=P?0:Object(v.updateFragPTSDTS)(F,I,j.startPTS,j.endPTS,j.startDTS,j.endDTS);return w.hls.trigger(g.Events.LEVEL_PTS_UPDATED,{details:F,level:R,drift:N,type:U,frag:I,start:j.startPTS,end:j.endPTS}),!0}return B},!1);k?(this.state=D.PARSED,this.hls.trigger(g.Events.FRAG_PARSED,{frag:I,part:b})):this.resetLoadingState()},_.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},s(E,[{key:"state",get:function(){return this._state},set:function(I){var b=this._state;b!==I&&(this._state=I,this.log(b+"->"+I))}}]),E}(c.default)},"./src/controller/buffer-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return h});var S=x("./src/polyfills/number.ts"),c=x("./src/events.ts"),m=x("./src/utils/logger.ts"),M=x("./src/errors.ts"),T=x("./src/utils/buffer-helper.ts"),g=x("./src/utils/mediasource-helper.ts"),u=x("./src/loader/fragment.ts"),n=x("./src/controller/buffer-operation-queue.ts"),d=Object(g.getMediaSource)(),l=/([ha]vc.)(?:\.[^.,]+)+/,h=function(){function v(r){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var i=t.hls,e=t.media,s=t.mediaSource;m.logger.log("[buffer-controller]: Media source opened"),e&&(t.updateMediaElementDuration(),i.trigger(c.Events.MEDIA_ATTACHED,{media:e})),s&&s.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){m.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){m.logger.log("[buffer-controller]: Media source ended")},this.hls=r,this._initSourceBuffer(),this.registerListeners()}var f=v.prototype;return f.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},f.destroy=function(){this.unregisterListeners(),this.details=null},f.registerListeners=function(){var t=this.hls;t.on(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(c.Events.BUFFER_RESET,this.onBufferReset,this),t.on(c.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(c.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(c.Events.BUFFER_EOS,this.onBufferEos,this),t.on(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(c.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(c.Events.FRAG_PARSED,this.onFragParsed,this),t.on(c.Events.FRAG_CHANGED,this.onFragChanged,this)},f.unregisterListeners=function(){var t=this.hls;t.off(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(c.Events.BUFFER_RESET,this.onBufferReset,this),t.off(c.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(c.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(c.Events.BUFFER_EOS,this.onBufferEos,this),t.off(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(c.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(c.Events.FRAG_PARSED,this.onFragParsed,this),t.off(c.Events.FRAG_CHANGED,this.onFragChanged,this)},f._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new n.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},f.onManifestParsed=function(t,i){var e=2;(i.audio&&!i.video||!i.altAudio)&&(e=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e,this.details=null,m.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},f.onMediaAttaching=function(t,i){var e=this.media=i.media;if(e&&d){var s=this.mediaSource=new d;s.addEventListener("sourceopen",this._onMediaSourceOpen),s.addEventListener("sourceended",this._onMediaSourceEnded),s.addEventListener("sourceclose",this._onMediaSourceClose),e.src=self.URL.createObjectURL(s),this._objectUrl=e.src}},f.onMediaDetaching=function(){var t=this.media,i=this.mediaSource,e=this._objectUrl;if(i){if(m.logger.log("[buffer-controller]: media source detaching"),i.readyState==="open")try{i.endOfStream()}catch(s){m.logger.warn("[buffer-controller]: onMediaDetaching: "+s.message+" while calling endOfStream")}this.onBufferReset(),i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(e&&self.URL.revokeObjectURL(e),t.src===e?(t.removeAttribute("src"),t.load()):m.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(c.Events.MEDIA_DETACHED,void 0)},f.onBufferReset=function(){var t=this;this.getSourceBufferTypes().forEach(function(i){var e=t.sourceBuffer[i];try{e&&(t.removeBufferListeners(i),t.mediaSource&&t.mediaSource.removeSourceBuffer(e),t.sourceBuffer[i]=void 0)}catch(s){m.logger.warn("[buffer-controller]: Failed to reset the "+i+" buffer",s)}}),this._initSourceBuffer()},f.onBufferCodecs=function(t,i){var e=this,s=this.getSourceBufferTypes().length;Object.keys(i).forEach(function(o){if(s){var a=e.tracks[o];if(a&&typeof a.buffer.changeType=="function"){var p=i[o],D=p.codec,L=p.levelCodec,y=p.container,E=(a.levelCodec||a.codec).replace(l,"$1"),_=(L||D).replace(l,"$1");if(E!==_){var A=y+";codecs="+(L||D);e.appendChangeType(o,A)}}}else e.pendingTracks[o]=i[o]}),!s&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},f.appendChangeType=function(t,i){var e=this,s=this.operationQueue,o={execute:function(){var p=e.sourceBuffer[t];p&&(m.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+i),p.changeType(i)),s.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(p){m.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",p)}};s.append(o,t)},f.onBufferAppending=function(t,i){var e=this,s=this.hls,o=this.operationQueue,a=this.tracks,p=i.data,D=i.type,L=i.frag,y=i.part,E=i.chunkMeta,_=E.buffering[D],A=self.performance.now();_.start=A;var I=L.stats.buffering,b=y?y.stats.buffering:null;I.start===0&&(I.start=A),b&&b.start===0&&(b.start=A);var R=a.audio,P=D==="audio"&&E.id===1&&(R==null?void 0:R.container)==="audio/mpeg",w={execute:function(){if(_.executeStart=self.performance.now(),P){var k=e.sourceBuffer[D];if(k){var B=L.start-k.timestampOffset;Math.abs(B)>=.1&&(m.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+L.start+" (delta: "+B+") sn: "+L.sn+")"),k.timestampOffset=L.start)}}e.appendExecutor(p,D)},onStart:function(){},onComplete:function(){var k=self.performance.now();_.executeEnd=_.end=k,I.first===0&&(I.first=k),b&&b.first===0&&(b.first=k);var B=e.sourceBuffer,U={};for(var j in B)U[j]=T.BufferHelper.getBuffered(B[j]);e.appendError=0,e.hls.trigger(c.Events.BUFFER_APPENDED,{type:D,frag:L,part:y,chunkMeta:E,parent:L.type,timeRanges:U})},onError:function(k){m.logger.error("[buffer-controller]: Error encountered while trying to append to the "+D+" SourceBuffer",k);var B={type:M.ErrorTypes.MEDIA_ERROR,parent:L.type,details:M.ErrorDetails.BUFFER_APPEND_ERROR,err:k,fatal:!1};k.code===DOMException.QUOTA_EXCEEDED_ERR?B.details=M.ErrorDetails.BUFFER_FULL_ERROR:(e.appendError++,B.details=M.ErrorDetails.BUFFER_APPEND_ERROR,e.appendError>s.config.appendErrorMaxRetry&&(m.logger.error("[buffer-controller]: Failed "+s.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),B.fatal=!0)),s.trigger(c.Events.ERROR,B)}};o.append(w,D)},f.onBufferFlushing=function(t,i){var e=this,s=this.operationQueue,o=function(p){return{execute:e.removeExecutor.bind(e,p,i.startOffset,i.endOffset),onStart:function(){},onComplete:function(){e.hls.trigger(c.Events.BUFFER_FLUSHED,{type:p})},onError:function(L){m.logger.warn("[buffer-controller]: Failed to remove from "+p+" SourceBuffer",L)}}};i.type?s.append(o(i.type),i.type):this.getSourceBufferTypes().forEach(function(a){s.append(o(a),a)})},f.onFragParsed=function(t,i){var e=this,s=i.frag,o=i.part,a=[],p=o?o.elementaryStreams:s.elementaryStreams;p[u.ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(p[u.ElementaryStreamTypes.AUDIO]&&a.push("audio"),p[u.ElementaryStreamTypes.VIDEO]&&a.push("video"));var D=function(){var y=self.performance.now();s.stats.buffering.end=y,o&&(o.stats.buffering.end=y);var E=o?o.stats:s.stats;e.hls.trigger(c.Events.FRAG_BUFFERED,{frag:s,part:o,stats:E,id:s.type})};a.length===0&&m.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+s.type+" level: "+s.level+" sn: "+s.sn),this.blockBuffers(D,a)},f.onFragChanged=function(t,i){this.flushBackBuffer()},f.onBufferEos=function(t,i){var e=this,s=this.getSourceBufferTypes().reduce(function(o,a){var p=e.sourceBuffer[a];return(!i.type||i.type===a)&&p&&!p.ended&&(p.ended=!0,m.logger.log("[buffer-controller]: "+a+" sourceBuffer now EOS")),o&&!!(!p||p.ended)},!0);s&&this.blockBuffers(function(){var o=e.mediaSource;!o||o.readyState!=="open"||o.endOfStream()})},f.onLevelUpdated=function(t,i){var e=i.details;!e.fragments.length||(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},f.flushBackBuffer=function(){var t=this.hls,i=this.details,e=this.media,s=this.sourceBuffer;if(!(!e||i===null)){var o=this.getSourceBufferTypes();if(!!o.length){var a=i.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if(!(!Object(S.isFiniteNumber)(a)||a<0)){var p=e.currentTime,D=i.levelTargetDuration,L=Math.max(a,D),y=Math.floor(p/D)*D-L;o.forEach(function(E){var _=s[E];if(_){var A=T.BufferHelper.getBuffered(_);A.length>0&&y>A.start(0)&&(t.trigger(c.Events.BACK_BUFFER_REACHED,{bufferEnd:y}),i.live&&t.trigger(c.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:y}),t.trigger(c.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:y,type:E}))}})}}}},f.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var t=this.details,i=this.hls,e=this.media,s=this.mediaSource,o=t.fragments[0].start+t.totalduration,a=e.duration,p=Object(S.isFiniteNumber)(s.duration)?s.duration:0;t.live&&i.config.liveDurationInfinity?(m.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),s.duration=1/0,this.updateSeekableRange(t)):(o>p&&o>a||!Object(S.isFiniteNumber)(a))&&(m.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),s.duration=o)}},f.updateSeekableRange=function(t){var i=this.mediaSource,e=t.fragments,s=e.length;if(s&&t.live&&i!==null&&i!==void 0&&i.setLiveSeekableRange){var o=Math.max(0,e[0].start),a=Math.max(o,o+t.totalduration);i.setLiveSeekableRange(o,a)}},f.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,i=this.operationQueue,e=this.pendingTracks,s=Object.keys(e).length;if(s&&!t||s===2){this.createSourceBuffers(e),this.pendingTracks={};var o=this.getSourceBufferTypes();if(o.length===0){this.hls.trigger(c.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}o.forEach(function(a){i.executeNext(a)})}},f.createSourceBuffers=function(t){var i=this.sourceBuffer,e=this.mediaSource;if(!e)throw Error("createSourceBuffers called when mediaSource was null");var s=0;for(var o in t)if(!i[o]){var a=t[o];if(!a)throw Error("source buffer exists for track "+o+", however track does not");var p=a.levelCodec||a.codec,D=a.container+";codecs="+p;m.logger.log("[buffer-controller]: creating sourceBuffer("+D+")");try{var L=i[o]=e.addSourceBuffer(D),y=o;this.addBufferListener(y,"updatestart",this._onSBUpdateStart),this.addBufferListener(y,"updateend",this._onSBUpdateEnd),this.addBufferListener(y,"error",this._onSBUpdateError),this.tracks[o]={buffer:L,codec:p,container:a.container,levelCodec:a.levelCodec,id:a.id},s++}catch(E){m.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+E.message),this.hls.trigger(c.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:E,mimeType:D})}}s&&this.hls.trigger(c.Events.BUFFER_CREATED,{tracks:this.tracks})},f._onSBUpdateStart=function(t){var i=this.operationQueue,e=i.current(t);e.onStart()},f._onSBUpdateEnd=function(t){var i=this.operationQueue,e=i.current(t);e.onComplete(),i.shiftAndExecuteNext(t)},f._onSBUpdateError=function(t,i){m.logger.error("[buffer-controller]: "+t+" SourceBuffer error",i),this.hls.trigger(c.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var e=this.operationQueue.current(t);e&&e.onError(i)},f.removeExecutor=function(t,i,e){var s=this.media,o=this.mediaSource,a=this.operationQueue,p=this.sourceBuffer,D=p[t];if(!s||!o||!D){m.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),a.shiftAndExecuteNext(t);return}var L=Object(S.isFiniteNumber)(s.duration)?s.duration:1/0,y=Object(S.isFiniteNumber)(o.duration)?o.duration:1/0,E=Math.max(0,i),_=Math.min(e,L,y);_>E?(m.logger.log("[buffer-controller]: Removing ["+E+","+_+"] from the "+t+" SourceBuffer"),console.assert(!D.updating,t+" sourceBuffer must not be updating"),D.remove(E,_)):a.shiftAndExecuteNext(t)},f.appendExecutor=function(t,i){var e=this.operationQueue,s=this.sourceBuffer,o=s[i];if(!o){m.logger.warn("[buffer-controller]: Attempting to append to the "+i+" SourceBuffer, but it does not exist"),e.shiftAndExecuteNext(i);return}o.ended=!1,console.assert(!o.updating,i+" sourceBuffer must not be updating"),o.appendBuffer(t)},f.blockBuffers=function(t,i){var e=this;if(i===void 0&&(i=this.getSourceBufferTypes()),!i.length){m.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(t);return}var s=this.operationQueue,o=i.map(function(a){return s.appendBlocker(a)});Promise.all(o).then(function(){t(),i.forEach(function(a){var p=e.sourceBuffer[a];(!p||!p.updating)&&s.shiftAndExecuteNext(a)})})},f.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},f.addBufferListener=function(t,i,e){var s=this.sourceBuffer[t];if(!!s){var o=e.bind(this,t);this.listeners[t].push({event:i,listener:o}),s.addEventListener(i,o)}},f.removeBufferListeners=function(t){var i=this.sourceBuffer[t];!i||this.listeners[t].forEach(function(e){i.removeEventListener(e.event,e.listener)})},v}()},"./src/controller/buffer-operation-queue.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return c});var S=x("./src/utils/logger.ts"),c=function(){function m(T){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=T}var M=m.prototype;return M.append=function(g,u){var n=this.queues[u];n.push(g),n.length===1&&this.buffers[u]&&this.executeNext(u)},M.insertAbort=function(g,u){var n=this.queues[u];n.unshift(g),this.executeNext(u)},M.appendBlocker=function(g){var u,n=new Promise(function(l){u=l}),d={execute:u,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(d,g),n},M.executeNext=function(g){var u=this.buffers,n=this.queues,d=u[g],l=n[g];if(l.length){var h=l[0];try{h.execute()}catch(v){S.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),h.onError(v),(!d||!d.updating)&&(l.shift(),this.executeNext(g))}}},M.shiftAndExecuteNext=function(g){this.queues[g].shift(),this.executeNext(g)},M.current=function(g){return this.queues[g][0]},m}()},"./src/controller/cap-level-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts");function c(T,g){for(var u=0;u<g.length;u++){var n=g[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(T,n.key,n)}}function m(T,g,u){return g&&c(T.prototype,g),u&&c(T,u),T}var M=function(){function T(u){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=u,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var g=T.prototype;return g.setStreamController=function(n){this.streamController=n},g.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},g.registerListeners=function(){var n=this.hls;n.on(S.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},g.unregisterListener=function(){var n=this.hls;n.off(S.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},g.onFpsDropLevelCapping=function(n,d){T.isLevelAllowed(d.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(d.droppedLevel)},g.onMediaAttaching=function(n,d){this.media=d.media instanceof HTMLVideoElement?d.media:null},g.onManifestParsed=function(n,d){var l=this.hls;this.restrictedLevels=[],this.firstLevel=d.firstLevel,l.config.capLevelToPlayerSize&&d.video&&this.startCapping()},g.onBufferCodecs=function(n,d){var l=this.hls;l.config.capLevelToPlayerSize&&d.video&&this.startCapping()},g.onMediaDetaching=function(){this.stopCapping()},g.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var n=this.hls.levels;if(n.length){var d=this.hls;d.autoLevelCapping=this.getMaxLevel(n.length-1),d.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=d.autoLevelCapping}}},g.getMaxLevel=function(n){var d=this,l=this.hls.levels;if(!l.length)return-1;var h=l.filter(function(v,f){return T.isLevelAllowed(f,d.restrictedLevels)&&f<=n});return this.clientRect=null,T.getMaxLevelByMediaSize(h,this.mediaWidth,this.mediaHeight)},g.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},g.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},g.getDimensions=function(){if(this.clientRect)return this.clientRect;var n=this.media,d={width:0,height:0};if(n){var l=n.getBoundingClientRect();d.width=l.width,d.height=l.height,!d.width&&!d.height&&(d.width=l.right-l.left||n.width||0,d.height=l.bottom-l.top||n.height||0)}return this.clientRect=d,d},T.isLevelAllowed=function(n,d){return d===void 0&&(d=[]),d.indexOf(n)===-1},T.getMaxLevelByMediaSize=function(n,d,l){if(!n||!n.length)return-1;for(var h=function(i,e){return e?i.width!==e.width||i.height!==e.height:!0},v=n.length-1,f=0;f<n.length;f+=1){var r=n[f];if((r.width>=d||r.height>=l)&&h(r,n[f+1])){v=f;break}}return v},m(T,[{key:"mediaWidth",get:function(){return this.getDimensions().width*T.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*T.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var n=1;try{n=self.devicePixelRatio}catch{}return n}}]),T}();C.default=M},"./src/controller/cmcd-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return h});var S=x("./src/events.ts"),c=x("./src/types/cmcd.ts"),m=x("./src/utils/buffer-helper.ts"),M=x("./src/utils/logger.ts");function T(v,f){for(var r=0;r<f.length;r++){var t=f[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(v,t.key,t)}}function g(v,f,r){return f&&T(v.prototype,f),r&&T(v,r),v}function u(v,f){var r=typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(r)return(r=r.call(v)).next.bind(r);if(Array.isArray(v)||(r=n(v))||f&&v&&typeof v.length=="number"){r&&(v=r);var t=0;return function(){return t>=v.length?{done:!0}:{done:!1,value:v[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(v,f){if(!!v){if(typeof v=="string")return d(v,f);var r=Object.prototype.toString.call(v).slice(8,-1);if(r==="Object"&&v.constructor&&(r=v.constructor.name),r==="Map"||r==="Set")return Array.from(v);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(v,f)}}function d(v,f){(f==null||f>v.length)&&(f=v.length);for(var r=0,t=new Array(f);r<f;r++)t[r]=v[r];return t}function l(){return l=Object.assign||function(v){for(var f=1;f<arguments.length;f++){var r=arguments[f];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(v[t]=r[t])}return v},l.apply(this,arguments)}var h=function(){function v(r){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1},this.applyPlaylistData=function(s){try{t.apply(s,{ot:c.CMCDObjectType.MANIFEST,su:!t.initialized})}catch(o){M.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(s){try{var o=s.frag,a=t.hls.levels[o.level],p=t.getObjectType(o),D={d:o.duration*1e3,ot:p};(p===c.CMCDObjectType.VIDEO||p===c.CMCDObjectType.AUDIO||p==c.CMCDObjectType.MUXED)&&(D.br=a.bitrate/1e3,D.tb=t.getTopBandwidth(p)/1e3,D.bl=t.getBufferLength(p)),t.apply(s,D)}catch(L){M.logger.warn("Could not generate segment CMCD data.",L)}},this.hls=r;var i=this.config=r.config,e=i.cmcd;e!=null&&(i.pLoader=this.createPlaylistLoader(),i.fLoader=this.createFragmentLoader(),this.sid=e.sessionId||v.uuid(),this.cid=e.contentId,this.useHeaders=e.useHeaders===!0,this.registerListeners())}var f=v.prototype;return f.registerListeners=function(){var t=this.hls;t.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.on(S.Events.BUFFER_CREATED,this.onBufferCreated,this)},f.unregisterListeners=function(){var t=this.hls;t.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.off(S.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},f.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},f.onMediaAttached=function(t,i){this.media=i.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},f.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},f.onBufferCreated=function(t,i){var e,s;this.audioBuffer=(e=i.tracks.audio)===null||e===void 0?void 0:e.buffer,this.videoBuffer=(s=i.tracks.video)===null||s===void 0?void 0:s.buffer},f.createData=function(){var t;return{v:c.CMCDVersion,sf:c.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)===null||t===void 0?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},f.apply=function(t,i){i===void 0&&(i={}),l(i,this.createData());var e=i.ot===c.CMCDObjectType.INIT||i.ot===c.CMCDObjectType.VIDEO||i.ot===c.CMCDObjectType.MUXED;if(this.starved&&e&&(i.bs=!0,i.su=!0,this.starved=!1),i.su==null&&(i.su=this.buffering),this.useHeaders){var s=v.toHeaders(i);if(!Object.keys(s).length)return;t.headers||(t.headers={}),l(t.headers,s)}else{var o=v.toQuery(i);if(!o)return;t.url=v.appendQueryToUri(t.url,o)}},f.getObjectType=function(t){var i=t.type;if(i==="subtitle")return c.CMCDObjectType.TIMED_TEXT;if(t.sn==="initSegment")return c.CMCDObjectType.INIT;if(i==="audio")return c.CMCDObjectType.AUDIO;if(i==="main")return this.hls.audioTracks.length?c.CMCDObjectType.VIDEO:c.CMCDObjectType.MUXED},f.getTopBandwidth=function(t){var i=0,e,s=this.hls;if(t===c.CMCDObjectType.AUDIO)e=s.audioTracks;else{var o=s.maxAutoLevel,a=o>-1?o+1:s.levels.length;e=s.levels.slice(0,a)}for(var p=u(e),D;!(D=p()).done;){var L=D.value;L.bitrate>i&&(i=L.bitrate)}return i>0?i:NaN},f.getBufferLength=function(t){var i=this.hls.media,e=t===c.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!e||!i)return NaN;var s=m.BufferHelper.bufferInfo(e,i.currentTime,this.config.maxBufferHole);return s.len*1e3},f.createPlaylistLoader=function(){var t=this.config.pLoader,i=this.applyPlaylistData,e=t||this.config.loader;return function(){function s(a){this.loader=void 0,this.loader=new e(a)}var o=s.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(p,D,L){i(p),this.loader.load(p,D,L)},g(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},f.createFragmentLoader=function(){var t=this.config.fLoader,i=this.applyFragmentData,e=t||this.config.loader;return function(){function s(a){this.loader=void 0,this.loader=new e(a)}var o=s.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(p,D,L){i(p),this.loader.load(p,D,L)},g(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},v.uuid=function(){var t=URL.createObjectURL(new Blob),i=t.toString();return URL.revokeObjectURL(t),i.substr(i.lastIndexOf("/")+1)},v.serialize=function(t){for(var i=[],e=function(P){return!Number.isNaN(P)&&P!=null&&P!==""&&P!==!1},s=function(P){return Math.round(P)},o=function(P){return s(P/100)*100},a=function(P){return encodeURIComponent(P)},p={br:s,d:s,bl:o,dl:o,mtp:o,nor:a,rtp:o,tb:s},D=Object.keys(t||{}).sort(),L=u(D),y;!(y=L()).done;){var E=y.value,_=t[E];if(!!e(_)&&!(E==="v"&&_===1)&&!(E=="pr"&&_===1)){var A=p[E];A&&(_=A(_));var I=typeof _,b=void 0;E==="ot"||E==="sf"||E==="st"?b=E+"="+_:I==="boolean"?b=E:I==="number"?b=E+"="+_:b=E+"="+JSON.stringify(_),i.push(b)}}return i.join(",")},v.toHeaders=function(t){for(var i=Object.keys(t),e={},s=["Object","Request","Session","Status"],o=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},p=0,D=i;p<D.length;p++){var L=D[p],y=a[L]!=null?a[L]:1;o[y][L]=t[L]}for(var E=0;E<o.length;E++){var _=v.serialize(o[E]);_&&(e["CMCD-"+s[E]]=_)}return e},v.toQuery=function(t){return"CMCD="+encodeURIComponent(v.serialize(t))},v.appendQueryToUri=function(t,i){if(!i)return t;var e=t.includes("?")?"&":"?";return""+t+e+i},v}()},"./src/controller/eme-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),c=x("./src/errors.ts"),m=x("./src/utils/logger.ts"),M=x("./src/utils/mediakeys-helper.ts");function T(h,v){for(var f=0;f<v.length;f++){var r=v[f];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(h,r.key,r)}}function g(h,v,f){return v&&T(h.prototype,v),f&&T(h,f),h}var u=3,n=function(v,f,r){var t={audioCapabilities:[],videoCapabilities:[]};return v.forEach(function(i){t.audioCapabilities.push({contentType:'audio/mp4; codecs="'+i+'"',robustness:r.audioRobustness||""})}),f.forEach(function(i){t.videoCapabilities.push({contentType:'video/mp4; codecs="'+i+'"',robustness:r.videoRobustness||""})}),[t]},d=function(v,f,r,t){switch(v){case M.KeySystems.WIDEVINE:return n(f,r,t);default:throw new Error("Unknown key-system: "+v)}},l=function(){function h(f){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=f,this._config=f.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var v=h.prototype;return v.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},v._registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this)},v._unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this)},v.getLicenseServerUrl=function(r){switch(r){case M.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+r+'"')},v._attemptKeySystemAccess=function(r,t,i){var e=this,s=d(r,t,i,this._drmSystemOptions);m.logger.log("Requesting encrypted media key-system access");var o=this.requestMediaKeySystemAccess(r,s);this.mediaKeysPromise=o.then(function(a){return e._onMediaKeySystemAccessObtained(r,a)}),o.catch(function(a){m.logger.error('Failed to obtain key-system "'+r+'" access:',a)})},v._onMediaKeySystemAccessObtained=function(r,t){var i=this;m.logger.log('Access for key-system "'+r+'" obtained');var e={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:r};this._mediaKeysList.push(e);var s=Promise.resolve().then(function(){return t.createMediaKeys()}).then(function(o){return e.mediaKeys=o,m.logger.log('Media-keys created for key-system "'+r+'"'),i._onMediaKeysCreated(),o});return s.catch(function(o){m.logger.error("Failed to create media-keys:",o)}),s},v._onMediaKeysCreated=function(){var r=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),r._onNewMediaKeySession(t.mediaKeysSession))})},v._onNewMediaKeySession=function(r){var t=this;m.logger.log("New key-system session "+r.sessionId),r.addEventListener("message",function(i){t._onKeySessionMessage(r,i.message)},!1)},v._onKeySessionMessage=function(r,t){m.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(i){m.logger.log("Received license data (length: "+(i&&i.byteLength)+"), updating key-session"),r.update(i)})},v.onMediaEncrypted=function(r){var t=this;if(m.logger.log('Media is encrypted using "'+r.initDataType+'" init data type'),!this.mediaKeysPromise){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var i=function(s){!t._media||(t._attemptSetMediaKeys(s),t._generateRequestWithPreferredKeySession(r.initDataType,r.initData))};this.mediaKeysPromise.then(i).catch(i)},v._attemptSetMediaKeys=function(r){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}m.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},v._generateRequestWithPreferredKeySession=function(r,t){var i=this,e=this._mediaKeysList[0];if(!e){m.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(e.mediaKeysSessionInitialized){m.logger.warn("Key-Session already initialized but requested again");return}var s=e.mediaKeysSession;if(!s){m.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!t){m.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}m.logger.log('Generating key-session request for "'+r+'" init data type'),e.mediaKeysSessionInitialized=!0,s.generateRequest(r,t).then(function(){m.logger.debug("Key-session generation succeeded")}).catch(function(o){m.logger.error("Error generating key-session request:",o),i.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},v._createLicenseXhr=function(r,t,i){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,e,r,t,i);var s=this._licenseXhrSetup;if(s)try{s.call(this.hls,e,r),s=void 0}catch(o){m.logger.error(o)}try{e.readyState||e.open("POST",r,!0),s&&s.call(this.hls,e,r)}catch(o){throw new Error("issue setting up KeySystem license XHR "+o)}return e},v._onLicenseRequestReadyStageChange=function(r,t,i,e){switch(r.readyState){case 4:if(r.status===200){this._requestLicenseFailureCount=0,m.logger.log("License request succeeded");var s=r.response,o=this._licenseResponseCallback;if(o)try{s=o.call(this.hls,r,t)}catch(p){m.logger.error(p)}e(s)}else{if(m.logger.error("License Request XHR failed ("+t+"). Status: "+r.status+" ("+r.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u){this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var a=u-this._requestLicenseFailureCount+1;m.logger.warn("Retrying license request, "+a+" attempts left"),this._requestLicense(i,e)}break}},v._generateLicenseRequestChallenge=function(r,t){switch(r.mediaKeySystemDomain){case M.KeySystems.WIDEVINE:return t}throw new Error("unsupported key-system: "+r.mediaKeySystemDomain)},v._requestLicense=function(r,t){m.logger.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i){m.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var e=this.getLicenseServerUrl(i.mediaKeySystemDomain),s=this._createLicenseXhr(e,r,t);m.logger.log("Sending license request to URL: "+e);var o=this._generateLicenseRequestChallenge(i,r);s.send(o)}catch(a){m.logger.error("Failure requesting DRM license: "+a),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},v.onMediaAttached=function(r,t){if(!!this._emeEnabled){var i=t.media;this._media=i,i.addEventListener("encrypted",this._onMediaEncrypted)}},v.onMediaDetached=function(){var r=this._media,t=this._mediaKeysList;!r||(r.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(i){if(i.mediaKeysSession)return i.mediaKeysSession.close().catch(function(){})})).then(function(){return r.setMediaKeys(null)}).catch(function(){}))},v.onManifestParsed=function(r,t){if(!!this._emeEnabled){var i=t.levels.map(function(s){return s.audioCodec}).filter(function(s){return!!s}),e=t.levels.map(function(s){return s.videoCodec}).filter(function(s){return!!s});this._attemptKeySystemAccess(M.KeySystems.WIDEVINE,i,e)}},g(h,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),h}();C.default=l},"./src/controller/fps-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),c=x("./src/utils/logger.ts"),m=function(){function M(g){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=g,this.registerListeners()}var T=M.prototype;return T.setStreamController=function(u){this.streamController=u},T.registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},T.unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching)},T.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},T.onMediaAttaching=function(u,n){var d=this.hls.config;if(d.capLevelOnFPSDrop){var l=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=l,l&&typeof l.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),d.fpsDroppedMonitoringPeriod)}},T.checkFPS=function(u,n,d){var l=performance.now();if(n){if(this.lastTime){var h=l-this.lastTime,v=d-this.lastDroppedFrames,f=n-this.lastDecodedFrames,r=1e3*v/h,t=this.hls;if(t.trigger(S.Events.FPS_DROP,{currentDropped:v,currentDecoded:f,totalDroppedFrames:d}),r>0&&v>t.config.fpsDroppedMonitoringThreshold*f){var i=t.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+i),i>0&&(t.autoLevelCapping===-1||t.autoLevelCapping>=i)&&(i=i-1,t.trigger(S.Events.FPS_DROP_LEVEL_CAPPING,{level:i,droppedLevel:t.currentLevel}),t.autoLevelCapping=i,this.streamController.nextLevelSwitch())}}this.lastTime=l,this.lastDroppedFrames=d,this.lastDecodedFrames=n}},T.checkFPSInterval=function(){var u=this.media;if(u)if(this.isVideoPlaybackQualityAvailable){var n=u.getVideoPlaybackQuality();this.checkFPS(u,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(u,u.webkitDecodedFrameCount,u.webkitDroppedFrameCount)},M}();C.default=m},"./src/controller/fragment-finders.ts":function(O,C,x){x.r(C),x.d(C,"findFragmentByPDT",function(){return m}),x.d(C,"findFragmentByPTS",function(){return M}),x.d(C,"fragmentWithinToleranceTest",function(){return T}),x.d(C,"pdtWithinToleranceTest",function(){return g}),x.d(C,"findFragWithCC",function(){return u});var S=x("./src/polyfills/number.ts"),c=x("./src/utils/binary-search.ts");function m(n,d,l){if(d===null||!Array.isArray(n)||!n.length||!Object(S.isFiniteNumber)(d))return null;var h=n[0].programDateTime;if(d<(h||0))return null;var v=n[n.length-1].endProgramDateTime;if(d>=(v||0))return null;l=l||0;for(var f=0;f<n.length;++f){var r=n[f];if(g(d,l,r))return r}return null}function M(n,d,l,h){l===void 0&&(l=0),h===void 0&&(h=0);var v=null;if(n?v=d[n.sn-d[0].sn+1]||null:l===0&&d[0].start===0&&(v=d[0]),v&&T(l,h,v)===0)return v;var f=c.default.search(d,T.bind(null,l,h));return f||v}function T(n,d,l){n===void 0&&(n=0),d===void 0&&(d=0);var h=Math.min(d,l.duration+(l.deltaPTS?l.deltaPTS:0));return l.start+l.duration-h<=n?1:l.start-h>n&&l.start?-1:0}function g(n,d,l){var h=Math.min(d,l.duration+(l.deltaPTS?l.deltaPTS:0))*1e3,v=l.endProgramDateTime||0;return v-h>n}function u(n,d){return c.default.search(n,function(l){return l.cc<d?1:l.cc>d?-1:0})}},"./src/controller/fragment-tracker.ts":function(O,C,x){x.r(C),x.d(C,"FragmentState",function(){return m}),x.d(C,"FragmentTracker",function(){return M});var S=x("./src/events.ts"),c=x("./src/types/loader.ts"),m;(function(u){u.NOT_LOADED="NOT_LOADED",u.BACKTRACKED="BACKTRACKED",u.APPENDING="APPENDING",u.PARTIAL="PARTIAL",u.OK="OK"})(m||(m={}));var M=function(){function u(d){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=d,this._registerListeners()}var n=u.prototype;return n._registerListeners=function(){var l=this.hls;l.on(S.Events.BUFFER_APPENDED,this.onBufferAppended,this),l.on(S.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.on(S.Events.FRAG_LOADED,this.onFragLoaded,this)},n._unregisterListeners=function(){var l=this.hls;l.off(S.Events.BUFFER_APPENDED,this.onBufferAppended,this),l.off(S.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.off(S.Events.FRAG_LOADED,this.onFragLoaded,this)},n.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},n.getAppendedFrag=function(l,h){if(h===c.PlaylistLevelType.MAIN){var v=this.activeFragment,f=this.activeParts;if(!v)return null;if(f)for(var r=f.length;r--;){var t=f[r],i=t?t.end:v.appendedPTS;if(t.start<=l&&i!==void 0&&l<=i)return r>9&&(this.activeParts=f.slice(r-9)),t}else if(v.start<=l&&v.appendedPTS!==void 0&&l<=v.appendedPTS)return v}return this.getBufferedFrag(l,h)},n.getBufferedFrag=function(l,h){for(var v=this.fragments,f=Object.keys(v),r=f.length;r--;){var t=v[f[r]];if((t==null?void 0:t.body.type)===h&&t.buffered){var i=t.body;if(i.start<=l&&l<=i.end)return i}}return null},n.detectEvictedFragments=function(l,h,v){var f=this;Object.keys(this.fragments).forEach(function(r){var t=f.fragments[r];if(!!t){if(!t.buffered){t.body.type===v&&f.removeFragment(t.body);return}var i=t.range[l];!i||i.time.some(function(e){var s=!f.isTimeBuffered(e.startPTS,e.endPTS,h);return s&&f.removeFragment(t.body),s})}})},n.detectPartialFragments=function(l){var h=this,v=this.timeRanges,f=l.frag,r=l.part;if(!(!v||f.sn==="initSegment")){var t=g(f),i=this.fragments[t];!i||(Object.keys(v).forEach(function(e){var s=f.elementaryStreams[e];if(!!s){var o=v[e],a=r!==null||s.partial===!0;i.range[e]=h.getBufferedTimes(f,r,a,o)}}),i.backtrack=i.loaded=null,Object.keys(i.range).length?i.buffered=!0:this.removeFragment(i.body))}},n.fragBuffered=function(l){var h=g(l),v=this.fragments[h];v&&(v.backtrack=v.loaded=null,v.buffered=!0)},n.getBufferedTimes=function(l,h,v,f){for(var r={time:[],partial:v},t=h?h.start:l.start,i=h?h.end:l.end,e=l.minEndPTS||i,s=l.maxStartPTS||t,o=0;o<f.length;o++){var a=f.start(o)-this.bufferPadding,p=f.end(o)+this.bufferPadding;if(s>=a&&e<=p){r.time.push({startPTS:Math.max(t,f.start(o)),endPTS:Math.min(i,f.end(o))});break}else if(t<p&&i>a)r.partial=!0,r.time.push({startPTS:Math.max(t,f.start(o)),endPTS:Math.min(i,f.end(o))});else if(i<=a)break}return r},n.getPartialFragment=function(l){var h=null,v,f,r,t=0,i=this.bufferPadding,e=this.fragments;return Object.keys(e).forEach(function(s){var o=e[s];!o||T(o)&&(f=o.body.start-i,r=o.body.end+i,l>=f&&l<=r&&(v=Math.min(l-f,r-l),t<=v&&(h=o.body,t=v)))}),h},n.getState=function(l){var h=g(l),v=this.fragments[h];return v?v.buffered?T(v)?m.PARTIAL:m.OK:v.backtrack?m.BACKTRACKED:m.APPENDING:m.NOT_LOADED},n.backtrack=function(l,h){var v=g(l),f=this.fragments[v];if(!f||f.backtrack)return null;var r=f.backtrack=h||f.loaded;return f.loaded=null,r},n.getBacktrackData=function(l){var h=g(l),v=this.fragments[h];if(v){var f,r=v.backtrack;if(r!=null&&(f=r.payload)!==null&&f!==void 0&&f.byteLength)return r;this.removeFragment(l)}return null},n.isTimeBuffered=function(l,h,v){for(var f,r,t=0;t<v.length;t++){if(f=v.start(t)-this.bufferPadding,r=v.end(t)+this.bufferPadding,l>=f&&h<=r)return!0;if(h<=f)return!1}return!1},n.onFragLoaded=function(l,h){var v=h.frag,f=h.part;if(!(v.sn==="initSegment"||v.bitrateTest||f)){var r=g(v);this.fragments[r]={body:v,loaded:h,backtrack:null,buffered:!1,range:Object.create(null)}}},n.onBufferAppended=function(l,h){var v=this,f=h.frag,r=h.part,t=h.timeRanges;if(f.type===c.PlaylistLevelType.MAIN)if(this.activeFragment=f,r){var i=this.activeParts;i||(this.activeParts=i=[]),i.push(r)}else this.activeParts=null;this.timeRanges=t,Object.keys(t).forEach(function(e){var s=t[e];if(v.detectEvictedFragments(e,s),!r)for(var o=0;o<s.length;o++)f.appendedPTS=Math.max(s.end(o),f.appendedPTS||0)})},n.onFragBuffered=function(l,h){this.detectPartialFragments(h)},n.hasFragment=function(l){var h=g(l);return!!this.fragments[h]},n.removeFragmentsInRange=function(l,h,v){var f=this;Object.keys(this.fragments).forEach(function(r){var t=f.fragments[r];if(!!t&&t.buffered){var i=t.body;i.type===v&&i.start<h&&i.end>l&&f.removeFragment(i)}})},n.removeFragment=function(l){var h=g(l);l.stats.loaded=0,l.clearElementaryStreamInfo(),delete this.fragments[h]},n.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},u}();function T(u){var n,d;return u.buffered&&(((n=u.range.video)===null||n===void 0?void 0:n.partial)||((d=u.range.audio)===null||d===void 0?void 0:d.partial))}function g(u){return u.type+"_"+u.level+"_"+u.urlId+"_"+u.sn}},"./src/controller/gap-controller.ts":function(O,C,x){x.r(C),x.d(C,"STALL_MINIMUM_DURATION_MS",function(){return T}),x.d(C,"MAX_START_GAP_JUMP",function(){return g}),x.d(C,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return u}),x.d(C,"SKIP_BUFFER_RANGE_START",function(){return n}),x.d(C,"default",function(){return d});var S=x("./src/utils/buffer-helper.ts"),c=x("./src/errors.ts"),m=x("./src/events.ts"),M=x("./src/utils/logger.ts"),T=250,g=2,u=.1,n=.05,d=function(){function l(v,f,r,t){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=v,this.media=f,this.fragmentTracker=r,this.hls=t}var h=l.prototype;return h.destroy=function(){this.hls=this.fragmentTracker=this.media=null},h.poll=function(f){var r=this.config,t=this.media,i=this.stalled,e=t.currentTime,s=t.seeking,o=this.seeking&&!s,a=!this.seeking&&s;if(this.seeking=s,e!==f){if(this.moved=!0,i!==null){if(this.stallReported){var p=self.performance.now()-i;M.logger.warn("playback not stuck anymore @"+e+", after "+Math.round(p)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((a||o)&&(this.stalled=null),!(t.paused||t.ended||t.playbackRate===0||!S.BufferHelper.getBuffered(t).length)){var D=S.BufferHelper.bufferInfo(t,e,0),L=D.len>0,y=D.nextStart||0;if(!(!L&&!y)){if(s){var E=D.len>g,_=!y||y-e>g&&!this.fragmentTracker.getPartialFragment(e);if(E||_)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var A,I=Math.max(y,D.start||0)-e,b=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,R=b==null||(A=b.details)===null||A===void 0?void 0:A.live,P=R?b.details.targetduration*2:g;if(I>0&&I<=P){this._trySkipBufferHole(null);return}}var w=self.performance.now();if(i===null){this.stalled=w;return}var F=w-i;!s&&F>=T&&this._reportStall(D.len);var k=S.BufferHelper.bufferInfo(t,e,r.maxBufferHole);this._tryFixBufferStall(k,F)}}},h._tryFixBufferStall=function(f,r){var t=this.config,i=this.fragmentTracker,e=this.media,s=e.currentTime,o=i.getPartialFragment(s);if(o){var a=this._trySkipBufferHole(o);if(a)return}f.len>t.maxBufferHole&&r>t.highBufferWatchdogPeriod*1e3&&(M.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},h._reportStall=function(f){var r=this.hls,t=this.media,i=this.stallReported;i||(this.stallReported=!0,M.logger.warn("Playback stalling at @"+t.currentTime+" due to low buffer (buffer="+f+")"),r.trigger(m.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:f}))},h._trySkipBufferHole=function(f){for(var r=this.config,t=this.hls,i=this.media,e=i.currentTime,s=0,o=S.BufferHelper.getBuffered(i),a=0;a<o.length;a++){var p=o.start(a);if(e+r.maxBufferHole>=s&&e<p){var D=Math.max(p+n,i.currentTime+u);return M.logger.warn("skipping hole, adjusting currentTime from "+e+" to "+D),this.moved=!0,this.stalled=null,i.currentTime=D,f&&t.trigger(m.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+e+" to "+D,frag:f}),D}s=o.end(a)}return 0},h._tryNudgeBuffer=function(){var f=this.config,r=this.hls,t=this.media,i=t.currentTime,e=(this.nudgeRetry||0)+1;if(this.nudgeRetry=e,e<f.nudgeMaxRetry){var s=i+e*f.nudgeOffset;M.logger.warn("Nudging 'currentTime' from "+i+" to "+s),t.currentTime=s,r.trigger(m.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else M.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+f.nudgeMaxRetry+" nudges"),r.trigger(m.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},l}()},"./src/controller/id3-track-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),c=x("./src/utils/texttrack-utils.ts"),m=x("./src/demux/id3.ts"),M=.25,T=function(){function g(n){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=n,this._registerListeners()}var u=g.prototype;return u.destroy=function(){this._unregisterListeners()},u._registerListeners=function(){var d=this.hls;d.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.on(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),d.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u._unregisterListeners=function(){var d=this.hls;d.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),d.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u.onMediaAttached=function(d,l){this.media=l.media},u.onMediaDetaching=function(){!this.id3Track||(Object(c.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},u.getID3Track=function(d){if(!!this.media){for(var l=0;l<d.length;l++){var h=d[l];if(h.kind==="metadata"&&h.label==="id3")return Object(c.sendAddTrackEvent)(h,this.media),h}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(d,l){if(!!this.media){var h=l.frag,v=l.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var f=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,r=0;r<v.length;r++){var t=m.getID3Frames(v[r].data);if(t){var i=v[r].pts,e=r<v.length-1?v[r+1].pts:h.end,s=e-i;s<=0&&(e=i+M);for(var o=0;o<t.length;o++){var a=t[o];if(!m.isTimeStampFrame(a)){var p=new f(i,e,"");p.value=a,this.id3Track.addCue(p)}}}}}},u.onBufferFlushing=function(d,l){var h=l.startOffset,v=l.endOffset,f=l.type;if(!f||f==="audio"){var r=this.id3Track;r&&Object(c.removeCuesInRange)(r,h,v)}},g}();C.default=T},"./src/controller/latency-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return g});var S=x("./src/errors.ts"),c=x("./src/events.ts"),m=x("./src/utils/logger.ts");function M(u,n){for(var d=0;d<n.length;d++){var l=n[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}function T(u,n,d){return n&&M(u.prototype,n),d&&M(u,d),u}var g=function(){function u(d){var l=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return l.timeupdate()},this.hls=d,this.config=d.config,this.registerListeners()}var n=u.prototype;return n.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},n.registerListeners=function(){this.hls.on(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(c.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(c.Events.ERROR,this.onError,this)},n.unregisterListeners=function(){this.hls.off(c.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(c.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(c.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(c.Events.ERROR,this.onError)},n.onMediaAttached=function(l,h){this.media=h.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},n.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},n.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},n.onLevelUpdated=function(l,h){var v=h.details;this.levelDetails=v,v.advanced&&this.timeupdate(),!v.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},n.onError=function(l,h){h.details===S.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,m.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},n.timeupdate=function(){var l=this.media,h=this.levelDetails;if(!(!l||!h)){this.currentTime=l.currentTime;var v=this.computeLatency();if(v!==null){this._latency=v;var f=this.config,r=f.lowLatencyMode,t=f.maxLiveSyncPlaybackRate;if(!(!r||t===1)){var i=this.targetLatency;if(i!==null){var e=v-i,s=Math.min(this.maxLatency,i+h.targetduration),o=e<s;if(h.live&&o&&e>.05&&this.forwardBufferLength>1){var a=Math.min(2,Math.max(1,t)),p=Math.round(2/(1+Math.exp(-.75*e-this.edgeStalled))*20)/20;l.playbackRate=Math.min(a,Math.max(1,p))}else l.playbackRate!==1&&l.playbackRate!==0&&(l.playbackRate=1)}}}}},n.estimateLiveEdge=function(){var l=this.levelDetails;return l===null?null:l.edge+l.age},n.computeLatency=function(){var l=this.estimateLiveEdge();return l===null?null:l-this.currentTime},T(u,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var l=this.config,h=this.levelDetails;return l.liveMaxLatencyDuration!==void 0?l.liveMaxLatencyDuration:h?l.liveMaxLatencyDurationCount*h.targetduration:0}},{key:"targetLatency",get:function(){var l=this.levelDetails;if(l===null)return null;var h=l.holdBack,v=l.partHoldBack,f=l.targetduration,r=this.config,t=r.liveSyncDuration,i=r.liveSyncDurationCount,e=r.lowLatencyMode,s=this.hls.userConfig,o=e&&v||h;(s.liveSyncDuration||s.liveSyncDurationCount||o===0)&&(o=t!==void 0?t:i*f);var a=f,p=1;return o+Math.min(this.stallCount*p,a)}},{key:"liveSyncPosition",get:function(){var l=this.estimateLiveEdge(),h=this.targetLatency,v=this.levelDetails;if(l===null||h===null||v===null)return null;var f=v.edge,r=l-h-this.edgeStalled,t=f-v.totalduration,i=f-(this.config.lowLatencyMode&&v.partTarget||v.targetduration);return Math.min(Math.max(t,r),i)}},{key:"drift",get:function(){var l=this.levelDetails;return l===null?1:l.drift}},{key:"edgeStalled",get:function(){var l=this.levelDetails;if(l===null)return 0;var h=(this.config.lowLatencyMode&&l.partTarget||l.targetduration)*3;return Math.max(l.age-h,0)}},{key:"forwardBufferLength",get:function(){var l=this.media,h=this.levelDetails;if(!l||!h)return 0;var v=l.buffered.length;return v?l.buffered.end(v-1):h.edge-this.currentTime}}]),u}()},"./src/controller/level-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return r});var S=x("./src/types/level.ts"),c=x("./src/events.ts"),m=x("./src/errors.ts"),M=x("./src/utils/codecs.ts"),T=x("./src/controller/level-helper.ts"),g=x("./src/controller/base-playlist-controller.ts"),u=x("./src/types/loader.ts");function n(){return n=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},n.apply(this,arguments)}function d(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function l(t,i,e){return i&&d(t.prototype,i),e&&d(t,e),t}function h(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,v(t,i)}function v(t,i){return v=Object.setPrototypeOf||function(s,o){return s.__proto__=o,s},v(t,i)}var f=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r=function(t){h(i,t);function i(s){var o;return o=t.call(this,s,"[level-controller]")||this,o._levels=[],o._firstLevel=-1,o._startLevel=void 0,o.currentLevelIndex=-1,o.manualLevelIndex=-1,o.onParsedComplete=void 0,o._registerListeners(),o}var e=i.prototype;return e._registerListeners=function(){var o=this.hls;o.on(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(c.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(c.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(c.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(c.Events.ERROR,this.onError,this)},e._unregisterListeners=function(){var o=this.hls;o.off(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(c.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(c.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(c.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(c.Events.ERROR,this.onError,this)},e.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,t.prototype.destroy.call(this)},e.startLoad=function(){var o=this._levels;o.forEach(function(a){a.loadError=0}),t.prototype.startLoad.call(this)},e.onManifestLoaded=function(o,a){var p=[],D=[],L=[],y,E={},_,A=!1,I=!1,b=!1;if(a.levels.forEach(function(F){var k=F.attrs;A=A||!!(F.width&&F.height),I=I||!!F.videoCodec,b=b||!!F.audioCodec,f&&F.audioCodec&&F.audioCodec.indexOf("mp4a.40.34")!==-1&&(F.audioCodec=void 0);var B=F.bitrate+"-"+F.attrs.RESOLUTION+"-"+F.attrs.CODECS;_=E[B],_?_.url.push(F.url):(_=new S.Level(F),E[B]=_,p.push(_)),k&&(k.AUDIO&&Object(T.addGroupId)(_,"audio",k.AUDIO),k.SUBTITLES&&Object(T.addGroupId)(_,"text",k.SUBTITLES))}),(A||I)&&b&&(p=p.filter(function(F){var k=F.videoCodec,B=F.width,U=F.height;return!!k||!!(B&&U)})),p=p.filter(function(F){var k=F.audioCodec,B=F.videoCodec;return(!k||Object(M.isCodecSupportedInMp4)(k,"audio"))&&(!B||Object(M.isCodecSupportedInMp4)(B,"video"))}),a.audioTracks&&(D=a.audioTracks.filter(function(F){return!F.audioCodec||Object(M.isCodecSupportedInMp4)(F.audioCodec,"audio")}),Object(T.assignTrackIdsByGroup)(D)),a.subtitles&&(L=a.subtitles,Object(T.assignTrackIdsByGroup)(L)),p.length>0){y=p[0].bitrate,p.sort(function(F,k){return F.bitrate-k.bitrate}),this._levels=p;for(var R=0;R<p.length;R++)if(p[R].bitrate===y){this._firstLevel=R,this.log("manifest loaded, "+p.length+" level(s) found, first bitrate: "+y);break}var P=b&&!I,w={levels:p,audioTracks:D,subtitleTracks:L,firstLevel:this._firstLevel,stats:a.stats,audio:b,video:I,altAudio:!P&&D.some(function(F){return!!F.url})};this.hls.trigger(c.Events.MANIFEST_PARSED,w),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(c.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:a.url,reason:"no level with compatible codecs found in manifest"})},e.onError=function(o,a){if(t.prototype.onError.call(this,o,a),!a.fatal){var p=a.context,D=this._levels[this.currentLevelIndex];if(p&&(p.type===u.PlaylistContextType.AUDIO_TRACK&&D.audioGroupIds&&p.groupId===D.audioGroupIds[D.urlId]||p.type===u.PlaylistContextType.SUBTITLE_TRACK&&D.textGroupIds&&p.groupId===D.textGroupIds[D.urlId])){this.redundantFailover(this.currentLevelIndex);return}var L=!1,y=!0,E;switch(a.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:if(a.frag){var _=this._levels[a.frag.level];_?(_.fragmentError++,_.fragmentError>this.hls.config.fragLoadingMaxRetry&&(E=a.frag.level)):E=a.frag.level}break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:p&&(p.deliveryDirectives&&(y=!1),E=p.level),L=!0;break;case m.ErrorDetails.REMUX_ALLOC_ERROR:E=a.level,L=!0;break}E!==void 0&&this.recoverLevel(a,E,L,y)}},e.recoverLevel=function(o,a,p,D){var L=o.details,y=this._levels[a];if(y.loadError++,p){var E=this.retryLoadingOrFail(o);if(E)o.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(D){var _=y.url.length;if(_>1&&y.loadError<_)o.levelRetry=!0,this.redundantFailover(a);else if(this.manualLevelIndex===-1){var A=a===0?this._levels.length-1:a-1;this.currentLevelIndex!==A&&this._levels[A].loadError===0&&(this.warn(L+": switch to "+A),o.levelRetry=!0,this.hls.nextAutoLevel=A)}}},e.redundantFailover=function(o){var a=this._levels[o],p=a.url.length;if(p>1){var D=(a.urlId+1)%p;this.warn("Switching to redundant URL-id "+D),this._levels.forEach(function(L){L.urlId=D}),this.level=o}},e.onFragLoaded=function(o,a){var p=a.frag;if(p!==void 0&&p.type===u.PlaylistLevelType.MAIN){var D=this._levels[p.level];D!==void 0&&(D.fragmentError=0,D.loadError=0)}},e.onLevelLoaded=function(o,a){var p,D=a.level,L=a.details,y=this._levels[D];if(!y){var E;this.warn("Invalid level index "+D),(E=a.deliveryDirectives)!==null&&E!==void 0&&E.skip&&(L.deltaUpdateFailed=!0);return}D===this.currentLevelIndex?(y.fragmentError===0&&(y.loadError=0,this.retryCount=0),this.playlistLoaded(D,a,y.details)):(p=a.deliveryDirectives)!==null&&p!==void 0&&p.skip&&(L.deltaUpdateFailed=!0)},e.onAudioTrackSwitched=function(o,a){var p=this.hls.levels[this.currentLevelIndex];if(!!p&&p.audioGroupIds){for(var D=-1,L=this.hls.audioTracks[a.id].groupId,y=0;y<p.audioGroupIds.length;y++)if(p.audioGroupIds[y]===L){D=y;break}D!==p.urlId&&(p.urlId=D,this.startLoad())}},e.loadPlaylist=function(o){var a=this.currentLevelIndex,p=this._levels[a];if(this.canLoad&&p&&p.url.length>0){var D=p.urlId,L=p.url[D];if(o)try{L=o.addDirectives(L)}catch(y){this.warn("Could not construct new URL with HLS Delivery Directives: "+y)}this.log("Attempt loading level index "+a+(o?" at sn "+o.msn+" part "+o.part:"")+" with URL-id "+D+" "+L),this.clearTimer(),this.hls.trigger(c.Events.LEVEL_LOADING,{url:L,level:a,id:D,deliveryDirectives:o||null})}},e.removeLevel=function(o,a){var p=function(y,E){return E!==a},D=this._levels.filter(function(L,y){return y!==o?!0:L.url.length>1&&a!==void 0?(L.url=L.url.filter(p),L.audioGroupIds&&(L.audioGroupIds=L.audioGroupIds.filter(p)),L.textGroupIds&&(L.textGroupIds=L.textGroupIds.filter(p)),L.urlId=0,!0):!1}).map(function(L,y){var E=L.details;return E!=null&&E.fragments&&E.fragments.forEach(function(_){_.level=y}),L});this._levels=D,this.hls.trigger(c.Events.LEVELS_UPDATED,{levels:D})},l(i,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(o){var a,p=this._levels;if(p.length!==0&&!(this.currentLevelIndex===o&&(a=p[o])!==null&&a!==void 0&&a.details)){if(o<0||o>=p.length){var D=o<0;if(this.hls.trigger(c.Events.ERROR,{type:m.ErrorTypes.OTHER_ERROR,details:m.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:D,reason:"invalid level idx"}),D)return;o=Math.min(o,p.length-1)}this.clearTimer();var L=this.currentLevelIndex,y=p[L],E=p[o];this.log("switching to level "+o+" from "+L),this.currentLevelIndex=o;var _=n({},E,{level:o,maxBitrate:E.maxBitrate,uri:E.uri,urlId:E.urlId});delete _._urlId,this.hls.trigger(c.Events.LEVEL_SWITCHING,_);var A=E.details;if(!A||A.live){var I=this.switchParams(E.uri,y==null?void 0:y.details);this.loadPlaylist(I)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(o){this.manualLevelIndex=o,this._startLevel===void 0&&(this._startLevel=o),o!==-1&&(this.level=o)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(o){this._firstLevel=o}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var o=this.hls.config.startLevel;return o!==void 0?o:this._firstLevel}else return this._startLevel},set:function(o){this._startLevel=o}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(o){this.level=o,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=o)}}]),i}(g.default)},"./src/controller/level-helper.ts":function(O,C,x){x.r(C),x.d(C,"addGroupId",function(){return m}),x.d(C,"assignTrackIdsByGroup",function(){return M}),x.d(C,"updatePTS",function(){return T}),x.d(C,"updateFragPTSDTS",function(){return u}),x.d(C,"mergeDetails",function(){return n}),x.d(C,"mapPartIntersection",function(){return d}),x.d(C,"mapFragmentIntersection",function(){return l}),x.d(C,"adjustSliding",function(){return h}),x.d(C,"addSliding",function(){return v}),x.d(C,"computeReloadInterval",function(){return f}),x.d(C,"getFragmentWithSN",function(){return r}),x.d(C,"getPartWith",function(){return t});var S=x("./src/polyfills/number.ts"),c=x("./src/utils/logger.ts");function m(i,e,s){switch(e){case"audio":i.audioGroupIds||(i.audioGroupIds=[]),i.audioGroupIds.push(s);break;case"text":i.textGroupIds||(i.textGroupIds=[]),i.textGroupIds.push(s);break}}function M(i){var e={};i.forEach(function(s){var o=s.groupId||"";s.id=e[o]=e[o]||0,e[o]++})}function T(i,e,s){var o=i[e],a=i[s];g(o,a)}function g(i,e){var s=e.startPTS;if(Object(S.isFiniteNumber)(s)){var o=0,a;e.sn>i.sn?(o=s-i.start,a=i):(o=i.start-s,a=e),a.duration!==o&&(a.duration=o)}else if(e.sn>i.sn){var p=i.cc===e.cc;p&&i.minEndPTS?e.start=i.start+(i.minEndPTS-i.start):e.start=i.start+i.duration}else e.start=Math.max(i.start-e.duration,0)}function u(i,e,s,o,a,p){var D=o-s;D<=0&&(c.logger.warn("Fragment should have a positive duration",e),o=s+e.duration,p=a+e.duration);var L=s,y=o,E=e.startPTS,_=e.endPTS;if(Object(S.isFiniteNumber)(E)){var A=Math.abs(E-s);Object(S.isFiniteNumber)(e.deltaPTS)?e.deltaPTS=Math.max(A,e.deltaPTS):e.deltaPTS=A,L=Math.max(s,E),s=Math.min(s,E),a=Math.min(a,e.startDTS),y=Math.min(o,_),o=Math.max(o,_),p=Math.max(p,e.endDTS)}e.duration=o-s;var I=s-e.start;e.appendedPTS=o,e.start=e.startPTS=s,e.maxStartPTS=L,e.startDTS=a,e.endPTS=o,e.minEndPTS=y,e.endDTS=p;var b=e.sn;if(!i||b<i.startSN||b>i.endSN)return 0;var R,P=b-i.startSN,w=i.fragments;for(w[P]=e,R=P;R>0;R--)g(w[R],w[R-1]);for(R=P;R<w.length-1;R++)g(w[R],w[R+1]);return i.fragmentHint&&g(w[w.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,I}function n(i,e){for(var s=null,o=i.fragments,a=o.length-1;a>=0;a--){var p=o[a].initSegment;if(p){s=p;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;var D=0,L;if(l(i,e,function(R,P){R.relurl&&(D=R.cc-P.cc),Object(S.isFiniteNumber)(R.startPTS)&&Object(S.isFiniteNumber)(R.endPTS)&&(P.start=P.startPTS=R.startPTS,P.startDTS=R.startDTS,P.appendedPTS=R.appendedPTS,P.maxStartPTS=R.maxStartPTS,P.endPTS=R.endPTS,P.endDTS=R.endDTS,P.minEndPTS=R.minEndPTS,P.duration=R.endPTS-R.startPTS,P.duration&&(L=P),e.PTSKnown=e.alignedSliding=!0),P.elementaryStreams=R.elementaryStreams,P.loader=R.loader,P.stats=R.stats,P.urlId=R.urlId,R.initSegment&&(P.initSegment=R.initSegment,s=R.initSegment)}),s){var y=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;y.forEach(function(R){var P;(!R.initSegment||R.initSegment.relurl===((P=s)===null||P===void 0?void 0:P.relurl))&&(R.initSegment=s)})}if(e.skippedSegments&&(e.deltaUpdateFailed=e.fragments.some(function(R){return!R}),e.deltaUpdateFailed)){c.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var E=e.skippedSegments;E--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}var _=e.fragments;if(D){c.logger.warn("discontinuity sliding from playlist, take drift into account");for(var A=0;A<_.length;A++)_[A].cc+=D}e.skippedSegments&&(e.startCC=e.fragments[0].cc),d(i.partList,e.partList,function(R,P){P.elementaryStreams=R.elementaryStreams,P.stats=R.stats}),L?u(e,L,L.startPTS,L.endPTS,L.startDTS,L.endDTS):h(i,e),_.length&&(e.totalduration=e.edge-_[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;var I=e.advancedDateTime;if(e.advanced&&I){var b=e.edge;e.driftStart||(e.driftStartTime=I,e.driftStart=b),e.driftEndTime=I,e.driftEnd=b}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}function d(i,e,s){if(i&&e)for(var o=0,a=0,p=i.length;a<=p;a++){var D=i[a],L=e[a+o];D&&L&&D.index===L.index&&D.fragment.sn===L.fragment.sn?s(D,L):o--}}function l(i,e,s){for(var o=e.skippedSegments,a=Math.max(i.startSN,e.startSN)-e.startSN,p=(i.fragmentHint?1:0)+(o?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,D=e.startSN-i.startSN,L=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,y=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments,E=a;E<=p;E++){var _=y[D+E],A=L[E];o&&!A&&E<o&&(A=e.fragments[E]=_),_&&A&&s(_,A)}}function h(i,e){var s=e.startSN+e.skippedSegments-i.startSN,o=i.fragments;s<0||s>=o.length||v(e,o[s].start)}function v(i,e){if(e){for(var s=i.fragments,o=i.skippedSegments;o<s.length;o++)s[o].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function f(i,e){var s=1e3*i.levelTargetDuration,o=s/2,a=i.age,p=a>0&&a<s*3,D=e.loading.end-e.loading.start,L,y=i.availabilityDelay;if(i.updated===!1)if(p){var E=333*i.misses;L=Math.max(Math.min(o,D*2),E),i.availabilityDelay=(i.availabilityDelay||0)+L}else L=o;else p?(y=Math.min(y||s/2,a),i.availabilityDelay=y,L=y+s-a):L=s-D;return Math.round(L)}function r(i,e,s){if(!i||!i.details)return null;var o=i.details,a=o.fragments[e-o.startSN];return a||(a=o.fragmentHint,a&&a.sn===e)?a:e<o.startSN&&s&&s.sn===e?s:null}function t(i,e,s){if(!i||!i.details)return null;var o=i.details.partList;if(o)for(var a=o.length;a--;){var p=o[a];if(p.index===s&&p.fragment.sn===e)return p}return null}},"./src/controller/stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return o});var S=x("./src/polyfills/number.ts"),c=x("./src/controller/base-stream-controller.ts"),m=x("./src/is-supported.ts"),M=x("./src/events.ts"),T=x("./src/utils/buffer-helper.ts"),g=x("./src/controller/fragment-tracker.ts"),u=x("./src/types/loader.ts"),n=x("./src/loader/fragment.ts"),d=x("./src/demux/transmuxer-interface.ts"),l=x("./src/types/transmuxer.ts"),h=x("./src/controller/gap-controller.ts"),v=x("./src/errors.ts"),f=x("./src/utils/logger.ts");function r(a,p){for(var D=0;D<p.length;D++){var L=p[D];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(a,L.key,L)}}function t(a,p,D){return p&&r(a.prototype,p),D&&r(a,D),a}function i(a,p){a.prototype=Object.create(p.prototype),a.prototype.constructor=a,e(a,p)}function e(a,p){return e=Object.setPrototypeOf||function(L,y){return L.__proto__=y,L},e(a,p)}var s=100,o=function(a){i(p,a);function p(L,y){var E;return E=a.call(this,L,y,"[stream-controller]")||this,E.audioCodecSwap=!1,E.gapController=null,E.level=-1,E._forceStartLoad=!1,E.altAudio=!1,E.audioOnly=!1,E.fragPlaying=null,E.onvplaying=null,E.onvseeked=null,E.fragLastKbps=0,E.stalled=!1,E.couldBacktrack=!1,E.audioCodecSwitch=!1,E.videoBuffer=null,E._registerListeners(),E}var D=p.prototype;return D._registerListeners=function(){var y=this.hls;y.on(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),y.on(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.on(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.on(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.on(M.Events.LEVEL_LOADING,this.onLevelLoading,this),y.on(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.on(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),y.on(M.Events.ERROR,this.onError,this),y.on(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),y.on(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),y.on(M.Events.BUFFER_CREATED,this.onBufferCreated,this),y.on(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),y.on(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),y.on(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var y=this.hls;y.off(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),y.off(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.off(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.off(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.off(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.off(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),y.off(M.Events.ERROR,this.onError,this),y.off(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),y.off(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),y.off(M.Events.BUFFER_CREATED,this.onBufferCreated,this),y.off(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),y.off(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),y.off(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},D.startLoad=function(y){if(this.levels){var E=this.lastCurrentTime,_=this.hls;if(this.stopLoad(),this.setInterval(s),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var A=_.startLevel;A===-1&&(_.config.testBandwidth?(A=0,this.bitrateTest=!0):A=_.nextAutoLevel),this.level=_.nextLoadLevel=A,this.loadedmetadata=!1}E>0&&y===-1&&(this.log("Override startPosition with lastCurrentTime @"+E.toFixed(3)),y=E),this.state=c.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=y,this.tick()}else this._forceStartLoad=!0,this.state=c.State.STOPPED},D.stopLoad=function(){this._forceStartLoad=!1,a.prototype.stopLoad.call(this)},D.doTick=function(){switch(this.state){case c.State.IDLE:this.doTickIdle();break;case c.State.WAITING_LEVEL:{var y,E=this.levels,_=this.level,A=E==null||(y=E[_])===null||y===void 0?void 0:y.details;if(A&&(!A.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(A))break;this.state=c.State.IDLE;break}break}case c.State.FRAG_LOADING_WAITING_RETRY:{var I,b=self.performance.now(),R=this.retryDate;(!R||b>=R||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=c.State.IDLE)}break}this.onTickEnd()},D.onTickEnd=function(){a.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},D.doTickIdle=function(){var y,E,_=this.hls,A=this.levelLastLoaded,I=this.levels,b=this.media,R=_.config,P=_.nextLoadLevel;if(!(A===null||!b&&(this.startFragRequested||!R.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!I||!I[P])){var w=I[P];this.level=_.nextLoadLevel=P;var F=w.details;if(!F||this.state===c.State.WAITING_LEVEL||F.live&&this.levelLastLoaded!==P){this.state=c.State.WAITING_LEVEL;return}var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:b,u.PlaylistLevelType.MAIN);if(k!==null){var B=k.len,U=this.getMaxBufferLength(w.maxBitrate);if(!(B>=U)){if(this._streamEnded(k,F)){var j={};this.altAudio&&(j.type="video"),this.hls.trigger(M.Events.BUFFER_EOS,j),this.state=c.State.ENDED;return}var K=k.end,N=this.getNextFragment(K,F);if(this.couldBacktrack&&!this.fragPrevious&&N&&N.sn!=="initSegment"){var Z=N.sn-F.startSN;Z>1&&(N=F.fragments[Z-1],this.fragmentTracker.removeFragment(N))}if(N&&this.fragmentTracker.getState(N)===g.FragmentState.OK&&this.nextLoadPosition>K){var $=this.audioOnly&&!this.altAudio?n.ElementaryStreamTypes.AUDIO:n.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(b,$,u.PlaylistLevelType.MAIN),N=this.getNextFragment(this.nextLoadPosition,F)}!N||(N.initSegment&&!N.initSegment.data&&!this.bitrateTest&&(N=N.initSegment),((y=N.decryptdata)===null||y===void 0?void 0:y.keyFormat)==="identity"&&!((E=N.decryptdata)!==null&&E!==void 0&&E.key)?this.loadKey(N,F):this.loadFragment(N,F,K))}}}},D.loadFragment=function(y,E,_){var A,I=this.fragmentTracker.getState(y);if(this.fragCurrent=y,I===g.FragmentState.BACKTRACKED){var b=this.fragmentTracker.getBacktrackData(y);if(b){this._handleFragmentLoadProgress(b),this._handleFragmentLoadComplete(b);return}else I=g.FragmentState.NOT_LOADED}I===g.FragmentState.NOT_LOADED||I===g.FragmentState.PARTIAL?y.sn==="initSegment"?this._loadInitSegment(y):this.bitrateTest?(y.bitrateTest=!0,this.log("Fragment "+y.sn+" of level "+y.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(y)):(this.startFragRequested=!0,a.prototype.loadFragment.call(this,y,E,_)):I===g.FragmentState.APPENDING?this.reduceMaxBufferLength(y.duration)&&this.fragmentTracker.removeFragment(y):((A=this.media)===null||A===void 0?void 0:A.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},D.getAppendedFrag=function(y){var E=this.fragmentTracker.getAppendedFrag(y,u.PlaylistLevelType.MAIN);return E&&"fragment"in E?E.fragment:E},D.getBufferedFrag=function(y){return this.fragmentTracker.getBufferedFrag(y,u.PlaylistLevelType.MAIN)},D.followingBufferedFrag=function(y){return y?this.getBufferedFrag(y.end+.5):null},D.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},D.nextLevelSwitch=function(){var y=this.levels,E=this.media;if(E!=null&&E.readyState){var _,A=this.getAppendedFrag(E.currentTime);if(A&&A.start>1&&this.flushMainBuffer(0,A.start-1),!E.paused&&y){var I=this.hls.nextLoadLevel,b=y[I],R=this.fragLastKbps;R&&this.fragCurrent?_=this.fragCurrent.duration*b.maxBitrate/(1e3*R)+1:_=0}else _=0;var P=this.getBufferedFrag(E.currentTime+_);if(P){var w=this.followingBufferedFrag(P);if(w){this.abortCurrentFrag();var F=w.maxStartPTS?w.maxStartPTS:w.start,k=w.duration,B=Math.max(P.end,F+Math.min(Math.max(k-this.config.maxFragLookUpTolerance,k*.5),k*.75));this.flushMainBuffer(B,Number.POSITIVE_INFINITY)}}}},D.abortCurrentFrag=function(){var y=this.fragCurrent;this.fragCurrent=null,y!=null&&y.loader&&y.loader.abort(),this.state===c.State.KEY_LOADING&&(this.state=c.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},D.flushMainBuffer=function(y,E){a.prototype.flushMainBuffer.call(this,y,E,this.altAudio?"video":null)},D.onMediaAttached=function(y,E){a.prototype.onMediaAttached.call(this,y,E);var _=E.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),_.addEventListener("playing",this.onvplaying),_.addEventListener("seeked",this.onvseeked),this.gapController=new h.default(this.config,_,this.fragmentTracker,this.hls)},D.onMediaDetaching=function(){var y=this.media;y&&(y.removeEventListener("playing",this.onvplaying),y.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),a.prototype.onMediaDetaching.call(this)},D.onMediaPlaying=function(){this.tick()},D.onMediaSeeked=function(){var y=this.media,E=y?y.currentTime:null;Object(S.isFiniteNumber)(E)&&this.log("Media seeked to "+E.toFixed(3)),this.tick()},D.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},D.onManifestParsed=function(y,E){var _=!1,A=!1,I;E.levels.forEach(function(b){I=b.audioCodec,I&&(I.indexOf("mp4a.40.2")!==-1&&(_=!0),I.indexOf("mp4a.40.5")!==-1&&(A=!0))}),this.audioCodecSwitch=_&&A&&!Object(m.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=E.levels,this.startFragRequested=!1},D.onLevelLoading=function(y,E){var _=this.levels;if(!(!_||this.state!==c.State.IDLE)){var A=_[E.level];(!A.details||A.details.live&&this.levelLastLoaded!==E.level||this.waitForCdnTuneIn(A.details))&&(this.state=c.State.WAITING_LEVEL)}},D.onLevelLoaded=function(y,E){var _,A=this.levels,I=E.level,b=E.details,R=b.totalduration;if(!A){this.warn("Levels were reset while loading level "+I);return}this.log("Level "+I+" loaded ["+b.startSN+","+b.endSN+"], cc ["+b.startCC+", "+b.endCC+"] duration:"+R);var P=this.fragCurrent;P&&(this.state===c.State.FRAG_LOADING||this.state===c.State.FRAG_LOADING_WAITING_RETRY)&&P.level!==E.level&&P.loader&&(this.state=c.State.IDLE,P.loader.abort());var w=A[I],F=0;if(b.live||(_=w.details)!==null&&_!==void 0&&_.live){if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed)return;F=this.alignPlaylists(b,w.details)}if(w.details=b,this.levelLastLoaded=I,this.hls.trigger(M.Events.LEVEL_UPDATED,{details:b,level:I}),this.state===c.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(b))return;this.state=c.State.IDLE}this.startFragRequested?b.live&&this.synchronizeToLiveEdge(b):this.setStartPosition(b,F),this.tick()},D._handleFragmentLoadProgress=function(y){var E,_=y.frag,A=y.part,I=y.payload,b=this.levels;if(!b){this.warn("Levels were reset while fragment load was in progress. Fragment "+_.sn+" of level "+_.level+" will not be buffered");return}var R=b[_.level],P=R.details;if(!P){this.warn("Dropping fragment "+_.sn+" of level "+_.level+" after level details were reset");return}var w=R.videoCodec,F=P.PTSKnown||!P.live,k=(E=_.initSegment)===null||E===void 0?void 0:E.data,B=this._getAudioCodec(R),U=this.transmuxer=this.transmuxer||new d.default(this.hls,u.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),j=A?A.index:-1,K=j!==-1,N=new l.ChunkMetadata(_.level,_.sn,_.stats.chunkCount,I.byteLength,j,K),Z=this.initPTS[_.cc];U.push(I,k,B,w,_,A,P.totalduration,F,N,Z)},D.onAudioTrackSwitching=function(y,E){var _=this.altAudio,A=!!E.url,I=E.id;if(!A){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var b=this.fragCurrent;b!=null&&b.loader&&(this.log("Switching to main audio track, cancel main fragment load"),b.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var R=this.hls;_&&R.trigger(M.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),R.trigger(M.Events.AUDIO_TRACK_SWITCHED,{id:I})}},D.onAudioTrackSwitched=function(y,E){var _=E.id,A=!!this.hls.audioTracks[_].url;if(A){var I=this.videoBuffer;I&&this.mediaBuffer!==I&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=I)}this.altAudio=A,this.tick()},D.onBufferCreated=function(y,E){var _=E.tracks,A,I,b=!1;for(var R in _){var P=_[R];if(P.id==="main"){if(I=R,A=P,R==="video"){var w=_[R];w&&(this.videoBuffer=w.buffer)}}else b=!0}b&&A?(this.log("Alternate track found, use "+I+".buffered to schedule main fragment loading"),this.mediaBuffer=A.buffer):this.mediaBuffer=this.media},D.onFragBuffered=function(y,E){var _=E.frag,A=E.part;if(!(_&&_.type!==u.PlaylistLevelType.MAIN)){if(this.fragContextChanged(_)){this.warn("Fragment "+_.sn+(A?" p: "+A.index:"")+" of level "+_.level+" finished buffering, but was aborted. state: "+this.state),this.state===c.State.PARSED&&(this.state=c.State.IDLE);return}var I=A?A.stats:_.stats;this.fragLastKbps=Math.round(8*I.total/(I.buffering.end-I.loading.first)),_.sn!=="initSegment"&&(this.fragPrevious=_),this.fragBufferedComplete(_,A)}},D.onError=function(y,E){switch(E.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:case v.ErrorDetails.KEY_LOAD_ERROR:case v.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.MAIN,E);break;case v.ErrorDetails.LEVEL_LOAD_ERROR:case v.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==c.State.ERROR&&(E.fatal?(this.warn(""+E.details),this.state=c.State.ERROR):!E.levelRetry&&this.state===c.State.WAITING_LEVEL&&(this.state=c.State.IDLE));break;case v.ErrorDetails.BUFFER_FULL_ERROR:if(E.parent==="main"&&(this.state===c.State.PARSING||this.state===c.State.PARSED)){var _=!0,A=this.getFwdBufferInfo(this.media,u.PlaylistLevelType.MAIN);A&&A.len>.5&&(_=!this.reduceMaxBufferLength(A.len)),_&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},D.checkBuffer=function(){var y=this.media,E=this.gapController;if(!(!y||!E||!y.readyState)){var _=T.BufferHelper.getBuffered(y);!this.loadedmetadata&&_.length?(this.loadedmetadata=!0,this.seekToStartPos()):E.poll(this.lastCurrentTime),this.lastCurrentTime=y.currentTime}},D.onFragLoadEmergencyAborted=function(){this.state=c.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},D.onBufferFlushed=function(y,E){var _=E.type;if(_!==n.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var A=(_===n.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(A,_,u.PlaylistLevelType.MAIN)}},D.onLevelsUpdated=function(y,E){this.levels=E.levels},D.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},D.seekToStartPos=function(){var y=this.media,E=y.currentTime,_=this.startPosition;if(_>=0&&E<_){if(y.seeking){f.logger.log("could not seek to "+_+", already seeking at "+E);return}var A=T.BufferHelper.getBuffered(y),I=A.length?A.start(0):0,b=I-_;b>0&&(b<this.config.maxBufferHole||b<this.config.maxFragLookUpTolerance)&&(f.logger.log("adjusting start position by "+b+" to match buffer start"),_+=b,this.startPosition=_),this.log("seek to target start position "+_+" from current time "+E),y.currentTime=_}},D._getAudioCodec=function(y){var E=this.config.defaultAudioCodec||y.audioCodec;return this.audioCodecSwap&&E&&(this.log("Swapping audio codec"),E.indexOf("mp4a.40.5")!==-1?E="mp4a.40.2":E="mp4a.40.5"),E},D._loadBitrateTestFrag=function(y){var E=this;this._doFragLoad(y).then(function(_){var A=E.hls;if(!(!_||A.nextLoadLevel||E.fragContextChanged(y))){E.fragLoadError=0,E.state=c.State.IDLE,E.startFragRequested=!1,E.bitrateTest=!1;var I=y.stats;I.parsing.start=I.parsing.end=I.buffering.start=I.buffering.end=self.performance.now(),A.trigger(M.Events.FRAG_LOADED,_)}})},D._handleTransmuxComplete=function(y){var E,_="main",A=this.hls,I=y.remuxResult,b=y.chunkMeta,R=this.getCurrentContext(b);if(!R){this.warn("The loading context changed while buffering fragment "+b.sn+" of level "+b.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(b.level);return}var P=R.frag,w=R.part,F=R.level,k=I.video,B=I.text,U=I.id3,j=I.initSegment,K=this.altAudio?void 0:I.audio;if(!this.fragContextChanged(P)){if(this.state=c.State.PARSING,j){j.tracks&&(this._bufferInitSegment(F,j.tracks,P,b),A.trigger(M.Events.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:_,tracks:j.tracks}));var N=j.initPTS,Z=j.timescale;Object(S.isFiniteNumber)(N)&&(this.initPTS[P.cc]=N,A.trigger(M.Events.INIT_PTS_FOUND,{frag:P,id:_,initPTS:N,timescale:Z}))}if(k&&I.independent!==!1){if(F.details){var $=k.startPTS,Y=k.endPTS,ee=k.startDTS,Q=k.endDTS;if(w)w.elementaryStreams[k.type]={startPTS:$,endPTS:Y,startDTS:ee,endDTS:Q};else if(k.firstKeyFrame&&k.independent&&(this.couldBacktrack=!0),k.dropped&&k.independent){var G=this.getLoadPosition()+this.config.maxBufferHole;if(G<$){this.backtrack(P);return}P.setElementaryStreamInfo(k.type,P.start,Y,P.start,Q,!0)}P.setElementaryStreamInfo(k.type,$,Y,ee,Q),this.bufferFragmentData(k,P,w,b)}}else if(I.independent===!1){this.backtrack(P);return}if(K){var q=K.startPTS,te=K.endPTS,ie=K.startDTS,ne=K.endDTS;w&&(w.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:q,endPTS:te,startDTS:ie,endDTS:ne}),P.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,q,te,ie,ne),this.bufferFragmentData(K,P,w,b)}if(U!=null&&(E=U.samples)!==null&&E!==void 0&&E.length){var le={frag:P,id:_,samples:U.samples};A.trigger(M.Events.FRAG_PARSING_METADATA,le)}if(B){var se={frag:P,id:_,samples:B.samples};A.trigger(M.Events.FRAG_PARSING_USERDATA,se)}}},D._bufferInitSegment=function(y,E,_,A){var I=this;if(this.state===c.State.PARSING){this.audioOnly=!!E.audio&&!E.video,this.altAudio&&!this.audioOnly&&delete E.audio;var b=E.audio,R=E.video,P=E.audiovideo;if(b){var w=y.audioCodec,F=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(w&&(w.indexOf("mp4a.40.5")!==-1?w="mp4a.40.2":w="mp4a.40.5"),b.metadata.channelCount!==1&&F.indexOf("firefox")===-1&&(w="mp4a.40.5")),F.indexOf("android")!==-1&&b.container!=="audio/mpeg"&&(w="mp4a.40.2",this.log("Android: force audio codec to "+w)),y.audioCodec&&y.audioCodec!==w&&this.log('Swapping manifest audio codec "'+y.audioCodec+'" for "'+w+'"'),b.levelCodec=w,b.id="main",this.log("Init audio buffer, container:"+b.container+", codecs[selected/level/parsed]=["+(w||"")+"/"+(y.audioCodec||"")+"/"+b.codec+"]")}R&&(R.levelCodec=y.videoCodec,R.id="main",this.log("Init video buffer, container:"+R.container+", codecs[level/parsed]=["+(y.videoCodec||"")+"/"+R.codec+"]")),P&&this.log("Init audiovideo buffer, container:"+P.container+", codecs[level/parsed]=["+(y.attrs.CODECS||"")+"/"+P.codec+"]"),this.hls.trigger(M.Events.BUFFER_CODECS,E),Object.keys(E).forEach(function(k){var B=E[k],U=B.initSegment;U!=null&&U.byteLength&&I.hls.trigger(M.Events.BUFFER_APPENDING,{type:k,data:U,frag:_,part:null,chunkMeta:A,parent:_.type})}),this.tick()}},D.backtrack=function(y){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(y);var E=this.fragmentTracker.backtrack(y);this.fragPrevious=null,this.nextLoadPosition=y.start,E?this.resetFragmentLoading(y):this.state=c.State.BACKTRACKING},D.checkFragmentChanged=function(){var y=this.media,E=null;if(y&&y.readyState>1&&y.seeking===!1){var _=y.currentTime;if(T.BufferHelper.isBuffered(y,_)?E=this.getAppendedFrag(_):T.BufferHelper.isBuffered(y,_+.1)&&(E=this.getAppendedFrag(_+.1)),E){var A=this.fragPlaying,I=E.level;(!A||E.sn!==A.sn||A.level!==I||E.urlId!==A.urlId)&&(this.hls.trigger(M.Events.FRAG_CHANGED,{frag:E}),(!A||A.level!==I)&&this.hls.trigger(M.Events.LEVEL_SWITCHED,{level:I}),this.fragPlaying=E)}}},t(p,[{key:"nextLevel",get:function(){var y=this.nextBufferedFrag;return y?y.level:-1}},{key:"currentLevel",get:function(){var y=this.media;if(y){var E=this.getAppendedFrag(y.currentTime);if(E)return E.level}return-1}},{key:"nextBufferedFrag",get:function(){var y=this.media;if(y){var E=this.getAppendedFrag(y.currentTime);return this.followingBufferedFrag(E)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),p}(c.default)},"./src/controller/subtitle-stream-controller.ts":function(O,C,x){x.r(C),x.d(C,"SubtitleStreamController",function(){return t});var S=x("./src/events.ts"),c=x("./src/utils/buffer-helper.ts"),m=x("./src/controller/fragment-finders.ts"),M=x("./src/utils/discontinuities.ts"),T=x("./src/controller/level-helper.ts"),g=x("./src/controller/fragment-tracker.ts"),u=x("./src/controller/base-stream-controller.ts"),n=x("./src/types/loader.ts"),d=x("./src/types/level.ts");function l(i,e){for(var s=0;s<e.length;s++){var o=e[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}function h(i,e,s){return e&&l(i.prototype,e),s&&l(i,s),i}function v(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,f(i,e)}function f(i,e){return f=Object.setPrototypeOf||function(o,a){return o.__proto__=a,o},f(i,e)}var r=500,t=function(i){v(e,i);function e(o,a){var p;return p=i.call(this,o,a,"[subtitle-stream-controller]")||this,p.levels=[],p.currentTrackId=-1,p.tracksBuffered=[],p.mainDetails=null,p._registerListeners(),p}var s=e.prototype;return s.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function(){var a=this.hls;a.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.on(S.Events.ERROR,this.onError,this),a.on(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.on(S.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.on(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.on(S.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s._unregisterListeners=function(){var a=this.hls;a.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.off(S.Events.ERROR,this.onError,this),a.off(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.off(S.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.off(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.off(S.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s.startLoad=function(){this.stopLoad(),this.state=u.State.IDLE,this.setInterval(r),this.tick()},s.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},s.onLevelLoaded=function(a,p){this.mainDetails=p.details},s.onSubtitleFragProcessed=function(a,p){var D=p.frag,L=p.success;if(this.fragPrevious=D,this.state=u.State.IDLE,!!L){var y=this.tracksBuffered[this.currentTrackId];if(!!y){for(var E,_=D.start,A=0;A<y.length;A++)if(_>=y[A].start&&_<=y[A].end){E=y[A];break}var I=D.start+D.duration;E?E.end=I:(E={start:_,end:I},y.push(E)),this.fragmentTracker.fragBuffered(D)}}},s.onBufferFlushing=function(a,p){var D=p.startOffset,L=p.endOffset;if(D===0&&L!==Number.POSITIVE_INFINITY){var y=this.currentTrackId,E=this.levels;if(!E.length||!E[y]||!E[y].details)return;var _=E[y].details,A=_.targetduration,I=L-A;if(I<=0)return;p.endOffsetSubtitles=Math.max(0,I),this.tracksBuffered.forEach(function(b){for(var R=0;R<b.length;){if(b[R].end<=I){b.shift();continue}else if(b[R].start<I)b[R].start=I;else break;R++}}),this.fragmentTracker.removeFragmentsInRange(D,I,n.PlaylistLevelType.SUBTITLE)}},s.onError=function(a,p){var D,L=p.frag;!L||L.type!==n.PlaylistLevelType.SUBTITLE||((D=this.fragCurrent)!==null&&D!==void 0&&D.loader&&this.fragCurrent.loader.abort(),this.state=u.State.IDLE)},s.onSubtitleTracksUpdated=function(a,p){var D=this,L=p.subtitleTracks;this.tracksBuffered=[],this.levels=L.map(function(y){return new d.Level(y)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(y){D.tracksBuffered[y.id]=[]}),this.mediaBuffer=null},s.onSubtitleTrackSwitch=function(a,p){if(this.currentTrackId=p.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var D=this.levels[this.currentTrackId];D!=null&&D.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,D&&this.setInterval(r)},s.onSubtitleTrackLoaded=function(a,p){var D,L=p.details,y=p.id,E=this.currentTrackId,_=this.levels;if(!!_.length){var A=_[E];if(!(y>=_.length||y!==E||!A)){if(this.mediaBuffer=this.mediaBufferTimeRanges,L.live||(D=A.details)!==null&&D!==void 0&&D.live){var I=this.mainDetails;if(L.deltaUpdateFailed||!I)return;var b=I.fragments[0];if(!A.details)L.hasProgramDateTime&&I.hasProgramDateTime?Object(M.alignMediaPlaylistByPDT)(L,I):b&&Object(T.addSliding)(L,b.start);else{var R=this.alignPlaylists(L,A.details);R===0&&b&&Object(T.addSliding)(L,b.start)}}if(A.details=L,this.levelLastLoaded=y,this.tick(),L.live&&!this.fragCurrent&&this.media&&this.state===u.State.IDLE){var P=Object(m.findFragmentByPTS)(null,L.fragments,this.media.currentTime,0);P||(this.warn("Subtitle playlist not aligned with playback"),A.details=void 0)}}}},s._handleFragmentLoadComplete=function(a){var p=a.frag,D=a.payload,L=p.decryptdata,y=this.hls;if(!this.fragContextChanged(p)&&D&&D.byteLength>0&&L&&L.key&&L.iv&&L.method==="AES-128"){var E=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(D),L.key.buffer,L.iv.buffer).then(function(_){var A=performance.now();y.trigger(S.Events.FRAG_DECRYPTED,{frag:p,payload:_,stats:{tstart:E,tdecrypt:A}})})}},s.doTick=function(){if(!this.media){this.state=u.State.IDLE;return}if(this.state===u.State.IDLE){var a,p=this.currentTrackId,D=this.levels;if(!D.length||!D[p]||!D[p].details)return;var L=D[p].details,y=L.targetduration,E=this.config,_=this.media,A=c.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,_.currentTime-y,E.maxBufferHole),I=A.end,b=A.len,R=this.getMaxBufferLength()+y;if(b>R)return;console.assert(L,"Subtitle track details are defined on idle subtitle stream controller tick");var P=L.fragments,w=P.length,F=L.edge,k,B=this.fragPrevious;if(I<F){var U=E.maxFragLookUpTolerance;k=Object(m.findFragmentByPTS)(B,P,I,U),!k&&B&&B.start<P[0].start&&(k=P[0])}else k=P[w-1];(a=k)!==null&&a!==void 0&&a.encrypted?this.loadKey(k,L):k&&this.fragmentTracker.getState(k)===g.FragmentState.NOT_LOADED&&this.loadFragment(k,L,I)}},s.loadFragment=function(a,p,D){this.fragCurrent=a,i.prototype.loadFragment.call(this,a,p,D)},h(e,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),e}(u.default)},"./src/controller/subtitle-track-controller.ts":function(O,C,x){x.r(C);var S=x("./src/events.ts"),c=x("./src/utils/texttrack-utils.ts"),m=x("./src/controller/base-playlist-controller.ts"),M=x("./src/types/loader.ts");function T(h,v){for(var f=0;f<v.length;f++){var r=v[f];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(h,r.key,r)}}function g(h,v,f){return v&&T(h.prototype,v),f&&T(h,f),h}function u(h,v){h.prototype=Object.create(v.prototype),h.prototype.constructor=h,n(h,v)}function n(h,v){return n=Object.setPrototypeOf||function(r,t){return r.__proto__=t,r},n(h,v)}var d=function(h){u(v,h);function v(r){var t;return t=h.call(this,r,"[subtitle-track-controller]")||this,t.media=null,t.tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.selectDefaultTrack=!0,t.queuedDefaultTrack=-1,t.trackChangeListener=function(){return t.onTextTracksChanged()},t.asyncPollTrackChange=function(){return t.pollTrackChange(0)},t.useTextTrackPolling=!1,t.subtitlePollingInterval=-1,t.subtitleDisplay=!0,t.registerListeners(),t}var f=v.prototype;return f.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,h.prototype.destroy.call(this)},f.registerListeners=function(){var t=this.hls;t.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(S.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){var t=this.hls;t.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(S.Events.ERROR,this.onError,this)},f.onMediaAttached=function(t,i){this.media=i.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},f.pollTrackChange=function(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)},f.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var t=l(this.media.textTracks);t.forEach(function(i){Object(c.clearCurrentCues)(i)}),this.subtitleTrack=-1,this.media=null}},f.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},f.onManifestParsed=function(t,i){this.tracks=i.subtitleTracks},f.onSubtitleTrackLoaded=function(t,i){var e=i.id,s=i.details,o=this.trackId,a=this.tracksInGroup[o];if(!a){this.warn("Invalid subtitle track id "+e);return}var p=a.details;a.details=i.details,this.log("subtitle track "+e+" loaded ["+s.startSN+"-"+s.endSN+"]"),e===this.trackId&&(this.retryCount=0,this.playlistLoaded(e,i,p))},f.onLevelLoading=function(t,i){this.switchLevel(i.level)},f.onLevelSwitching=function(t,i){this.switchLevel(i.level)},f.switchLevel=function(t){var i=this.hls.levels[t];if(!!(i!=null&&i.textGroupIds)){var e=i.textGroupIds[i.urlId];if(this.groupId!==e){var s=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,o=this.tracks.filter(function(D){return!e||D.groupId===e});this.tracksInGroup=o;var a=this.findTrackId(s==null?void 0:s.name)||this.findTrackId();this.groupId=e;var p={subtitleTracks:o};this.log("Updating subtitle tracks, "+o.length+' track(s) found in "'+e+'" group-id'),this.hls.trigger(S.Events.SUBTITLE_TRACKS_UPDATED,p),a!==-1&&this.setSubtitleTrack(a,s)}}},f.findTrackId=function(t){for(var i=this.tracksInGroup,e=0;e<i.length;e++){var s=i[e];if((!this.selectDefaultTrack||s.default)&&(!t||t===s.name))return s.id}return-1},f.onError=function(t,i){h.prototype.onError.call(this,t,i),!(i.fatal||!i.context)&&i.context.type===M.PlaylistContextType.SUBTITLE_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&this.retryLoadingOrFail(i)},f.loadPlaylist=function(t){var i=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(i)){var e=i.id,s=i.groupId,o=i.url;if(t)try{o=t.addDirectives(o)}catch(a){this.warn("Could not construct new URL with HLS Delivery Directives: "+a)}this.log("Loading subtitle playlist for id "+e),this.hls.trigger(S.Events.SUBTITLE_TRACK_LOADING,{url:o,id:e,groupId:s,deliveryDirectives:t||null})}},f.toggleTrackModes=function(t){var i=this,e=this.media,s=this.subtitleDisplay,o=this.trackId;if(!!e){var a=l(e.textTracks),p=a.filter(function(y){return y.groupId===i.groupId});if(t===-1)[].slice.call(a).forEach(function(y){y.mode="disabled"});else{var D=p[o];D&&(D.mode="disabled")}var L=p[t];L&&(L.mode=s?"showing":"hidden")}},f.setSubtitleTrack=function(t,i){var e,s=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(this.trackId!==t&&this.toggleTrackModes(t),!(this.trackId===t&&(t===-1||(e=s[t])!==null&&e!==void 0&&e.details)||t<-1||t>=s.length)){this.clearTimer();var o=s[t];if(this.log("Switching to subtitle track "+t),this.trackId=t,o){var a=o.id,p=o.groupId,D=p===void 0?"":p,L=o.name,y=o.type,E=o.url;this.hls.trigger(S.Events.SUBTITLE_TRACK_SWITCH,{id:a,groupId:D,name:L,type:y,url:E});var _=this.switchParams(o.url,i==null?void 0:i.details);this.loadPlaylist(_)}else this.hls.trigger(S.Events.SUBTITLE_TRACK_SWITCH,{id:t})}},f.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var t=-1,i=l(this.media.textTracks),e=0;e<i.length;e++)if(i[e].mode==="hidden")t=e;else if(i[e].mode==="showing"){t=e;break}this.subtitleTrack!==t&&(this.subtitleTrack=t)}},g(v,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1;var i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,i)}}]),v}(m.default);function l(h){for(var v=[],f=0;f<h.length;f++){var r=h[f];r.kind==="subtitles"&&r.label&&v.push(h[f])}return v}C.default=d},"./src/controller/timeline-controller.ts":function(O,C,x){x.r(C),x.d(C,"TimelineController",function(){return l});var S=x("./src/polyfills/number.ts"),c=x("./src/events.ts"),m=x("./src/utils/cea-608-parser.ts"),M=x("./src/utils/output-filter.ts"),T=x("./src/utils/webvtt-parser.ts"),g=x("./src/utils/texttrack-utils.ts"),u=x("./src/utils/imsc1-ttml-parser.ts"),n=x("./src/types/loader.ts"),d=x("./src/utils/logger.ts"),l=function(){function r(i){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=f(),this.captionsProperties=void 0,this.hls=i,this.config=i.config,this.Cues=i.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var e=new M.default(this,"textTrack1"),s=new M.default(this,"textTrack2"),o=new M.default(this,"textTrack3"),a=new M.default(this,"textTrack4");this.cea608Parser1=new m.default(1,e,s),this.cea608Parser2=new m.default(3,o,a)}i.on(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(c.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(c.Events.FRAG_LOADING,this.onFragLoading,this),i.on(c.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(c.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.on(c.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.on(c.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(c.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.on(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=r.prototype;return t.destroy=function(){var e=this.hls;e.off(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(c.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(c.Events.FRAG_LOADING,this.onFragLoading,this),e.off(c.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(c.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(c.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(c.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(c.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,s,o,a,p){for(var D=!1,L=p.length;L--;){var y=p[L],E=v(y[0],y[1],s,o);if(E>=0&&(y[0]=Math.min(y[0],s),y[1]=Math.max(y[1],o),D=!0,E/(o-s)>.5))return}if(D||p.push([s,o]),this.config.renderTextTracksNatively){var _=this.captionsTracks[e];this.Cues.newCue(_,s,o,a)}else{var A=this.Cues.newCue(null,s,o,a);this.hls.trigger(c.Events.CUES_PARSED,{type:"captions",cues:A,track:e})}},t.onInitPtsFound=function(e,s){var o=this,a=s.frag,p=s.id,D=s.initPTS,L=s.timescale,y=this.unparsedVttFrags;p==="main"&&(this.initPTS[a.cc]=D,this.timescale[a.cc]=L),y.length&&(this.unparsedVttFrags=[],y.forEach(function(E){o.onFragLoaded(c.Events.FRAG_LOADED,E)}))},t.getExistingTrack=function(e){var s=this.media;if(s)for(var o=0;o<s.textTracks.length;o++){var a=s.textTracks[o];if(a[e])return a}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var s=this.captionsProperties,o=this.captionsTracks,a=this.media,p=s[e],D=p.label,L=p.languageCode,y=this.getExistingTrack(e);if(y)o[e]=y,Object(g.clearCurrentCues)(o[e]),Object(g.sendAddTrackEvent)(o[e],a);else{var E=this.createTextTrack("captions",D,L);E&&(E[e]=!0,o[e]=E)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var s=this.captionsProperties[e];if(!!s){var o=s.label,a={_id:e,label:o,kind:"captions",default:s.media?!!s.media.default:!1,closedCaptions:s.media};this.nonNativeCaptionsTracks[e]=a,this.hls.trigger(c.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[a]})}}},t.createTextTrack=function(e,s,o){var a=this.media;if(!!a)return a.addTextTrack(e,s,o)},t.onMediaAttaching=function(e,s){this.media=s.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(s){Object(g.clearCurrentCues)(e[s]),delete e[s]}),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=f(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(!!e){var s=e.textTracks;if(s)for(var o=0;o<s.length;o++)Object(g.clearCurrentCues)(s[o])}},t.onSubtitleTracksUpdated=function(e,s){var o=this;this.textTracks=[];var a=s.subtitleTracks||[],p=a.some(function(E){return E.textCodec===u.IMSC1_CODEC});if(this.config.enableWebVTT||p&&this.config.enableIMSC1){var D=this.tracks&&a&&this.tracks.length===a.length;if(this.tracks=a||[],this.config.renderTextTracksNatively){var L=this.media?this.media.textTracks:[];this.tracks.forEach(function(E,_){var A;if(_<L.length){for(var I=null,b=0;b<L.length;b++)if(h(L[b],E)){I=L[b];break}I&&(A=I)}A?Object(g.clearCurrentCues)(A):(A=o.createTextTrack("subtitles",E.name,E.lang),A&&(A.mode="disabled")),A&&(A.groupId=E.groupId,o.textTracks.push(A))})}else if(!D&&this.tracks&&this.tracks.length){var y=this.tracks.map(function(E){return{label:E.name,kind:E.type.toLowerCase(),default:E.default,subtitleTrack:E}});this.hls.trigger(c.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:y})}}},t.onManifestLoaded=function(e,s){var o=this;this.config.enableCEA708Captions&&s.captions&&s.captions.forEach(function(a){var p=/(?:CC|SERVICE)([1-4])/.exec(a.instreamId);if(!!p){var D="textTrack"+p[1],L=o.captionsProperties[D];!L||(L.label=a.name,a.lang&&(L.languageCode=a.lang),L.media=a)}})},t.onFragLoading=function(e,s){var o=this.cea608Parser1,a=this.cea608Parser2,p=this.lastSn,D=this.lastPartIndex;if(!(!this.enabled||!(o&&a))&&s.frag.type===n.PlaylistLevelType.MAIN){var L,y,E=s.frag.sn,_=(L=s==null||(y=s.part)===null||y===void 0?void 0:y.index)!=null?L:-1;E===p+1||E===p&&_===D+1||(o.reset(),a.reset()),this.lastSn=E,this.lastPartIndex=_}},t.onFragLoaded=function(e,s){var o=s.frag,a=s.payload,p=this.initPTS,D=this.unparsedVttFrags;if(o.type===n.PlaylistLevelType.SUBTITLE)if(a.byteLength){if(!Object(S.isFiniteNumber)(p[o.cc])){D.push(s),p.length&&this.hls.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Missing initial subtitle PTS")});return}var L=o.decryptdata,y="stats"in s;if(L==null||L.key==null||L.method!=="AES-128"||y){var E=this.tracks[o.level],_=this.vttCCs;_[o.cc]||(_[o.cc]={start:o.start,prevCC:this.prevCC,new:!0},this.prevCC=o.cc),E&&E.textCodec===u.IMSC1_CODEC?this._parseIMSC1(o,a):this._parseVTTs(o,a,_)}}else this.hls.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,s){var o=this,a=this.hls;Object(u.parseIMSC1)(s,this.initPTS[e.cc],this.timescale[e.cc],function(p){o._appendCues(p,e.level),a.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(p){d.logger.log("Failed to parse IMSC1: "+p),a.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:p})})},t._parseVTTs=function(e,s,o){var a=this,p=this.hls;Object(T.parseWebVTT)(s,this.initPTS[e.cc],this.timescale[e.cc],o,e.cc,e.start,function(D){a._appendCues(D,e.level),p.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(D){a._fallbackToIMSC1(e,s),d.logger.log("Failed to parse VTT cue: "+D),p.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:D})})},t._fallbackToIMSC1=function(e,s){var o=this,a=this.tracks[e.level];a.textCodec||Object(u.parseIMSC1)(s,this.initPTS[e.cc],this.timescale[e.cc],function(){a.textCodec=u.IMSC1_CODEC,o._parseIMSC1(e,s)},function(){a.textCodec="wvtt"})},t._appendCues=function(e,s){var o=this.hls;if(this.config.renderTextTracksNatively){var a=this.textTracks[s];if(a.mode==="disabled")return;e.forEach(function(L){return Object(g.addCueToTrack)(a,L)})}else{var p=this.tracks[s],D=p.default?"default":"subtitles"+s;o.trigger(c.Events.CUES_PARSED,{type:"subtitles",cues:e,track:D})}},t.onFragDecrypted=function(e,s){var o=s.frag;if(o.type===n.PlaylistLevelType.SUBTITLE){if(!Object(S.isFiniteNumber)(this.initPTS[o.cc])){this.unparsedVttFrags.push(s);return}this.onFragLoaded(c.Events.FRAG_LOADED,s)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,s){var o=this.cea608Parser1,a=this.cea608Parser2;if(!(!this.enabled||!(o&&a)))for(var p=0;p<s.samples.length;p++){var D=s.samples[p].bytes;if(D){var L=this.extractCea608Data(D);o.addData(s.samples[p].pts,L[0]),a.addData(s.samples[p].pts,L[1])}}},t.onBufferFlushing=function(e,s){var o=s.startOffset,a=s.endOffset,p=s.endOffsetSubtitles,D=s.type,L=this.media;if(!(!L||L.currentTime<a)){if(!D||D==="video"){var y=this.captionsTracks;Object.keys(y).forEach(function(_){return Object(g.removeCuesInRange)(y[_],o,a)})}if(this.config.renderTextTracksNatively&&o===0&&p!==void 0){var E=this.textTracks;Object.keys(E).forEach(function(_){return Object(g.removeCuesInRange)(E[_],o,p)})}}},t.extractCea608Data=function(e){for(var s=e[0]&31,o=2,a=[[],[]],p=0;p<s;p++){var D=e[o++],L=127&e[o++],y=127&e[o++],E=(4&D)!==0,_=3&D;L===0&&y===0||E&&(_===0||_===1)&&(a[_].push(L),a[_].push(y))}return a},r}();function h(r,t){return r&&r.label===t.name&&!(r.textTrack1||r.textTrack2)}function v(r,t,i,e){return Math.min(t,e)-Math.max(r,i)}function f(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function c(M,T){this.subtle=void 0,this.aesIV=void 0,this.subtle=M,this.aesIV=T}var m=c.prototype;return m.decrypt=function(T,g){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},g,T)},c}()},"./src/crypt/aes-decryptor.ts":function(O,C,x){x.r(C),x.d(C,"removePadding",function(){return c}),x.d(C,"default",function(){return m});var S=x("./src/utils/typed-array.ts");function c(M){var T=M.byteLength,g=T&&new DataView(M.buffer).getUint8(T-1);return g?Object(S.sliceUint8)(M,0,T-g):M}var m=function(){function M(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var T=M.prototype;return T.uint8ArrayToUint32Array_=function(u){for(var n=new DataView(u),d=new Uint32Array(4),l=0;l<4;l++)d[l]=n.getUint32(l*4);return d},T.initTable=function(){var u=this.sBox,n=this.invSBox,d=this.subMix,l=d[0],h=d[1],v=d[2],f=d[3],r=this.invSubMix,t=r[0],i=r[1],e=r[2],s=r[3],o=new Uint32Array(256),a=0,p=0,D=0;for(D=0;D<256;D++)D<128?o[D]=D<<1:o[D]=D<<1^283;for(D=0;D<256;D++){var L=p^p<<1^p<<2^p<<3^p<<4;L=L>>>8^L&255^99,u[a]=L,n[L]=a;var y=o[a],E=o[y],_=o[E],A=o[L]*257^L*16843008;l[a]=A<<24|A>>>8,h[a]=A<<16|A>>>16,v[a]=A<<8|A>>>24,f[a]=A,A=_*16843009^E*65537^y*257^a*16843008,t[L]=A<<24|A>>>8,i[L]=A<<16|A>>>16,e[L]=A<<8|A>>>24,s[L]=A,a?(a=y^o[o[o[_^y]]],p^=o[o[p]]):a=p=1}},T.expandKey=function(u){for(var n=this.uint8ArrayToUint32Array_(u),d=!0,l=0;l<n.length&&d;)d=n[l]===this.key[l],l++;if(!d){this.key=n;var h=this.keySize=n.length;if(h!==4&&h!==6&&h!==8)throw new Error("Invalid aes key size="+h);var v=this.ksRows=(h+6+1)*4,f,r,t=this.keySchedule=new Uint32Array(v),i=this.invKeySchedule=new Uint32Array(v),e=this.sBox,s=this.rcon,o=this.invSubMix,a=o[0],p=o[1],D=o[2],L=o[3],y,E;for(f=0;f<v;f++){if(f<h){y=t[f]=n[f];continue}E=y,f%h===0?(E=E<<8|E>>>24,E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255],E^=s[f/h|0]<<24):h>6&&f%h===4&&(E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255]),t[f]=y=(t[f-h]^E)>>>0}for(r=0;r<v;r++)f=v-r,r&3?E=t[f]:E=t[f-4],r<4||f<=4?i[r]=E:i[r]=a[e[E>>>24]]^p[e[E>>>16&255]]^D[e[E>>>8&255]]^L[e[E&255]],i[r]=i[r]>>>0}},T.networkToHostOrderSwap=function(u){return u<<24|(u&65280)<<8|(u&16711680)>>8|u>>>24},T.decrypt=function(u,n,d){for(var l=this.keySize+6,h=this.invKeySchedule,v=this.invSBox,f=this.invSubMix,r=f[0],t=f[1],i=f[2],e=f[3],s=this.uint8ArrayToUint32Array_(d),o=s[0],a=s[1],p=s[2],D=s[3],L=new Int32Array(u),y=new Int32Array(L.length),E,_,A,I,b,R,P,w,F,k,B,U,j,K,N=this.networkToHostOrderSwap;n<L.length;){for(F=N(L[n]),k=N(L[n+1]),B=N(L[n+2]),U=N(L[n+3]),b=F^h[0],R=U^h[1],P=B^h[2],w=k^h[3],j=4,K=1;K<l;K++)E=r[b>>>24]^t[R>>16&255]^i[P>>8&255]^e[w&255]^h[j],_=r[R>>>24]^t[P>>16&255]^i[w>>8&255]^e[b&255]^h[j+1],A=r[P>>>24]^t[w>>16&255]^i[b>>8&255]^e[R&255]^h[j+2],I=r[w>>>24]^t[b>>16&255]^i[R>>8&255]^e[P&255]^h[j+3],b=E,R=_,P=A,w=I,j=j+4;E=v[b>>>24]<<24^v[R>>16&255]<<16^v[P>>8&255]<<8^v[w&255]^h[j],_=v[R>>>24]<<24^v[P>>16&255]<<16^v[w>>8&255]<<8^v[b&255]^h[j+1],A=v[P>>>24]<<24^v[w>>16&255]<<16^v[b>>8&255]<<8^v[R&255]^h[j+2],I=v[w>>>24]<<24^v[b>>16&255]<<16^v[R>>8&255]<<8^v[P&255]^h[j+3],y[n]=N(E^o),y[n+1]=N(I^a),y[n+2]=N(A^p),y[n+3]=N(_^D),o=F,a=k,p=B,D=U,n=n+4}return y.buffer},M}()},"./src/crypt/decrypter.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return n});var S=x("./src/crypt/aes-crypto.ts"),c=x("./src/crypt/fast-aes-key.ts"),m=x("./src/crypt/aes-decryptor.ts"),M=x("./src/utils/logger.ts"),T=x("./src/utils/mp4-tools.ts"),g=x("./src/utils/typed-array.ts"),u=16,n=function(){function d(h,v,f){var r=f===void 0?{}:f,t=r.removePKCS7Padding,i=t===void 0?!0:t;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=h,this.config=v,this.removePKCS7Padding=i,i)try{var e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var l=d.prototype;return l.destroy=function(){this.observer=null},l.isSync=function(){return this.config.enableSoftwareAES},l.flush=function(){var v=this.currentResult;if(!v){this.reset();return}var f=new Uint8Array(v);return this.reset(),this.removePKCS7Padding?Object(m.removePadding)(f):f},l.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},l.decrypt=function(v,f,r,t){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(v),f,r);var i=this.flush();i&&t(i.buffer)}else this.webCryptoDecrypt(new Uint8Array(v),f,r).then(t)},l.softwareDecrypt=function(v,f,r){var t=this.currentIV,i=this.currentResult,e=this.remainderData;this.logOnce("JS AES decrypt"),e&&(v=Object(T.appendUint8Array)(e,v),this.remainderData=null);var s=this.getValidChunk(v);if(!s.length)return null;t&&(r=t);var o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new m.default),o.expandKey(f);var a=i;return this.currentResult=o.decrypt(s.buffer,0,r),this.currentIV=Object(g.sliceUint8)(s,-16).buffer,a||null},l.webCryptoDecrypt=function(v,f,r){var t=this,i=this.subtle;return(this.key!==f||!this.fastAesKey)&&(this.key=f,this.fastAesKey=new c.default(i,f)),this.fastAesKey.expandKey().then(function(e){if(!i)return Promise.reject(new Error("web crypto not initialized"));var s=new S.default(i,r);return s.decrypt(v.buffer,e)}).catch(function(e){return t.onWebCryptoError(e,v,f,r)})},l.onWebCryptoError=function(v,f,r,t){return M.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",v),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(f,r,t)},l.getValidChunk=function(v){var f=v,r=v.length-v.length%u;return r!==v.length&&(f=Object(g.sliceUint8)(v,0,r),this.remainderData=Object(g.sliceUint8)(v,r)),f},l.logOnce=function(v){!this.logEnabled||(M.logger.log("[decrypter.ts]: "+v),this.logEnabled=!1)},d}()},"./src/crypt/fast-aes-key.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function c(M,T){this.subtle=void 0,this.key=void 0,this.subtle=M,this.key=T}var m=c.prototype;return m.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},c}()},"./src/demux/aacdemuxer.ts":function(O,C,x){x.r(C);var S=x("./src/demux/base-audio-demuxer.ts"),c=x("./src/demux/adts.ts"),m=x("./src/utils/logger.ts"),M=x("./src/demux/id3.ts");function T(n,d){n.prototype=Object.create(d.prototype),n.prototype.constructor=n,g(n,d)}function g(n,d){return g=Object.setPrototypeOf||function(h,v){return h.__proto__=v,h},g(n,d)}var u=function(n){T(d,n);function d(h,v){var f;return f=n.call(this)||this,f.observer=void 0,f.config=void 0,f.observer=h,f.config=v,f}var l=d.prototype;return l.resetInitSegment=function(v,f,r){n.prototype.resetInitSegment.call(this,v,f,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:v,duration:r,inputTimeScale:9e4,dropped:0}},d.probe=function(v){if(!v)return!1;for(var f=M.getID3Data(v,0)||[],r=f.length,t=v.length;r<t;r++)if(c.probe(v,r))return m.logger.log("ADTS sync word found !"),!0;return!1},l.canParse=function(v,f){return c.canParse(v,f)},l.appendFrame=function(v,f,r){c.initTrackConfig(v,this.observer,f,r,v.manifestCodec);var t=c.appendFrame(v,f,r,this.initPTS,this.frameIndex);if(t&&t.missing===0)return t},d}(S.default);u.minProbeByteLength=9,C.default=u},"./src/demux/adts.ts":function(O,C,x){x.r(C),x.d(C,"getAudioConfig",function(){return M}),x.d(C,"isHeaderPattern",function(){return T}),x.d(C,"getHeaderLength",function(){return g}),x.d(C,"getFullFrameLength",function(){return u}),x.d(C,"canGetFrameLength",function(){return n}),x.d(C,"isHeader",function(){return d}),x.d(C,"canParse",function(){return l}),x.d(C,"probe",function(){return h}),x.d(C,"initTrackConfig",function(){return v}),x.d(C,"getFrameDuration",function(){return f}),x.d(C,"parseFrameHeader",function(){return r}),x.d(C,"appendFrame",function(){return t});var S=x("./src/utils/logger.ts"),c=x("./src/errors.ts"),m=x("./src/events.ts");function M(i,e,s,o){var a,p,D,L,y=navigator.userAgent.toLowerCase(),E=o,_=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((e[s+2]&192)>>>6)+1;var A=(e[s+2]&60)>>>2;if(A>_.length-1){i.trigger(m.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+A});return}return D=(e[s+2]&1)<<2,D|=(e[s+3]&192)>>>6,S.logger.log("manifest codec:"+o+", ADTS type:"+a+", samplingIndex:"+A),/firefox/i.test(y)?A>=6?(a=5,L=new Array(4),p=A-3):(a=2,L=new Array(2),p=A):y.indexOf("android")!==-1?(a=2,L=new Array(2),p=A):(a=5,L=new Array(4),o&&(o.indexOf("mp4a.40.29")!==-1||o.indexOf("mp4a.40.5")!==-1)||!o&&A>=6?p=A-3:((o&&o.indexOf("mp4a.40.2")!==-1&&(A>=6&&D===1||/vivaldi/i.test(y))||!o&&D===1)&&(a=2,L=new Array(2)),p=A)),L[0]=a<<3,L[0]|=(A&14)>>1,L[1]|=(A&1)<<7,L[1]|=D<<3,a===5&&(L[1]|=(p&14)>>1,L[2]=(p&1)<<7,L[2]|=2<<2,L[3]=0),{config:L,samplerate:_[A],channelCount:D,codec:"mp4a.40."+a,manifestCodec:E}}function T(i,e){return i[e]===255&&(i[e+1]&246)===240}function g(i,e){return i[e+1]&1?7:9}function u(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function n(i,e){return e+5<i.length}function d(i,e){return e+1<i.length&&T(i,e)}function l(i,e){return n(i,e)&&T(i,e)&&u(i,e)<=i.length-e}function h(i,e){if(d(i,e)){var s=g(i,e);if(e+s>=i.length)return!1;var o=u(i,e);if(o<=s)return!1;var a=e+o;return a===i.length||d(i,a)}return!1}function v(i,e,s,o,a){if(!i.samplerate){var p=M(e,s,o,a);if(!p)return;i.config=p.config,i.samplerate=p.samplerate,i.channelCount=p.channelCount,i.codec=p.codec,i.manifestCodec=p.manifestCodec,S.logger.log("parsed codec:"+i.codec+", rate:"+p.samplerate+", channels:"+p.channelCount)}}function f(i){return 1024*9e4/i}function r(i,e,s,o,a){var p=g(i,e),D=u(i,e);if(D-=p,D>0){var L=s+o*a;return{headerLength:p,frameLength:D,stamp:L}}}function t(i,e,s,o,a){var p=f(i.samplerate),D=r(e,s,o,a,p);if(D){var L=D.frameLength,y=D.headerLength,E=D.stamp,_=y+L,A=Math.max(0,s+_-e.length),I;A?(I=new Uint8Array(_-y),I.set(e.subarray(s+y,e.length),0)):I=e.subarray(s+y,s+_);var b={unit:I,pts:E};return A||i.samples.push(b),{sample:b,length:_,missing:A}}}},"./src/demux/base-audio-demuxer.ts":function(O,C,x){x.r(C),x.d(C,"initPTSFn",function(){return u});var S=x("./src/polyfills/number.ts"),c=x("./src/demux/id3.ts"),m=x("./src/demux/dummy-demuxed-track.ts"),M=x("./src/utils/mp4-tools.ts"),T=x("./src/utils/typed-array.ts"),g=function(){function n(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var d=n.prototype;return d.resetInitSegment=function(h,v,f){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},d.resetTimeStamp=function(){},d.resetContiguity=function(){},d.canParse=function(h,v){return!1},d.appendFrame=function(h,v,f){},d.demux=function(h,v){this.cachedData&&(h=Object(M.appendUint8Array)(this.cachedData,h),this.cachedData=null);var f=c.getID3Data(h,0),r=f?f.length:0,t,i,e=this._audioTrack,s=this._id3Track,o=f?c.getTimeStamp(f):void 0,a=h.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=u(o,v)),f&&f.length>0&&s.samples.push({pts:this.initPTS,dts:this.initPTS,data:f}),i=this.initPTS;r<a;){if(this.canParse(h,r)){var p=this.appendFrame(e,h,r);p?(this.frameIndex++,i=p.sample.pts,r+=p.length,t=r):r=a}else c.canParse(h,r)?(f=c.getID3Data(h,r),s.samples.push({pts:i,dts:i,data:f}),r+=f.length,t=r):r++;if(r===a&&t!==a){var D=Object(T.sliceUint8)(h,t);this.cachedData?this.cachedData=Object(M.appendUint8Array)(this.cachedData,D):this.cachedData=D}}return{audioTrack:e,avcTrack:Object(m.dummyTrack)(),id3Track:s,textTrack:Object(m.dummyTrack)()}},d.demuxSampleAes=function(h,v,f){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},d.flush=function(h){var v=this.cachedData;return v&&(this.cachedData=null,this.demux(v,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(m.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(m.dummyTrack)()}},d.destroy=function(){},n}(),u=function(d,l){return Object(S.isFiniteNumber)(d)?d*90:l*9e4};C.default=g},"./src/demux/chunk-cache.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function m(){this.chunks=[],this.dataLength=0}var M=m.prototype;return M.push=function(g){this.chunks.push(g),this.dataLength+=g.length},M.flush=function(){var g=this.chunks,u=this.dataLength,n;if(g.length)g.length===1?n=g[0]:n=c(g,u);else return new Uint8Array(0);return this.reset(),n},M.reset=function(){this.chunks.length=0,this.dataLength=0},m}();function c(m,M){for(var T=new Uint8Array(M),g=0,u=0;u<m.length;u++){var n=m[u];T.set(n,g),g+=n.length}return T}},"./src/demux/dummy-demuxed-track.ts":function(O,C,x){x.r(C),x.d(C,"dummyTrack",function(){return S});function S(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(O,C,x){x.r(C);var S=x("./src/utils/logger.ts"),c=function(){function m(T){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=T,this.bytesAvailable=T.byteLength,this.word=0,this.bitsAvailable=0}var M=m.prototype;return M.loadWord=function(){var g=this.data,u=this.bytesAvailable,n=g.byteLength-u,d=new Uint8Array(4),l=Math.min(4,u);if(l===0)throw new Error("no bytes available");d.set(g.subarray(n,n+l)),this.word=new DataView(d.buffer).getUint32(0),this.bitsAvailable=l*8,this.bytesAvailable-=l},M.skipBits=function(g){var u;this.bitsAvailable>g?(this.word<<=g,this.bitsAvailable-=g):(g-=this.bitsAvailable,u=g>>3,g-=u>>3,this.bytesAvailable-=u,this.loadWord(),this.word<<=g,this.bitsAvailable-=g)},M.readBits=function(g){var u=Math.min(this.bitsAvailable,g),n=this.word>>>32-u;return g>32&&S.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=u,this.bitsAvailable>0?this.word<<=u:this.bytesAvailable>0&&this.loadWord(),u=g-u,u>0&&this.bitsAvailable?n<<u|this.readBits(u):n},M.skipLZ=function(){var g;for(g=0;g<this.bitsAvailable;++g)if((this.word&2147483648>>>g)!==0)return this.word<<=g,this.bitsAvailable-=g,g;return this.loadWord(),g+this.skipLZ()},M.skipUEG=function(){this.skipBits(1+this.skipLZ())},M.skipEG=function(){this.skipBits(1+this.skipLZ())},M.readUEG=function(){var g=this.skipLZ();return this.readBits(g+1)-1},M.readEG=function(){var g=this.readUEG();return 1&g?1+g>>>1:-1*(g>>>1)},M.readBoolean=function(){return this.readBits(1)===1},M.readUByte=function(){return this.readBits(8)},M.readUShort=function(){return this.readBits(16)},M.readUInt=function(){return this.readBits(32)},M.skipScalingList=function(g){for(var u=8,n=8,d,l=0;l<g;l++)n!==0&&(d=this.readEG(),n=(u+d+256)%256),u=n===0?u:n},M.readSPS=function(){var g=0,u=0,n=0,d=0,l,h,v,f=this.readUByte.bind(this),r=this.readBits.bind(this),t=this.readUEG.bind(this),i=this.readBoolean.bind(this),e=this.skipBits.bind(this),s=this.skipEG.bind(this),o=this.skipUEG.bind(this),a=this.skipScalingList.bind(this);f();var p=f();if(r(5),e(3),f(),o(),p===100||p===110||p===122||p===244||p===44||p===83||p===86||p===118||p===128){var D=t();if(D===3&&e(1),o(),o(),e(1),i())for(h=D!==3?8:12,v=0;v<h;v++)i()&&(v<6?a(16):a(64))}o();var L=t();if(L===0)t();else if(L===1)for(e(1),s(),s(),l=t(),v=0;v<l;v++)s();o(),e(1);var y=t(),E=t(),_=r(1);_===0&&e(1),e(1),i()&&(g=t(),u=t(),n=t(),d=t());var A=[1,1];if(i()&&i()){var I=f();switch(I){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:{A=[f()<<8|f(),f()<<8|f()];break}}}return{width:Math.ceil((y+1)*16-g*2-u*2),height:(2-_)*(E+1)*16-(_?2:4)*(n+d),pixelRatio:A}},M.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},m}();C.default=c},"./src/demux/id3.ts":function(O,C,x){x.r(C),x.d(C,"isHeader",function(){return S}),x.d(C,"isFooter",function(){return c}),x.d(C,"getID3Data",function(){return m}),x.d(C,"canParse",function(){return T}),x.d(C,"getTimeStamp",function(){return g}),x.d(C,"isTimeStampFrame",function(){return u}),x.d(C,"getID3Frames",function(){return d}),x.d(C,"decodeFrame",function(){return l}),x.d(C,"utf8ArrayToStr",function(){return t}),x.d(C,"testables",function(){return i});var S=function(a,p){return p+10<=a.length&&a[p]===73&&a[p+1]===68&&a[p+2]===51&&a[p+3]<255&&a[p+4]<255&&a[p+6]<128&&a[p+7]<128&&a[p+8]<128&&a[p+9]<128},c=function(a,p){return p+10<=a.length&&a[p]===51&&a[p+1]===68&&a[p+2]===73&&a[p+3]<255&&a[p+4]<255&&a[p+6]<128&&a[p+7]<128&&a[p+8]<128&&a[p+9]<128},m=function(a,p){for(var D=p,L=0;S(a,p);){L+=10;var y=M(a,p+6);L+=y,c(a,p+10)&&(L+=10),p+=L}if(L>0)return a.subarray(D,D+L)},M=function(a,p){var D=0;return D=(a[p]&127)<<21,D|=(a[p+1]&127)<<14,D|=(a[p+2]&127)<<7,D|=a[p+3]&127,D},T=function(a,p){return S(a,p)&&M(a,p+6)+10<=a.length-p},g=function(a){for(var p=d(a),D=0;D<p.length;D++){var L=p[D];if(u(L))return r(L)}},u=function(a){return a&&a.key==="PRIV"&&a.info==="com.apple.streaming.transportStreamTimestamp"},n=function(a){var p=String.fromCharCode(a[0],a[1],a[2],a[3]),D=M(a,4),L=10;return{type:p,size:D,data:a.subarray(L,L+D)}},d=function(a){for(var p=0,D=[];S(a,p);){var L=M(a,p+6);p+=10;for(var y=p+L;p+8<y;){var E=n(a.subarray(p)),_=l(E);_&&D.push(_),p+=E.size+10}c(a,p)&&(p+=10)}return D},l=function(a){return a.type==="PRIV"?h(a):a.type[0]==="W"?f(a):v(a)},h=function(a){if(!(a.size<2)){var p=t(a.data,!0),D=new Uint8Array(a.data.subarray(p.length+1));return{key:a.type,info:p,data:D.buffer}}},v=function(a){if(!(a.size<2)){if(a.type==="TXXX"){var p=1,D=t(a.data.subarray(p),!0);p+=D.length+1;var L=t(a.data.subarray(p));return{key:a.type,info:D,data:L}}var y=t(a.data.subarray(1));return{key:a.type,data:y}}},f=function(a){if(a.type==="WXXX"){if(a.size<2)return;var p=1,D=t(a.data.subarray(p),!0);p+=D.length+1;var L=t(a.data.subarray(p));return{key:a.type,info:D,data:L}}var y=t(a.data);return{key:a.type,data:y}},r=function(a){if(a.data.byteLength===8){var p=new Uint8Array(a.data),D=p[3]&1,L=(p[4]<<23)+(p[5]<<15)+(p[6]<<7)+p[7];return L/=45,D&&(L+=4772185884e-2),Math.round(L)}},t=function(a,p){p===void 0&&(p=!1);var D=s();if(D){var L=D.decode(a);if(p){var y=L.indexOf("\0");return y!==-1?L.substring(0,y):L}return L.replace(/\0/g,"")}for(var E=a.length,_,A,I,b="",R=0;R<E;){if(_=a[R++],_===0&&p)return b;if(_===0||_===3)continue;switch(_>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(_);break;case 12:case 13:A=a[R++],b+=String.fromCharCode((_&31)<<6|A&63);break;case 14:A=a[R++],I=a[R++],b+=String.fromCharCode((_&15)<<12|(A&63)<<6|(I&63)<<0);break}}return b},i={decodeTextFrame:v},e;function s(){return!e&&typeof self.TextDecoder!="undefined"&&(e=new self.TextDecoder("utf-8")),e}},"./src/demux/mp3demuxer.ts":function(O,C,x){x.r(C);var S=x("./src/demux/base-audio-demuxer.ts"),c=x("./src/demux/id3.ts"),m=x("./src/utils/logger.ts"),M=x("./src/demux/mpegaudio.ts");function T(n,d){n.prototype=Object.create(d.prototype),n.prototype.constructor=n,g(n,d)}function g(n,d){return g=Object.setPrototypeOf||function(h,v){return h.__proto__=v,h},g(n,d)}var u=function(n){T(d,n);function d(){return n.apply(this,arguments)||this}var l=d.prototype;return l.resetInitSegment=function(v,f,r){n.prototype.resetInitSegment.call(this,v,f,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:v,duration:r,inputTimeScale:9e4,dropped:0}},d.probe=function(v){if(!v)return!1;for(var f=c.getID3Data(v,0)||[],r=f.length,t=v.length;r<t;r++)if(M.probe(v,r))return m.logger.log("MPEG Audio sync word found !"),!0;return!1},l.canParse=function(v,f){return M.canParse(v,f)},l.appendFrame=function(v,f,r){if(this.initPTS!==null)return M.appendFrame(v,f,r,this.initPTS,this.frameIndex)},d}(S.default);u.minProbeByteLength=4,C.default=u},"./src/demux/mp4demuxer.ts":function(O,C,x){x.r(C);var S=x("./src/utils/mp4-tools.ts"),c=x("./src/demux/dummy-demuxed-track.ts"),m=function(){function M(g,u){this.remainderData=null,this.config=void 0,this.config=u}var T=M.prototype;return T.resetTimeStamp=function(){},T.resetInitSegment=function(){},T.resetContiguity=function(){},M.probe=function(u){return Object(S.findBox)({data:u,start:0,end:Math.min(u.length,16384)},["moof"]).length>0},T.demux=function(u){var n=u,d=Object(c.dummyTrack)();if(this.config.progressive){this.remainderData&&(n=Object(S.appendUint8Array)(this.remainderData,u));var l=Object(S.segmentValidRange)(n);this.remainderData=l.remainder,d.samples=l.valid||new Uint8Array}else d.samples=n;return{audioTrack:Object(c.dummyTrack)(),avcTrack:d,id3Track:Object(c.dummyTrack)(),textTrack:Object(c.dummyTrack)()}},T.flush=function(){var u=Object(c.dummyTrack)();return u.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(c.dummyTrack)(),avcTrack:u,id3Track:Object(c.dummyTrack)(),textTrack:Object(c.dummyTrack)()}},T.demuxSampleAes=function(u,n,d){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},T.destroy=function(){},M}();m.minProbeByteLength=1024,C.default=m},"./src/demux/mpegaudio.ts":function(O,C,x){x.r(C),x.d(C,"appendFrame",function(){return g}),x.d(C,"parseHeader",function(){return u}),x.d(C,"isHeaderPattern",function(){return n}),x.d(C,"isHeader",function(){return d}),x.d(C,"canParse",function(){return l}),x.d(C,"probe",function(){return h});var S=null,c=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],m=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],T=[0,1,1,4];function g(v,f,r,t,i){if(!(r+24>f.length)){var e=u(f,r);if(e&&r+e.frameLength<=f.length){var s=e.samplesPerFrame*9e4/e.sampleRate,o=t+i*s,a={unit:f.subarray(r,r+e.frameLength),pts:o,dts:o};return v.config=[],v.channelCount=e.channelCount,v.samplerate=e.sampleRate,v.samples.push(a),{sample:a,length:e.frameLength,missing:0}}}}function u(v,f){var r=v[f+1]>>3&3,t=v[f+1]>>1&3,i=v[f+2]>>4&15,e=v[f+2]>>2&3;if(r!==1&&i!==0&&i!==15&&e!==3){var s=v[f+2]>>1&1,o=v[f+3]>>6,a=r===3?3-t:t===3?3:4,p=c[a*14+i-1]*1e3,D=r===3?0:r===2?1:2,L=m[D*3+e],y=o===3?1:2,E=M[r][t],_=T[t],A=E*8*_,I=Math.floor(E*p/L+s)*_;if(S===null){var b=navigator.userAgent||"",R=b.match(/Chrome\/(\d+)/i);S=R?parseInt(R[1]):0}var P=!!S&&S<=87;return P&&t===2&&p>=224e3&&o===0&&(v[f+3]=v[f+3]|128),{sampleRate:L,channelCount:y,frameLength:I,samplesPerFrame:A}}}function n(v,f){return v[f]===255&&(v[f+1]&224)===224&&(v[f+1]&6)!==0}function d(v,f){return f+1<v.length&&n(v,f)}function l(v,f){var r=4;return n(v,f)&&r<=v.length-f}function h(v,f){if(f+1<v.length&&n(v,f)){var r=4,t=u(v,f),i=r;t!=null&&t.frameLength&&(i=t.frameLength);var e=f+i;return e===v.length||d(v,e)}return!1}},"./src/demux/sample-aes.ts":function(O,C,x){x.r(C);var S=x("./src/crypt/decrypter.ts"),c=x("./src/demux/tsdemuxer.ts"),m=function(){function M(g,u,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new S.default(g,u,{removePKCS7Padding:!1})}var T=M.prototype;return T.decryptBuffer=function(u,n){this.decrypter.decrypt(u,this.keyData.key.buffer,this.keyData.iv.buffer,n)},T.decryptAacSample=function(u,n,d,l){var h=u[n].unit,v=h.subarray(16,h.length-h.length%16),f=v.buffer.slice(v.byteOffset,v.byteOffset+v.length),r=this;this.decryptBuffer(f,function(t){var i=new Uint8Array(t);h.set(i,16),l||r.decryptAacSamples(u,n+1,d)})},T.decryptAacSamples=function(u,n,d){for(;;n++){if(n>=u.length){d();return}if(!(u[n].unit.length<32)){var l=this.decrypter.isSync();if(this.decryptAacSample(u,n,d,l),!l)return}}},T.getAvcEncryptedData=function(u){for(var n=Math.floor((u.length-48)/160)*16+16,d=new Int8Array(n),l=0,h=32;h<u.length-16;h+=160,l+=16)d.set(u.subarray(h,h+16),l);return d},T.getAvcDecryptedUnit=function(u,n){for(var d=new Uint8Array(n),l=0,h=32;h<u.length-16;h+=160,l+=16)u.set(d.subarray(l,l+16),h);return u},T.decryptAvcSample=function(u,n,d,l,h,v){var f=Object(c.discardEPB)(h.data),r=this.getAvcEncryptedData(f),t=this;this.decryptBuffer(r.buffer,function(i){h.data=t.getAvcDecryptedUnit(f,i),v||t.decryptAvcSamples(u,n,d+1,l)})},T.decryptAvcSamples=function(u,n,d,l){if(u instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,d=0){if(n>=u.length){l();return}for(var h=u[n].units;!(d>=h.length);d++){var v=h[d];if(!(v.data.length<=48||v.type!==1&&v.type!==5)){var f=this.decrypter.isSync();if(this.decryptAvcSample(u,n,d,l,v,f),!f)return}}}},M}();C.default=m},"./src/demux/transmuxer-interface.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return d});var S=x("./node_modules/webworkify-webpack/index.js"),c=x("./src/events.ts"),m=x("./src/demux/transmuxer.ts"),M=x("./src/utils/logger.ts"),T=x("./src/errors.ts"),g=x("./src/utils/mediasource-helper.ts"),u=x("./node_modules/eventemitter3/index.js"),n=Object(g.getMediaSource)()||{isTypeSupported:function(){return!1}},d=function(){function l(v,f,r,t){var i=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=v,this.id=f,this.onTransmuxComplete=r,this.onFlush=t;var e=v.config,s=function(L,y){y=y||{},y.frag=i.frag,y.id=i.id,v.trigger(L,y)};this.observer=new u.EventEmitter,this.observer.on(c.Events.FRAG_DECRYPTED,s),this.observer.on(c.Events.ERROR,s);var o={mp4:n.isTypeSupported("video/mp4"),mpeg:n.isTypeSupported("audio/mpeg"),mp3:n.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(e.enableWorker&&typeof Worker!="undefined"){M.logger.log("demuxing in webworker");var p;try{p=this.worker=S("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),p.addEventListener("message",this.onwmsg),p.onerror=function(D){v.trigger(c.Events.ERROR,{type:T.ErrorTypes.OTHER_ERROR,details:T.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(D.message+"  ("+D.filename+":"+D.lineno+")")})},p.postMessage({cmd:"init",typeSupported:o,vendor:a,id:f,config:JSON.stringify(e)})}catch(D){M.logger.warn("Error in worker:",D),M.logger.error("Error while initializing DemuxerWorker, fallback to inline"),p&&self.URL.revokeObjectURL(p.objectURL),this.transmuxer=new m.default(this.observer,o,e,a,f),this.worker=null}}else this.transmuxer=new m.default(this.observer,o,e,a,f)}var h=l.prototype;return h.destroy=function(){var f=this.worker;if(f)f.removeEventListener("message",this.onwmsg),f.terminate(),this.worker=null;else{var r=this.transmuxer;r&&(r.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.observer=null},h.push=function(f,r,t,i,e,s,o,a,p,D){var L,y,E=this;p.transmuxing.start=self.performance.now();var _=this.transmuxer,A=this.worker,I=s?s.start:e.start,b=e.decryptdata,R=this.frag,P=!(R&&e.cc===R.cc),w=!(R&&p.level===R.level),F=R?p.sn-R.sn:-1,k=this.part?p.part-this.part.index:1,B=!w&&(F===1||F===0&&k===1),U=self.performance.now();(w||F||e.stats.parsing.start===0)&&(e.stats.parsing.start=U),s&&(k||!B)&&(s.stats.parsing.start=U);var j=!(R&&((L=e.initSegment)===null||L===void 0?void 0:L.url)===((y=R.initSegment)===null||y===void 0?void 0:y.url)),K=new m.TransmuxState(P,B,a,w,I,j);if(!B||P||j){M.logger.log("[transmuxer-interface, "+e.type+"]: Starting new transmux session for sn: "+p.sn+" p: "+p.part+" level: "+p.level+" id: "+p.id+`
        discontinuity: `+P+`
        trackSwitch: `+w+`
        contiguous: `+B+`
        accurateTimeOffset: `+a+`
        timeOffset: `+I+`
        initSegmentChange: `+j);var N=new m.TransmuxConfig(t,i,r,o,D);this.configureTransmuxer(N)}if(this.frag=e,this.part=s,A)A.postMessage({cmd:"demux",data:f,decryptdata:b,chunkMeta:p,state:K},f instanceof ArrayBuffer?[f]:[]);else if(_){var Z=_.push(f,b,p,K);Object(m.isPromise)(Z)?Z.then(function($){E.handleTransmuxComplete($)}):this.handleTransmuxComplete(Z)}},h.flush=function(f){var r=this;f.transmuxing.start=self.performance.now();var t=this.transmuxer,i=this.worker;if(i)i.postMessage({cmd:"flush",chunkMeta:f});else if(t){var e=t.flush(f);Object(m.isPromise)(e)?e.then(function(s){r.handleFlushResult(s,f)}):this.handleFlushResult(e,f)}},h.handleFlushResult=function(f,r){var t=this;f.forEach(function(i){t.handleTransmuxComplete(i)}),this.onFlush(r)},h.onWorkerMessage=function(f){var r=f.data,t=this.hls;switch(r.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(r.data);break}case"flush":{this.onFlush(r.data);break}default:{r.data=r.data||{},r.data.frag=this.frag,r.data.id=this.id,t.trigger(r.event,r.data);break}}},h.configureTransmuxer=function(f){var r=this.worker,t=this.transmuxer;r?r.postMessage({cmd:"configure",config:f}):t&&t.configure(f)},h.handleTransmuxComplete=function(f){f.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(f)},l}()},"./src/demux/transmuxer-worker.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return T});var S=x("./src/demux/transmuxer.ts"),c=x("./src/events.ts"),m=x("./src/utils/logger.ts"),M=x("./node_modules/eventemitter3/index.js");function T(l){var h=new M.EventEmitter,v=function(r,t){l.postMessage({event:r,data:t})};h.on(c.Events.FRAG_DECRYPTED,v),h.on(c.Events.ERROR,v),l.addEventListener("message",function(f){var r=f.data;switch(r.cmd){case"init":{var t=JSON.parse(r.config);l.transmuxer=new S.default(h,r.typeSupported,t,r.vendor,r.id),Object(m.enableLogs)(t.debug),v("init",null);break}case"configure":{l.transmuxer.configure(r.config);break}case"demux":{var i=l.transmuxer.push(r.data,r.decryptdata,r.chunkMeta,r.state);Object(S.isPromise)(i)?i.then(function(o){g(l,o)}):g(l,i);break}case"flush":{var e=r.chunkMeta,s=l.transmuxer.flush(e);Object(S.isPromise)(s)?s.then(function(o){n(l,o,e)}):n(l,s,e);break}}})}function g(l,h){if(!d(h.remuxResult)){var v=[],f=h.remuxResult,r=f.audio,t=f.video;r&&u(v,r),t&&u(v,t),l.postMessage({event:"transmuxComplete",data:h},v)}}function u(l,h){h.data1&&l.push(h.data1.buffer),h.data2&&l.push(h.data2.buffer)}function n(l,h,v){h.forEach(function(f){g(l,f)}),l.postMessage({event:"flush",data:v})}function d(l){return!l.audio&&!l.video&&!l.text&&!l.id3&&!l.initSegment}},"./src/demux/transmuxer.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return i}),x.d(C,"isPromise",function(){return o}),x.d(C,"TransmuxConfig",function(){return a}),x.d(C,"TransmuxState",function(){return p});var S=x("./src/events.ts"),c=x("./src/errors.ts"),m=x("./src/crypt/decrypter.ts"),M=x("./src/demux/aacdemuxer.ts"),T=x("./src/demux/mp4demuxer.ts"),g=x("./src/demux/tsdemuxer.ts"),u=x("./src/demux/mp3demuxer.ts"),n=x("./src/remux/mp4-remuxer.ts"),d=x("./src/remux/passthrough-remuxer.ts"),l=x("./src/demux/chunk-cache.ts"),h=x("./src/utils/mp4-tools.ts"),v=x("./src/utils/logger.ts"),f;try{f=self.performance.now.bind(self.performance)}catch{v.logger.debug("Unable to use Performance API on this environment"),f=self.Date.now}var r=[{demux:g.default,remux:n.default},{demux:T.default,remux:d.default},{demux:M.default,remux:n.default},{demux:u.default,remux:n.default}],t=1024;r.forEach(function(D){var L=D.demux;t=Math.max(t,L.minProbeByteLength)});var i=function(){function D(y,E,_,A,I){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new l.default,this.observer=y,this.typeSupported=E,this.config=_,this.vendor=A,this.id=I}var L=D.prototype;return L.configure=function(E){this.transmuxConfig=E,this.decrypter&&this.decrypter.reset()},L.push=function(E,_,A,I){var b=this,R=A.transmuxing;R.executeStart=f();var P=new Uint8Array(E),w=this.cache,F=this.config,k=this.currentTransmuxState,B=this.transmuxConfig;I&&(this.currentTransmuxState=I);var U=e(P,_);if(U&&U.method==="AES-128"){var j=this.getDecrypter();if(F.enableSoftwareAES){var K=j.softwareDecrypt(P,U.key.buffer,U.iv.buffer);if(!K)return R.executeEnd=f(),s(A);P=new Uint8Array(K)}else return this.decryptionPromise=j.webCryptoDecrypt(P,U.key.buffer,U.iv.buffer).then(function(ae){var fe=b.push(ae,null,A);return b.decryptionPromise=null,fe}),this.decryptionPromise}var N=I||k,Z=N.contiguous,$=N.discontinuity,Y=N.trackSwitch,ee=N.accurateTimeOffset,Q=N.timeOffset,G=N.initSegmentChange,q=B.audioCodec,te=B.videoCodec,ie=B.defaultInitPts,ne=B.duration,le=B.initSegmentData;if(($||Y||G)&&this.resetInitSegment(le,q,te,ne),($||G)&&this.resetInitialTimestamp(ie),Z||this.resetContiguity(),this.needsProbing(P,$,Y)){if(w.dataLength){var se=w.flush();P=Object(h.appendUint8Array)(se,P)}this.configureTransmuxer(P,B)}var oe=this.transmux(P,U,Q,ee,A),J=this.currentTransmuxState;return J.contiguous=!0,J.discontinuity=!1,J.trackSwitch=!1,R.executeEnd=f(),oe},L.flush=function(E){var _=this,A=E.transmuxing;A.executeStart=f();var I=this.decrypter,b=this.cache,R=this.currentTransmuxState,P=this.decryptionPromise;if(P)return P.then(function(){return _.flush(E)});var w=[],F=R.timeOffset;if(I){var k=I.flush();k&&w.push(this.push(k,null,E))}var B=b.dataLength;b.reset();var U=this.demuxer,j=this.remuxer;if(!U||!j)return B>=t&&this.observer.emit(S.Events.ERROR,S.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),A.executeEnd=f(),[s(E)];var K=U.flush(F);return o(K)?K.then(function(N){return _.flushRemux(w,N,E),w}):(this.flushRemux(w,K,E),w)},L.flushRemux=function(E,_,A){var I=_.audioTrack,b=_.avcTrack,R=_.id3Track,P=_.textTrack,w=this.currentTransmuxState,F=w.accurateTimeOffset,k=w.timeOffset;v.logger.log("[transmuxer.ts]: Flushed fragment "+A.sn+(A.part>-1?" p: "+A.part:"")+" of level "+A.level);var B=this.remuxer.remux(I,b,R,P,k,F,!0,this.id);E.push({remuxResult:B,chunkMeta:A}),A.transmuxing.executeEnd=f()},L.resetInitialTimestamp=function(E){var _=this.demuxer,A=this.remuxer;!_||!A||(_.resetTimeStamp(E),A.resetTimeStamp(E))},L.resetContiguity=function(){var E=this.demuxer,_=this.remuxer;!E||!_||(E.resetContiguity(),_.resetNextTimestamp())},L.resetInitSegment=function(E,_,A,I){var b=this.demuxer,R=this.remuxer;!b||!R||(b.resetInitSegment(_,A,I),R.resetInitSegment(E,_,A))},L.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},L.transmux=function(E,_,A,I,b){var R;return _&&_.method==="SAMPLE-AES"?R=this.transmuxSampleAes(E,_,A,I,b):R=this.transmuxUnencrypted(E,A,I,b),R},L.transmuxUnencrypted=function(E,_,A,I){var b=this.demuxer.demux(E,_,!1,!this.config.progressive),R=b.audioTrack,P=b.avcTrack,w=b.id3Track,F=b.textTrack,k=this.remuxer.remux(R,P,w,F,_,A,!1,this.id);return{remuxResult:k,chunkMeta:I}},L.transmuxSampleAes=function(E,_,A,I,b){var R=this;return this.demuxer.demuxSampleAes(E,_,A).then(function(P){var w=R.remuxer.remux(P.audioTrack,P.avcTrack,P.id3Track,P.textTrack,A,I,!1,R.id);return{remuxResult:w,chunkMeta:b}})},L.configureTransmuxer=function(E,_){for(var A=this.config,I=this.observer,b=this.typeSupported,R=this.vendor,P=_.audioCodec,w=_.defaultInitPts,F=_.duration,k=_.initSegmentData,B=_.videoCodec,U,j=0,K=r.length;j<K;j++)if(r[j].demux.probe(E)){U=r[j];break}U||(v.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),U={demux:T.default,remux:d.default});var N=this.demuxer,Z=this.remuxer,$=U.remux,Y=U.demux;(!Z||!(Z instanceof $))&&(this.remuxer=new $(I,A,b,R)),(!N||!(N instanceof Y))&&(this.demuxer=new Y(I,A,b),this.probe=Y.probe),this.resetInitSegment(k,P,B,F),this.resetInitialTimestamp(w)},L.needsProbing=function(E,_,A){return!this.demuxer||!this.remuxer||_||A},L.getDecrypter=function(){var E=this.decrypter;return E||(E=this.decrypter=new m.default(this.observer,this.config)),E},D}();function e(D,L){var y=null;return D.byteLength>0&&L!=null&&L.key!=null&&L.iv!==null&&L.method!=null&&(y=L),y}var s=function(L){return{remuxResult:{},chunkMeta:L}};function o(D){return"then"in D&&D.then instanceof Function}var a=function(L,y,E,_,A){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=L,this.videoCodec=y,this.initSegmentData=E,this.duration=_,this.defaultInitPts=A},p=function(L,y,E,_,A,I){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=L,this.contiguous=y,this.accurateTimeOffset=E,this.trackSwitch=_,this.timeOffset=A,this.initSegmentChange=I}},"./src/demux/tsdemuxer.ts":function(O,C,x){x.r(C),x.d(C,"discardEPB",function(){return s});var S=x("./src/demux/adts.ts"),c=x("./src/demux/mpegaudio.ts"),m=x("./src/demux/exp-golomb.ts"),M=x("./src/demux/id3.ts"),T=x("./src/demux/sample-aes.ts"),g=x("./src/events.ts"),u=x("./src/utils/mp4-tools.ts"),n=x("./src/utils/logger.ts"),d=x("./src/errors.ts"),l={video:1,audio:2,id3:3,text:4},h=function(){function o(p,D,L){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=p,this.config=D,this.typeSupported=L}o.probe=function(D){var L=o.syncOffset(D);return L<0?!1:(L&&n.logger.warn("MPEG2-TS detected but first sync word found @ offset "+L+", junk ahead ?"),!0)},o.syncOffset=function(D){for(var L=Math.min(1e3,D.length-564),y=0;y<L;){if(D[y]===71&&D[y+188]===71&&D[y+2*188]===71)return y;y++}return-1},o.createTrack=function(D,L){return{container:D==="video"||D==="audio"?"video/mp2t":void 0,type:D,id:l[D],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:D==="audio"?L:void 0}};var a=o.prototype;return a.resetInitSegment=function(D,L,y){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=o.createTrack("video",y),this._audioTrack=o.createTrack("audio",y),this._id3Track=o.createTrack("id3",y),this._txtTrack=o.createTrack("text",y),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=D,this.videoCodec=L,this._duration=y},a.resetTimeStamp=function(){},a.resetContiguity=function(){var D=this._audioTrack,L=this._avcTrack,y=this._id3Track;D&&(D.pesData=null),L&&(L.pesData=null),y&&(y.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},a.demux=function(D,L,y,E){y===void 0&&(y=!1),E===void 0&&(E=!1),y||(this.sampleAes=null);var _,A=this._avcTrack,I=this._audioTrack,b=this._id3Track,R=A.pid,P=A.pesData,w=I.pid,F=b.pid,k=I.pesData,B=b.pesData,U=!1,j=this.pmtParsed,K=this._pmtId,N=D.length;if(this.remainderData&&(D=Object(u.appendUint8Array)(this.remainderData,D),N=D.length,this.remainderData=null),N<188&&!E)return this.remainderData=D,{audioTrack:I,avcTrack:A,id3Track:b,textTrack:this._txtTrack};var Z=Math.max(0,o.syncOffset(D));N-=(N+Z)%188,N<D.byteLength&&!E&&(this.remainderData=new Uint8Array(D.buffer,N,D.buffer.byteLength-N));for(var $=0,Y=Z;Y<N;Y+=188)if(D[Y]===71){var ee=!!(D[Y+1]&64),Q=((D[Y+1]&31)<<8)+D[Y+2],G=(D[Y+3]&48)>>4,q=void 0;if(G>1){if(q=Y+5+D[Y+4],q===Y+188)continue}else q=Y+4;switch(Q){case R:ee&&(P&&(_=t(P))&&this.parseAVCPES(_,!1),P={data:[],size:0}),P&&(P.data.push(D.subarray(q,Y+188)),P.size+=Y+188-q);break;case w:ee&&(k&&(_=t(k))&&(I.isAAC?this.parseAACPES(_):this.parseMPEGPES(_)),k={data:[],size:0}),k&&(k.data.push(D.subarray(q,Y+188)),k.size+=Y+188-q);break;case F:ee&&(B&&(_=t(B))&&this.parseID3PES(_),B={data:[],size:0}),B&&(B.data.push(D.subarray(q,Y+188)),B.size+=Y+188-q);break;case 0:ee&&(q+=D[q]+1),K=this._pmtId=f(D,q);break;case K:{ee&&(q+=D[q]+1);var te=r(D,q,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,y);R=te.avc,R>0&&(A.pid=R),w=te.audio,w>0&&(I.pid=w,I.isAAC=te.isAAC),F=te.id3,F>0&&(b.pid=F),U&&!j&&(n.logger.log("reparse from beginning"),U=!1,Y=Z-188),j=this.pmtParsed=!0;break}case 17:case 8191:break;default:U=!0;break}}else $++;$>0&&this.observer.emit(g.Events.ERROR,g.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+$+" TS packet/s that do not start with 0x47"}),A.pesData=P,I.pesData=k,b.pesData=B;var ie={audioTrack:I,avcTrack:A,id3Track:b,textTrack:this._txtTrack};return E&&this.extractRemainingSamples(ie),ie},a.flush=function(){var D=this.remainderData;this.remainderData=null;var L;return D?L=this.demux(D,-1,!1,!0):L={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(L),this.sampleAes?this.decrypt(L,this.sampleAes):L},a.extractRemainingSamples=function(D){var L=D.audioTrack,y=D.avcTrack,E=D.id3Track,_=y.pesData,A=L.pesData,I=E.pesData,b;_&&(b=t(_))?(this.parseAVCPES(b,!0),y.pesData=null):y.pesData=_,A&&(b=t(A))?(L.isAAC?this.parseAACPES(b):this.parseMPEGPES(b),L.pesData=null):(A!=null&&A.size&&n.logger.log("last AAC PES packet truncated,might overlap between fragments"),L.pesData=A),I&&(b=t(I))?(this.parseID3PES(b),E.pesData=null):E.pesData=I},a.demuxSampleAes=function(D,L,y){var E=this.demux(D,y,!0,!this.config.progressive),_=this.sampleAes=new T.default(this.observer,this.config,L);return this.decrypt(E,_)},a.decrypt=function(D,L){return new Promise(function(y){var E=D.audioTrack,_=D.avcTrack;E.samples&&E.isAAC?L.decryptAacSamples(E.samples,0,function(){_.samples?L.decryptAvcSamples(_.samples,0,0,function(){y(D)}):y(D)}):_.samples&&L.decryptAvcSamples(_.samples,0,0,function(){y(D)})})},a.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},a.parseAVCPES=function(D,L){var y=this,E=this._avcTrack,_=this.parseAVCNALu(D.data),A=this.avcSample,I,b=!1;D.data=null,A&&_.length&&!E.audFound&&(i(A,E),A=this.avcSample=v(!1,D.pts,D.dts,"")),_.forEach(function(R){switch(R.type){case 1:{I=!0,A||(A=y.avcSample=v(!0,D.pts,D.dts,"")),A.frame=!0;var P=R.data;if(b&&P.length>4){var w=new m.default(P).readSliceType();(w===2||w===4||w===7||w===9)&&(A.key=!0)}break}case 5:I=!0,A||(A=y.avcSample=v(!0,D.pts,D.dts,"")),A.key=!0,A.frame=!0;break;case 6:{I=!0;var F=new m.default(s(R.data));F.readUByte();for(var k=0,B=0,U=!1,j=0;!U&&F.bytesAvailable>1;){k=0;do j=F.readUByte(),k+=j;while(j===255);B=0;do j=F.readUByte(),B+=j;while(j===255);if(k===4&&F.bytesAvailable!==0){U=!0;var K=F.readUByte();if(K===181){var N=F.readUShort();if(N===49){var Z=F.readUInt();if(Z===1195456820){var $=F.readUByte();if($===3){for(var Y=F.readUByte(),ee=F.readUByte(),Q=31&Y,G=[Y,ee],q=0;q<Q;q++)G.push(F.readUByte()),G.push(F.readUByte()),G.push(F.readUByte());e(y._txtTrack.samples,{type:3,pts:D.pts,bytes:G})}}}}}else if(k===5&&F.bytesAvailable!==0){if(U=!0,B>16){for(var te=[],ie=0;ie<16;ie++)te.push(F.readUByte().toString(16)),(ie===3||ie===5||ie===7||ie===9)&&te.push("-");for(var ne=B-16,le=new Uint8Array(ne),se=0;se<ne;se++)le[se]=F.readUByte();e(y._txtTrack.samples,{pts:D.pts,payloadType:k,uuid:te.join(""),userData:Object(M.utf8ArrayToStr)(le),userDataBytes:le})}}else if(B<F.bytesAvailable)for(var oe=0;oe<B;oe++)F.readUByte()}break}case 7:if(I=!0,b=!0,!E.sps){var J=new m.default(R.data),ae=J.readSPS();E.width=ae.width,E.height=ae.height,E.pixelRatio=ae.pixelRatio,E.sps=[R.data],E.duration=y._duration;for(var fe=R.data.subarray(1,4),de="avc1.",ve=0;ve<3;ve++){var ue=fe[ve].toString(16);ue.length<2&&(ue="0"+ue),de+=ue}E.codec=de}break;case 8:I=!0,E.pps||(E.pps=[R.data]);break;case 9:I=!1,E.audFound=!0,A&&i(A,E),A=y.avcSample=v(!1,D.pts,D.dts,"");break;case 12:I=!1;break;default:I=!1,A&&(A.debug+="unknown NAL "+R.type+" ");break}if(A&&I){var Te=A.units;Te.push(R)}}),L&&A&&(i(A,E),this.avcSample=null)},a.getLastNalUnit=function(){var D,L=this.avcSample,y;if(!L||L.units.length===0){var E=this._avcTrack.samples;L=E[E.length-1]}if((D=L)!==null&&D!==void 0&&D.units){var _=L.units;y=_[_.length-1]}return y},a.parseAVCNALu=function(D){var L=D.byteLength,y=this._avcTrack,E=y.naluState||0,_=E,A=[],I=0,b,R,P,w=-1,F=0;for(E===-1&&(w=0,F=D[0]&31,E=0,I=1);I<L;){if(b=D[I++],!E){E=b?0:1;continue}if(E===1){E=b?0:2;continue}if(!b)E=3;else if(b===1){if(w>=0){var k={data:D.subarray(w,I-E-1),type:F};A.push(k)}else{var B=this.getLastNalUnit();if(B&&(_&&I<=4-_&&B.state&&(B.data=B.data.subarray(0,B.data.byteLength-_)),R=I-E-1,R>0)){var U=new Uint8Array(B.data.byteLength+R);U.set(B.data,0),U.set(D.subarray(0,R),B.data.byteLength),B.data=U,B.state=0}}I<L?(P=D[I]&31,w=I,F=P,E=0):E=-1}else E=0}if(w>=0&&E>=0){var j={data:D.subarray(w,L),type:F,state:E};A.push(j)}if(A.length===0){var K=this.getLastNalUnit();if(K){var N=new Uint8Array(K.data.byteLength+D.byteLength);N.set(K.data,0),N.set(D,K.data.byteLength),K.data=N}}return y.naluState=E,A},a.parseAACPES=function(D){var L=0,y=this._audioTrack,E=this.aacOverFlow,_=D.data;if(E){this.aacOverFlow=null;var A=E.sample.unit.byteLength,I=Math.min(E.missing,A),b=A-I;E.sample.unit.set(_.subarray(0,I),b),y.samples.push(E.sample),L=E.missing}var R,P;for(R=L,P=_.length;R<P-1&&!S.isHeader(_,R);R++);if(R!==L){var w,F;if(R<P-1?(w="AAC PES did not start with ADTS header,offset:"+R,F=!1):(w="no ADTS header found in AAC PES",F=!0),n.logger.warn("parsing error:"+w),this.observer.emit(g.Events.ERROR,g.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:F,reason:w}),F)return}S.initTrackConfig(y,this.observer,_,R,this.audioCodec);var k;if(D.pts!==void 0)k=D.pts;else if(E){var B=S.getFrameDuration(y.samplerate);k=E.sample.pts+B}else{n.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var U=0;R<P;)if(S.isHeader(_,R)){if(R+5<P){var j=S.appendFrame(y,_,R,k,U);if(j)if(j.missing)this.aacOverFlow=j;else{R+=j.length,U++;continue}}break}else R++},a.parseMPEGPES=function(D){var L=D.data,y=L.length,E=0,_=0,A=D.pts;if(A===void 0){n.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;_<y;)if(c.isHeader(L,_)){var I=c.appendFrame(this._audioTrack,L,_,A,E);if(I)_+=I.length,E++;else break}else _++},a.parseID3PES=function(D){if(D.pts===void 0){n.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(D)},o}();h.minProbeByteLength=188;function v(o,a,p,D){return{key:o,frame:!1,pts:a,dts:p,units:[],debug:D,length:0}}function f(o,a){return(o[a+10]&31)<<8|o[a+11]}function r(o,a,p,D){var L={audio:-1,avc:-1,id3:-1,isAAC:!0},y=(o[a+1]&15)<<8|o[a+2],E=a+3+y-4,_=(o[a+10]&15)<<8|o[a+11];for(a+=12+_;a<E;){var A=(o[a+1]&31)<<8|o[a+2];switch(o[a]){case 207:if(!D){n.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:L.audio===-1&&(L.audio=A);break;case 21:L.id3===-1&&(L.id3=A);break;case 219:if(!D){n.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:L.avc===-1&&(L.avc=A);break;case 3:case 4:p?L.audio===-1&&(L.audio=A,L.isAAC=!1):n.logger.log("MPEG audio found, not supported in this browser");break;case 36:n.logger.warn("Unsupported HEVC stream type found");break}a+=((o[a+3]&15)<<8|o[a+4])+5}return L}function t(o){var a=0,p,D,L,y,E,_=o.data;if(!o||o.size===0)return null;for(;_[0].length<19&&_.length>1;){var A=new Uint8Array(_[0].length+_[1].length);A.set(_[0]),A.set(_[1],_[0].length),_[0]=A,_.splice(1,1)}p=_[0];var I=(p[0]<<16)+(p[1]<<8)+p[2];if(I===1){if(D=(p[4]<<8)+p[5],D&&D>o.size-6)return null;var b=p[7];b&192&&(y=(p[9]&14)*536870912+(p[10]&255)*4194304+(p[11]&254)*16384+(p[12]&255)*128+(p[13]&254)/2,b&64?(E=(p[14]&14)*536870912+(p[15]&255)*4194304+(p[16]&254)*16384+(p[17]&255)*128+(p[18]&254)/2,y-E>60*9e4&&(n.logger.warn(Math.round((y-E)/9e4)+"s delta between PTS and DTS, align them"),y=E)):E=y),L=p[8];var R=L+9;if(o.size<=R)return null;o.size-=R;for(var P=new Uint8Array(o.size),w=0,F=_.length;w<F;w++){p=_[w];var k=p.byteLength;if(R)if(R>k){R-=k;continue}else p=p.subarray(R),k-=R,R=0;P.set(p,a),a+=k}return D&&(D-=L+3),{data:P,pts:y,dts:E,len:D}}return null}function i(o,a){if(o.units.length&&o.frame){if(o.pts===void 0){var p=a.samples,D=p.length;if(D){var L=p[D-1];o.pts=L.pts,o.dts=L.dts}else{a.dropped++;return}}a.samples.push(o)}o.debug.length&&n.logger.log(o.pts+"/"+o.dts+":"+o.debug)}function e(o,a){var p=o.length;if(p>0){if(a.pts>=o[p-1].pts)o.push(a);else for(var D=p-1;D>=0;D--)if(a.pts<o[D].pts){o.splice(D,0,a);break}}else o.push(a)}function s(o){for(var a=o.byteLength,p=[],D=1;D<a-2;)o[D]===0&&o[D+1]===0&&o[D+2]===3?(p.push(D+2),D+=2):D++;if(p.length===0)return o;var L=a-p.length,y=new Uint8Array(L),E=0;for(D=0;D<L;E++,D++)E===p[0]&&(E++,p.shift()),y[D]=o[E];return y}C.default=h},"./src/errors.ts":function(O,C,x){x.r(C),x.d(C,"ErrorTypes",function(){return S}),x.d(C,"ErrorDetails",function(){return c});var S;(function(m){m.NETWORK_ERROR="networkError",m.MEDIA_ERROR="mediaError",m.KEY_SYSTEM_ERROR="keySystemError",m.MUX_ERROR="muxError",m.OTHER_ERROR="otherError"})(S||(S={}));var c;(function(m){m.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",m.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",m.KEY_SYSTEM_NO_SESSION="keySystemNoSession",m.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",m.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",m.MANIFEST_LOAD_ERROR="manifestLoadError",m.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",m.MANIFEST_PARSING_ERROR="manifestParsingError",m.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",m.LEVEL_EMPTY_ERROR="levelEmptyError",m.LEVEL_LOAD_ERROR="levelLoadError",m.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",m.LEVEL_SWITCH_ERROR="levelSwitchError",m.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",m.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",m.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",m.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",m.FRAG_LOAD_ERROR="fragLoadError",m.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",m.FRAG_DECRYPT_ERROR="fragDecryptError",m.FRAG_PARSING_ERROR="fragParsingError",m.REMUX_ALLOC_ERROR="remuxAllocError",m.KEY_LOAD_ERROR="keyLoadError",m.KEY_LOAD_TIMEOUT="keyLoadTimeOut",m.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",m.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",m.BUFFER_APPEND_ERROR="bufferAppendError",m.BUFFER_APPENDING_ERROR="bufferAppendingError",m.BUFFER_STALLED_ERROR="bufferStalledError",m.BUFFER_FULL_ERROR="bufferFullError",m.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",m.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",m.INTERNAL_EXCEPTION="internalException",m.INTERNAL_ABORTED="aborted",m.UNKNOWN="unknown"})(c||(c={}))},"./src/events.ts":function(O,C,x){x.r(C),x.d(C,"Events",function(){return S});var S;(function(c){c.MEDIA_ATTACHING="hlsMediaAttaching",c.MEDIA_ATTACHED="hlsMediaAttached",c.MEDIA_DETACHING="hlsMediaDetaching",c.MEDIA_DETACHED="hlsMediaDetached",c.BUFFER_RESET="hlsBufferReset",c.BUFFER_CODECS="hlsBufferCodecs",c.BUFFER_CREATED="hlsBufferCreated",c.BUFFER_APPENDING="hlsBufferAppending",c.BUFFER_APPENDED="hlsBufferAppended",c.BUFFER_EOS="hlsBufferEos",c.BUFFER_FLUSHING="hlsBufferFlushing",c.BUFFER_FLUSHED="hlsBufferFlushed",c.MANIFEST_LOADING="hlsManifestLoading",c.MANIFEST_LOADED="hlsManifestLoaded",c.MANIFEST_PARSED="hlsManifestParsed",c.LEVEL_SWITCHING="hlsLevelSwitching",c.LEVEL_SWITCHED="hlsLevelSwitched",c.LEVEL_LOADING="hlsLevelLoading",c.LEVEL_LOADED="hlsLevelLoaded",c.LEVEL_UPDATED="hlsLevelUpdated",c.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",c.LEVELS_UPDATED="hlsLevelsUpdated",c.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",c.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",c.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",c.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",c.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",c.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",c.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",c.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",c.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",c.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",c.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",c.CUES_PARSED="hlsCuesParsed",c.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",c.INIT_PTS_FOUND="hlsInitPtsFound",c.FRAG_LOADING="hlsFragLoading",c.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",c.FRAG_LOADED="hlsFragLoaded",c.FRAG_DECRYPTED="hlsFragDecrypted",c.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",c.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",c.FRAG_PARSING_METADATA="hlsFragParsingMetadata",c.FRAG_PARSED="hlsFragParsed",c.FRAG_BUFFERED="hlsFragBuffered",c.FRAG_CHANGED="hlsFragChanged",c.FPS_DROP="hlsFpsDrop",c.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",c.ERROR="hlsError",c.DESTROYING="hlsDestroying",c.KEY_LOADING="hlsKeyLoading",c.KEY_LOADED="hlsKeyLoaded",c.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",c.BACK_BUFFER_REACHED="hlsBackBufferReached"})(S||(S={}))},"./src/hls.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return e});var S=x("./node_modules/url-toolkit/src/url-toolkit.js"),c=x("./src/loader/playlist-loader.ts"),m=x("./src/loader/key-loader.ts"),M=x("./src/controller/id3-track-controller.ts"),T=x("./src/controller/latency-controller.ts"),g=x("./src/controller/level-controller.ts"),u=x("./src/controller/fragment-tracker.ts"),n=x("./src/controller/stream-controller.ts"),d=x("./src/is-supported.ts"),l=x("./src/utils/logger.ts"),h=x("./src/config.ts"),v=x("./node_modules/eventemitter3/index.js"),f=x("./src/events.ts"),r=x("./src/errors.ts");function t(s,o){for(var a=0;a<o.length;a++){var p=o[a];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(s,p.key,p)}}function i(s,o,a){return o&&t(s.prototype,o),a&&t(s,a),s}var e=function(){s.isSupported=function(){return Object(d.isSupported)()};function s(a){a===void 0&&(a={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new v.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var p=this.config=Object(h.mergeConfig)(s.DefaultConfig,a);this.userConfig=a,Object(l.enableLogs)(p.debug),this._autoLevelCapping=-1,p.progressive&&Object(h.enableStreamingMode)(p);var D=p.abrController,L=p.bufferController,y=p.capLevelController,E=p.fpsController,_=this.abrController=new D(this),A=this.bufferController=new L(this),I=this.capLevelController=new y(this),b=new E(this),R=new c.default(this),P=new m.default(this),w=new M.default(this),F=this.levelController=new g.default(this),k=new u.FragmentTracker(this),B=this.streamController=new n.default(this,k);I.setStreamController(B),b.setStreamController(B);var U=[F,B];this.networkControllers=U;var j=[R,P,_,A,I,b,w,k];this.audioTrackController=this.createController(p.audioTrackController,null,U),this.createController(p.audioStreamController,k,U),this.subtitleTrackController=this.createController(p.subtitleTrackController,null,U),this.createController(p.subtitleStreamController,k,U),this.createController(p.timelineController,null,j),this.emeController=this.createController(p.emeController,null,j),this.cmcdController=this.createController(p.cmcdController,null,j),this.latencyController=this.createController(T.default,null,j),this.coreComponents=j}var o=s.prototype;return o.createController=function(p,D,L){if(p){var y=D?new p(this,D):new p(this);return L&&L.push(y),y}return null},o.on=function(p,D,L){L===void 0&&(L=this),this._emitter.on(p,D,L)},o.once=function(p,D,L){L===void 0&&(L=this),this._emitter.once(p,D,L)},o.removeAllListeners=function(p){this._emitter.removeAllListeners(p)},o.off=function(p,D,L,y){L===void 0&&(L=this),this._emitter.off(p,D,L,y)},o.listeners=function(p){return this._emitter.listeners(p)},o.emit=function(p,D,L){return this._emitter.emit(p,D,L)},o.trigger=function(p,D){if(this.config.debug)return this.emit(p,p,D);try{return this.emit(p,p,D)}catch(L){l.logger.error("An internal error happened while handling event "+p+'. Error message: "'+L.message+'". Here is a stacktrace:',L),this.trigger(f.Events.ERROR,{type:r.ErrorTypes.OTHER_ERROR,details:r.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:p,error:L})}return!1},o.listenerCount=function(p){return this._emitter.listenerCount(p)},o.destroy=function(){l.logger.log("destroy"),this.trigger(f.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(p){return p.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(p){return p.destroy()}),this.coreComponents.length=0},o.attachMedia=function(p){l.logger.log("attachMedia"),this._media=p,this.trigger(f.Events.MEDIA_ATTACHING,{media:p})},o.detachMedia=function(){l.logger.log("detachMedia"),this.trigger(f.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function(p){this.stopLoad();var D=this.media,L=this.url,y=this.url=S.buildAbsoluteURL(self.location.href,p,{alwaysNormalize:!0});l.logger.log("loadSource:"+y),D&&L&&L!==y&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(D)),this.trigger(f.Events.MANIFEST_LOADING,{url:p})},o.startLoad=function(p){p===void 0&&(p=-1),l.logger.log("startLoad("+p+")"),this.networkControllers.forEach(function(D){D.startLoad(p)})},o.stopLoad=function(){l.logger.log("stopLoad"),this.networkControllers.forEach(function(p){p.stopLoad()})},o.swapAudioCodec=function(){l.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function(){l.logger.log("recoverMediaError");var p=this._media;this.detachMedia(),p&&this.attachMedia(p)},o.removeLevel=function(p,D){D===void 0&&(D=0),this.levelController.removeLevel(p,D)},i(s,[{key:"levels",get:function(){var p=this.levelController.levels;return p||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(p){l.logger.log("set currentLevel:"+p),this.loadLevel=p,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(p){l.logger.log("set nextLevel:"+p),this.levelController.manualLevel=p,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(p){l.logger.log("set loadLevel:"+p),this.levelController.manualLevel=p}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(p){this.levelController.nextLoadLevel=p}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(p){l.logger.log("set firstLevel:"+p),this.levelController.firstLevel=p}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(p){l.logger.log("set startLevel:"+p),p!==-1&&(p=Math.max(p,this.minAutoLevel)),this.levelController.startLevel=p}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(p){var D=!!p;D!==this.config.capLevelToPlayerSize&&(D?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=D)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(p){this._autoLevelCapping!==p&&(l.logger.log("set autoLevelCapping:"+p),this._autoLevelCapping=p)}},{key:"bandwidthEstimate",get:function(){var p=this.abrController.bwEstimator;return p?p.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var p=this.levels,D=this.config.minAutoBitrate;if(!p)return 0;for(var L=p.length,y=0;y<L;y++)if(p[y].maxBitrate>D)return y;return 0}},{key:"maxAutoLevel",get:function(){var p=this.levels,D=this.autoLevelCapping,L;return D===-1&&p&&p.length?L=p.length-1:L=D,L}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(p){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,p)}},{key:"audioTracks",get:function(){var p=this.audioTrackController;return p?p.audioTracks:[]}},{key:"audioTrack",get:function(){var p=this.audioTrackController;return p?p.audioTrack:-1},set:function(p){var D=this.audioTrackController;D&&(D.audioTrack=p)}},{key:"subtitleTracks",get:function(){var p=this.subtitleTrackController;return p?p.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var p=this.subtitleTrackController;return p?p.subtitleTrack:-1},set:function(p){var D=this.subtitleTrackController;D&&(D.subtitleTrack=p)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var p=this.subtitleTrackController;return p?p.subtitleDisplay:!1},set:function(p){var D=this.subtitleTrackController;D&&(D.subtitleDisplay=p)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(p){this.config.lowLatencyMode=p}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return f.Events}},{key:"ErrorTypes",get:function(){return r.ErrorTypes}},{key:"ErrorDetails",get:function(){return r.ErrorDetails}},{key:"DefaultConfig",get:function(){return s.defaultConfig?s.defaultConfig:h.hlsDefaultConfig},set:function(p){s.defaultConfig=p}}]),s}();e.defaultConfig=void 0},"./src/is-supported.ts":function(O,C,x){x.r(C),x.d(C,"isSupported",function(){return m}),x.d(C,"changeTypeSupported",function(){return M});var S=x("./src/utils/mediasource-helper.ts");function c(){return self.SourceBuffer||self.WebKitSourceBuffer}function m(){var T=Object(S.getMediaSource)();if(!T)return!1;var g=c(),u=T&&typeof T.isTypeSupported=="function"&&T.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!g||g.prototype&&typeof g.prototype.appendBuffer=="function"&&typeof g.prototype.remove=="function";return!!u&&!!n}function M(){var T,g=c();return typeof(g==null||(T=g.prototype)===null||T===void 0?void 0:T.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return h}),x.d(C,"LoadError",function(){return f});var S=x("./src/polyfills/number.ts"),c=x("./src/errors.ts");function m(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t)}function M(r){var t=typeof Map=="function"?new Map:void 0;return M=function(e){if(e===null||!u(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return T(e,arguments,d(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),n(s,e)},M(r)}function T(r,t,i){return g()?T=Reflect.construct:T=function(s,o,a){var p=[null];p.push.apply(p,o);var D=Function.bind.apply(s,p),L=new D;return a&&n(L,a.prototype),L},T.apply(null,arguments)}function g(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function u(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function n(r,t){return n=Object.setPrototypeOf||function(e,s){return e.__proto__=s,e},n(r,t)}function d(r){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},d(r)}var l=Math.pow(2,17),h=function(){function r(i){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=i}var t=r.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,s){var o=this,a=e.url;if(!a)return Promise.reject(new f({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,networkDetails:null},"Fragment does not have a "+(a?"part list":"url")));this.abort();var p=this.config,D=p.fLoader,L=p.loader;return new Promise(function(y,E){o.loader&&o.loader.destroy();var _=o.loader=e.loader=D?new D(p):new L(p),A=v(e),I={timeout:p.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:p.fragLoadingMaxRetryTimeout,highWaterMark:l};e.stats=_.stats,_.load(A,I,{onSuccess:function(R,P,w,F){o.resetLoader(e,_),y({frag:e,part:null,payload:R.data,networkDetails:F})},onError:function(R,P,w){o.resetLoader(e,_),E(new f({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:R,networkDetails:w}))},onAbort:function(R,P,w){o.resetLoader(e,_),E(new f({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,networkDetails:w}))},onTimeout:function(R,P,w){o.resetLoader(e,_),E(new f({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,networkDetails:w}))},onProgress:function(R,P,w,F){s&&s({frag:e,part:null,payload:w,networkDetails:F})}})})},t.loadPart=function(e,s,o){var a=this;this.abort();var p=this.config,D=p.fLoader,L=p.loader;return new Promise(function(y,E){a.loader&&a.loader.destroy();var _=a.loader=e.loader=D?new D(p):new L(p),A=v(e,s),I={timeout:p.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:p.fragLoadingMaxRetryTimeout,highWaterMark:l};s.stats=_.stats,_.load(A,I,{onSuccess:function(R,P,w,F){a.resetLoader(e,_),a.updateStatsFromPart(e,s);var k={frag:e,part:s,payload:R.data,networkDetails:F};o(k),y(k)},onError:function(R,P,w){a.resetLoader(e,_),E(new f({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:s,response:R,networkDetails:w}))},onAbort:function(R,P,w){e.stats.aborted=s.stats.aborted,a.resetLoader(e,_),E(new f({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:s,networkDetails:w}))},onTimeout:function(R,P,w){a.resetLoader(e,_),E(new f({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:s,networkDetails:w}))}})})},t.updateStatsFromPart=function(e,s){var o=e.stats,a=s.stats,p=a.total;if(o.loaded+=a.loaded,p){var D=Math.round(e.duration/s.duration),L=Math.min(Math.round(o.loaded/p),D),y=D-L,E=y*Math.round(o.loaded/L);o.total=o.loaded+E}else o.total=Math.max(o.loaded,o.total);var _=o.loading,A=a.loading;_.start?_.first+=A.first-A.start:(_.start=A.start,_.first=A.first),_.end=A.end},t.resetLoader=function(e,s){e.loader=null,this.loader===s&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),s.destroy()},r}();function v(r,t){t===void 0&&(t=null);var i=t||r,e={frag:r,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},s=i.byteRangeStartOffset,o=i.byteRangeEndOffset;return Object(S.isFiniteNumber)(s)&&Object(S.isFiniteNumber)(o)&&(e.rangeStart=s,e.rangeEnd=o),e}var f=function(r){m(t,r);function t(i){for(var e,s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];return e=r.call.apply(r,[this].concat(o))||this,e.data=void 0,e.data=i,e}return t}(M(Error))},"./src/loader/fragment.ts":function(O,C,x){x.r(C),x.d(C,"ElementaryStreamTypes",function(){return l}),x.d(C,"BaseSegment",function(){return h}),x.d(C,"Fragment",function(){return v}),x.d(C,"Part",function(){return f});var S=x("./src/polyfills/number.ts"),c=x("./node_modules/url-toolkit/src/url-toolkit.js"),m=x("./src/utils/logger.ts"),M=x("./src/loader/level-key.ts"),T=x("./src/loader/load-stats.ts");function g(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,u(r,t)}function u(r,t){return u=Object.setPrototypeOf||function(e,s){return e.__proto__=s,e},u(r,t)}function n(r,t){for(var i=0;i<t.length;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}function d(r,t,i){return t&&n(r.prototype,t),i&&n(r,i),r}var l;(function(r){r.AUDIO="audio",r.VIDEO="video",r.AUDIOVIDEO="audiovideo"})(l||(l={}));var h=function(){function r(i){var e;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(e={},e[l.AUDIO]=null,e[l.VIDEO]=null,e[l.AUDIOVIDEO]=null,e),this.baseurl=i}var t=r.prototype;return t.setByteRange=function(e,s){var o=e.split("@",2),a=[];o.length===1?a[0]=s?s.byteRangeEndOffset:0:a[0]=parseInt(o[1]),a[1]=parseInt(o[0])+a[0],this._byteRange=a},d(r,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(c.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),r}(),v=function(r){g(t,r);function t(e,s){var o;return o=r.call(this,s)||this,o._decryptdata=null,o.rawProgramDateTime=null,o.programDateTime=null,o.tagList=[],o.duration=0,o.sn=0,o.levelkey=void 0,o.type=void 0,o.loader=null,o.level=-1,o.cc=0,o.startPTS=void 0,o.endPTS=void 0,o.appendedPTS=void 0,o.startDTS=void 0,o.endDTS=void 0,o.start=0,o.deltaPTS=void 0,o.maxStartPTS=void 0,o.minEndPTS=void 0,o.stats=new T.LoadStats,o.urlId=0,o.data=void 0,o.bitrateTest=!1,o.title=null,o.initSegment=null,o.type=e,o}var i=t.prototype;return i.createInitializationVector=function(s){for(var o=new Uint8Array(16),a=12;a<16;a++)o[a]=s>>8*(15-a)&255;return o},i.setDecryptDataFromLevelKey=function(s,o){var a=s;return(s==null?void 0:s.method)==="AES-128"&&s.uri&&!s.iv&&(a=M.LevelKey.fromURI(s.uri),a.method=s.method,a.iv=this.createInitializationVector(o),a.keyFormat="identity"),a},i.setElementaryStreamInfo=function(s,o,a,p,D,L){L===void 0&&(L=!1);var y=this.elementaryStreams,E=y[s];if(!E){y[s]={startPTS:o,endPTS:a,startDTS:p,endDTS:D,partial:L};return}E.startPTS=Math.min(E.startPTS,o),E.endPTS=Math.max(E.endPTS,a),E.startDTS=Math.min(E.startDTS,p),E.endDTS=Math.max(E.endDTS,D)},i.clearElementaryStreamInfo=function(){var s=this.elementaryStreams;s[l.AUDIO]=null,s[l.VIDEO]=null,s[l.AUDIOVIDEO]=null},d(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var s=this.sn;typeof s!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&m.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),s=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,s)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(S.isFiniteNumber)(this.programDateTime))return null;var s=Object(S.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+s*1e3}},{key:"encrypted",get:function(){var s;return!!((s=this.decryptdata)!==null&&s!==void 0&&s.keyFormat&&this.decryptdata.uri)}}]),t}(h),f=function(r){g(t,r);function t(i,e,s,o,a){var p;p=r.call(this,s)||this,p.fragOffset=0,p.duration=0,p.gap=!1,p.independent=!1,p.relurl=void 0,p.fragment=void 0,p.index=void 0,p.stats=new T.LoadStats,p.duration=i.decimalFloatingPoint("DURATION"),p.gap=i.bool("GAP"),p.independent=i.bool("INDEPENDENT"),p.relurl=i.enumeratedString("URI"),p.fragment=e,p.index=o;var D=i.enumeratedString("BYTERANGE");return D&&p.setByteRange(D,a),a&&(p.fragOffset=a.fragOffset+a.duration),p}return d(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(h)},"./src/loader/key-loader.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return M});var S=x("./src/events.ts"),c=x("./src/errors.ts"),m=x("./src/utils/logger.ts"),M=function(){function T(u){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=u,this._registerListeners()}var g=T.prototype;return g._registerListeners=function(){this.hls.on(S.Events.KEY_LOADING,this.onKeyLoading,this)},g._unregisterListeners=function(){this.hls.off(S.Events.KEY_LOADING,this.onKeyLoading)},g.destroy=function(){this._unregisterListeners();for(var n in this.loaders){var d=this.loaders[n];d&&d.destroy()}this.loaders={}},g.onKeyLoading=function(n,d){var l=d.frag,h=l.type,v=this.loaders[h];if(!l.decryptdata){m.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var f=l.decryptdata.uri;if(f!==this.decrypturl||this.decryptkey===null){var r=this.hls.config;if(v&&(m.logger.warn("abort previous key loader for type:"+h),v.abort()),!f){m.logger.warn("key uri is falsy");return}var t=r.loader,i=l.loader=this.loaders[h]=new t(r);this.decrypturl=f,this.decryptkey=null;var e={url:f,frag:l,responseType:"arraybuffer"},s={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:r.fragLoadingRetryDelay,maxRetryDelay:r.fragLoadingMaxRetryTimeout,highWaterMark:0},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};i.load(e,s,o)}else this.decryptkey&&(l.decryptdata.key=this.decryptkey,this.hls.trigger(S.Events.KEY_LOADED,{frag:l}))},g.loadsuccess=function(n,d,l){var h=l.frag;if(!h.decryptdata){m.logger.error("after key load, decryptdata unset");return}this.decryptkey=h.decryptdata.key=new Uint8Array(n.data),h.loader=null,delete this.loaders[h.type],this.hls.trigger(S.Events.KEY_LOADED,{frag:h})},g.loaderror=function(n,d){var l=d.frag,h=l.loader;h&&h.abort(),delete this.loaders[l.type],this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:l,response:n})},g.loadtimeout=function(n,d){var l=d.frag,h=l.loader;h&&h.abort(),delete this.loaders[l.type],this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:l})},T}()},"./src/loader/level-details.ts":function(O,C,x){x.r(C),x.d(C,"LevelDetails",function(){return T});var S=x("./src/polyfills/number.ts");function c(g,u){for(var n=0;n<u.length;n++){var d=u[n];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(g,d.key,d)}}function m(g,u,n){return u&&c(g.prototype,u),n&&c(g,n),g}var M=10,T=function(){function g(n){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=n}var u=g.prototype;return u.reloaded=function(d){if(!d){this.advanced=!0,this.updated=!0;return}var l=this.lastPartSn-d.lastPartSn,h=this.lastPartIndex-d.lastPartIndex;this.updated=this.endSN!==d.endSN||!!h||!!l,this.advanced=this.endSN>d.endSN||l>0||l===0&&h>0,this.updated||this.advanced?this.misses=Math.floor(d.misses*.6):this.misses=d.misses+1,this.availabilityDelay=d.availabilityDelay},m(g,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(S.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||M}},{key:"drift",get:function(){var d=this.driftEndTime-this.driftStartTime;if(d>0){var l=this.driftEnd-this.driftStart;return l*1e3/d}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var d;return(d=this.partList)!==null&&d!==void 0&&d.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var d;return(d=this.fragments)!==null&&d!==void 0&&d.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var d;return(d=this.partList)!==null&&d!==void 0&&d.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var d;return(d=this.partList)!==null&&d!==void 0&&d.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),g}()},"./src/loader/level-key.ts":function(O,C,x){x.r(C),x.d(C,"LevelKey",function(){return M});var S=x("./node_modules/url-toolkit/src/url-toolkit.js");function c(T,g){for(var u=0;u<g.length;u++){var n=g[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(T,n.key,n)}}function m(T,g,u){return g&&c(T.prototype,g),u&&c(T,u),T}var M=function(){T.fromURL=function(u,n){return new T(u,n)},T.fromURI=function(u){return new T(u)};function T(g,u){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,u?this._uri=Object(S.buildAbsoluteURL)(g,u,{alwaysNormalize:!0}):this._uri=g}return m(T,[{key:"uri",get:function(){return this._uri}}]),T}()},"./src/loader/load-stats.ts":function(O,C,x){x.r(C),x.d(C,"LoadStats",function(){return S});var S=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return t});var S=x("./src/polyfills/number.ts"),c=x("./node_modules/url-toolkit/src/url-toolkit.js"),m=x("./src/loader/fragment.ts"),M=x("./src/loader/level-details.ts"),T=x("./src/loader/level-key.ts"),g=x("./src/utils/attr-list.ts"),u=x("./src/utils/logger.ts"),n=x("./src/utils/codecs.ts"),d=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,l=/#EXT-X-MEDIA:(.*)/g,h=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),v=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),f=/\.(mp4|m4s|m4v|m4a)$/i;function r(a){var p,D;return f.test((p=(D=c.parseURL(a))===null||D===void 0?void 0:D.path)!=null?p:"")}var t=function(){function a(){}return a.findGroup=function(D,L){for(var y=0;y<D.length;y++){var E=D[y];if(E.id===L)return E}},a.convertAVC1ToAVCOTI=function(D){var L=D.split(".");if(L.length>2){var y=L.shift()+".";return y+=parseInt(L.shift()).toString(16),y+=("000"+parseInt(L.shift()).toString(16)).substr(-4),y}return D},a.resolve=function(D,L){return c.buildAbsoluteURL(L,D,{alwaysNormalize:!0})},a.parseMasterPlaylist=function(D,L){var y=[],E={},_=!1;d.lastIndex=0;for(var A;(A=d.exec(D))!=null;)if(A[1]){var I=new g.AttrList(A[1]),b={attrs:I,bitrate:I.decimalInteger("AVERAGE-BANDWIDTH")||I.decimalInteger("BANDWIDTH"),name:I.NAME,url:a.resolve(A[2],L)},R=I.decimalResolution("RESOLUTION");R&&(b.width=R.width,b.height=R.height),i((I.CODECS||"").split(/[ ,]+/).filter(function(w){return w}),b),b.videoCodec&&b.videoCodec.indexOf("avc1")!==-1&&(b.videoCodec=a.convertAVC1ToAVCOTI(b.videoCodec)),y.push(b)}else if(A[3]){var P=new g.AttrList(A[3]);P["DATA-ID"]&&(_=!0,E[P["DATA-ID"]]=P)}return{levels:y,sessionData:_?E:null}},a.parseMasterPlaylistMedia=function(D,L,y,E){E===void 0&&(E=[]);var _,A=[],I=0;for(l.lastIndex=0;(_=l.exec(D))!==null;){var b=new g.AttrList(_[1]);if(b.TYPE===y){var R={attrs:b,bitrate:0,id:I++,groupId:b["GROUP-ID"],instreamId:b["INSTREAM-ID"],name:b.NAME||b.LANGUAGE||"",type:y,default:b.bool("DEFAULT"),autoselect:b.bool("AUTOSELECT"),forced:b.bool("FORCED"),lang:b.LANGUAGE,url:b.URI?a.resolve(b.URI,L):""};if(E.length){var P=a.findGroup(E,R.groupId)||E[0];e(R,P,"audioCodec"),e(R,P,"textCodec")}A.push(R)}}return A},a.parseLevelPlaylist=function(D,L,y,E,_){var A=new M.LevelDetails(L),I=A.fragments,b=null,R=0,P=0,w=0,F=0,k=null,B=new m.Fragment(E,L),U,j,K,N=-1,Z=!1;for(h.lastIndex=0,A.m3u8=D;(U=h.exec(D))!==null;){Z&&(Z=!1,B=new m.Fragment(E,L),B.start=w,B.sn=R,B.cc=F,B.level=y,b&&(B.initSegment=b,B.rawProgramDateTime=b.rawProgramDateTime));var $=U[1];if($){B.duration=parseFloat($);var Y=(" "+U[2]).slice(1);B.title=Y||null,B.tagList.push(Y?["INF",$,Y]:["INF",$])}else if(U[3])Object(S.isFiniteNumber)(B.duration)&&(B.start=w,K&&(B.levelkey=K),B.sn=R,B.level=y,B.cc=F,B.urlId=_,I.push(B),B.relurl=(" "+U[3]).slice(1),o(B,k),k=B,w+=B.duration,R++,P=0,Z=!0);else if(U[4]){var ee=(" "+U[4]).slice(1);k?B.setByteRange(ee,k):B.setByteRange(ee)}else if(U[5])B.rawProgramDateTime=(" "+U[5]).slice(1),B.tagList.push(["PROGRAM-DATE-TIME",B.rawProgramDateTime]),N===-1&&(N=I.length);else{if(U=U[0].match(v),!U){u.logger.warn("No matches on slow regex match for level playlist!");continue}for(j=1;j<U.length&&typeof U[j]=="undefined";j++);var Q=(" "+U[j]).slice(1),G=(" "+U[j+1]).slice(1),q=U[j+2]?(" "+U[j+2]).slice(1):"";switch(Q){case"PLAYLIST-TYPE":A.type=G.toUpperCase();break;case"MEDIA-SEQUENCE":R=A.startSN=parseInt(G);break;case"SKIP":{var te=new g.AttrList(G),ie=te.decimalInteger("SKIPPED-SEGMENTS");if(Object(S.isFiniteNumber)(ie)){A.skippedSegments=ie;for(var ne=ie;ne--;)I.unshift(null);R+=ie}var le=te.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(A.recentlyRemovedDateranges=le.split("	"));break}case"TARGETDURATION":A.targetduration=parseFloat(G);break;case"VERSION":A.version=parseInt(G);break;case"EXTM3U":break;case"ENDLIST":A.live=!1;break;case"#":(G||q)&&B.tagList.push(q?[G,q]:[G]);break;case"DIS":F++;case"GAP":B.tagList.push([Q]);break;case"BITRATE":B.tagList.push([Q,G]);break;case"DISCONTINUITY-SEQ":F=parseInt(G);break;case"KEY":{var se,oe=new g.AttrList(G),J=oe.enumeratedString("METHOD"),ae=oe.URI,fe=oe.hexadecimalInteger("IV"),de=oe.enumeratedString("KEYFORMATVERSIONS"),ve=oe.enumeratedString("KEYID"),ue=(se=oe.enumeratedString("KEYFORMAT"))!=null?se:"identity",Te=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(Te.indexOf(ue)>-1){u.logger.warn("Keyformat "+ue+" is not supported from the manifest");continue}else if(ue!=="identity")continue;J&&(K=T.LevelKey.fromURL(L,ae),ae&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(J)>=0&&(K.method=J,K.keyFormat=ue,ve&&(K.keyID=ve),de&&(K.keyFormatVersions=de),K.iv=fe));break}case"START":{var he=new g.AttrList(G),Ee=he.decimalFloatingPoint("TIME-OFFSET");Object(S.isFiniteNumber)(Ee)&&(A.startTimeOffset=Ee);break}case"MAP":{var W=new g.AttrList(G);B.relurl=W.URI,W.BYTERANGE&&B.setByteRange(W.BYTERANGE),B.level=y,B.sn="initSegment",K&&(B.levelkey=K),B.initSegment=null,b=B,Z=!0;break}case"SERVER-CONTROL":{var z=new g.AttrList(G);A.canBlockReload=z.bool("CAN-BLOCK-RELOAD"),A.canSkipUntil=z.optionalFloat("CAN-SKIP-UNTIL",0),A.canSkipDateRanges=A.canSkipUntil>0&&z.bool("CAN-SKIP-DATERANGES"),A.partHoldBack=z.optionalFloat("PART-HOLD-BACK",0),A.holdBack=z.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var V=new g.AttrList(G);A.partTarget=V.decimalFloatingPoint("PART-TARGET");break}case"PART":{var X=A.partList;X||(X=A.partList=[]);var H=P>0?X[X.length-1]:void 0,re=P++,ce=new m.Part(new g.AttrList(G),B,L,re,H);X.push(ce),B.duration+=ce.duration;break}case"PRELOAD-HINT":{var me=new g.AttrList(G);A.preloadHint=me;break}case"RENDITION-REPORT":{var xe=new g.AttrList(G);A.renditionReports=A.renditionReports||[],A.renditionReports.push(xe);break}default:u.logger.warn("line parsed but not handled: "+U);break}}}k&&!k.relurl?(I.pop(),w-=k.duration,A.partList&&(A.fragmentHint=k)):A.partList&&(o(B,k),B.cc=F,A.fragmentHint=B);var Se=I.length,_e=I[0],Le=I[Se-1];if(w+=A.skippedSegments*A.targetduration,w>0&&Se&&Le){A.averagetargetduration=w/Se;var be=Le.sn;A.endSN=be!=="initSegment"?be:0,_e&&(A.startCC=_e.cc,_e.initSegment||A.fragments.every(function(Oe){return Oe.relurl&&r(Oe.relurl)})&&(u.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),B=new m.Fragment(E,L),B.relurl=Le.relurl,B.level=y,B.sn="initSegment",_e.initSegment=B,A.needSidxRanges=!0))}else A.endSN=0,A.startCC=0;return A.fragmentHint&&(w+=A.fragmentHint.duration),A.totalduration=w,A.endCC=F,N>0&&s(I,N),A},a}();function i(a,p){["video","audio","text"].forEach(function(D){var L=a.filter(function(E){return Object(n.isCodecType)(E,D)});if(L.length){var y=L.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});p[D+"Codec"]=y.length>0?y[0]:L[0],a=a.filter(function(E){return L.indexOf(E)===-1})}}),p.unknownCodecs=a}function e(a,p,D){var L=p[D];L&&(a[D]=L)}function s(a,p){for(var D=a[p],L=p;L--;){var y=a[L];if(!y)return;y.programDateTime=D.programDateTime-y.duration*1e3,D=y}}function o(a,p){a.rawProgramDateTime?a.programDateTime=Date.parse(a.rawProgramDateTime):p!=null&&p.programDateTime&&(a.programDateTime=p.endProgramDateTime),Object(S.isFiniteNumber)(a.programDateTime)||(a.programDateTime=null,a.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),c=x("./src/events.ts"),m=x("./src/errors.ts"),M=x("./src/utils/logger.ts"),T=x("./src/utils/mp4-tools.ts"),g=x("./src/loader/m3u8-parser.ts"),u=x("./src/types/loader.ts"),n=x("./src/utils/attr-list.ts");function d(v){var f=v.type;switch(f){case u.PlaylistContextType.AUDIO_TRACK:return u.PlaylistLevelType.AUDIO;case u.PlaylistContextType.SUBTITLE_TRACK:return u.PlaylistLevelType.SUBTITLE;default:return u.PlaylistLevelType.MAIN}}function l(v,f){var r=v.url;return(r===void 0||r.indexOf("data:")===0)&&(r=f.url),r}var h=function(){function v(r){this.hls=void 0,this.loaders=Object.create(null),this.hls=r,this.registerListeners()}var f=v.prototype;return f.registerListeners=function(){var t=this.hls;t.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(c.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(c.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(c.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},f.unregisterListeners=function(){var t=this.hls;t.off(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(c.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(c.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(c.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},f.createInternalLoader=function(t){var i=this.hls.config,e=i.pLoader,s=i.loader,o=e||s,a=new o(i);return t.loader=a,this.loaders[t.type]=a,a},f.getInternalLoader=function(t){return this.loaders[t.type]},f.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},f.destroyInternalLoaders=function(){for(var t in this.loaders){var i=this.loaders[t];i&&i.destroy(),this.resetInternalLoader(t)}},f.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},f.onManifestLoading=function(t,i){var e=i.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:u.PlaylistContextType.MANIFEST,url:e,deliveryDirectives:null})},f.onLevelLoading=function(t,i){var e=i.id,s=i.level,o=i.url,a=i.deliveryDirectives;this.load({id:e,groupId:null,level:s,responseType:"text",type:u.PlaylistContextType.LEVEL,url:o,deliveryDirectives:a})},f.onAudioTrackLoading=function(t,i){var e=i.id,s=i.groupId,o=i.url,a=i.deliveryDirectives;this.load({id:e,groupId:s,level:null,responseType:"text",type:u.PlaylistContextType.AUDIO_TRACK,url:o,deliveryDirectives:a})},f.onSubtitleTrackLoading=function(t,i){var e=i.id,s=i.groupId,o=i.url,a=i.deliveryDirectives;this.load({id:e,groupId:s,level:null,responseType:"text",type:u.PlaylistContextType.SUBTITLE_TRACK,url:o,deliveryDirectives:a})},f.load=function(t){var i,e=this.hls.config,s=this.getInternalLoader(t);if(s){var o=s.context;if(o&&o.url===t.url){M.logger.trace("[playlist-loader]: playlist request ongoing");return}M.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),s.abort()}var a,p,D,L;switch(t.type){case u.PlaylistContextType.MANIFEST:a=e.manifestLoadingMaxRetry,p=e.manifestLoadingTimeOut,D=e.manifestLoadingRetryDelay,L=e.manifestLoadingMaxRetryTimeout;break;case u.PlaylistContextType.LEVEL:case u.PlaylistContextType.AUDIO_TRACK:case u.PlaylistContextType.SUBTITLE_TRACK:a=0,p=e.levelLoadingTimeOut;break;default:a=e.levelLoadingMaxRetry,p=e.levelLoadingTimeOut,D=e.levelLoadingRetryDelay,L=e.levelLoadingMaxRetryTimeout;break}if(s=this.createInternalLoader(t),(i=t.deliveryDirectives)!==null&&i!==void 0&&i.part){var y;if(t.type===u.PlaylistContextType.LEVEL&&t.level!==null?y=this.hls.levels[t.level].details:t.type===u.PlaylistContextType.AUDIO_TRACK&&t.id!==null?y=this.hls.audioTracks[t.id].details:t.type===u.PlaylistContextType.SUBTITLE_TRACK&&t.id!==null&&(y=this.hls.subtitleTracks[t.id].details),y){var E=y.partTarget,_=y.targetduration;E&&_&&(p=Math.min(Math.max(E*3,_*.8)*1e3,p))}}var A={timeout:p,maxRetry:a,retryDelay:D,maxRetryDelay:L,highWaterMark:0},I={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};s.load(t,A,I)},f.loadsuccess=function(t,i,e,s){if(s===void 0&&(s=null),e.isSidxRequest){this.handleSidxRequest(t,e),this.handlePlaylistLoaded(t,i,e,s);return}this.resetInternalLoader(e.type);var o=t.data;if(o.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(t,e,"no EXTM3U delimiter",s);return}i.parsing.start=performance.now(),o.indexOf("#EXTINF:")>0||o.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,i,e,s):this.handleMasterPlaylist(t,i,e,s)},f.loaderror=function(t,i,e){e===void 0&&(e=null),this.handleNetworkError(i,e,!1,t)},f.loadtimeout=function(t,i,e){e===void 0&&(e=null),this.handleNetworkError(i,e,!0)},f.handleMasterPlaylist=function(t,i,e,s){var o=this.hls,a=t.data,p=l(t,e),D=g.default.parseMasterPlaylist(a,p),L=D.levels,y=D.sessionData;if(!L.length){this.handleManifestParsingError(t,e,"no level found in manifest",s);return}var E=L.map(function(P){return{id:P.attrs.AUDIO,audioCodec:P.audioCodec}}),_=L.map(function(P){return{id:P.attrs.SUBTITLES,textCodec:P.textCodec}}),A=g.default.parseMasterPlaylistMedia(a,p,"AUDIO",E),I=g.default.parseMasterPlaylistMedia(a,p,"SUBTITLES",_),b=g.default.parseMasterPlaylistMedia(a,p,"CLOSED-CAPTIONS");if(A.length){var R=A.some(function(P){return!P.url});!R&&L[0].audioCodec&&!L[0].attrs.AUDIO&&(M.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),A.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new n.AttrList({}),bitrate:0,url:""}))}o.trigger(c.Events.MANIFEST_LOADED,{levels:L,audioTracks:A,subtitles:I,captions:b,url:p,stats:i,networkDetails:s,sessionData:y})},f.handleTrackOrLevelPlaylist=function(t,i,e,s){var o=this.hls,a=e.id,p=e.level,D=e.type,L=l(t,e),y=Object(S.isFiniteNumber)(a)?a:0,E=Object(S.isFiniteNumber)(p)?p:y,_=d(e),A=g.default.parseLevelPlaylist(t.data,L,E,_,y);if(!A.fragments.length){o.trigger(c.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:L,reason:"no fragments found in level",level:typeof e.level=="number"?e.level:void 0});return}if(D===u.PlaylistContextType.MANIFEST){var I={attrs:new n.AttrList({}),bitrate:0,details:A,name:"",url:L};o.trigger(c.Events.MANIFEST_LOADED,{levels:[I],audioTracks:[],url:L,stats:i,networkDetails:s,sessionData:null})}if(i.parsing.end=performance.now(),A.needSidxRanges){var b,R=(b=A.fragments[0].initSegment)===null||b===void 0?void 0:b.url;this.load({url:R,isSidxRequest:!0,type:D,level:p,levelDetails:A,id:a,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}e.levelDetails=A,this.handlePlaylistLoaded(t,i,e,s)},f.handleSidxRequest=function(t,i){var e=Object(T.parseSegmentIndex)(new Uint8Array(t.data));if(!!e){var s=e.references,o=i.levelDetails;s.forEach(function(a,p){var D=a.info,L=o.fragments[p];L.byteRange.length===0&&L.setByteRange(String(1+D.end-D.start)+"@"+String(D.start)),L.initSegment&&L.initSegment.setByteRange(String(e.moovEndOffset)+"@0")})}},f.handleManifestParsingError=function(t,i,e,s){this.hls.trigger(c.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:i.type===u.PlaylistContextType.MANIFEST,url:t.url,reason:e,response:t,context:i,networkDetails:s})},f.handleNetworkError=function(t,i,e,s){e===void 0&&(e=!1),M.logger.warn("[playlist-loader]: A network "+(e?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var o=m.ErrorDetails.UNKNOWN,a=!1,p=this.getInternalLoader(t);switch(t.type){case u.PlaylistContextType.MANIFEST:o=e?m.ErrorDetails.MANIFEST_LOAD_TIMEOUT:m.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case u.PlaylistContextType.LEVEL:o=e?m.ErrorDetails.LEVEL_LOAD_TIMEOUT:m.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case u.PlaylistContextType.AUDIO_TRACK:o=e?m.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:m.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;case u.PlaylistContextType.SUBTITLE_TRACK:o=e?m.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:m.ErrorDetails.SUBTITLE_LOAD_ERROR,a=!1;break}p&&this.resetInternalLoader(t.type);var D={type:m.ErrorTypes.NETWORK_ERROR,details:o,fatal:a,url:t.url,loader:p,context:t,networkDetails:i};s&&(D.response=s),this.hls.trigger(c.Events.ERROR,D)},f.handlePlaylistLoaded=function(t,i,e,s){var o=e.type,a=e.level,p=e.id,D=e.groupId,L=e.loader,y=e.levelDetails,E=e.deliveryDirectives;if(!(y!=null&&y.targetduration)){this.handleManifestParsingError(t,e,"invalid target duration",s);return}if(!!L)switch(y.live&&(L.getCacheAge&&(y.ageHeader=L.getCacheAge()||0),(!L.getCacheAge||isNaN(y.ageHeader))&&(y.ageHeader=0)),o){case u.PlaylistContextType.MANIFEST:case u.PlaylistContextType.LEVEL:this.hls.trigger(c.Events.LEVEL_LOADED,{details:y,level:a||0,id:p||0,stats:i,networkDetails:s,deliveryDirectives:E});break;case u.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(c.Events.AUDIO_TRACK_LOADED,{details:y,id:p||0,groupId:D||"",stats:i,networkDetails:s,deliveryDirectives:E});break;case u.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(c.Events.SUBTITLE_TRACK_LOADED,{details:y,id:p||0,groupId:D||"",stats:i,networkDetails:s,deliveryDirectives:E});break}},v}();C.default=h},"./src/polyfills/number.ts":function(O,C,x){x.r(C),x.d(C,"isFiniteNumber",function(){return S}),x.d(C,"MAX_SAFE_INTEGER",function(){return c});var S=Number.isFinite||function(m){return typeof m=="number"&&isFinite(m)},c=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(O,C,x){x.r(C);var S=function(){function c(){}return c.getSilentFrame=function(M,T){switch(M){case"mp4a.40.2":if(T===1)return new Uint8Array([0,200,0,128,35,128]);if(T===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(T===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(T===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(T===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(T===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(T===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(T===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(T===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},c}();C.default=S},"./src/remux/mp4-generator.ts":function(O,C,x){x.r(C);var S=Math.pow(2,32)-1,c=function(){function m(){}return m.init=function(){m.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var T;for(T in m.types)m.types.hasOwnProperty(T)&&(m.types[T]=[T.charCodeAt(0),T.charCodeAt(1),T.charCodeAt(2),T.charCodeAt(3)]);var g=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),u=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);m.HDLR_TYPES={video:g,audio:u};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),d=new Uint8Array([0,0,0,0,0,0,0,0]);m.STTS=m.STSC=m.STCO=d,m.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),m.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),m.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),m.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var l=new Uint8Array([105,115,111,109]),h=new Uint8Array([97,118,99,49]),v=new Uint8Array([0,0,0,1]);m.FTYP=m.box(m.types.ftyp,l,v,l,h),m.DINF=m.box(m.types.dinf,m.box(m.types.dref,n))},m.box=function(T){for(var g=8,u=arguments.length,n=new Array(u>1?u-1:0),d=1;d<u;d++)n[d-1]=arguments[d];for(var l=n.length,h=l;l--;)g+=n[l].byteLength;var v=new Uint8Array(g);for(v[0]=g>>24&255,v[1]=g>>16&255,v[2]=g>>8&255,v[3]=g&255,v.set(T,4),l=0,g=8;l<h;l++)v.set(n[l],g),g+=n[l].byteLength;return v},m.hdlr=function(T){return m.box(m.types.hdlr,m.HDLR_TYPES[T])},m.mdat=function(T){return m.box(m.types.mdat,T)},m.mdhd=function(T,g){g*=T;var u=Math.floor(g/(S+1)),n=Math.floor(g%(S+1));return m.box(m.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,T>>24&255,T>>16&255,T>>8&255,T&255,u>>24,u>>16&255,u>>8&255,u&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))},m.mdia=function(T){return m.box(m.types.mdia,m.mdhd(T.timescale,T.duration),m.hdlr(T.type),m.minf(T))},m.mfhd=function(T){return m.box(m.types.mfhd,new Uint8Array([0,0,0,0,T>>24,T>>16&255,T>>8&255,T&255]))},m.minf=function(T){return T.type==="audio"?m.box(m.types.minf,m.box(m.types.smhd,m.SMHD),m.DINF,m.stbl(T)):m.box(m.types.minf,m.box(m.types.vmhd,m.VMHD),m.DINF,m.stbl(T))},m.moof=function(T,g,u){return m.box(m.types.moof,m.mfhd(T),m.traf(u,g))},m.moov=function(T){for(var g=T.length,u=[];g--;)u[g]=m.trak(T[g]);return m.box.apply(null,[m.types.moov,m.mvhd(T[0].timescale,T[0].duration)].concat(u).concat(m.mvex(T)))},m.mvex=function(T){for(var g=T.length,u=[];g--;)u[g]=m.trex(T[g]);return m.box.apply(null,[m.types.mvex].concat(u))},m.mvhd=function(T,g){g*=T;var u=Math.floor(g/(S+1)),n=Math.floor(g%(S+1)),d=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,T>>24&255,T>>16&255,T>>8&255,T&255,u>>24,u>>16&255,u>>8&255,u&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return m.box(m.types.mvhd,d)},m.sdtp=function(T){var g=T.samples||[],u=new Uint8Array(4+g.length),n,d;for(n=0;n<g.length;n++)d=g[n].flags,u[n+4]=d.dependsOn<<4|d.isDependedOn<<2|d.hasRedundancy;return m.box(m.types.sdtp,u)},m.stbl=function(T){return m.box(m.types.stbl,m.stsd(T),m.box(m.types.stts,m.STTS),m.box(m.types.stsc,m.STSC),m.box(m.types.stsz,m.STSZ),m.box(m.types.stco,m.STCO))},m.avc1=function(T){var g=[],u=[],n,d,l;for(n=0;n<T.sps.length;n++)d=T.sps[n],l=d.byteLength,g.push(l>>>8&255),g.push(l&255),g=g.concat(Array.prototype.slice.call(d));for(n=0;n<T.pps.length;n++)d=T.pps[n],l=d.byteLength,u.push(l>>>8&255),u.push(l&255),u=u.concat(Array.prototype.slice.call(d));var h=m.box(m.types.avcC,new Uint8Array([1,g[3],g[4],g[5],255,224|T.sps.length].concat(g).concat([T.pps.length]).concat(u))),v=T.width,f=T.height,r=T.pixelRatio[0],t=T.pixelRatio[1];return m.box(m.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,v>>8&255,v&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,m.box(m.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),m.box(m.types.pasp,new Uint8Array([r>>24,r>>16&255,r>>8&255,r&255,t>>24,t>>16&255,t>>8&255,t&255])))},m.esds=function(T){var g=T.config.length;return new Uint8Array([0,0,0,0,3,23+g,0,1,0,4,15+g,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([g]).concat(T.config).concat([6,1,2]))},m.mp4a=function(T){var g=T.samplerate;return m.box(m.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,T.channelCount,0,16,0,0,0,0,g>>8&255,g&255,0,0]),m.box(m.types.esds,m.esds(T)))},m.mp3=function(T){var g=T.samplerate;return m.box(m.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,T.channelCount,0,16,0,0,0,0,g>>8&255,g&255,0,0]))},m.stsd=function(T){return T.type==="audio"?!T.isAAC&&T.codec==="mp3"?m.box(m.types.stsd,m.STSD,m.mp3(T)):m.box(m.types.stsd,m.STSD,m.mp4a(T)):m.box(m.types.stsd,m.STSD,m.avc1(T))},m.tkhd=function(T){var g=T.id,u=T.duration*T.timescale,n=T.width,d=T.height,l=Math.floor(u/(S+1)),h=Math.floor(u%(S+1));return m.box(m.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,g>>24&255,g>>16&255,g>>8&255,g&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,h>>24,h>>16&255,h>>8&255,h&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,d>>8&255,d&255,0,0]))},m.traf=function(T,g){var u=m.sdtp(T),n=T.id,d=Math.floor(g/(S+1)),l=Math.floor(g%(S+1));return m.box(m.types.traf,m.box(m.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),m.box(m.types.tfdt,new Uint8Array([1,0,0,0,d>>24,d>>16&255,d>>8&255,d&255,l>>24,l>>16&255,l>>8&255,l&255])),m.trun(T,u.length+16+20+8+16+8+8),u)},m.trak=function(T){return T.duration=T.duration||4294967295,m.box(m.types.trak,m.tkhd(T),m.mdia(T))},m.trex=function(T){var g=T.id;return m.box(m.types.trex,new Uint8Array([0,0,0,0,g>>24,g>>16&255,g>>8&255,g&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},m.trun=function(T,g){var u=T.samples||[],n=u.length,d=12+16*n,l=new Uint8Array(d),h,v,f,r,t,i;for(g+=8+d,l.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255],0),h=0;h<n;h++)v=u[h],f=v.duration,r=v.size,t=v.flags,i=v.cts,l.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t.isLeading<<2|t.dependsOn,t.isDependedOn<<6|t.hasRedundancy<<4|t.paddingValue<<1|t.isNonSync,t.degradPrio&240<<8,t.degradPrio&15,i>>>24&255,i>>>16&255,i>>>8&255,i&255],12+16*h);return m.box(m.types.trun,l)},m.initSegment=function(T){m.types||m.init();var g=m.moov(T),u=new Uint8Array(m.FTYP.byteLength+g.byteLength);return u.set(m.FTYP),u.set(g,m.FTYP.byteLength),u},m}();c.types=void 0,c.HDLR_TYPES=void 0,c.STTS=void 0,c.STSC=void 0,c.STCO=void 0,c.STSZ=void 0,c.VMHD=void 0,c.SMHD=void 0,c.STSD=void 0,c.FTYP=void 0,c.DINF=void 0,C.default=c},"./src/remux/mp4-remuxer.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return i}),x.d(C,"normalizePts",function(){return e});var S=x("./src/polyfills/number.ts"),c=x("./src/remux/aac-helper.ts"),m=x("./src/remux/mp4-generator.ts"),M=x("./src/events.ts"),T=x("./src/errors.ts"),g=x("./src/utils/logger.ts"),u=x("./src/types/loader.ts"),n=x("./src/utils/timescale-conversion.ts");function d(){return d=Object.assign||function(p){for(var D=1;D<arguments.length;D++){var L=arguments[D];for(var y in L)Object.prototype.hasOwnProperty.call(L,y)&&(p[y]=L[y])}return p},d.apply(this,arguments)}var l=10*1e3,h=1024,v=1152,f=null,r=null,t=!1,i=function(){function p(L,y,E,_){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=L,this.config=y,this.typeSupported=E,this.ISGenerated=!1,f===null){var A=navigator.userAgent||"",I=A.match(/Chrome\/(\d+)/i);f=I?parseInt(I[1]):0}if(r===null){var b=navigator.userAgent.match(/Safari\/(\d+)/i);r=b?parseInt(b[1]):0}t=!!f&&f<75||!!r&&r<600}var D=p.prototype;return D.destroy=function(){},D.resetTimeStamp=function(y){g.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=y},D.resetNextTimestamp=function(){g.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},D.resetInitSegment=function(){g.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},D.getVideoStartPts=function(y){var E=!1,_=y.reduce(function(A,I){var b=I.pts-A;return b<-4294967296?(E=!0,e(A,I.pts)):b>0?A:I.pts},y[0].pts);return E&&g.logger.debug("PTS rollover detected"),_},D.remux=function(y,E,_,A,I,b,R,P){var w,F,k,B,U,j,K=I,N=I,Z=y.pid>-1,$=E.pid>-1,Y=E.samples.length,ee=y.samples.length>0,Q=Y>1,G=(!Z||ee)&&(!$||Q)||this.ISGenerated||R;if(G){this.ISGenerated||(k=this.generateIS(y,E,I));var q=this.isVideoContiguous,te=-1;if(Q&&(te=s(E.samples),!q&&this.config.forceKeyFrameOnDiscontinuity))if(j=!0,te>0){g.logger.warn("[mp4-remuxer]: Dropped "+te+" out of "+Y+" video samples due to a missing keyframe");var ie=this.getVideoStartPts(E.samples);E.samples=E.samples.slice(te),E.dropped+=te,N+=(E.samples[0].pts-ie)/(E.timescale||9e4)}else te===-1&&(g.logger.warn("[mp4-remuxer]: No keyframe found out of "+Y+" video samples"),j=!1);if(this.ISGenerated){if(ee&&Q){var ne=this.getVideoStartPts(E.samples),le=e(y.samples[0].pts,ne)-ne,se=le/E.inputTimeScale;K+=Math.max(0,se),N+=Math.max(0,-se)}if(ee){if(y.samplerate||(g.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),k=this.generateIS(y,E,I)),F=this.remuxAudio(y,K,this.isAudioContiguous,b,$||Q||P===u.PlaylistLevelType.AUDIO?N:void 0),Q){var oe=F?F.endPTS-F.startPTS:0;E.inputTimeScale||(g.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),k=this.generateIS(y,E,I)),w=this.remuxVideo(E,N,q,oe)}}else Q&&(w=this.remuxVideo(E,N,q,0));w&&(w.firstKeyFrame=te,w.independent=te!==-1)}}return this.ISGenerated&&(_.samples.length&&(U=this.remuxID3(_,I)),A.samples.length&&(B=this.remuxText(A,I))),{audio:F,video:w,initSegment:k,independent:j,text:B,id3:U}},D.generateIS=function(y,E,_){var A=y.samples,I=E.samples,b=this.typeSupported,R={},P=!Object(S.isFiniteNumber)(this._initPTS),w="audio/mp4",F,k,B;if(P&&(F=k=1/0),y.config&&A.length&&(y.timescale=y.samplerate,y.isAAC||(b.mpeg?(w="audio/mpeg",y.codec=""):b.mp3&&(y.codec="mp3")),R.audio={id:"audio",container:w,codec:y.codec,initSegment:!y.isAAC&&b.mpeg?new Uint8Array(0):m.default.initSegment([y]),metadata:{channelCount:y.channelCount}},P&&(B=y.inputTimeScale,F=k=A[0].pts-Math.round(B*_))),E.sps&&E.pps&&I.length&&(E.timescale=E.inputTimeScale,R.video={id:"main",container:"video/mp4",codec:E.codec,initSegment:m.default.initSegment([E]),metadata:{width:E.width,height:E.height}},P)){B=E.inputTimeScale;var U=this.getVideoStartPts(I),j=Math.round(B*_);k=Math.min(k,e(I[0].dts,U)-j),F=Math.min(F,U-j)}if(Object.keys(R).length)return this.ISGenerated=!0,P&&(this._initPTS=F,this._initDTS=k),{tracks:R,initPTS:F,timescale:B}},D.remuxVideo=function(y,E,_,A){var I=y.inputTimeScale,b=y.samples,R=[],P=b.length,w=this._initPTS,F=this.nextAvcDts,k=8,B,U,j,K=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,Z=0,$=!1;if(!_||F===null){var Y=E*I,ee=b[0].pts-e(b[0].dts,b[0].pts);F=Y-ee}for(var Q=0;Q<P;Q++){var G=b[Q];if(G.pts=e(G.pts-w,F),G.dts=e(G.dts-w,F),G.dts>G.pts){var q=18e3;Z=Math.max(Math.min(Z,G.pts-G.dts),-1*q)}G.dts<b[Q>0?Q-1:Q].dts&&($=!0)}$&&b.sort(function(ke,Ne){var tt=ke.dts-Ne.dts,rt=ke.pts-Ne.pts;return tt||rt}),U=b[0].dts,j=b[b.length-1].dts;var te=Math.round((j-U)/(P-1));if(Z<0){if(Z<te*-2){g.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(n.toMsFromMpegTsClock)(-te,!0)+" ms");for(var ie=Z,ne=0;ne<P;ne++)b[ne].dts=ie=Math.max(ie,b[ne].pts-te),b[ne].pts=Math.max(ie,b[ne].pts)}else{g.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(n.toMsFromMpegTsClock)(Z,!0)+" ms to overcome this issue");for(var le=0;le<P;le++)b[le].dts=b[le].dts+Z}U=b[0].dts}if(_){var se=U-F,oe=se>te,J=se<-1;if(oe||J){oe?g.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(se,!0)+" ms ("+se+"dts) hole between fragments detected, filling it"):g.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(-se,!0)+" ms ("+se+"dts) overlapping between fragments detected"),U=F;var ae=b[0].pts-se;b[0].dts=U,b[0].pts=ae,g.logger.log("Video: First PTS/DTS adjusted: "+Object(n.toMsFromMpegTsClock)(ae,!0)+"/"+Object(n.toMsFromMpegTsClock)(U,!0)+", delta: "+Object(n.toMsFromMpegTsClock)(se,!0)+" ms")}}t&&(U=Math.max(0,U));for(var fe=0,de=0,ve=0;ve<P;ve++){for(var ue=b[ve],Te=ue.units,he=Te.length,Ee=0,W=0;W<he;W++)Ee+=Te[W].data.length;de+=Ee,fe+=he,ue.length=Ee,ue.dts=Math.max(ue.dts,U),ue.pts=Math.max(ue.pts,ue.dts,0),K=Math.min(ue.pts,K),N=Math.max(ue.pts,N)}j=b[P-1].dts;var z=de+4*fe+8,V;try{V=new Uint8Array(z)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:T.ErrorTypes.MUX_ERROR,details:T.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:z,reason:"fail allocating video mdat "+z});return}var X=new DataView(V.buffer);X.setUint32(0,z),V.set(m.default.types.mdat,4);for(var H=0;H<P;H++){for(var re=b[H],ce=re.units,me=0,xe=0,Se=ce.length;xe<Se;xe++){var _e=ce[xe],Le=_e.data,be=_e.data.byteLength;X.setUint32(k,be),k+=4,V.set(Le,k),k+=be,me+=4+be}if(H<P-1)B=b[H+1].dts-re.dts;else{var Oe=this.config,Ce=re.dts-b[H>0?H-1:H].dts;if(Oe.stretchShortVideoTrack&&this.nextAudioPts!==null){var $e=Math.floor(Oe.maxBufferHole*I),Fe=(A?K+A*I:this.nextAudioPts)-re.pts;Fe>$e?(B=Fe-Ce,B<0&&(B=Ce),g.logger.log("[mp4-remuxer]: It is approximately "+Fe/90+" ms to the next segment; using duration "+B/90+" ms for the last video frame.")):B=Ce}else B=Ce}var Xe=Math.round(re.pts-re.dts);R.push(new o(re.key,B,me,Xe))}if(R.length&&f&&f<70){var je=R[0].flags;je.dependsOn=2,je.isNonSync=0}console.assert(B!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=F=j+B,this.isVideoContiguous=!0;var Je=m.default.moof(y.sequenceNumber++,U,d({},y,{samples:R})),qe="video",et={data1:Je,data2:V,startPTS:K/I,endPTS:(N+B)/I,startDTS:U/I,endDTS:F/I,type:qe,hasAudio:!1,hasVideo:!0,nb:R.length,dropped:y.dropped};return y.samples=[],y.dropped=0,console.assert(V.length,"MDAT length must not be zero"),et},D.remuxAudio=function(y,E,_,A,I){var b=y.inputTimeScale,R=y.samplerate?y.samplerate:b,P=b/R,w=y.isAAC?h:v,F=w*P,k=this._initPTS,B=!y.isAAC&&this.typeSupported.mpeg,U=[],j=y.samples,K=B?0:8,N=this.nextAudioPts||-1,Z=E*b;if(this.isAudioContiguous=_=_||j.length&&N>0&&(A&&Math.abs(Z-N)<9e3||Math.abs(e(j[0].pts-k,Z)-N)<20*F),j.forEach(function(Le){Le.pts=e(Le.pts-k,Z)}),!_||N<0){if(j=j.filter(function(Le){return Le.pts>=0}),!j.length)return;I===0?N=0:A?N=Math.max(0,Z):N=j[0].pts}if(y.isAAC)for(var $=I!==void 0,Y=this.config.maxAudioFramesDrift,ee=0,Q=N;ee<j.length;ee++){var G=j[ee],q=G.pts,te=q-Q,ie=Math.abs(1e3*te/b);if(te<=-Y*F&&$)ee===0&&(g.logger.warn("Audio frame @ "+(q/b).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*te/b)+" ms."),this.nextAudioPts=N=Q=q);else if(te>=Y*F&&ie<l&&$){var ne=Math.round(te/F);Q=q-ne*F,Q<0&&(ne--,Q+=F),ee===0&&(this.nextAudioPts=N=Q),g.logger.warn("[mp4-remuxer]: Injecting "+ne+" audio frame @ "+(Q/b).toFixed(3)+"s due to "+Math.round(1e3*te/b)+" ms gap.");for(var le=0;le<ne;le++){var se=Math.max(Q,0),oe=c.default.getSilentFrame(y.manifestCodec||y.codec,y.channelCount);oe||(g.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=G.unit.subarray()),j.splice(ee,0,{unit:oe,pts:se}),Q+=F,ee++}}G.pts=Q,Q+=F}for(var J=null,ae=null,fe,de=0,ve=j.length;ve--;)de+=j[ve].unit.byteLength;for(var ue=0,Te=j.length;ue<Te;ue++){var he=j[ue],Ee=he.unit,W=he.pts;if(ae!==null){var z=U[ue-1];z.duration=Math.round((W-ae)/P)}else if(_&&y.isAAC&&(W=N),J=W,de>0){de+=K;try{fe=new Uint8Array(de)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:T.ErrorTypes.MUX_ERROR,details:T.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:de,reason:"fail allocating audio mdat "+de});return}if(!B){var V=new DataView(fe.buffer);V.setUint32(0,de),fe.set(m.default.types.mdat,4)}}else return;fe.set(Ee,K);var X=Ee.byteLength;K+=X,U.push(new o(!0,w,X,0)),ae=W}var H=U.length;if(!!H){var re=U[U.length-1];this.nextAudioPts=N=ae+P*re.duration;var ce=B?new Uint8Array(0):m.default.moof(y.sequenceNumber++,J/P,d({},y,{samples:U}));y.samples=[];var me=J/b,xe=N/b,Se="audio",_e={data1:ce,data2:fe,startPTS:me,endPTS:xe,startDTS:me,endDTS:xe,type:Se,hasAudio:!0,hasVideo:!1,nb:H};return this.isAudioContiguous=!0,console.assert(fe.length,"MDAT length must not be zero"),_e}},D.remuxEmptyAudio=function(y,E,_,A){var I=y.inputTimeScale,b=y.samplerate?y.samplerate:I,R=I/b,P=this.nextAudioPts,w=(P!==null?P:A.startDTS*I)+this._initDTS,F=A.endDTS*I+this._initDTS,k=R*h,B=Math.ceil((F-w)/k),U=c.default.getSilentFrame(y.manifestCodec||y.codec,y.channelCount);if(g.logger.warn("[mp4-remuxer]: remux empty Audio"),!U){g.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var j=[],K=0;K<B;K++){var N=w+K*k;j.push({unit:U,pts:N,dts:N})}return y.samples=j,this.remuxAudio(y,E,_,!1)},D.remuxID3=function(y,E){var _=y.samples.length;if(!!_){for(var A=y.inputTimeScale,I=this._initPTS,b=this._initDTS,R=0;R<_;R++){var P=y.samples[R];P.pts=e(P.pts-I,E*A)/A,P.dts=e(P.dts-b,E*A)/A}var w=y.samples;return y.samples=[],{samples:w}}},D.remuxText=function(y,E){var _=y.samples.length;if(!!_){for(var A=y.inputTimeScale,I=this._initPTS,b=0;b<_;b++){var R=y.samples[b];R.pts=e(R.pts-I,E*A)/A}y.samples.sort(function(w,F){return w.pts-F.pts});var P=y.samples;return y.samples=[],{samples:P}}},p}();function e(p,D){var L;if(D===null)return p;for(D<p?L=-8589934592:L=8589934592;Math.abs(p-D)>4294967296;)p+=L;return p}function s(p){for(var D=0;D<p.length;D++)if(p[D].key)return D;return-1}var o=function(D,L,y,E){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=L,this.size=y,this.cts=E,this.flags=new a(D)},a=function(D){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=D?2:1,this.isNonSync=D?0:1}},"./src/remux/passthrough-remuxer.ts":function(O,C,x){x.r(C);var S=x("./src/polyfills/number.ts"),c=x("./src/utils/mp4-tools.ts"),m=x("./src/loader/fragment.ts"),M=x("./src/utils/logger.ts"),T=function(){function n(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var d=n.prototype;return d.destroy=function(){},d.resetTimeStamp=function(h){this.initPTS=h,this.lastEndDTS=null},d.resetNextTimestamp=function(){this.lastEndDTS=null},d.resetInitSegment=function(h,v,f){this.audioCodec=v,this.videoCodec=f,this.generateInitSegment(h),this.emitInitSegment=!0},d.generateInitSegment=function(h){var v=this.audioCodec,f=this.videoCodec;if(!h||!h.byteLength){this.initTracks=void 0,this.initData=void 0;return}var r=this.initData=Object(c.parseInitSegment)(h);v||(v=u(r.audio,m.ElementaryStreamTypes.AUDIO)),f||(f=u(r.video,m.ElementaryStreamTypes.VIDEO));var t={};r.audio&&r.video?t.audiovideo={container:"video/mp4",codec:v+","+f,initSegment:h,id:"main"}:r.audio?t.audio={container:"audio/mp4",codec:v,initSegment:h,id:"audio"}:r.video?t.video={container:"video/mp4",codec:f,initSegment:h,id:"main"}:M.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=t},d.remux=function(h,v,f,r,t){var i=this.initPTS,e=this.lastEndDTS,s={audio:void 0,video:void 0,text:r,id3:f,initSegment:void 0};Object(S.isFiniteNumber)(e)||(e=this.lastEndDTS=t||0);var o=v.samples;if(!o||!o.length)return s;var a={initPTS:void 0,timescale:1},p=this.initData;if((!p||!p.length)&&(this.generateInitSegment(o),p=this.initData),!p||!p.length)return M.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),s;this.emitInitSegment&&(a.tracks=this.initTracks,this.emitInitSegment=!1),Object(S.isFiniteNumber)(i)||(this.initPTS=a.initPTS=i=g(p,o,e));var D=Object(c.getDuration)(o,p),L=e,y=D+L;Object(c.offsetStartDTS)(p,o,i),D>0?this.lastEndDTS=y:(M.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!p.audio,_=!!p.video,A="";E&&(A+="audio"),_&&(A+="video");var I={data1:o,startPTS:L,startDTS:L,endPTS:y,endDTS:y,type:A,hasAudio:E,hasVideo:_,nb:1,dropped:0};return s.audio=I.type==="audio"?I:void 0,s.video=I.type!=="audio"?I:void 0,s.text=r,s.id3=f,s.initSegment=a,s},n}(),g=function(d,l,h){return Object(c.getStartDTS)(d,l)-h};function u(n,d){var l=n==null?void 0:n.codec;return l&&l.length>4?l:l==="hvc1"?"hvc1.1.c.L120.90":l==="av01"?"av01.0.04M.08":l==="avc1"||d===m.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}C.default=T},"./src/task-loop.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function c(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var m=c.prototype;return m.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},m.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},m.onHandlerDestroyed=function(){},m.hasInterval=function(){return!!this._tickInterval},m.hasNextTick=function(){return!!this._tickTimer},m.setInterval=function(T){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,T),!0)},m.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},m.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},m.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},m.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},m.doTick=function(){},c}()},"./src/types/cmcd.ts":function(O,C,x){x.r(C),x.d(C,"CMCDVersion",function(){return S}),x.d(C,"CMCDObjectType",function(){return c}),x.d(C,"CMCDStreamingFormat",function(){return m}),x.d(C,"CMCDStreamType",function(){return M});var S=1,c;(function(T){T.MANIFEST="m",T.AUDIO="a",T.VIDEO="v",T.MUXED="av",T.INIT="i",T.CAPTION="c",T.TIMED_TEXT="tt",T.KEY="k",T.OTHER="o"})(c||(c={}));var m;(function(T){T.DASH="d",T.HLS="h",T.SMOOTH="s",T.OTHER="o"})(m||(m={}));var M;(function(T){T.VOD="v",T.LIVE="l"})(M||(M={}))},"./src/types/level.ts":function(O,C,x){x.r(C),x.d(C,"HlsSkip",function(){return m}),x.d(C,"getSkipValue",function(){return M}),x.d(C,"HlsUrlParameters",function(){return T}),x.d(C,"Level",function(){return g});function S(u,n){for(var d=0;d<n.length;d++){var l=n[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}function c(u,n,d){return n&&S(u.prototype,n),d&&S(u,d),u}var m;(function(u){u.No="",u.Yes="YES",u.v2="v2"})(m||(m={}));function M(u,n){var d=u.canSkipUntil,l=u.canSkipDateRanges,h=u.endSN,v=n!==void 0?n-h:0;return d&&v<d?l?m.v2:m.Yes:m.No}var T=function(){function u(d,l,h){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=d,this.part=l,this.skip=h}var n=u.prototype;return n.addDirectives=function(l){var h=new self.URL(l);return this.msn!==void 0&&h.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&h.searchParams.set("_HLS_part",this.part.toString()),this.skip&&h.searchParams.set("_HLS_skip",this.skip),h.toString()},u}(),g=function(){function u(n){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[n.url],this.attrs=n.attrs,this.bitrate=n.bitrate,n.details&&(this.details=n.details),this.id=n.id||0,this.name=n.name,this.width=n.width||0,this.height=n.height||0,this.audioCodec=n.audioCodec,this.videoCodec=n.videoCodec,this.unknownCodecs=n.unknownCodecs,this.codecSet=[n.videoCodec,n.audioCodec].filter(function(d){return d}).join(",").replace(/\.[^.,]+/g,"")}return c(u,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(d){var l=d%this.url.length;this._urlId!==l&&(this.details=void 0,this._urlId=l)}}]),u}()},"./src/types/loader.ts":function(O,C,x){x.r(C),x.d(C,"PlaylistContextType",function(){return S}),x.d(C,"PlaylistLevelType",function(){return c});var S;(function(m){m.MANIFEST="manifest",m.LEVEL="level",m.AUDIO_TRACK="audioTrack",m.SUBTITLE_TRACK="subtitleTrack"})(S||(S={}));var c;(function(m){m.MAIN="main",m.AUDIO="audio",m.SUBTITLE="subtitle"})(c||(c={}))},"./src/types/transmuxer.ts":function(O,C,x){x.r(C),x.d(C,"ChunkMetadata",function(){return S});var S=function(M,T,g,u,n,d){u===void 0&&(u=0),n===void 0&&(n=-1),d===void 0&&(d=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=c(),this.buffering={audio:c(),video:c(),audiovideo:c()},this.level=M,this.sn=T,this.id=g,this.size=u,this.part=n,this.partial=d};function c(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(O,C,x){x.r(C),x.d(C,"AttrList",function(){return m});var S=/^(\d+)x(\d+)$/,c=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,m=function(){function M(g){typeof g=="string"&&(g=M.parseAttrList(g));for(var u in g)g.hasOwnProperty(u)&&(this[u]=g[u])}var T=M.prototype;return T.decimalInteger=function(u){var n=parseInt(this[u],10);return n>Number.MAX_SAFE_INTEGER?1/0:n},T.hexadecimalInteger=function(u){if(this[u]){var n=(this[u]||"0x").slice(2);n=(n.length&1?"0":"")+n;for(var d=new Uint8Array(n.length/2),l=0;l<n.length/2;l++)d[l]=parseInt(n.slice(l*2,l*2+2),16);return d}else return null},T.hexadecimalIntegerAsNumber=function(u){var n=parseInt(this[u],16);return n>Number.MAX_SAFE_INTEGER?1/0:n},T.decimalFloatingPoint=function(u){return parseFloat(this[u])},T.optionalFloat=function(u,n){var d=this[u];return d?parseFloat(d):n},T.enumeratedString=function(u){return this[u]},T.bool=function(u){return this[u]==="YES"},T.decimalResolution=function(u){var n=S.exec(this[u]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}},M.parseAttrList=function(u){var n,d={},l='"';for(c.lastIndex=0;(n=c.exec(u))!==null;){var h=n[2];h.indexOf(l)===0&&h.lastIndexOf(l)===h.length-1&&(h=h.slice(1,-1)),d[n[1]]=h}return d},M}()},"./src/utils/binary-search.ts":function(O,C,x){x.r(C);var S={search:function(m,M){for(var T=0,g=m.length-1,u=null,n=null;T<=g;){u=(T+g)/2|0,n=m[u];var d=M(n);if(d>0)T=u+1;else if(d<0)g=u-1;else return n}return null}};C.default=S},"./src/utils/buffer-helper.ts":function(O,C,x){x.r(C),x.d(C,"BufferHelper",function(){return m});var S=x("./src/utils/logger.ts"),c={length:0,start:function(){return 0},end:function(){return 0}},m=function(){function M(){}return M.isBuffered=function(g,u){try{if(g){for(var n=M.getBuffered(g),d=0;d<n.length;d++)if(u>=n.start(d)&&u<=n.end(d))return!0}}catch{}return!1},M.bufferInfo=function(g,u,n){try{if(g){var d=M.getBuffered(g),l=[],h;for(h=0;h<d.length;h++)l.push({start:d.start(h),end:d.end(h)});return this.bufferedInfo(l,u,n)}}catch{}return{len:0,start:u,end:u,nextStart:void 0}},M.bufferedInfo=function(g,u,n){u=Math.max(0,u),g.sort(function(a,p){var D=a.start-p.start;return D||p.end-a.end});var d=[];if(n)for(var l=0;l<g.length;l++){var h=d.length;if(h){var v=d[h-1].end;g[l].start-v<n?g[l].end>v&&(d[h-1].end=g[l].end):d.push(g[l])}else d.push(g[l])}else d=g;for(var f=0,r,t=u,i=u,e=0;e<d.length;e++){var s=d[e].start,o=d[e].end;if(u+n>=s&&u<o)t=s,i=o,f=i-u;else if(u+n<s){r=s;break}}return{len:f,start:t||0,end:i||0,nextStart:r}},M.getBuffered=function(g){try{return g.buffered}catch(u){return S.logger.log("failed to get media.buffered",u),c}},M}()},"./src/utils/cea-608-parser.ts":function(O,C,x){x.r(C),x.d(C,"Row",function(){return i}),x.d(C,"CaptionScreen",function(){return e});var S=x("./src/utils/logger.ts"),c={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},m=function(y){var E=y;return c.hasOwnProperty(y)&&(E=c[y]),String.fromCharCode(E)},M=15,T=100,g={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},n={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h;(function(L){L[L.ERROR=0]="ERROR",L[L.TEXT=1]="TEXT",L[L.WARNING=2]="WARNING",L[L.INFO=2]="INFO",L[L.DEBUG=3]="DEBUG",L[L.DATA=3]="DATA"})(h||(h={}));var v=function(){function L(){this.time=null,this.verboseLevel=h.ERROR}var y=L.prototype;return y.log=function(_,A){this.verboseLevel>=_&&S.logger.log(this.time+" ["+_+"] "+A)},L}(),f=function(y){for(var E=[],_=0;_<y.length;_++)E.push(y[_].toString(16));return E},r=function(){function L(E,_,A,I,b){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=E||"white",this.underline=_||!1,this.italics=A||!1,this.background=I||"black",this.flash=b||!1}var y=L.prototype;return y.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},y.setStyles=function(_){for(var A=["foreground","underline","italics","background","flash"],I=0;I<A.length;I++){var b=A[I];_.hasOwnProperty(b)&&(this[b]=_[b])}},y.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},y.equals=function(_){return this.foreground===_.foreground&&this.underline===_.underline&&this.italics===_.italics&&this.background===_.background&&this.flash===_.flash},y.copy=function(_){this.foreground=_.foreground,this.underline=_.underline,this.italics=_.italics,this.background=_.background,this.flash=_.flash},y.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},L}(),t=function(){function L(E,_,A,I,b,R){this.uchar=void 0,this.penState=void 0,this.uchar=E||" ",this.penState=new r(_,A,I,b,R)}var y=L.prototype;return y.reset=function(){this.uchar=" ",this.penState.reset()},y.setChar=function(_,A){this.uchar=_,this.penState.copy(A)},y.setPenState=function(_){this.penState.copy(_)},y.equals=function(_){return this.uchar===_.uchar&&this.penState.equals(_.penState)},y.copy=function(_){this.uchar=_.uchar,this.penState.copy(_.penState)},y.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},L}(),i=function(){function L(E){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var _=0;_<T;_++)this.chars.push(new t);this.logger=E,this.pos=0,this.currPenState=new r}var y=L.prototype;return y.equals=function(_){for(var A=!0,I=0;I<T;I++)if(!this.chars[I].equals(_.chars[I])){A=!1;break}return A},y.copy=function(_){for(var A=0;A<T;A++)this.chars[A].copy(_.chars[A])},y.isEmpty=function(){for(var _=!0,A=0;A<T;A++)if(!this.chars[A].isEmpty()){_=!1;break}return _},y.setCursor=function(_){this.pos!==_&&(this.pos=_),this.pos<0?(this.logger.log(h.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>T&&(this.logger.log(h.DEBUG,"Too large cursor position "+this.pos),this.pos=T)},y.moveCursor=function(_){var A=this.pos+_;if(_>1)for(var I=this.pos+1;I<A+1;I++)this.chars[I].setPenState(this.currPenState);this.setCursor(A)},y.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},y.insertChar=function(_){_>=144&&this.backSpace();var A=m(_);if(this.pos>=T){this.logger.log(h.ERROR,"Cannot insert "+_.toString(16)+" ("+A+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(A,this.currPenState),this.moveCursor(1)},y.clearFromPos=function(_){var A;for(A=_;A<T;A++)this.chars[A].reset()},y.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},y.clearToEndOfRow=function(){this.clearFromPos(this.pos)},y.getTextString=function(){for(var _=[],A=!0,I=0;I<T;I++){var b=this.chars[I].uchar;b!==" "&&(A=!1),_.push(b)}return A?"":_.join("")},y.setPenStyles=function(_){this.currPenState.setStyles(_);var A=this.chars[this.pos];A.setPenState(this.currPenState)},L}(),e=function(){function L(E){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var _=0;_<M;_++)this.rows.push(new i(E));this.logger=E,this.currRow=M-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var y=L.prototype;return y.reset=function(){for(var _=0;_<M;_++)this.rows[_].clear();this.currRow=M-1},y.equals=function(_){for(var A=!0,I=0;I<M;I++)if(!this.rows[I].equals(_.rows[I])){A=!1;break}return A},y.copy=function(_){for(var A=0;A<M;A++)this.rows[A].copy(_.rows[A])},y.isEmpty=function(){for(var _=!0,A=0;A<M;A++)if(!this.rows[A].isEmpty()){_=!1;break}return _},y.backSpace=function(){var _=this.rows[this.currRow];_.backSpace()},y.clearToEndOfRow=function(){var _=this.rows[this.currRow];_.clearToEndOfRow()},y.insertChar=function(_){var A=this.rows[this.currRow];A.insertChar(_)},y.setPen=function(_){var A=this.rows[this.currRow];A.setPenStyles(_)},y.moveCursor=function(_){var A=this.rows[this.currRow];A.moveCursor(_)},y.setCursor=function(_){this.logger.log(h.INFO,"setCursor: "+_);var A=this.rows[this.currRow];A.setCursor(_)},y.setPAC=function(_){this.logger.log(h.INFO,"pacData = "+JSON.stringify(_));var A=_.row-1;if(this.nrRollUpRows&&A<this.nrRollUpRows-1&&(A=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==A){for(var I=0;I<M;I++)this.rows[I].clear();var b=this.currRow+1-this.nrRollUpRows,R=this.lastOutputScreen;if(R){var P=R.rows[b].cueStartTime,w=this.logger.time;if(P&&w!==null&&P<w)for(var F=0;F<this.nrRollUpRows;F++)this.rows[A-this.nrRollUpRows+F+1].copy(R.rows[b+F])}}this.currRow=A;var k=this.rows[this.currRow];if(_.indent!==null){var B=_.indent,U=Math.max(B-1,0);k.setCursor(_.indent),_.color=k.chars[U].penState.foreground}var j={foreground:_.color,underline:_.underline,italics:_.italics,background:"black",flash:!1};this.setPen(j)},y.setBkgData=function(_){this.logger.log(h.INFO,"bkgData = "+JSON.stringify(_)),this.backSpace(),this.setPen(_),this.insertChar(32)},y.setRollUpRows=function(_){this.nrRollUpRows=_},y.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(h.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(h.TEXT,this.getDisplayText());var _=this.currRow+1-this.nrRollUpRows,A=this.rows.splice(_,1)[0];A.clear(),this.rows.splice(this.currRow,0,A),this.logger.log(h.INFO,"Rolling up")},y.getDisplayText=function(_){_=_||!1;for(var A=[],I="",b=-1,R=0;R<M;R++){var P=this.rows[R].getTextString();P&&(b=R+1,_?A.push("Row "+b+": '"+P+"'"):A.push(P.trim()))}return A.length>0&&(_?I="["+A.join(" | ")+"]":I=A.join(`
`)),I},y.getTextAndFormat=function(){return this.rows},L}(),s=function(){function L(E,_,A){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=E,this.outputFilter=_,this.mode=null,this.verbose=0,this.displayedMemory=new e(A),this.nonDisplayedMemory=new e(A),this.lastOutputScreen=new e(A),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=A}var y=L.prototype;return y.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},y.getHandler=function(){return this.outputFilter},y.setHandler=function(_){this.outputFilter=_},y.setPAC=function(_){this.writeScreen.setPAC(_)},y.setBkgData=function(_){this.writeScreen.setBkgData(_)},y.setMode=function(_){_!==this.mode&&(this.mode=_,this.logger.log(h.INFO,"MODE="+_),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=_)},y.insertChars=function(_){for(var A=0;A<_.length;A++)this.writeScreen.insertChar(_[A]);var I=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(h.INFO,I+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(h.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},y.ccRCL=function(){this.logger.log(h.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},y.ccBS=function(){this.logger.log(h.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},y.ccAOF=function(){},y.ccAON=function(){},y.ccDER=function(){this.logger.log(h.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},y.ccRU=function(_){this.logger.log(h.INFO,"RU("+_+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(_)},y.ccFON=function(){this.logger.log(h.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},y.ccRDC=function(){this.logger.log(h.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},y.ccTR=function(){this.logger.log(h.INFO,"TR"),this.setMode("MODE_TEXT")},y.ccRTD=function(){this.logger.log(h.INFO,"RTD"),this.setMode("MODE_TEXT")},y.ccEDM=function(){this.logger.log(h.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},y.ccCR=function(){this.logger.log(h.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},y.ccENM=function(){this.logger.log(h.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},y.ccEOC=function(){if(this.logger.log(h.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var _=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=_,this.writeScreen=this.nonDisplayedMemory,this.logger.log(h.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},y.ccTO=function(_){this.logger.log(h.INFO,"TO("+_+") - Tab Offset"),this.writeScreen.moveCursor(_)},y.ccMIDROW=function(_){var A={flash:!1};if(A.underline=_%2===1,A.italics=_>=46,A.italics)A.foreground="white";else{var I=Math.floor(_/2)-16,b=["white","green","blue","cyan","red","yellow","magenta"];A.foreground=b[I]}this.logger.log(h.INFO,"MIDROW: "+JSON.stringify(A)),this.writeScreen.setPen(A)},y.outputDataUpdate=function(_){_===void 0&&(_=!1);var A=this.logger.time;A!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=A:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,A,this.lastOutputScreen),_&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:A),this.lastOutputScreen.copy(this.displayedMemory))},y.cueSplitAtTime=function(_){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,_,this.displayedMemory),this.cueStartTime=_))},L}(),o=function(){function L(E,_,A){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var I=new v;this.channels=[null,new s(E,_,I),new s(E+1,A,I)],this.cmdHistory=D(),this.logger=I}var y=L.prototype;return y.getHandler=function(_){return this.channels[_].getHandler()},y.setHandler=function(_,A){this.channels[_].setHandler(A)},y.addData=function(_,A){var I,b,R,P=!1;this.logger.time=_;for(var w=0;w<A.length;w+=2)if(b=A[w]&127,R=A[w+1]&127,!(b===0&&R===0)){if(this.logger.log(h.DATA,"["+f([A[w],A[w+1]])+"] -> ("+f([b,R])+")"),I=this.parseCmd(b,R),I||(I=this.parseMidrow(b,R)),I||(I=this.parsePAC(b,R)),I||(I=this.parseBackgroundAttributes(b,R)),!I&&(P=this.parseChars(b,R),P)){var F=this.currentChannel;if(F&&F>0){var k=this.channels[F];k.insertChars(P)}else this.logger.log(h.WARNING,"No channel found yet. TEXT-MODE?")}!I&&!P&&this.logger.log(h.WARNING,"Couldn't parse cleaned data "+f([b,R])+" orig: "+f([A[w],A[w+1]]))}},y.parseCmd=function(_,A){var I=this.cmdHistory,b=(_===20||_===28||_===21||_===29)&&A>=32&&A<=47,R=(_===23||_===31)&&A>=33&&A<=35;if(!(b||R))return!1;if(p(_,A,I))return a(null,null,I),this.logger.log(h.DEBUG,"Repeated command ("+f([_,A])+") is dropped"),!0;var P=_===20||_===21||_===23?1:2,w=this.channels[P];return _===20||_===21||_===28||_===29?A===32?w.ccRCL():A===33?w.ccBS():A===34?w.ccAOF():A===35?w.ccAON():A===36?w.ccDER():A===37?w.ccRU(2):A===38?w.ccRU(3):A===39?w.ccRU(4):A===40?w.ccFON():A===41?w.ccRDC():A===42?w.ccTR():A===43?w.ccRTD():A===44?w.ccEDM():A===45?w.ccCR():A===46?w.ccENM():A===47&&w.ccEOC():w.ccTO(A-32),a(_,A,I),this.currentChannel=P,!0},y.parseMidrow=function(_,A){var I=0;if((_===17||_===25)&&A>=32&&A<=47){if(_===17?I=1:I=2,I!==this.currentChannel)return this.logger.log(h.ERROR,"Mismatch channel in midrow parsing"),!1;var b=this.channels[I];return b?(b.ccMIDROW(A),this.logger.log(h.DEBUG,"MIDROW ("+f([_,A])+")"),!0):!1}return!1},y.parsePAC=function(_,A){var I,b=this.cmdHistory,R=(_>=17&&_<=23||_>=25&&_<=31)&&A>=64&&A<=127,P=(_===16||_===24)&&A>=64&&A<=95;if(!(R||P))return!1;if(p(_,A,b))return a(null,null,b),!0;var w=_<=23?1:2;A>=64&&A<=95?I=w===1?g[_]:n[_]:I=w===1?u[_]:d[_];var F=this.channels[w];return F?(F.setPAC(this.interpretPAC(I,A)),a(_,A,b),this.currentChannel=w,!0):!1},y.interpretPAC=function(_,A){var I,b={color:null,italics:!1,indent:null,underline:!1,row:_};return A>95?I=A-96:I=A-64,b.underline=(I&1)===1,I<=13?b.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(I/2)]:I<=15?(b.italics=!0,b.color="white"):b.indent=Math.floor((I-16)/2)*4,b},y.parseChars=function(_,A){var I,b=null,R=null;if(_>=25?(I=2,R=_-8):(I=1,R=_),R>=17&&R<=19){var P;R===17?P=A+80:R===18?P=A+112:P=A+144,this.logger.log(h.INFO,"Special char '"+m(P)+"' in channel "+I),b=[P]}else _>=32&&_<=127&&(b=A===0?[_]:[_,A]);if(b){var w=f(b);this.logger.log(h.DEBUG,"Char codes =  "+w.join(",")),a(_,A,this.cmdHistory)}return b},y.parseBackgroundAttributes=function(_,A){var I=(_===16||_===24)&&A>=32&&A<=47,b=(_===23||_===31)&&A>=45&&A<=47;if(!(I||b))return!1;var R,P={};_===16||_===24?(R=Math.floor((A-32)/2),P.background=l[R],A%2===1&&(P.background=P.background+"_semi")):A===45?P.background="transparent":(P.foreground="black",A===47&&(P.underline=!0));var w=_<=23?1:2,F=this.channels[w];return F.setBkgData(P),a(_,A,this.cmdHistory),!0},y.reset=function(){for(var _=0;_<Object.keys(this.channels).length;_++){var A=this.channels[_];A&&A.reset()}this.cmdHistory=D()},y.cueSplitAtTime=function(_){for(var A=0;A<this.channels.length;A++){var I=this.channels[A];I&&I.cueSplitAtTime(_)}},L}();function a(L,y,E){E.a=L,E.b=y}function p(L,y,E){return E.a===L&&E.b===y}function D(){return{a:null,b:null}}C.default=o},"./src/utils/codecs.ts":function(O,C,x){x.r(C),x.d(C,"isCodecType",function(){return c}),x.d(C,"isCodecSupportedInMp4",function(){return m});var S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function c(M,T){var g=S[T];return!!g&&g[M.slice(0,4)]===!0}function m(M,T){return MediaSource.isTypeSupported((T||"video")+'/mp4;codecs="'+M+'"')}},"./src/utils/cues.ts":function(O,C,x){x.r(C);var S=x("./src/utils/vttparser.ts"),c=x("./src/utils/webvtt-parser.ts"),m=x("./src/utils/texttrack-utils.ts"),M=/\s/,T={newCue:function(u,n,d,l){for(var h=[],v,f,r,t,i,e=self.VTTCue||self.TextTrackCue,s=0;s<l.rows.length;s++)if(v=l.rows[s],r=!0,t=0,i="",!v.isEmpty()){for(var o=0;o<v.chars.length;o++)M.test(v.chars[o].uchar)&&r?t++:(i+=v.chars[o].uchar,r=!1);v.cueStartTime=n,n===d&&(d+=1e-4),t>=16?t--:t++;var a=Object(S.fixLineBreaks)(i.trim()),p=Object(c.generateCueId)(n,d,a);(!u||!u.cues||!u.cues.getCueById(p))&&(f=new e(n,d,a),f.id=p,f.line=s+1,f.align="left",f.position=10+Math.min(80,Math.floor(t*8/32)*10),h.push(f))}return u&&h.length&&(h.sort(function(D,L){return D.line==="auto"||L.line==="auto"?0:D.line>8&&L.line>8?L.line-D.line:D.line-L.line}),h.forEach(function(D){return Object(m.addCueToTrack)(u,D)})),h}};C.default=T},"./src/utils/discontinuities.ts":function(O,C,x){x.r(C),x.d(C,"findFirstFragWithCC",function(){return M}),x.d(C,"shouldAlignOnDiscontinuities",function(){return T}),x.d(C,"findDiscontinuousReferenceFrag",function(){return g}),x.d(C,"adjustSlidingStart",function(){return n}),x.d(C,"alignStream",function(){return d}),x.d(C,"alignPDT",function(){return h}),x.d(C,"alignFragmentByPDTDelta",function(){return v}),x.d(C,"alignMediaPlaylistByPDT",function(){return f});var S=x("./src/polyfills/number.ts"),c=x("./src/utils/logger.ts"),m=x("./src/controller/level-helper.ts");function M(r,t){for(var i=null,e=0,s=r.length;e<s;e++){var o=r[e];if(o&&o.cc===t){i=o;break}}return i}function T(r,t,i){return!!(t.details&&(i.endCC>i.startCC||r&&r.cc<i.startCC))}function g(r,t){var i=r.fragments,e=t.fragments;if(!e.length||!i.length){c.logger.log("No fragments to align");return}var s=M(i,e[0].cc);if(!s||s&&!s.startPTS){c.logger.log("No frag in previous level to align on");return}return s}function u(r,t){if(r){var i=r.start+t;r.start=r.startPTS=i,r.endPTS=i+r.duration}}function n(r,t){for(var i=t.fragments,e=0,s=i.length;e<s;e++)u(i[e],r);t.fragmentHint&&u(t.fragmentHint,r),t.alignedSliding=!0}function d(r,t,i){!t||(l(r,i,t),!i.alignedSliding&&t.details&&h(i,t.details),!i.alignedSliding&&t.details&&!i.skippedSegments&&Object(m.adjustSliding)(t.details,i))}function l(r,t,i){if(T(r,i,t)){var e=g(i.details,t);e&&Object(S.isFiniteNumber)(e.start)&&(c.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),n(e.start,t))}}function h(r,t){if(!(!t.fragments.length||!r.hasProgramDateTime||!t.hasProgramDateTime)){var i=t.fragments[0].programDateTime,e=r.fragments[0].programDateTime,s=(e-i)/1e3+t.fragments[0].start;s&&Object(S.isFiniteNumber)(s)&&(c.logger.log("Adjusting PTS using programDateTime delta "+(e-i)+"ms, sliding:"+s.toFixed(3)+" "+r.url+" "),n(s,r))}}function v(r,t){var i=r.programDateTime;if(!!i){var e=(i-t)/1e3;r.start=r.startPTS=e,r.endPTS=e+r.duration}}function f(r,t){if(!(!t.fragments.length||!r.hasProgramDateTime||!t.hasProgramDateTime)){var i=t.fragments[0].programDateTime,e=t.fragments[0].start,s=i-e*1e3;r.fragments.forEach(function(o){v(o,s)}),r.fragmentHint&&v(r.fragmentHint,s),r.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(O,C,x){x.r(C);var S=x("./src/utils/ewma.ts"),c=function(){function m(T,g,u){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=u,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new S.default(T),this.fast_=new S.default(g)}var M=m.prototype;return M.update=function(g,u){var n=this.slow_,d=this.fast_;this.slow_.halfLife!==g&&(this.slow_=new S.default(g,n.getEstimate(),n.getTotalWeight())),this.fast_.halfLife!==u&&(this.fast_=new S.default(u,d.getEstimate(),d.getTotalWeight()))},M.sample=function(g,u){g=Math.max(g,this.minDelayMs_);var n=8*u,d=g/1e3,l=n/d;this.fast_.sample(d,l),this.slow_.sample(d,l)},M.canEstimate=function(){var g=this.fast_;return g&&g.getTotalWeight()>=this.minWeight_},M.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},M.destroy=function(){},m}();C.default=c},"./src/utils/ewma.ts":function(O,C,x){x.r(C);var S=function(){function c(M,T,g){T===void 0&&(T=0),g===void 0&&(g=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=M,this.alpha_=M?Math.exp(Math.log(.5)/M):0,this.estimate_=T,this.totalWeight_=g}var m=c.prototype;return m.sample=function(T,g){var u=Math.pow(this.alpha_,T);this.estimate_=g*(1-u)+u*this.estimate_,this.totalWeight_+=T},m.getTotalWeight=function(){return this.totalWeight_},m.getEstimate=function(){if(this.alpha_){var T=1-Math.pow(this.alpha_,this.totalWeight_);if(T)return this.estimate_/T}return this.estimate_},c}();C.default=S},"./src/utils/fetch-loader.ts":function(O,C,x){x.r(C),x.d(C,"fetchSupported",function(){return v});var S=x("./src/polyfills/number.ts"),c=x("./src/loader/load-stats.ts"),m=x("./src/demux/chunk-cache.ts");function M(e,s){e.prototype=Object.create(s.prototype),e.prototype.constructor=e,d(e,s)}function T(e){var s=typeof Map=="function"?new Map:void 0;return T=function(a){if(a===null||!n(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof s!="undefined"){if(s.has(a))return s.get(a);s.set(a,p)}function p(){return g(a,arguments,l(this).constructor)}return p.prototype=Object.create(a.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),d(p,a)},T(e)}function g(e,s,o){return u()?g=Reflect.construct:g=function(p,D,L){var y=[null];y.push.apply(y,D);var E=Function.bind.apply(p,y),_=new E;return L&&d(_,L.prototype),_},g.apply(null,arguments)}function u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function n(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function d(e,s){return d=Object.setPrototypeOf||function(a,p){return a.__proto__=p,a},d(e,s)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},l(e)}function h(){return h=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},h.apply(this,arguments)}function v(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var f=function(){function e(o){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=o.fetchSetup||t,this.controller=new self.AbortController,this.stats=new c.LoadStats}var s=e.prototype;return s.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},s.abortInternal=function(){var a=this.response;(!a||!a.ok)&&(this.stats.aborted=!0,this.controller.abort())},s.abort=function(){var a;this.abortInternal(),(a=this.callbacks)!==null&&a!==void 0&&a.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},s.load=function(a,p,D){var L=this,y=this.stats;if(y.loading.start)throw new Error("Loader can only be used once.");y.loading.start=self.performance.now();var E=r(a,this.controller.signal),_=D.onProgress,A=a.responseType==="arraybuffer",I=A?"byteLength":"length";this.context=a,this.config=p,this.callbacks=D,this.request=this.fetchSetup(a,E),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){L.abortInternal(),D.onTimeout(y,a,L.response)},p.timeout),self.fetch(this.request).then(function(b){if(L.response=L.loader=b,!b.ok){var R=b.status,P=b.statusText;throw new i(P||"fetch, bad network response",R,b)}return y.loading.first=Math.max(self.performance.now(),y.loading.start),y.total=parseInt(b.headers.get("Content-Length")||"0"),_&&Object(S.isFiniteNumber)(p.highWaterMark)?L.loadProgressively(b,y,a,p.highWaterMark,_):A?b.arrayBuffer():b.text()}).then(function(b){var R=L.response;self.clearTimeout(L.requestTimeout),y.loading.end=Math.max(self.performance.now(),y.loading.first),y.loaded=y.total=b[I];var P={url:R.url,data:b};_&&!Object(S.isFiniteNumber)(p.highWaterMark)&&_(y,a,b,R),D.onSuccess(P,y,a,R)}).catch(function(b){if(self.clearTimeout(L.requestTimeout),!y.aborted){var R=b.code||0;D.onError({code:R,text:b.message},a,b.details)}})},s.getCacheAge=function(){var a=null;if(this.response){var p=this.response.headers.get("age");a=p?parseFloat(p):null}return a},s.loadProgressively=function(a,p,D,L,y){L===void 0&&(L=0);var E=new m.default,_=a.body.getReader(),A=function I(){return _.read().then(function(b){if(b.done)return E.dataLength&&y(p,D,E.flush(),a),Promise.resolve(new ArrayBuffer(0));var R=b.value,P=R.length;return p.loaded+=P,P<L||E.dataLength?(E.push(R),E.dataLength>=L&&y(p,D,E.flush(),a)):y(p,D,R,a),I()}).catch(function(){return Promise.reject()})};return A()},e}();function r(e,s){var o={method:"GET",mode:"cors",credentials:"same-origin",signal:s,headers:new self.Headers(h({},e.headers))};return e.rangeEnd&&o.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),o}function t(e,s){return new self.Request(e.url,s)}var i=function(e){M(s,e);function s(o,a,p){var D;return D=e.call(this,o)||this,D.code=void 0,D.details=void 0,D.code=a,D.details=p,D}return s}(T(Error));C.default=f},"./src/utils/imsc1-ttml-parser.ts":function(O,C,x){x.r(C),x.d(C,"IMSC1_CODEC",function(){return n}),x.d(C,"parseIMSC1",function(){return v});var S=x("./src/utils/mp4-tools.ts"),c=x("./src/utils/vttparser.ts"),m=x("./src/utils/vttcue.ts"),M=x("./src/demux/id3.ts"),T=x("./src/utils/timescale-conversion.ts"),g=x("./src/utils/webvtt-parser.ts");function u(){return u=Object.assign||function(L){for(var y=1;y<arguments.length;y++){var E=arguments[y];for(var _ in E)Object.prototype.hasOwnProperty.call(E,_)&&(L[_]=E[_])}return L},u.apply(this,arguments)}var n="stpp.ttml.im1t",d=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,l=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,h={left:"start",center:"center",right:"end",start:"start",end:"end"};function v(L,y,E,_,A){var I=Object(S.findBox)(new Uint8Array(L),["mdat"]);if(I.length===0){A(new Error("Could not parse IMSC1 mdat"));return}var b=I[0],R=Object(M.utf8ArrayToStr)(new Uint8Array(L,b.start,b.end-b.start)),P=Object(T.toTimescaleFromScale)(y,1,E);try{_(f(R,P))}catch(w){A(w)}}function f(L,y){var E=new DOMParser,_=E.parseFromString(L,"text/xml"),A=_.getElementsByTagName("tt")[0];if(!A)throw new Error("Invalid ttml");var I={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},b=Object.keys(I).reduce(function(k,B){return k[B]=A.getAttribute("ttp:"+B)||I[B],k},{}),R=A.getAttribute("xml:space")!=="preserve",P=t(r(A,"styling","style")),w=t(r(A,"layout","region")),F=r(A,"body","[begin]");return[].map.call(F,function(k){var B=i(k,R);if(!B||!k.hasAttribute("begin"))return null;var U=a(k.getAttribute("begin"),b),j=a(k.getAttribute("dur"),b),K=a(k.getAttribute("end"),b);if(U===null)throw o(k);if(K===null){if(j===null)throw o(k);K=U+j}var N=new m.default(U-y,K-y,B);N.id=Object(g.generateCueId)(N.startTime,N.endTime,N.text);var Z=w[k.getAttribute("region")],$=P[k.getAttribute("style")];N.position=10,N.size=80;var Y=e(Z,$),ee=Y.textAlign;if(ee){var Q=h[ee];Q&&(N.lineAlign=Q),N.align=ee}return u(N,Y),N}).filter(function(k){return k!==null})}function r(L,y,E){var _=L.getElementsByTagName(y)[0];return _?[].slice.call(_.querySelectorAll(E)):[]}function t(L){return L.reduce(function(y,E){var _=E.getAttribute("xml:id");return _&&(y[_]=E),y},{})}function i(L,y){return[].slice.call(L.childNodes).reduce(function(E,_,A){var I;return _.nodeName==="br"&&A?E+`
`:(I=_.childNodes)!==null&&I!==void 0&&I.length?i(_,y):y?E+_.textContent.trim().replace(/\s+/g," "):E+_.textContent},"")}function e(L,y){var E="http://www.w3.org/ns/ttml#styling",_=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return _.reduce(function(A,I){var b=s(y,E,I)||s(L,E,I);return b&&(A[I]=b),A},{})}function s(L,y,E){return L.hasAttributeNS(y,E)?L.getAttributeNS(y,E):null}function o(L){return new Error("Could not parse ttml timestamp "+L)}function a(L,y){if(!L)return null;var E=Object(c.parseTimeStamp)(L);return E===null&&(d.test(L)?E=p(L,y):l.test(L)&&(E=D(L,y))),E}function p(L,y){var E=d.exec(L),_=(E[4]|0)+(E[5]|0)/y.subFrameRate;return(E[1]|0)*3600+(E[2]|0)*60+(E[3]|0)+_/y.frameRate}function D(L,y){var E=l.exec(L),_=Number(E[1]),A=E[2];switch(A){case"h":return _*3600;case"m":return _*60;case"ms":return _*1e3;case"f":return _/y.frameRate;case"t":return _/y.tickRate}return _}},"./src/utils/logger.ts":function(O,C,x){x.r(C),x.d(C,"enableLogs",function(){return g}),x.d(C,"logger",function(){return u});var S=function(){},c={trace:S,debug:S,log:S,warn:S,info:S,error:S},m=c;function M(n){var d=self.console[n];return d?d.bind(self.console,"["+n+"] >"):S}function T(n){for(var d=arguments.length,l=new Array(d>1?d-1:0),h=1;h<d;h++)l[h-1]=arguments[h];l.forEach(function(v){m[v]=n[v]?n[v].bind(n):M(v)})}function g(n){if(self.console&&n===!0||typeof n=="object"){T(n,"debug","log","info","warn","error");try{m.log()}catch{m=c}}else m=c}var u=m},"./src/utils/mediakeys-helper.ts":function(O,C,x){x.r(C),x.d(C,"KeySystems",function(){return S}),x.d(C,"requestMediaKeySystemAccess",function(){return c});var S;(function(m){m.WIDEVINE="com.widevine.alpha",m.PLAYREADY="com.microsoft.playready"})(S||(S={}));var c=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(O,C,x){x.r(C),x.d(C,"getMediaSource",function(){return S});function S(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(O,C,x){x.r(C),x.d(C,"bin2str",function(){return T}),x.d(C,"readUint16",function(){return g}),x.d(C,"readUint32",function(){return u}),x.d(C,"writeUint32",function(){return n}),x.d(C,"findBox",function(){return d}),x.d(C,"parseSegmentIndex",function(){return l}),x.d(C,"parseInitSegment",function(){return h}),x.d(C,"getStartDTS",function(){return v}),x.d(C,"getDuration",function(){return f}),x.d(C,"computeRawDurationFromSamples",function(){return r}),x.d(C,"offsetStartDTS",function(){return t}),x.d(C,"segmentValidRange",function(){return i}),x.d(C,"appendUint8Array",function(){return e});var S=x("./src/utils/typed-array.ts"),c=x("./src/loader/fragment.ts"),m=Math.pow(2,32)-1,M=[].push;function T(s){return String.fromCharCode.apply(null,s)}function g(s,o){"data"in s&&(o+=s.start,s=s.data);var a=s[o]<<8|s[o+1];return a<0?65536+a:a}function u(s,o){"data"in s&&(o+=s.start,s=s.data);var a=s[o]<<24|s[o+1]<<16|s[o+2]<<8|s[o+3];return a<0?4294967296+a:a}function n(s,o,a){"data"in s&&(o+=s.start,s=s.data),s[o]=a>>24,s[o+1]=a>>16&255,s[o+2]=a>>8&255,s[o+3]=a&255}function d(s,o){var a=[];if(!o.length)return a;var p,D,L;"data"in s?(p=s.data,D=s.start,L=s.end):(p=s,D=0,L=p.byteLength);for(var y=D;y<L;){var E=u(p,y),_=T(p.subarray(y+4,y+8)),A=E>1?y+E:L;if(_===o[0])if(o.length===1)a.push({data:p,start:y+8,end:A});else{var I=d({data:p,start:y+8,end:A},o.slice(1));I.length&&M.apply(a,I)}y=A}return a}function l(s){var o=d(s,["moov"]),a=o[0],p=a?a.end:null,D=d(s,["sidx"]);if(!D||!D[0])return null;var L=[],y=D[0],E=y.data[0],_=E===0?8:16,A=u(y,_);_+=4;var I=0,b=0;E===0?_+=8:_+=16,_+=2;var R=y.end+b,P=g(y,_);_+=2;for(var w=0;w<P;w++){var F=_,k=u(y,F);F+=4;var B=k&2147483647,U=(k&2147483648)>>>31;if(U===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var j=u(y,F);F+=4,L.push({referenceSize:B,subsegmentDuration:j,info:{duration:j/A,start:R,end:R+B-1}}),R+=B,F+=4,_=F}return{earliestPresentationTime:I,timescale:A,version:E,referencesCount:P,references:L,moovEndOffset:p}}function h(s){for(var o=[],a=d(s,["moov","trak"]),p=0;p<a.length;p++){var D=a[p],L=d(D,["tkhd"])[0];if(L){var y=L.data[L.start],E=y===0?12:20,_=u(L,E),A=d(D,["mdia","mdhd"])[0];if(A){y=A.data[A.start],E=y===0?12:20;var I=u(A,E),b=d(D,["mdia","hdlr"])[0];if(b){var R=T(b.data.subarray(b.start+8,b.start+12)),P={soun:c.ElementaryStreamTypes.AUDIO,vide:c.ElementaryStreamTypes.VIDEO}[R];if(P){var w=d(D,["mdia","minf","stbl","stsd"])[0],F=void 0;w&&(F=T(w.data.subarray(w.start+12,w.start+16))),o[_]={timescale:I,type:P},o[P]={timescale:I,id:_,codec:F}}}}}}var k=d(s,["moov","mvex","trex"]);return k.forEach(function(B){var U=u(B,4),j=o[U];j&&(j.default={duration:u(B,12),flags:u(B,20)})}),o}function v(s,o){return d(o,["moof","traf"]).reduce(function(a,p){var D=d(p,["tfdt"])[0],L=D.data[D.start],y=d(p,["tfhd"]).reduce(function(E,_){var A=u(_,4),I=s[A];if(I){var b=u(D,4);L===1&&(b*=Math.pow(2,32),b+=u(D,8));var R=I.timescale||9e4,P=b/R;if(isFinite(P)&&(E===null||P<E))return P}return E},null);return y!==null&&isFinite(y)&&(a===null||y<a)?y:a},null)||0}function f(s,o){for(var a=0,p=0,D=0,L=d(s,["moof","traf"]),y=0;y<L.length;y++){var E=L[y],_=d(E,["tfhd"])[0],A=u(_,4),I=o[A];if(!!I){var b=I.default,R=u(_,0)|(b==null?void 0:b.flags),P=b==null?void 0:b.duration;R&8&&(R&2?P=u(_,12):P=u(_,8));for(var w=I.timescale||9e4,F=d(E,["trun"]),k=0;k<F.length;k++){if(a=r(F[k]),!a&&P){var B=u(F[k],4);a=P*B}I.type===c.ElementaryStreamTypes.VIDEO?p+=a/w:I.type===c.ElementaryStreamTypes.AUDIO&&(D+=a/w)}}}if(p===0&&D===0){var U=l(s);if(U!=null&&U.references)return U.references.reduce(function(j,K){return j+K.info.duration||0},0)}return p||D}function r(s){var o=u(s,0),a=8;o&1&&(a+=4),o&4&&(a+=4);for(var p=0,D=u(s,4),L=0;L<D;L++){if(o&256){var y=u(s,a);p+=y,a+=4}o&512&&(a+=4),o&1024&&(a+=4),o&2048&&(a+=4)}return p}function t(s,o,a){d(o,["moof","traf"]).forEach(function(p){d(p,["tfhd"]).forEach(function(D){var L=u(D,4),y=s[L];if(!!y){var E=y.timescale||9e4;d(p,["tfdt"]).forEach(function(_){var A=_.data[_.start],I=u(_,4);if(A===0)n(_,4,I-a*E);else{I*=Math.pow(2,32),I+=u(_,8),I-=a*E,I=Math.max(I,0);var b=Math.floor(I/(m+1)),R=Math.floor(I%(m+1));n(_,4,b),n(_,8,R)}})}})})}function i(s){var o={valid:null,remainder:null},a=d(s,["moof"]);if(a){if(a.length<2)return o.remainder=s,o}else return o;var p=a[a.length-1];return o.valid=Object(S.sliceUint8)(s,0,p.start-8),o.remainder=Object(S.sliceUint8)(s,p.start-8),o}function e(s,o){var a=new Uint8Array(s.length+o.length);return a.set(s),a.set(o,s.length),a}},"./src/utils/output-filter.ts":function(O,C,x){x.r(C),x.d(C,"default",function(){return S});var S=function(){function c(M,T){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=M,this.trackName=T}var m=c.prototype;return m.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},m.newCue=function(T,g,u){(this.startTime===null||this.startTime>T)&&(this.startTime=T),this.endTime=g,this.screen=u,this.timelineController.createCaptionsTrack(this.trackName)},m.reset=function(){this.cueRanges=[],this.startTime=null},c}()},"./src/utils/texttrack-utils.ts":function(O,C,x){x.r(C),x.d(C,"sendAddTrackEvent",function(){return c}),x.d(C,"addCueToTrack",function(){return m}),x.d(C,"clearCurrentCues",function(){return M}),x.d(C,"removeCuesInRange",function(){return T}),x.d(C,"getCuesInRange",function(){return u});var S=x("./src/utils/logger.ts");function c(n,d){var l;try{l=new Event("addtrack")}catch{l=document.createEvent("Event"),l.initEvent("addtrack",!1,!1)}l.track=n,d.dispatchEvent(l)}function m(n,d){var l=n.mode;if(l==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(d.id))try{if(n.addCue(d),!n.cues.getCueById(d.id))throw new Error("addCue is failed for: "+d)}catch(v){S.logger.debug("[texttrack-utils]: "+v);var h=new self.TextTrackCue(d.startTime,d.endTime,d.text);h.id=d.id,n.addCue(h)}l==="disabled"&&(n.mode=l)}function M(n){var d=n.mode;if(d==="disabled"&&(n.mode="hidden"),n.cues)for(var l=n.cues.length;l--;)n.removeCue(n.cues[l]);d==="disabled"&&(n.mode=d)}function T(n,d,l){var h=n.mode;if(h==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0)for(var v=u(n.cues,d,l),f=0;f<v.length;f++)n.removeCue(v[f]);h==="disabled"&&(n.mode=h)}function g(n,d){if(d<n[0].startTime)return 0;var l=n.length-1;if(d>n[l].endTime)return-1;for(var h=0,v=l;h<=v;){var f=Math.floor((v+h)/2);if(d<n[f].startTime)v=f-1;else if(d>n[f].startTime&&h<l)h=f+1;else return f}return n[h].startTime-d<d-n[v].startTime?h:v}function u(n,d,l){var h=[],v=g(n,d);if(v>-1)for(var f=v,r=n.length;f<r;f++){var t=n[f];if(t.startTime>=d&&t.endTime<=l)h.push(t);else if(t.startTime>l)return h}return h}},"./src/utils/time-ranges.ts":function(O,C,x){x.r(C);var S={toString:function(m){for(var M="",T=m.length,g=0;g<T;g++)M+="["+m.start(g).toFixed(3)+","+m.end(g).toFixed(3)+"]";return M}};C.default=S},"./src/utils/timescale-conversion.ts":function(O,C,x){x.r(C),x.d(C,"toTimescaleFromBase",function(){return c}),x.d(C,"toTimescaleFromScale",function(){return m}),x.d(C,"toMsFromMpegTsClock",function(){return M}),x.d(C,"toMpegTsClockFromTimescale",function(){return T});var S=9e4;function c(g,u,n,d){n===void 0&&(n=1),d===void 0&&(d=!1);var l=g*u*n;return d?Math.round(l):l}function m(g,u,n,d){return n===void 0&&(n=1),d===void 0&&(d=!1),c(g,u,1/n,d)}function M(g,u){return u===void 0&&(u=!1),c(g,1e3,1/S,u)}function T(g,u){return u===void 0&&(u=1),c(g,S,1/u)}},"./src/utils/typed-array.ts":function(O,C,x){x.r(C),x.d(C,"sliceUint8",function(){return S});function S(c,m,M){return Uint8Array.prototype.slice?c.slice(m,M):new Uint8Array(Array.prototype.slice.call(c,m,M))}},"./src/utils/vttcue.ts":function(O,C,x){x.r(C),C.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var S=["","lr","rl"],c=["start","middle","end","left","right"];function m(n,d){if(typeof d!="string"||!Array.isArray(n))return!1;var l=d.toLowerCase();return~n.indexOf(l)?l:!1}function M(n){return m(S,n)}function T(n){return m(c,n)}function g(n){for(var d=arguments.length,l=new Array(d>1?d-1:0),h=1;h<d;h++)l[h-1]=arguments[h];for(var v=1;v<arguments.length;v++){var f=arguments[v];for(var r in f)n[r]=f[r]}return n}function u(n,d,l){var h=this,v={enumerable:!0};h.hasBeenReset=!1;var f="",r=!1,t=n,i=d,e=l,s=null,o="",a=!0,p="auto",D="start",L=50,y="middle",E=50,_="middle";Object.defineProperty(h,"id",g({},v,{get:function(){return f},set:function(I){f=""+I}})),Object.defineProperty(h,"pauseOnExit",g({},v,{get:function(){return r},set:function(I){r=!!I}})),Object.defineProperty(h,"startTime",g({},v,{get:function(){return t},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");t=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",g({},v,{get:function(){return i},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");i=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",g({},v,{get:function(){return e},set:function(I){e=""+I,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",g({},v,{get:function(){return s},set:function(I){s=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",g({},v,{get:function(){return o},set:function(I){var b=M(I);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");o=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",g({},v,{get:function(){return a},set:function(I){a=!!I,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",g({},v,{get:function(){return p},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");p=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",g({},v,{get:function(){return D},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");D=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",g({},v,{get:function(){return L},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");L=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",g({},v,{get:function(){return y},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");y=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",g({},v,{get:function(){return E},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");E=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",g({},v,{get:function(){return _},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");_=b,this.hasBeenReset=!0}})),h.displayState=void 0}return u.prototype.getCueAsHTML=function(){var n=self.WebVTT;return n.convertCueToDOMTree(self,this.text)},u}()},"./src/utils/vttparser.ts":function(O,C,x){x.r(C),x.d(C,"parseTimeStamp",function(){return m}),x.d(C,"fixLineBreaks",function(){return d}),x.d(C,"VTTParser",function(){return l});var S=x("./src/utils/vttcue.ts"),c=function(){function h(){}var v=h.prototype;return v.decode=function(r,t){if(!r)return"";if(typeof r!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(r))},h}();function m(h){function v(r,t,i,e){return(r|0)*3600+(t|0)*60+(i|0)+parseFloat(e||0)}var f=h.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return f?parseFloat(f[2])>59?v(f[2],f[3],0,f[4]):v(f[1],f[2],f[3],f[4]):null}var M=function(){function h(){this.values=Object.create(null)}var v=h.prototype;return v.set=function(r,t){!this.get(r)&&t!==""&&(this.values[r]=t)},v.get=function(r,t,i){return i?this.has(r)?this.values[r]:t[i]:this.has(r)?this.values[r]:t},v.has=function(r){return r in this.values},v.alt=function(r,t,i){for(var e=0;e<i.length;++e)if(t===i[e]){this.set(r,t);break}},v.integer=function(r,t){/^-?\d+$/.test(t)&&this.set(r,parseInt(t,10))},v.percent=function(r,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var i=parseFloat(t);if(i>=0&&i<=100)return this.set(r,i),!0}return!1},h}();function T(h,v,f,r){var t=r?h.split(r):[h];for(var i in t)if(typeof t[i]=="string"){var e=t[i].split(f);if(e.length===2){var s=e[0],o=e[1];v(s,o)}}}var g=new S.default(0,0,""),u=g.align==="middle"?"middle":"center";function n(h,v,f){var r=h;function t(){var s=m(h);if(s===null)throw new Error("Malformed timestamp: "+r);return h=h.replace(/^[^\sa-zA-Z-]+/,""),s}function i(s,o){var a=new M;T(s,function(L,y){var E;switch(L){case"region":for(var _=f.length-1;_>=0;_--)if(f[_].id===y){a.set(L,f[_].region);break}break;case"vertical":a.alt(L,y,["rl","lr"]);break;case"line":E=y.split(","),a.integer(L,E[0]),a.percent(L,E[0])&&a.set("snapToLines",!1),a.alt(L,E[0],["auto"]),E.length===2&&a.alt("lineAlign",E[1],["start",u,"end"]);break;case"position":E=y.split(","),a.percent(L,E[0]),E.length===2&&a.alt("positionAlign",E[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":a.percent(L,y);break;case"align":a.alt(L,y,["start",u,"end","left","right"]);break}},/:/,/\s/),o.region=a.get("region",null),o.vertical=a.get("vertical","");var p=a.get("line","auto");p==="auto"&&g.line===-1&&(p=-1),o.line=p,o.lineAlign=a.get("lineAlign","start"),o.snapToLines=a.get("snapToLines",!0),o.size=a.get("size",100),o.align=a.get("align",u);var D=a.get("position","auto");D==="auto"&&g.position===50&&(D=o.align==="start"||o.align==="left"?0:o.align==="end"||o.align==="right"?100:50),o.position=D}function e(){h=h.replace(/^\s+/,"")}if(e(),v.startTime=t(),e(),h.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);h=h.substr(3),e(),v.endTime=t(),e(),i(h,v)}function d(h){return h.replace(/<br(?: \/)?>/gi,`
`)}var l=function(){function h(){this.state="INITIAL",this.buffer="",this.decoder=new c,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var v=h.prototype;return v.parse=function(r){var t=this;r&&(t.buffer+=t.decoder.decode(r,{stream:!0}));function i(){var D=t.buffer,L=0;for(D=d(D);L<D.length&&D[L]!=="\r"&&D[L]!==`
`;)++L;var y=D.substr(0,L);return D[L]==="\r"&&++L,D[L]===`
`&&++L,t.buffer=D.substr(L),y}function e(D){T(D,function(L,y){},/:/)}try{var s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=i();var o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=i(),t.state){case"HEADER":/:/.test(s)?e(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new S.default(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{n(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{var p=s.indexOf("-->")!==-1;if(!s||p&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},v.flush=function(){var r=this;try{if((r.cue||r.state==="HEADER")&&(r.buffer+=`

`,r.parse()),r.state==="INITIAL"||r.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){r.onparsingerror&&r.onparsingerror(t)}return r.onflush&&r.onflush(),this},h}()},"./src/utils/webvtt-parser.ts":function(O,C,x){x.r(C),x.d(C,"generateCueId",function(){return l}),x.d(C,"parseWebVTT",function(){return v});var S=x("./src/polyfills/number.ts"),c=x("./src/utils/vttparser.ts"),m=x("./src/demux/id3.ts"),M=x("./src/utils/timescale-conversion.ts"),T=x("./src/remux/mp4-remuxer.ts"),g=/\r\n|\n\r|\n|\r/g,u=function(r,t,i){return i===void 0&&(i=0),r.substr(i,t.length)===t},n=function(r){var t=parseInt(r.substr(-3)),i=parseInt(r.substr(-6,2)),e=parseInt(r.substr(-9,2)),s=r.length>9?parseInt(r.substr(0,r.indexOf(":"))):0;if(!Object(S.isFiniteNumber)(t)||!Object(S.isFiniteNumber)(i)||!Object(S.isFiniteNumber)(e)||!Object(S.isFiniteNumber)(s))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+r);return t+=1e3*i,t+=60*1e3*e,t+=60*60*1e3*s,t},d=function(r){for(var t=5381,i=r.length;i;)t=t*33^r.charCodeAt(--i);return(t>>>0).toString()};function l(f,r,t){return d(f.toString())+d(r.toString())+d(t)}var h=function(r,t,i){var e=r[t],s=r[e.prevCC];if(!s||!s.new&&e.new){r.ccOffset=r.presentationOffset=e.start,e.new=!1;return}for(;(o=s)!==null&&o!==void 0&&o.new;){var o;r.ccOffset+=e.start-s.start,e.new=!1,e=s,s=r[e.prevCC]}r.presentationOffset=i};function v(f,r,t,i,e,s,o,a){var p=new c.VTTParser,D=Object(m.utf8ArrayToStr)(new Uint8Array(f)).trim().replace(g,`
`).split(`
`),L=[],y=Object(M.toMpegTsClockFromTimescale)(r,t),E="00:00.000",_=0,A=0,I,b=!0,R=!1;p.oncue=function(P){var w=i[e],F=i.ccOffset,k=(_-y)/9e4;if(w!=null&&w.new&&(A!==void 0?F=i.ccOffset=w.start:h(i,e,k)),k&&(F=k-i.presentationOffset),R){var B=P.endTime-P.startTime,U=Object(T.normalizePts)((P.startTime+F-A)*9e4,s*9e4)/9e4;P.startTime=U,P.endTime=U+B}var j=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(j)),P.id||(P.id=l(P.startTime,P.endTime,j)),P.endTime>0&&L.push(P)},p.onparsingerror=function(P){I=P},p.onflush=function(){if(I){a(I);return}o(L)},D.forEach(function(P){if(b)if(u(P,"X-TIMESTAMP-MAP=")){b=!1,R=!0,P.substr(16).split(",").forEach(function(w){u(w,"LOCAL:")?E=w.substr(6):u(w,"MPEGTS:")&&(_=parseInt(w.substr(7)))});try{A=n(E)/1e3}catch(w){R=!1,I=w}return}else P===""&&(b=!1);p.parse(P+`
`)}),p.flush()}},"./src/utils/xhr-loader.ts":function(O,C,x){x.r(C);var S=x("./src/utils/logger.ts"),c=x("./src/loader/load-stats.ts"),m=/^age:\s*[\d.]+\s*$/m,M=function(){function T(u){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=u?u.xhrSetup:null,this.stats=new c.LoadStats,this.retryDelay=0}var g=T.prototype;return g.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},g.abortInternal=function(){var n=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),n&&(n.onreadystatechange=null,n.onprogress=null,n.readyState!==4&&(this.stats.aborted=!0,n.abort()))},g.abort=function(){var n;this.abortInternal(),(n=this.callbacks)!==null&&n!==void 0&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},g.load=function(n,d,l){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=n,this.config=d,this.callbacks=l,this.retryDelay=d.retryDelay,this.loadInternal()},g.loadInternal=function(){var n=this.config,d=this.context;if(!!n){var l=this.loader=new self.XMLHttpRequest,h=this.stats;h.loading.first=0,h.loaded=0;var v=this.xhrSetup;try{if(v)try{v(l,d.url)}catch{l.open("GET",d.url,!0),v(l,d.url)}l.readyState||l.open("GET",d.url,!0);var f=this.context.headers;if(f)for(var r in f)l.setRequestHeader(r,f[r])}catch(t){this.callbacks.onError({code:l.status,text:t.message},d,l);return}d.rangeEnd&&l.setRequestHeader("Range","bytes="+d.rangeStart+"-"+(d.rangeEnd-1)),l.onreadystatechange=this.readystatechange.bind(this),l.onprogress=this.loadprogress.bind(this),l.responseType=d.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),l.send()}},g.readystatechange=function(){var n=this.context,d=this.loader,l=this.stats;if(!(!n||!d)){var h=d.readyState,v=this.config;if(!l.aborted&&h>=2)if(self.clearTimeout(this.requestTimeout),l.loading.first===0&&(l.loading.first=Math.max(self.performance.now(),l.loading.start)),h===4){d.onreadystatechange=null,d.onprogress=null;var f=d.status;if(f>=200&&f<300){l.loading.end=Math.max(self.performance.now(),l.loading.first);var r,t;if(n.responseType==="arraybuffer"?(r=d.response,t=r.byteLength):(r=d.responseText,t=r.length),l.loaded=l.total=t,!this.callbacks)return;var i=this.callbacks.onProgress;if(i&&i(l,n,r,d),!this.callbacks)return;var e={url:d.responseURL,data:r};this.callbacks.onSuccess(e,l,n,d)}else l.retry>=v.maxRetry||f>=400&&f<499?(S.logger.error(f+" while loading "+n.url),this.callbacks.onError({code:f,text:d.statusText},n,d)):(S.logger.warn(f+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,v.maxRetryDelay),l.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),v.timeout)}},g.loadtimeout=function(){S.logger.warn("timeout while loading "+this.context.url);var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))},g.loadprogress=function(n){var d=this.stats;d.loaded=n.loaded,n.lengthComputable&&(d.total=n.total)},g.getCacheAge=function(){var n=null;if(this.loader&&m.test(this.loader.getAllResponseHeaders())){var d=this.loader.getResponseHeader("age");n=d?parseFloat(d):null}return n},T}();C.default=M}}).default})})(Qe);var He=Ue(Qe.exports);const Me=ye=>(dt("data-v-2f8a626f"),ye=ye(),ct(),ye),Ft=Me(()=>pe("div",{class:"artplayer-app"},null,-1)),kt={key:0,class:"zfile-video-switch-tools"},Bt=De("\u4E0A\u4E00\u4E2A\u89C6\u9891"),Ut=De("\u4E0B\u4E00\u4E2A\u89C6\u9891"),jt={class:"zfile-video-tools"},Nt=De(" \u76F4\u63A5\u4E0B\u8F7D "),Kt=Me(()=>pe("img",{src:pt,alt:"\u4E0B\u8F7D"},null,-1)),Wt=De(" \u4F7F\u7528\u8FC5\u96F7\u4E0B\u8F7D "),Gt=Me(()=>pe("img",{src:gt,alt:"\u8FC5\u96F7"},null,-1)),zt=De(" \u4F7F\u7528 motrix \u4E0B\u8F7D "),Vt=Me(()=>pe("img",{src:mt,alt:"motrix"},null,-1)),Ht=De(" \u4F7F\u7528 PotPlayer \u64AD\u653E "),Yt=Me(()=>pe("img",{src:yt,alt:"PotPlayer"},null,-1)),Zt=De(" \u4F7F\u7528 IINA \u64AD\u653E "),Qt=Me(()=>pe("img",{src:Et,alt:"IINA"},null,-1)),$t=De(" \u4F7F\u7528 VLC \u64AD\u653E "),Xt=Me(()=>pe("img",{src:xt,alt:"VLC"},null,-1)),Jt=De(" \u4F7F\u7528 nPlayer \u64AD\u653E "),qt=Me(()=>pe("img",{src:_t,alt:"nPlayer"},null,-1)),er=De(" \u4F7F\u7528 MXPlayer(Free) \u64AD\u653E "),tr=Me(()=>pe("img",{src:Tt,alt:"MXPlayer(Free)"},null,-1)),rr=De(" \u4F7F\u7528 MXPlayer(Pro) \u64AD\u653E "),ir=Me(()=>pe("img",{src:St,alt:"MXPlayer(Pro)"},null,-1)),nr=Me(()=>pe("div",{class:"zfile-video-tools-tips"}," tips: \u53EF\u70B9\u51FB\u4E0A\u65B9\u7684\u8F6F\u4EF6\u56FE\u6807\u8FDB\u884C\u4E0B\u8F7D\u64AD\u653E, \u672C\u5730\u64AD\u653E\u5668\u89E3\u7801\u6548\u679C\u66F4\u4F73. ",-1)),sr={__name:"VideoPlayer",setup(ye){let Ie=it(),O=ot(),C=nt(),x=st();const S=e=>{let s=[];return C.filterFileByType("video").forEach(o=>{s.push({default:o.name===e,html:o.name,url:o.url})}),s};let c=lt(null);const m=e=>{switch(e){case"download":window.location=c.value.url;break;case"thunder":window.location=`thunder://${btoa("AA"+c.value.url+"ZZ")}`;break;case"motrix":window.location=`motrix://new-task?uri=${encodeURIComponent(c.value.url)}&out=${encodeURIComponent(c.value.name)}`;break;case"potplayer":window.location=`potplayer://${encodeURI(c.value.url)}`;break;case"iina":window.location=`iina://weblink?url=${encodeURIComponent(c.value.url)}`;break;case"vlc":window.location=`vlc://${c.value.url}`;break;case"nplayer":window.location=`nplayer-${c.value.url}`;break;case"mxplayer":window.location="intent:"+c.value.url+"#Intent;package=com.mxtech.videoplayer.ad;S.title="+c.value.name+";end";break;case"mxplayer-pro":window.location="intent:"+c.value.url+"#Intent;package=com.mxtech.videoplayer.pro;S.title="+c.value.name+";end";break}},M=e=>{let s=C.filterFileByType("video");T();for(let o=0;o<s.length;o++)if(s[o].name===e)return{prev:s[o-1]||null,next:s[o+1]||null}},T=()=>{let e=JSON.parse(localStorage.getItem("_h5_player_play_progress_"));if(e){for(let s of Object.keys(e))s.endsWith(e[s].progress)&&delete e[s];localStorage.setItem("_h5_player_play_progress_",JSON.stringify(e))}},g=e=>{let s=[];return C.fileList.find((o,a)=>{let p=o.name.toLowerCase();(p===e+".vtt"||p===e+".srt"||p===e+".ass")&&s.push({default:s.length===0,url:o.url,html:p})}),s.length>0&&s.push({url:"",html:"\u5173\u95ED\u5B57\u5E55"}),s};let u='<i class="art-icon art-icon-video-list"><svg t="1650551038453" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12028" width="20" height="20"><path d="M111.395066 179.64038l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12029"></path><path d="M111.395066 468.067418l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12030"></path><path d="M111.395066 756.493433l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12031"></path></svg></i>',n=`<i class="art-icon art-icon-subtitle"><svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 48 48">
    <path d="M0 0h48v48H0z" fill="none"></path>
    <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
</svg></i>`,d='<i class="art-icon art-icon-next-video"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>',l='<i class="art-icon art-icon-prev-video" style="transform: scale(-1,1);"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>';const h=ze("zfile-video-auto-player-next",!1),v=ze("zfile-video-auto-player",!1);let f=null;const r=(e,s)=>{c.value={name:e,url:s},document.querySelector(".zfile-video-dialog .el-dialog__title").innerHTML=e,f&&f.destroy();let o="mp4";e.toLowerCase().endsWith("flv")?o="flv":e.toLowerCase().endsWith("m3u8")&&(o="m3u8");let a=C.fileList.find(L=>{if("__"+e+"__"===L.name)return L});if(a){let L=Ie.removeDuplicateSeparator(a.path+"/"+a.name+"/video.m3u8"),y=Ie.removeDuplicateSeparator(x.config.domain+"/"+x.config.directLinkPrefix+"/"+O.params.storageKey+"/"+L);c.value.url=y,o="m3u8"}let p={container:".artplayer-app",title:e,url:c.value.url,type:o,setting:!0,playbackRate:!0,flip:!0,fullscreen:!0,fastForward:!0,autoOrientation:!0,aspectRatio:!0,fullscreenWeb:!0,theme:"#23ade5",lock:!0,subtitleOffset:!0,miniProgressBar:!0,autoplay:v.value,whitelist:["*"],moreVideoAttr:{"x5-video-player-type":"h5","x5-video-player-fullscreen":!1,"x5-video-orientation":"portraint",preload:"metadata",crossOrigin:"anonymous"},customType:{flv:function(L,y){if(Ve.isSupported()){const E=Ve.createPlayer({type:"flv",url:y});E.attachMediaElement(L),E.load()}else f.notice.show="\u4E0D\u652F\u6301\u64AD\u653E\u683C\u5F0F\uFF1Aflv"},m3u8:function(L,y){if(He.isSupported()){const E=new He;E.loadSource(y),E.attachMedia(L)}else{const E=L.canPlayType("application/vnd.apple.mpegurl");E==="probably"||E=="maybe"?L.src=y:f.notice.show="\u4E0D\u652F\u6301\u64AD\u653E\u683C\u5F0F\uFF1Am3u8"}}},contextmenu:[{html:"\u4E0B\u8F7D",click:function(){window.open(s)}}],settings:[{html:"\u81EA\u52A8\u64AD\u653E",tooltip:v.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:v.value,onSwitch:function(L,y,E){console.info(L,y,E);const _=!L.switch;return v.value=_,f.autoplay=_,L.tooltip=_?"\u5F00\u542F":"\u5173\u95ED",_}},{html:"\u81EA\u52A8\u64AD\u653E\u4E0B\u4E00\u4E2A\u89C6\u9891",tooltip:h.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:h.value,onSwitch:function(L,y,E){console.info(L,y,E);const _=!L.switch;return h.value=_,L.tooltip=_?"\u5F00\u542F":"\u5173\u95ED",_}}],controls:[{name:"video-list",position:"right",html:u,selector:S(e),onSelect:function(L,y){return r(L.html,L.url),u}}]},D=g(e);D.length>0&&D.length>1&&p.controls.push({name:"video-subtitle",position:"right",html:n,selector:D,onSelect:L=>(L.html==="\u5173\u95ED\u5B57\u5E55"?f.subtitle.show=!1:(f.subtitle.show=!0,f.subtitle.url=L.url),n)}),f=new Lt(p),f.on("destory",()=>{}),Ie.isMobile.value===!1&&f.on("ready",()=>{let L=M(f.option.title);L.prev&&f.controls.add({name:"prev-video",position:"left",index:5,tooltip:"\u64AD\u653E\u4E0A\u4E00\u4E2A",html:l,click:()=>{i()}}),L.next&&f.controls.add({name:"next-video",position:"left",index:15,tooltip:"\u64AD\u653E\u4E0B\u4E00\u4E2A",html:d,click:()=>{t()}})}),f.on("video:ended",()=>{h.value&&t()}),D.length>0&&(f.subtitle.url=D[0].url)},t=()=>{const e=M(f.option.title).next;e&&r(e.name,e.url)},i=()=>{const e=M(f.option.title).prev;e&&r(e.name,e.url)};return ut(()=>{r(C.currentClickRow.name,C.currentClickRow.url)}),(e,s)=>{const o=ht,a=vt;return Pe(),we("div",null,[Ft,Re(c)&&Re(Ie).isMobile.value?(Pe(),we("div",kt,[We(Ae(o,{icon:Re(bt),onClick:i},{default:ge(()=>[Bt]),_:1},8,["icon"]),[[Ge,M(Re(c).name).prev]]),We(Ae(o,{icon:Re(wt),onClick:t},{default:ge(()=>[Ut]),_:1},8,["icon"]),[[Ge,M(Re(c).name).next]])])):ft("",!0),pe("div",jt,[pe("div",{class:"zfile-video-tools-item",onClick:s[0]||(s[0]=p=>m("download"))},[Ae(a,{placement:"top"},{content:ge(()=>[Nt]),default:ge(()=>[Kt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[1]||(s[1]=p=>m("thunder"))},[Ae(a,{placement:"top"},{content:ge(()=>[Wt]),default:ge(()=>[Gt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[2]||(s[2]=p=>m("motrix"))},[Ae(a,{placement:"top"},{content:ge(()=>[zt]),default:ge(()=>[Vt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[3]||(s[3]=p=>m("potplayer"))},[Ae(a,{placement:"top"},{content:ge(()=>[Ht]),default:ge(()=>[Yt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[4]||(s[4]=p=>m("iina"))},[Ae(a,{placement:"top"},{content:ge(()=>[Zt]),default:ge(()=>[Qt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[5]||(s[5]=p=>m("vlc"))},[Ae(a,{placement:"top"},{content:ge(()=>[$t]),default:ge(()=>[Xt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[6]||(s[6]=p=>m("nplayer"))},[Ae(a,{placement:"top"},{content:ge(()=>[Jt]),default:ge(()=>[qt]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[7]||(s[7]=p=>m("mxplayer"))},[Ae(a,{placement:"top"},{content:ge(()=>[er]),default:ge(()=>[tr]),_:1})]),pe("div",{class:"zfile-video-tools-item",onClick:s[8]||(s[8]=p=>m("mxplayer-pro"))},[Ae(a,{placement:"top"},{content:ge(()=>[rr]),default:ge(()=>[ir]),_:1})])]),nr])}}};var Lr=at(sr,[["__scopeId","data-v-2f8a626f"]]);export{Lr as default};
